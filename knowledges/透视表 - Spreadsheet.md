## 图表属性

- 名称：透视表
- 别名：交叉表、多维表格、数据透视表，英文名 Spreadsheet / Pivot Table
- 形状：矩形网格
- 图表类别：多维数据分析
- 图表功能：交叉分析、数据汇总、维度钻取、多指标对比

## 基础概念

透视表（Pivot Table）是一种强大的数据分析工具，用于对大量数据进行汇总、分析、探索和展示。它允许用户通过拖放字段到行、列和值区域，快速生成交叉表格式的汇总报告。

透视表的核心能力在于多维度交叉分析。用户可以将分类维度放在行头或列头，将数值指标放在数据区域，从而实现不同维度的数据对比和汇总。透视表也支持明细表模式，用于展示原始数据的详细记录。

与普通表格相比，透视表具有以下优势：

- 支持多层级行头和列头
- 自动汇总和小计
- 高性能渲染，支持大数据量
- 灵活的交互能力（排序、筛选、展开/收起）

## 适用场景

- 财务报表：按时间、部门、产品类别的多维度收入/成本分析。
- 销售分析：按地区、渠道、产品的销售数据交叉分析。
- 运营指标：DAU、MAU 等指标按不同维度的对比分析。
- 数据汇总：需要对原始数据进行分组聚合的场景。

## 不适用场景

1. 只需简单展示扁平数据时，使用普通表格即可。
2. 数据之间存在层级关系或网络关系时，建议使用树图或网络图。
3. 需要展示数据趋势时，建议使用折线图或面积图。

## 图表用法

### 图表属性

```typescript
type Spreadsheet = {
  type: 'spreadsheet';
  data: Record<string, any>[];
  rows?: string[]; // 行头字段（存在时为透视表）
  columns?: string[]; // 列头字段/列顺序
  values?: string[]; // 数值字段（存在时为透视表）
  theme?: 'default' | 'dark';
  title?: string;
};
```

### 数据要求

- type：图表类型，必填，文本类型，值为 "spreadsheet"。
- data：表格数据，必填，数组对象类型。
- rows：行头字段，选填，字符串数组。存在时渲染为透视表。
- columns：列头字段，选填，字符串数组。用于指定列顺序或透视表的列维度。
- values：数值字段，选填，字符串数组。存在时渲染为透视表。
- theme：主题，选填，'default' 或 'dark'。
- title：表格标题，选填，文本类型。

## 使用示例

1. 展示销售明细表（明细表模式）。

```json
{
  "type": "spreadsheet",
  "data": [
    { "省份": "浙江", "城市": "杭州", "类型": "笔", "价格": 1 },
    { "省份": "浙江", "城市": "杭州", "类型": "纸张", "价格": 2 },
    { "省份": "浙江", "城市": "舟山", "类型": "笔", "价格": 17 },
    { "省份": "浙江", "城市": "舟山", "类型": "纸张", "价格": 6 }
  ],
  "title": "销售明细表"
}
```

2. 展示销售透视表（透视表模式）。

```json
{
  "type": "spreadsheet",
  "data": [
    { "省份": "浙江", "城市": "杭州", "类型": "笔", "价格": 1 },
    { "省份": "浙江", "城市": "杭州", "类型": "纸张", "价格": 2 },
    { "省份": "浙江", "城市": "舟山", "类型": "笔", "价格": 17 },
    { "省份": "浙江", "城市": "舟山", "类型": "纸张", "价格": 6 }
  ],
  "rows": ["省份", "城市"],
  "columns": ["类型"],
  "values": ["价格"],
  "title": "销售透视表"
}
```

3. 展示多指标透视表。

```json
{
  "type": "spreadsheet",
  "data": [
    { "地区": "华东", "产品": "电脑", "销售额": 50000, "利润": 8000 },
    { "地区": "华东", "产品": "手机", "销售额": 35000, "利润": 5500 },
    { "地区": "华北", "产品": "电脑", "销售额": 42000, "利润": 6800 },
    { "地区": "华北", "产品": "手机", "销售额": 28000, "利润": 4200 }
  ],
  "rows": ["地区"],
  "columns": ["产品"],
  "values": ["销售额", "利润"],
  "title": "区域产品销售分析"
}
```
