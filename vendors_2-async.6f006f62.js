(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_@antv/gpt-vis"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_@antv/gpt-vis"]||[]).push([["vendors_2"],{"001e0431":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{LayerSwitch:function(){return u;},default:function(){return u;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("d812e418")),o=n("631fd3ae"),s=r._(n("8e397f88"));function l(e){return Object.keys(null!=e?e:{}).every(e=>["layer","name","img"].includes(e));}class u extends s.default{constructor(...e){super(...e),(0,a.default)(this,"onLayerChange",()=>{var e;null!==(e=this.controlOption.layers)&&void 0!==e&&e.length||(this.selectValue=this.getLayerVisible(),this.setOptions({options:this.getLayerOptions()}));}),(0,a.default)(this,"onLayerVisibleChane",()=>{this.setSelectValue(this.getLayerVisible());}),(0,a.default)(this,"onSelectChange",()=>{this.layers.forEach(e=>{let t=this.selectValue.includes(e.name),n=e.isVisible();t&&!n&&e.show(),!t&&n&&e.hide();});});}get layers(){let e=this.layerService,{layers:t}=this.controlOption;if(Array.isArray(t)&&t.length){let n=[];return t.forEach(t=>{if(t instanceof Object&&(l(t)?n.push(t.layer):n.push(t)),"string"==typeof t){let r=e.getLayer(t)||e.getLayerByName(t);r&&n.push(r);}}),n;}return e.getLayers()||[];}getDefault(e){var t;return(0,i.default)((0,i.default)({},super.getDefault(e)),{},{title:"\u56FE\u5C42\u63A7\u5236",btnIcon:(0,o.createL7Icon)("l7-icon-layer"),options:[],multiple:null===(t=null==e?void 0:e.multiple)||void 0===t||t});}getLayerVisible(){return this.layers.filter(e=>e.isVisible()).map(e=>e.name);}getLayerOptions(){let{layers:e}=this.controlOption,t=null==e?void 0:e.every(e=>e.img);return e?null==e?void 0:e.map(e=>{if(l(e))return{text:e.name||e.layer.name,value:e.layer.name,img:t?e.img:void 0};if("string"==typeof e){let t=this.layerService.getLayer(e)||this.layerService.getLayerByName(e);return{text:null==t?void 0:t.name,value:null==t?void 0:t.name};}return{text:e.name,value:e.name};}):this.layers.map(e=>({text:e.name,value:e.name}));}setOptions(e){let t=this.checkUpdateOption(e,["layers","multiple"]);super.setOptions(e),t&&(!1===this.controlOption.multiple&&this.handleSingleSelection(),this.selectValue=this.getLayerVisible(),this.controlOption.options=this.getLayerOptions(),this.popper.setContent(this.getPopperContent(this.controlOption.options)));}handleSingleSelection(){this.layers.forEach((e,t)=>{0===t?e.show():e.hide();});}onAdd(){var e;return!1===this.controlOption.multiple&&this.handleSingleSelection(),null!==(e=this.controlOption.options)&&void 0!==e&&e.length||(this.controlOption.options=this.getLayerOptions()),this.controlOption.defaultValue||(this.controlOption.defaultValue=this.getLayerVisible()),this.on("selectChange",this.onSelectChange),this.layerService.on("layerChange",this.onLayerChange),super.onAdd();}onRemove(){this.off("selectChange",this.onSelectChange),this.layerService.off("layerChange",this.onLayerChange);}getIsMultiple(){return this.controlOption.multiple;}}},"00247819":function(e,t,n){var r=n("ce906886");e.exports=function(e,t,n){var i,a={};r.forEach(n,function(n){for(var r,o,s=e.parent(n);s;){if((r=e.parent(s))?(o=a[r],a[r]=s):(o=i,i=s),o&&o!==s){t.setEdge(o,s);return;}s=r;}});};},"0040cd97":function(e,t,n){var r=n("011deb24"),i=n("1f86664c"),a=n("05d6656f"),o=n("7c1db5f7"),s=n("c4fc35e5");e.exports=function(e,t,n,l){if(!o(e))return e;t=i(t,e);for(var u=-1,c=t.length,d=c-1,f=e;null!=f&&++u<c;){var h=s(t[u]),p=n;if("__proto__"===h||"constructor"===h||"prototype"===h)break;if(u!=d){var v=f[h];void 0===(p=l?l(v,h,f):void 0)&&(p=o(v)?v:a(t[u+1])?[]:{});}r(f,h,p),f=f[h];}return e;};},"0078e0f4":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"DoubleClickZoomHandler",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("d812e418"));class i{constructor(e,t){(0,r.default)(this,"_clickZoom",void 0),(0,r.default)(this,"_tapZoom",void 0),this._clickZoom=e,this._tapZoom=t;}enable(){this._clickZoom.enable(),this._tapZoom.enable();}disable(){this._clickZoom.disable(),this._tapZoom.disable();}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled();}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive();}}},"011deb24":function(e,t,n){var r=n("6b3683f9"),i=n("31e26024"),a=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var o=e[t];a.call(e,t)&&i(o,n)&&(void 0!==n||t in e)||r(e,t,n);};},"019759ab":function(e,t,n){e.exports=function(e){return null==e;};},"01b31941":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return m;}});var r=n("777fffbe"),i=n("852bbaa9"),a=i._(n("b17de636")),o=r._(n("84b4727a")),s=r._(n("0f9cdec1")),l=r._(n("4ef6cfc6")),u=r._(n("97d98753")),c=i._(n("bb92c4ce")),d=r._(n("5d61e09d")),f=r._(n("b194b4a1")),h=r._(n("b733ff0a")),p=r._(n("575c7ec2")),v=i._(n("eea0eef8")),g=i._(n("dfc7d926"));function m(e,t,n){var r=new y(null==t?v.defaultX:t,null==n?g.defaultY:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e);}function y(e,t,n,r,i,a){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0;}function b(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t;}var _=m.prototype=y.prototype;_.copy=function(){var e,t,n=new y(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=b(r),n;for(e=[{source:r,target:n._root=[,,,,]}];r=e.pop();)for(var i=0;i<4;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=[,,,,]}):r.target[i]=b(t));return n;},_.add=a.default,_.addAll=a.addAll,_.cover=o.default,_.data=s.default,_.extent=l.default,_.find=u.default,_.remove=c.default,_.removeAll=c.removeAll,_.root=d.default,_.size=f.default,_.visit=h.default,_.visitAfter=p.default,_.x=v.default,_.y=g.default;},"020a7b3d":function(e,t,n){var r=n("860e2ef1"),i=n("81c54a07"),a=n("d2bdbec4"),o=n("6ab6b06e"),s=n("ef51a61d"),l=n("c0051812"),u=n("85163435"),c=n("c31b66bd"),d="[object Arguments]",f="[object Array]",h="[object Object]",p=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,v,g,m){var y=l(e),b=l(t),_=y?f:s(e),x=b?f:s(t);_=_==d?h:_,x=x==d?h:x;var w=_==h,E=x==h,M=_==x;if(M&&u(e)){if(!u(t))return!1;y=!0,w=!1;}if(M&&!w)return m||(m=new r),y||c(e)?i(e,t,n,v,g,m):a(e,t,_,n,v,g,m);if(!(1&n)){var S=w&&p.call(e,"__wrapped__"),k=E&&p.call(t,"__wrapped__");if(S||k){var C=S?e.value():e,A=k?t.value():t;return m||(m=new r),g(C,A,n,v,m);}}return!!M&&(m||(m=new r),o(e,t,n,v,g,m));};},"02737fa5":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{COMMON_ATTRIBUTE_LOCATION:function(){return i;},getCommonStyleAttributeOptions:function(){return a;}});var r=n("d9b661b3");let i={POSITION:0,POSITION_64LOW:1,COLOR:2,PICKING_COLOR:3,STROKE:4,OPACITY:5,OFFSETS:6,ROTATION:7,MAX:8};function a(e){switch(e){case"rotation":return{name:"Rotation",type:r.AttributeType.Attribute,descriptor:{name:"a_Rotation",shaderLocation:i.ROTATION,buffer:{usage:r.gl.DYNAMIC_DRAW,data:[],type:r.gl.FLOAT},size:1,update:e=>{let{rotation:t=0}=e;return Array.isArray(t)?[t[0]]:[t];}}};case"stroke":return{name:"stroke",type:r.AttributeType.Attribute,descriptor:{name:"a_Stroke",shaderLocation:i.STROKE,buffer:{usage:r.gl.DYNAMIC_DRAW,data:[],type:r.gl.FLOAT},size:4,update:e=>{let{stroke:t=[1,1,1,1]}=e;return t;}}};case"opacity":return{name:"opacity",type:r.AttributeType.Attribute,descriptor:{name:"a_Opacity",shaderLocation:i.OPACITY,buffer:{usage:r.gl.STATIC_DRAW,data:[],type:r.gl.FLOAT},size:1,update:e=>{let{opacity:t=1}=e;return[t];}}};case"offsets":return{name:"offsets",type:r.AttributeType.Attribute,descriptor:{name:"a_Offsets",shaderLocation:i.OFFSETS,buffer:{usage:r.gl.STATIC_DRAW,data:[],type:r.gl.FLOAT},size:2,update:e=>{let{offsets:t}=e;return t;}}};default:return;}}},"02b75865":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){return void 0===e;};},"02e3140a":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("71f18948")),a=r._(n("b0c50986")),o=Object.prototype.hasOwnProperty,s=function(e,t){if(null===e||!(0,a.default)(e))return{};var n={};return(0,i.default)(t,function(t){o.call(e,t)&&(n[t]=e[t]);}),n;};},"02f1c5d2":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});class r{apply(e){e.hooks.beforeRender.tap("UpdateModelPlugin",()=>{e.layerModel&&e.layerModel.needUpdate().then(t=>{t&&e.renderLayers();});}),e.hooks.afterRender.tap("UpdateModelPlugin",()=>{e.layerModelNeedUpdate=!1;});}}},"0340f449":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){return function(t){return e(t);};};},"0341a906":function(e,t,n){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e;};},"0389e1e1":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("95d364ba")),a=r._(n("19b4e351"));function o(e,t,n,r){var o=(0,i.default)((0,a.default)(1&r?e.prototype:e),t,n);return 2&r&&"function"==typeof o?function(e){return o.apply(n,e);}:o;}},"03d93d57":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e,t){return null==e?void 0:e[t];};},"0489f0a4":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"Plugin",{enumerable:!0,get:function(){return b;}});var r=n("777fffbe"),i=r._(n("d812e418")),a=r._(n("1316cf9d")),o=r._(n("3d495adb")),s=r._(n("66a06515")),l=r._(n("20defe2a")),u=n("597eee67"),c=r._(n("82f98358")),d=n("0d884ee9");function f(e,t){var n=t.cx,r=t.cy,i=t.r;e.arc(void 0===n?0:n,void 0===r?0:r,i,0,2*Math.PI,!1);}function h(e,t){var n=t.cx,r=void 0===n?0:n,i=t.cy,a=void 0===i?0:i,o=t.rx,s=t.ry;e.ellipse?e.ellipse(r,a,o,s,0,0,2*Math.PI,!1):(e.save(),e.scale(o>s?1:o/s,o>s?s/o:1),e.arc(r,a,o>s?o:s,0,2*Math.PI));}function p(e,t){var n,r=t.x1,i=t.y1,a=t.x2,o=t.y2,s=t.markerStart,l=t.markerEnd,c=t.markerStartOffset,d=t.markerEndOffset,f=0,h=0,p=0,v=0,g=0;s&&(0,u.isDisplayObject)(s)&&c&&(f=Math.cos(g=Math.atan2(o-i,a-r))*(c||0),h=Math.sin(g)*(c||0)),l&&(0,u.isDisplayObject)(l)&&d&&(p=Math.cos(g=Math.atan2(i-o,r-a))*(d||0),v=Math.sin(g)*(d||0)),e.moveTo(r+f,i+h),e.lineTo(a+p,o+v);}function v(e,t){var n,r=t.markerStart,i=t.markerEnd,a=t.markerStartOffset,o=t.markerEndOffset,s=t.d,l=s.absolutePath,d=s.segments,f=0,h=0,p=0,v=0,g=0;if(r&&(0,u.isDisplayObject)(r)&&a){var m=r.parentNode.getStartTangent(),y=(0,c.default)(m,2),b=y[0],_=y[1];n=b[0]-_[0],f=Math.cos(g=Math.atan2(b[1]-_[1],n))*(a||0),h=Math.sin(g)*(a||0);}if(i&&(0,u.isDisplayObject)(i)&&o){var x=i.parentNode.getEndTangent(),w=(0,c.default)(x,2),E=w[0],M=w[1];n=E[0]-M[0],p=Math.cos(g=Math.atan2(E[1]-M[1],n))*(o||0),v=Math.sin(g)*(o||0);}for(var S=0;S<l.length;S++){var k=l[S],C=k[0],A=l[S+1],L=0===S&&(0!==f||0!==h),P=(S===l.length-1||A&&("M"===A[0]||"Z"===A[0]))&&0!==p&&0!==v,N=L?[f,h]:[0,0],O=(0,c.default)(N,2),I=O[0],R=O[1],D=P?[p,v]:[0,0],z=(0,c.default)(D,2),B=z[0],U=z[1];switch(C){case"M":e.moveTo(k[1]+I,k[2]+R);break;case"L":e.lineTo(k[1]+B,k[2]+U);break;case"Q":e.quadraticCurveTo(k[1],k[2],k[3]+B,k[4]+U);break;case"C":e.bezierCurveTo(k[1],k[2],k[3],k[4],k[5]+B,k[6]+U);break;case"A":var F=d[S].arcParams,j=F.cx,V=F.cy,G=F.rx,H=F.ry,W=F.startAngle,Z=F.endAngle,q=F.xRotation,Y=F.sweepFlag;if(e.ellipse)e.ellipse(j,V,G,H,q,W,Z,!!(1-Y));else{var X=G>H?G:H,$=G>H?1:G/H,K=G>H?H/G:1;e.translate(j,V),e.rotate(q),e.scale($,K),e.arc(0,0,X,W,Z,!!(1-Y)),e.scale(1/$,1/K),e.rotate(-q),e.translate(-j,-V);}P&&e.lineTo(k[6]+p,k[7]+v);break;case"Z":e.closePath();}}}function g(e,t){var n,r=t.markerStart,i=t.markerEnd,a=t.markerStartOffset,o=t.markerEndOffset,s=t.points.points,l=s.length,c=s[0][0],d=s[0][1],f=s[l-1][0],h=s[l-1][1],p=0,v=0,g=0,m=0,y=0;r&&(0,u.isDisplayObject)(r)&&a&&(n=s[1][0]-s[0][0],p=Math.cos(y=Math.atan2(s[1][1]-s[0][1],n))*(a||0),v=Math.sin(y)*(a||0)),i&&(0,u.isDisplayObject)(i)&&o&&(n=s[l-1][0]-s[0][0],g=Math.cos(y=Math.atan2(s[l-1][1]-s[0][1],n))*(o||0),m=Math.sin(y)*(o||0)),e.moveTo(c+(p||g),d+(v||m));for(var b=1;b<l-1;b++){var _=s[b];e.lineTo(_[0],_[1]);}e.lineTo(f,h);}function m(e,t){var n,r=t.markerStart,i=t.markerEnd,a=t.markerStartOffset,o=t.markerEndOffset,s=t.points.points,l=s.length,c=s[0][0],d=s[0][1],f=s[l-1][0],h=s[l-1][1],p=0,v=0,g=0,m=0,y=0;r&&(0,u.isDisplayObject)(r)&&a&&(n=s[1][0]-s[0][0],p=Math.cos(y=Math.atan2(s[1][1]-s[0][1],n))*(a||0),v=Math.sin(y)*(a||0)),i&&(0,u.isDisplayObject)(i)&&o&&(n=s[l-2][0]-s[l-1][0],g=Math.cos(y=Math.atan2(s[l-2][1]-s[l-1][1],n))*(o||0),m=Math.sin(y)*(o||0)),e.moveTo(c+p,d+v);for(var b=1;b<l-1;b++){var _=s[b];e.lineTo(_[0],_[1]);}e.lineTo(f+g,h+m);}function y(e,t){var n=t.x,r=void 0===n?0:n,i=t.y,a=void 0===i?0:i,o=t.radius,s=t.width,l=t.height;if(o&&o.some(function(e){return 0!==e;})){var u=s>0?1:-1,f=l>0?1:-1,h=u+f===0,p=o.map(function(e){return(0,d.clamp)(e,0,Math.min(Math.abs(s)/2,Math.abs(l)/2));}),v=(0,c.default)(p,4),g=v[0],m=v[1],y=v[2],b=v[3];e.moveTo(u*g+r,a),e.lineTo(s-u*m+r,a),0!==m&&e.arc(s-u*m+r,f*m+a,m,-f*Math.PI/2,u>0?0:Math.PI,h),e.lineTo(s+r,l-f*y+a),0!==y&&e.arc(s-u*y+r,l-f*y+a,y,u>0?0:Math.PI,f>0?Math.PI/2:1.5*Math.PI,h),e.lineTo(u*b+r,l+a),0!==b&&e.arc(u*b+r,l-f*b+a,b,f>0?Math.PI/2:-Math.PI/2,u>0?Math.PI:0,h),e.lineTo(r,f*g+a),0!==g&&e.arc(u*g+r,f*g+a,g,u>0?Math.PI:0,f>0?1.5*Math.PI:Math.PI/2,h);}else e.rect(r,a,s,l);}var b=function(e){function t(){var e;(0,a.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,s.default)(this,t,[].concat(r))).name="canvas-path-generator",e;}return(0,l.default)(t,e),(0,o.default)(t,[{key:"init",value:function(){var e,t=(e={},(0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)(e,u.Shape.CIRCLE,f),u.Shape.ELLIPSE,h),u.Shape.RECT,y),u.Shape.LINE,p),u.Shape.POLYLINE,m),u.Shape.POLYGON,g),u.Shape.PATH,v),u.Shape.TEXT,void 0),u.Shape.GROUP,void 0),u.Shape.IMAGE,void 0),(0,i.default)((0,i.default)((0,i.default)(e,u.Shape.HTML,void 0),u.Shape.MESH,void 0),u.Shape.FRAGMENT,void 0));this.context.pathGeneratorFactory=t;}},{key:"destroy",value:function(){delete this.context.pathGeneratorFactory;}}]);}(u.AbstractRendererPlugin);},"04cc7448":function(e,t,n){"use strict";function r(e,t,n){var r=e[0],i=e[1];return[r+(t[0]-r)*n,i+(t[1]-i)*n];}n.d(t,"__esModule",{value:!0}),n.d(t,"midPoint",{enumerable:!0,get:function(){return r;}});},"052092d4":function(e,t,n){"use strict";function r(e,t,n){let r=i(e,e.VERTEX_SHADER,t),a=i(e,e.FRAGMENT_SHADER,n);if(!r||!a)return null;let o=e.createProgram();if(!o)return null;if(e.attachShader(o,r),e.attachShader(o,a),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS))return console.warn("Failed to link program: "+e.getProgramInfoLog(o)),e.deleteProgram(o),e.deleteShader(a),e.deleteShader(r),null;let s=e.getProgramParameter(o,e.ACTIVE_ATTRIBUTES);for(let t=0;t<s;t++){let n=e.getActiveAttrib(o,t);o[n.name]=e.getAttribLocation(o,n.name);}let l=e.getProgramParameter(o,e.ACTIVE_UNIFORMS);for(let t=0;t<l;t++){let n=e.getActiveUniform(o,t);o[n.name]=e.getUniformLocation(o,n.name);}return o.vertexShader=r,o.fragmentShader=a,o;}function i(e,t,n){let r=e.createShader(t);return null==r?(console.warn("unable to create shader"),null):(e.shaderSource(r,n),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))?r:(console.warn("Failed to compile shader: "+e.getShaderInfoLog(r)),e.deleteShader(r),null);}function a(e,t,n,r,i){let a=e.createTexture();return e.bindTexture(e.TEXTURE_2D,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r,i,0,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_2D,null),a;}function o(e,t,n){let r=e.createTexture();return e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_2D,null),r;}function s(e,t,n){e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_2D,t);}function l(e,t){let n=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),n;}n.d(t,"__esModule",{value:!0}),n.e(t,{bindTexture:function(){return s;},createBuffer:function(){return l;},createDataTexture:function(){return o;},createProgram:function(){return r;},createTexture:function(){return a;},loadShader:function(){return i;}});},"05869b42":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("a9c461d6")),i=function(e){return(0,r.default)(this,e).has(e);};},"059e0d93":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0});var r=n("777fffbe"),i=n("81e755b2"),a=r._(n("1316cf9d")),o=r._(n("3d495adb")),s=r._(n("66a06515")),l=r._(n("20defe2a")),u=r._(n("6c762716")),c=r._(n("82f98358")),d=n("0d884ee9"),f=function(e){function t(e,n,r,i){var o;return(0,a.default)(this,t),(o=(0,s.default)(this,t,[e])).currentTime=r,o.timelineTime=i,o.target=n,o.type="finish",o.bubbles=!1,o.currentTarget=n,o.defaultPrevented=!1,o.eventPhase=o.AT_TARGET,o.timeStamp=Date.now(),o.currentTime=r,o.timelineTime=i,o;}return(0,l.default)(t,e),(0,o.default)(t);}(i.FederatedEvent),h=0,p=(0,o.default)(function e(t,n){var r;(0,a.default)(this,e),this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=t,t.animation=this,this.timeline=n,this.id="".concat(h++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number(null===(r=this.effect)||void 0===r?void 0:r.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises();},[{key:"pending",get:function(){return null===this._startTime&&!this._paused&&0!==this.playbackRate||this.currentTimePending;}},{key:"playState",get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running";}},{key:"ready",get:function(){var e=this;return this.readyPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(t,n){e.resolveReadyPromise=function(){t(e);},e.rejectReadyPromise=function(){n(Error());};}),this.pending||this.resolveReadyPromise()),this.readyPromise;}},{key:"finished",get:function(){var e=this;return this.finishedPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(t,n){e.resolveFinishedPromise=function(){t(e);},e.rejectFinishedPromise=function(){n(Error());};}),"finished"===this.playState&&this.resolveFinishedPromise()),this.finishedPromise;}},{key:"currentTime",get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime;},set:function(e){if(!isNaN(e=Number(e))){if(this.timeline.restart(),!this._paused&&null!==this._startTime){var t;this._startTime=Number(null===(t=this.timeline)||void 0===t?void 0:t.currentTime)-e/this.playbackRate;}this.currentTimePending=!1,this._currentTime!==e&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(e,!0),this.timeline.applyDirtiedAnimation(this));}}},{key:"startTime",get:function(){return this._startTime;},set:function(e){null!==e&&(this.updatePromises(),!isNaN(e=Number(e))&&(this._paused||this._idle||(this._startTime=e,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises())));}},{key:"playbackRate",get:function(){return this._playbackRate;},set:function(e){if(e!==this._playbackRate){this.updatePromises();var t=this.currentTime;this._playbackRate=e,this.startTime=null,"paused"!==this.playState&&"idle"!==this.playState&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),null!==t&&(this.currentTime=t),this.updatePromises();}}},{key:"_isFinished",get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&0>=Number(this._currentTime));}},{key:"totalDuration",get:function(){return this._totalDuration;}},{key:"_needsTick",get:function(){return this.pending||"running"===this.playState||!this._finishedFlag;}},{key:"updatePromises",value:function(){if(null!==(e=this.effect.target)&&void 0!==e&&e.destroyed)return this.readyPromise=void 0,this.finishedPromise=void 0,!1;var e,t=this.oldPlayState,n=this.pending?"pending":this.playState;return this.readyPromise&&n!==t&&("idle"===n?(this.rejectReadyPromise(),this.readyPromise=void 0):"pending"===t?this.resolveReadyPromise():"pending"===n&&(this.readyPromise=void 0)),this.finishedPromise&&n!==t&&("idle"===n?(this.rejectFinishedPromise(),this.finishedPromise=void 0):"finished"===n?this.resolveFinishedPromise():"finished"===t&&(this.finishedPromise=void 0)),this.oldPlayState=n,this.readyPromise||this.finishedPromise;}},{key:"play",value:function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),-1===this.timeline.animations.indexOf(this)&&this.timeline.animations.push(this),this.updatePromises();}},{key:"pause",value:function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),this._isFinished||this._paused||this._idle?this._idle&&(this.rewind(),this._idle=!1):this.currentTimePending=!0,this._startTime=null,this._paused=!0,this.updatePromises();}},{key:"finish",value:function(){this.updatePromises(),this._idle||(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises());}},{key:"cancel",value:function(){var e=this;if(this.updatePromises(),this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var t=new f(null,this,this.currentTime,null);setTimeout(function(){e.oncancel(t);});}}},{key:"reverse",value:function(){this.updatePromises();var e=this.currentTime;this.playbackRate*=-1,this.play(),null!==e&&(this.currentTime=e),this.updatePromises();}},{key:"updatePlaybackRate",value:function(e){this.playbackRate=e;}},{key:"targetAnimations",value:function(){var e;return(null===(e=this.effect)||void 0===e?void 0:e.target).getAnimations();}},{key:"markTarget",value:function(){var e=this.targetAnimations();-1===e.indexOf(this)&&e.push(this);}},{key:"unmarkTarget",value:function(){var e=this.targetAnimations(),t=e.indexOf(this);-1!==t&&e.splice(t,1);}},{key:"tick",value:function(e,t){this._idle||this._paused||(null===this._startTime?t&&(this.startTime=e-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((e-this._startTime)*this.playbackRate)),t&&(this.currentTimePending=!1,this.fireEvents(e));}},{key:"rewind",value:function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw Error("Unable to rewind negative playback rate animation with infinite duration");}},{key:"persist",value:function(){throw Error(i.ERROR_MSG_METHOD_NOT_IMPLEMENTED);}},{key:"addEventListener",value:function(e,t,n){throw Error(i.ERROR_MSG_METHOD_NOT_IMPLEMENTED);}},{key:"removeEventListener",value:function(e,t,n){throw Error(i.ERROR_MSG_METHOD_NOT_IMPLEMENTED);}},{key:"dispatchEvent",value:function(e){throw Error(i.ERROR_MSG_METHOD_NOT_IMPLEMENTED);}},{key:"commitStyles",value:function(){throw Error(i.ERROR_MSG_METHOD_NOT_IMPLEMENTED);}},{key:"ensureAlive",value:function(){var e,t;this.playbackRate<0&&0===this.currentTime?this._inEffect=!!(null!==(e=this.effect)&&void 0!==e&&e.update(-1)):this._inEffect=!!(null!==(t=this.effect)&&void 0!==t&&t.update(this.currentTime)),this._inTimeline||!this._inEffect&&this._finishedFlag||(this._inTimeline=!0,this.timeline.animations.push(this));}},{key:"tickCurrentTime",value:function(e,t){e!==this._currentTime&&(this._currentTime=e,this._isFinished&&!t&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive());}},{key:"fireEvents",value:function(e){var t=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var n=new f(null,this,this.currentTime,e);setTimeout(function(){t.onfinish&&t.onfinish(n);});}this._finishedFlag=!0;}}else{if(this.onframe&&"running"===this.playState){var r=new f(null,this,this.currentTime,e);this.onframe(r);}this._finishedFlag=!1;}}}]),v="function"==typeof Float32Array,g=function(e,t){return 1-3*t+3*e;},m=function(e,t){return 3*t-6*e;},y=function(e){return 3*e;},b=function(e,t,n){return((g(t,n)*e+m(t,n))*e+y(t))*e;},_=function(e,t,n){return 3*g(t,n)*e*e+2*m(t,n)*e+y(t);},x=function(e,t,n,r,i){var a,o,s=0;do(a=b(o=t+(n-t)/2,r,i)-e)>0?n=o:t=o;while(Math.abs(a)>1e-7&&++s<10)return o;},w=function(e,t,n,r){for(var i=0;i<4;++i){var a=_(t,n,r);if(0===a)break;var o=b(t,n,r)-e;t-=o/a;}return t;},E=function(e,t,n,r){if(!(e>=0&&e<=1&&n>=0&&n<=1))throw Error("bezier x values must be in [0, 1] range");if(e===t&&n===r)return function(e){return e;};for(var i=v?new Float32Array(11):Array(11),a=0;a<11;++a)i[a]=b(.1*a,e,n);var o=function(t){for(var r=0,a=1;10!==a&&i[a]<=t;++a)r+=.1;var o=r+(t-i[--a])/(i[a+1]-i[a])*.1,s=_(o,e,n);return s>=.001?w(t,o,e,n):0===s?o:x(t,r,r+.1,e,n);};return function(e){return 0===e||1===e?e:b(o(e),t,r);};},M=function(e){return Math.pow(e,2);},S=function(e){return Math.pow(e,3);},k=function(e){return Math.pow(e,4);},C=function(e){return Math.pow(e,5);},A=function(e){return Math.pow(e,6);},L=function(e){return 1-Math.cos(e*Math.PI/2);},P=function(e){return 1-Math.sqrt(1-e*e);},N=function(e){return e*e*(3*e-2);},O=function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*t-2)/22-e,2);},I=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=(0,c.default)(t,2),r=n[0],i=n[1],a=(0,d.clamp)(Number(void 0===r?1:r),1,10),o=(0,d.clamp)(Number(void 0===i?.5:i),.1,2);return 0===e||1===e?e:-a*Math.pow(2,10*(e-1))*Math.sin(2*Math.PI*(e-1-o/(2*Math.PI)*Math.asin(1/a))/o);},R=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=(0,c.default)(t,4),i=r[0],a=void 0===i?1:i,o=r[1],s=void 0===o?100:o,l=r[2],u=void 0===l?10:l,f=r[3],h=void 0===f?0:f;a=(0,d.clamp)(a,.1,1e3),s=(0,d.clamp)(s,.1,1e3),u=(0,d.clamp)(u,.1,1e3),h=(0,d.clamp)(h,.1,1e3);var p=Math.sqrt(s/a),v=u/(2*Math.sqrt(s*a)),g=v<1?p*Math.sqrt(1-v*v):0,m=v<1?(v*p+-h)/g:-h+p,y=n?n*e/1e3:e;return(y=v<1?Math.exp(-y*v*p)*(1*Math.cos(g*y)+m*Math.sin(g*y)):(1+m*y)*Math.exp(-y*p),0===e||1===e)?e:1-y;},D=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=(0,c.default)(t,2),r=n[0],i=void 0===r?10:r;return("start"===n[1]?Math.ceil:Math.floor)((0,d.clamp)(e,0,1)*i)/i;},z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=(0,c.default)(t,4);return E(n[0],n[1],n[2],n[3])(e);},B=E(.42,0,1,1),U=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;return 1-e(1-t,n,r);};},F=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;return t<.5?e(2*t,n,r)/2:1-e(-2*t+2,n,r)/2;};},j=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;return t<.5?(1-e(1-2*t,n,r))/2:(e(2*t-1,n,r)+1)/2;};},V={steps:D,"step-start":function(e){return D(e,[1,"start"]);},"step-end":function(e){return D(e,[1,"end"]);},linear:function(e){return e;},"cubic-bezier":z,ease:function(e){return z(e,[.25,.1,.25,1]);},in:B,out:U(B),"in-out":F(B),"out-in":j(B),"in-quad":M,"out-quad":U(M),"in-out-quad":F(M),"out-in-quad":j(M),"in-cubic":S,"out-cubic":U(S),"in-out-cubic":F(S),"out-in-cubic":j(S),"in-quart":k,"out-quart":U(k),"in-out-quart":F(k),"out-in-quart":j(k),"in-quint":C,"out-quint":U(C),"in-out-quint":F(C),"out-in-quint":j(C),"in-expo":A,"out-expo":U(A),"in-out-expo":F(A),"out-in-expo":j(A),"in-sine":L,"out-sine":U(L),"in-out-sine":F(L),"out-in-sine":j(L),"in-circ":P,"out-circ":U(P),"in-out-circ":F(P),"out-in-circ":j(P),"in-back":N,"out-back":U(N),"in-out-back":F(N),"out-in-back":j(N),"in-bounce":O,"out-bounce":U(O),"in-out-bounce":F(O),"out-in-bounce":j(O),"in-elastic":I,"out-elastic":U(I),"in-out-elastic":F(I),"out-in-elastic":j(I),spring:R,"spring-in":R,"spring-out":U(R),"spring-in-out":F(R),"spring-out-in":j(R)},G=function(e){var t;return("-"===(t=(t=e).replace(/([A-Z])/g,function(e){return"-".concat(e.toLowerCase());})).charAt(0)?t.substring(1):t).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim();},H=function(e){return e;};function W(e,t){return function(n){if(n>=1)return 1;var r=1/e;return(n+=t*r)-n%r;};}var Z="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",q=new RegExp("cubic-bezier\\(".concat(Z,",").concat(Z,",").concat(Z,",").concat(Z,"\\)")),Y=/steps\(\s*(\d+)\s*\)/,X=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function $(e){var t=q.exec(e);if(t)return E.apply(void 0,(0,u.default)(t.slice(1).map(Number)));var n=Y.exec(e);if(n)return W(Number(n[1]),0);var r=X.exec(e);return r?W(Number(r[1]),{start:1,middle:.5,end:0}[r[2]]):V[G(e)]||V.linear;}function K(e){return"offset"!==e&&"easing"!==e&&"composite"!==e&&"computedOffset"!==e;}var Q=function(e,t,n){return function(r){var i=function e(t,n,r){if("number"==typeof t&&"number"==typeof n)return t*(1-r)+n*r;if("boolean"==typeof t&&"boolean"==typeof n||"string"==typeof t&&"string"==typeof n)return r<.5?t:n;if(Array.isArray(t)&&Array.isArray(n)){for(var i=t.length,a=n.length,o=Math.max(i,a),s=[],l=0;l<o;l++)s.push(e(t[l<i?l:i-1],n[l<a?l:a-1],r));return s;}throw Error("Mismatched interpolation arguments ".concat(t,":").concat(n));}(e,t,r);return(0,d.isNumber)(i)?i:n(i);};},J=(0,o.default)(function e(){(0,a.default)(this,e),this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=H,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null;},[{key:"easing",get:function(){return this._easing;},set:function(e){this.easingFunction=$(e),this._easing=e;}}]);function ee(e,t){if(null===e)return[];Array.isArray(e)||(e=function(e){var t=[];for(var n in e)if(!(n in["easing","offset","composite"])){var r=e[n];Array.isArray(r)||(r=[r]);for(var i=r.length,a=0;a<i;a++){if(!t[a]){var o={};"offset"in e&&(o.offset=Number(e.offset)),"easing"in e&&(o.easing=e.easing),"composite"in e&&(o.composite=e.composite),t[a]=o;}void 0!==r[a]&&null!==r[a]&&(t[a][n]=r[a]);}}return t.sort(function(e,t){return(e.computedOffset||0)-(t.computedOffset||0);}),t;}(e));for(var n=e.map(function(e){var n={};for(var r in null!=t&&t.composite&&(n.composite="auto"),e){var i=e[r];if("offset"===r){if(null!==i){if(!isFinite(i=Number(i)))throw Error("Keyframe offsets must be numbers.");if(i<0||i>1)throw Error("Keyframe offsets must be between 0 and 1.");n.computedOffset=i;}}else if("composite"===r&&-1===["replace","add","accumulate","auto"].indexOf(i))throw Error("".concat(i," compositing is not supported"));n[r]=i;}return void 0===n.offset&&(n.offset=null),void 0===n.easing&&(n.easing=(null==t?void 0:t.easing)||"linear"),void 0===n.composite&&(n.composite="auto"),n;}),r=!0,i=-1/0,a=0;a<n.length;a++){var o=n[a].offset;if((0,d.isNil)(o))r=!1;else{if(o<i)throw TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=o;}}return n=n.filter(function(e){return Number(e.offset)>=0&&1>=Number(e.offset);}),r||function(){var e,t,r=n.length;n[r-1].computedOffset=Number(null!==(e=n[r-1].offset)&&void 0!==e?e:1),r>1&&(n[0].computedOffset=Number(null!==(t=n[0].offset)&&void 0!==t?t:0));for(var i=0,a=Number(n[0].computedOffset),o=1;o<r;o++){var s=n[o].computedOffset;if(!(0,d.isNil)(s)&&!(0,d.isNil)(a)){for(var l=1;l<o-i;l++)n[i+l].computedOffset=a+(Number(s)-a)*l/(o-i);i=o,a=Number(s);}}}(),n;}var et="backwards|forwards|both|none".split("|"),en="reverse|alternate|alternate-reverse".split("|"),er=(0,o.default)(function e(t,n,r){var o,s,l,c,d,f,h,p,v,g,m,y,b=this;(0,a.default)(this,e),this.composite="replace",this.iterationComposite="replace",this.target=t,this.timing=("number"==typeof(o=null!=(c=r)?c:{duration:"auto"})&&(o=isNaN(o)?{duration:"auto"}:{duration:o}),d=c=o,f=new J,"number"!=typeof d||isNaN(d)?void 0!==d&&Object.keys(d).forEach(function(e){void 0===d[e]||null===d[e]||"auto"===d[e]||("number"==typeof f[e]||"duration"===e)&&("number"!=typeof d[e]||isNaN(d[e]))||"fill"===e&&-1===et.indexOf(d[e])||"direction"===e&&-1===en.indexOf(d[e])||(f[e]=d[e]);}):f.duration=d,f),this.timing.effect=this,this.timing.activeDuration=Math.abs((0===(s=h=this.timing).duration||0===s.iterations?0:("auto"===s.duration?0:Number(s.duration))*(null!==(l=s.iterations)&&void 0!==l?l:1))/(h.playbackRate||1)),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=ee(n,this.timing),this.interpolations=(p=this.normalizedKeyframes,v=this.timing,g=this.target,y=function(e,t){var n=[];for(var r in e)for(var a=e[r],o=0;o<a.length-1;o++){var s=o,l=o+1,c=a[s].computedOffset,d=a[l].computedOffset,f=c,h=d;0===o&&(f=-1/0,0===d&&(l=s)),o===a.length-2&&(h=1/0,1===c&&(s=l)),n.push({applyFrom:f,applyTo:h,startOffset:a[s].computedOffset,endOffset:a[l].computedOffset,easingFunction:a[s].easingFunction,property:r,interpolation:function(e,t,n,r){var a=i.propertyMetadataCache[e];if(a&&a.syntax&&a.int){var o=i.runtime.styleValueRegistry.getPropertySyntax(a.syntax);if(o){var s=o.parser,l=s?s(t,r):t,c=s?s(n,r):n,d=o.mixer(l,c,r);if(d){var f=Q.apply(void 0,(0,u.default)(d));return function(e){return 0===e?t:1===e?n:f(e);};}}}return Q(!1,!0,function(e){return e?n:t;});}(r,a[s].value,a[l].value,t)});}return n.sort(function(e,t){return e.startOffset-t.startOffset;}),n;}(m=function(e,t){for(var n={},r=0;r<e.length;r++)for(var i in e[r])if(K(i)){var a={offset:e[r].offset,computedOffset:e[r].computedOffset,easing:e[r].easing,easingFunction:$(e[r].easing)||t.easingFunction,value:e[r][i]};n[i]=n[i]||[],n[i].push(a);}return n;}(p,v),g),function(e,t){if(null!==t)y.filter(function(e){return t>=e.applyFrom&&t<e.applyTo;}).forEach(function(n){var r=t-n.startOffset,i=n.endOffset-n.startOffset;e.setAttribute(n.property,n.interpolation(0===i?0:r/i),!1,!1);});else for(var n in m)K(n)&&e.setAttribute(n,null);});var _=i.runtime.globalThis.Proxy;this.computedTiming=_?new _(this.timing,{get:function(e,t){return"duration"===t?"auto"===e.duration?0:e.duration:"fill"===t?"auto"===e.fill?"none":e.fill:"localTime"===t?b.animation&&b.animation.currentTime||null:"currentIteration"===t?b.animation&&"running"===b.animation.playState?e.currentIteration||0:null:"progress"===t?b.animation&&"running"===b.animation.playState?e.progress||0:null:e[t];},set:function(){return!0;}}):this.timing;},[{key:"applyInterpolations",value:function(){this.interpolations(this.target,Number(this.timeFraction));}},{key:"update",value:function(e){return null!==e&&(this.timeFraction=function(e,t,n){var r,i,a,o,s,l,u,c=function(e,t,n){if(null===t)return 0;var r=n.endTime;return t<Math.min(n.delay,r)?1:t>=Math.min(n.delay+e+n.endDelay,r)?2:3;}(e,t,n),d=function(e,t,n,r,i){switch(r){case 1:if("backwards"===t||"both"===t)return 0;return null;case 3:return n-i;case 2:if("forwards"===t||"both"===t)return e;return null;case 0:return null;}}(e,n.fill,t,c,n.delay);if(null===d)return null;var f="auto"===n.duration?0:n.duration,h=(r=n.iterations,a=i=n.iterationStart,0===f?1!==c&&(a+=r):a+=d/f,a),p=(o=n.iterationStart,s=n.iterations,0==(l=h===1/0?o%1:h%1)&&2===c&&0!==s&&(0!==d||0===f)&&(l=1),l),v=(u=n.iterations,2===c&&u===1/0?1/0:1===p?Math.floor(h)-1:Math.floor(h)),g=function(e,t,n){var r=e;if("normal"!==e&&"reverse"!==e){var i=t;"alternate-reverse"===e&&(i+=1),r="normal",i!==1/0&&i%2!=0&&(r="reverse");}return"normal"===r?n:1-n;}(n.direction,v,p);return n.currentIteration=v,n.progress=g,n.easingFunction(g);}(this.timing.activeDuration,e,this.timing),null!==this.timeFraction);}},{key:"getKeyframes",value:function(){return this.normalizedKeyframes;}},{key:"setKeyframes",value:function(e){this.normalizedKeyframes=ee(e);}},{key:"getComputedTiming",value:function(){return this.computedTiming;}},{key:"getTiming",value:function(){return this.timing;}},{key:"updateTiming",value:function(e){var t=this;Object.keys(e||{}).forEach(function(n){t.timing[n]=e[n];});}}]);function ei(e,t){return Number(e.id)-Number(t.id);}var ea=(0,o.default)(function e(t){var n=this;(0,a.default)(this,e),this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(e){n.currentTime=e,n.discardAnimations(),0===n.animations.length?n.timelineTicking=!1:n.requestAnimationFrame(n.webAnimationsNextTick);},this.processRafCallbacks=function(e){var t=n.rafCallbacks;n.rafCallbacks=[],e<Number(n.currentTime)&&(e=Number(n.currentTime)),n.animations.sort(ei),n.animations=n.tick(e,!0,n.animations)[0],t.forEach(function(t){t[1](e);}),n.applyPendingEffects();},this.document=t;},[{key:"getAnimations",value:function(){return this.discardAnimations(),this.animations.slice();}},{key:"isTicking",value:function(){return this.inTick;}},{key:"play",value:function(e,t,n){var r=new p(new er(e,t,n),this);return this.animations.push(r),this.restartWebAnimationsNextTick(),r.updatePromises(),r.play(),r.updatePromises(),r;}},{key:"applyDirtiedAnimation",value:function(e){var t=this;if(!this.inTick){e.markTarget();var n=e.targetAnimations();n.sort(ei),this.tick(Number(this.currentTime),!1,n.slice())[1].forEach(function(e){var n=t.animations.indexOf(e);-1!==n&&t.animations.splice(n,1);}),this.applyPendingEffects();}}},{key:"restart",value:function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame;}},{key:"destroy",value:function(){this.document.defaultView.cancelAnimationFrame(this.frameId);}},{key:"applyPendingEffects",value:function(){this.pendingEffects.forEach(function(e){null==e||e.applyInterpolations();}),this.pendingEffects=[];}},{key:"updateAnimationsPromises",value:function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(e){return e.updatePromises();});}},{key:"discardAnimations",value:function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(e){return"finished"!==e.playState&&"idle"!==e.playState;});}},{key:"restartWebAnimationsNextTick",value:function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick));}},{key:"rAF",value:function(e){var t=this.rafId++;return 0===this.rafCallbacks.length&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([t,e]),t;}},{key:"requestAnimationFrame",value:function(e){var t=this;return this.rAF(function(n){t.updateAnimationsPromises(),e(n),t.updateAnimationsPromises();});}},{key:"tick",value:function(e,t,n){var r,i,a=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=e,this.ticking=!1;var o=[],s=[],l=[],u=[];return n.forEach(function(n){n.tick(e,t),n._inEffect?(s.push(n.effect),n.markTarget()):(o.push(n.effect),n.unmarkTarget()),n._needsTick&&(a.ticking=!0);var r=n._inEffect||n._needsTick;n._inTimeline=r,r?l.push(n):u.push(n);}),(r=this.pendingEffects).push.apply(r,o),(i=this.pendingEffects).push.apply(i,s),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[l,u];}}]);i.runtime.EasingFunction=$,i.runtime.AnimationTimeline=ea;},"05a4af02":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=n("777fffbe")._(n("731b2a36")).default.Symbol;},"05c30d73":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("a0ccf4b6")),a=r._(n("72f55a8e")),o=r._(n("f8218a40")),s=function(e,t,n,r,s,l){var u=1&n,c=e.length,d=t.length;if(c!=d&&!(u&&d>c))return!1;var f=l.get(e),h=l.get(t);if(f&&h)return f==t&&h==e;var p=-1,v=!0,g=2&n?new i.default:void 0;for(l.set(e,t),l.set(t,e);++p<c;){var m=e[p],y=t[p];if(r)var b=u?r(y,m,p,t,e,l):r(m,y,p,e,t,l);if(void 0!==b){if(b)continue;v=!1;break;}if(g){if(!(0,a.default)(t,function(e,t){if(!(0,o.default)(g,t)&&(m===e||s(m,e,n,r,l)))return g.push(t);})){v=!1;break;}}else if(!(m===y||s(m,y,n,r,l))){v=!1;break;}}return l.delete(e),l.delete(t),v;};},"05d6656f":function(e,t,n){var r=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&r.test(e))&&e>-1&&e%1==0&&e<t;};},"062d75f7":function(e,t,n){e.exports=function(e,t){return function(n){return e(t(n));};};},"062e2d5f":function(e,t,n){var r=n("c405380d");e.exports=function(e){var t=r(e,function(e){return 500===n.size&&n.clear(),e;}),n=t.cache;return t;};},"0654920e":function(e,t,n){e.exports=function(e){return void 0===e;};},"06f4e2df":function(e,t,n){var r=n("ddf11daa"),i=n("528719b1"),a=n("baa3a209");e.exports=function(e,t){return null==e?e:r(e,i(t),a);};},"07b92ccd":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{forceCenter:function(){return i.default;},forceCollide:function(){return a.default;},forceLink:function(){return o.default;},forceManyBody:function(){return s.default;},forceRadial:function(){return l.default;},forceSimulation:function(){return u.default;},forceX:function(){return c.default;},forceY:function(){return d.default;},forceZ:function(){return f.default;}});var r=n("777fffbe"),i=r._(n("966b1c37")),a=r._(n("50fa8f3d")),o=r._(n("c22ec664")),s=r._(n("eadbad1c")),l=r._(n("4cbeec94")),u=r._(n("2a1c9565")),c=r._(n("37216398")),d=r._(n("4bbd8d21")),f=r._(n("6855ca3a"));},"07d71ad2":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"PathParser",{enumerable:!0,get:function(){return r;}});var r=function(e){this.pathValue=e,this.segments=[],this.max=e.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err="";};},"082ade53":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{Zoom:function(){return c;},default:function(){return c;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("d812e418")),o=n("d9b661b3"),s=n("fb1ec05a"),l=n("631fd3ae"),u=n("9d431275");class c extends u.Control{constructor(...e){super(...e),(0,a.default)(this,"disabled",void 0),(0,a.default)(this,"zoomInButton",void 0),(0,a.default)(this,"zoomOutButton",void 0),(0,a.default)(this,"zoomNumDiv",void 0),(0,a.default)(this,"zoomIn",()=>{!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn();}),(0,a.default)(this,"zoomOut",()=>{!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut();}),(0,a.default)(this,"updateDisabled",()=>{let e=this.mapsService;this.zoomInButton.removeAttribute("disabled"),this.zoomOutButton.removeAttribute("disabled"),(this.disabled||e.getZoom()<=e.getMinZoom())&&this.zoomOutButton.setAttribute("disabled","true"),this.controlOption.showZoom&&this.zoomNumDiv&&(this.zoomNumDiv.innerText=String(Math.floor(e.getZoom()))),(this.disabled||e.getZoom()>=e.getMaxZoom())&&this.zoomInButton.setAttribute("disabled","true");});}getDefault(e){return(0,i.default)((0,i.default)({},super.getDefault(e)),{},{position:o.PositionType.BOTTOMRIGHT,name:"zoom",zoomInText:(0,l.createL7Icon)("l7-icon-enlarge"),zoomInTitle:"Zoom in",zoomOutText:(0,l.createL7Icon)("l7-icon-narrow"),zoomOutTitle:"Zoom out",showZoom:!1});}setOptions(e){super.setOptions(e),this.checkUpdateOption(e,["zoomInText","zoomInTitle","zoomOutText","zoomOutTitle","showZoom"])&&this.resetButtonGroup(this.container);}onAdd(){let e=s.DOM.create("div","l7-control-zoom");return this.resetButtonGroup(e),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),e;}onRemove(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled);}disable(){return this.disabled=!0,this.updateDisabled(),this;}enable(){return this.disabled=!1,this.updateDisabled(),this;}resetButtonGroup(e){s.DOM.clearChildren(e),this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,"l7-button-control",e,this.zoomIn),this.controlOption.showZoom&&(this.zoomNumDiv=this.createButton("0","","l7-button-control l7-control-zoom__number",e)),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,"l7-button-control",e,this.zoomOut),this.updateDisabled();}createButton(e,t,n,r,i){let a=s.DOM.create("button",n,r);return"string"==typeof e?a.innerHTML=e:a.append(e),a.title=t,i&&a.addEventListener("click",i),a;}}},"083a713c":function(e,t,n){"use strict";function r(e,t,n,r){for(;e.length;){let i=e.shift();if(n(i))return!0;t.add(i.id),r(i.id).forEach(n=>{t.has(n.id)||(t.add(n.id),e.push(n));});}return!1;}n.d(t,"__esModule",{value:!0}),n.e(t,{doBFS:function(){return r;},doDFS:function(){return function e(t,n,r,i){if(r(t))return!0;for(let a of(n.add(t.id),i(t.id)))if(!n.has(a.id)&&e(a,n,r,i))return!0;return!1;};}});},"08453f9e":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"TileLayerService",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418"));class o{constructor({rendererService:e,layerService:t,parent:n}){(0,a.default)(this,"tileResource",new Map),(0,a.default)(this,"rendererService",void 0),(0,a.default)(this,"layerService",void 0),(0,a.default)(this,"parent",void 0),(0,a.default)(this,"layerTiles",[]),this.rendererService=e,this.layerService=t,this.parent=n;}get tiles(){return this.layerTiles;}hasTile(e){return this.layerTiles.some(t=>t.key===e);}addTile(e){this.layerTiles.push(e);}getTile(e){return this.layerTiles.find(t=>t.key===e);}getVisibleTileBylngLat(e){return this.layerTiles.find(t=>t.isLoaded&&t.visible&&t.lnglatInBounds(e));}removeTile(e){let t=this.layerTiles.findIndex(t=>t.key===e),n=this.layerTiles.splice(t,1);n[0]&&n[0].destroy();}updateTileVisible(e){let t=this.getTile(e.key);if(e.isVisible){if(e.parent){let n=this.isChildrenLoaded(e.parent);null==t||t.updateVisible(n);}else null==t||t.updateVisible(!0);}else if(e.parent){let n=this.isChildrenLoaded(e.parent);null==t||t.updateVisible(!n);}else null==t||t.updateVisible(!1);}isParentLoaded(e){let t=e.parent;if(!t)return!0;let n=this.getTile(null==t?void 0:t.key);return null!=n&&!!n.isLoaded;}isChildrenLoaded(e){let t=null==e?void 0:e.children;return 0===t.length||t.every(e=>{let t=this.getTile(null==e?void 0:e.key);return!t||(null==t?void 0:t.isLoaded)===!0;});}render(){var e=this;return(0,i.default)(function*(){var t;let n=e.getRenderLayers().map((t=(0,i.default)(function*(t){yield e.layerService.renderTileLayer(t);}),function(e){return t.apply(this,arguments);}));yield Promise.all(n);})();}getRenderLayers(){let e=this.layerTiles.filter(e=>e.visible&&e.isLoaded),t=[];return e.map(e=>t.push(...e.getLayers())),t;}getLayers(){let e=this.layerTiles.filter(e=>e.isLoaded),t=[];return e.map(e=>t.push(...e.getLayers())),t;}getTiles(){return this.layerTiles;}destroy(){this.layerTiles.forEach(e=>e.destroy()),this.tileResource.clear();}}},"085e1ebd":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"segmentArcFactory",{enumerable:!0,get:function(){return o;}});var r=n("b1a0b97a"),i=n("d1adb660");function a(e,t){var n=e.x,r=e.y,i=t.x,a=t.y,o=Math.sqrt((Math.pow(n,2)+Math.pow(r,2))*(Math.pow(i,2)+Math.pow(a,2)));return(n*a-r*i<0?-1:1)*Math.acos((n*i+r*a)/o);}function o(e,t,n,o,s,l,u,c,d,f,h){var p,v=h.bbox,g=void 0===v||v,m=h.length,y=void 0===m||m,b=h.sampleSize,_=void 0===b?30:b,x="number"==typeof f,w=e,E=t,M=0,S=[w,E,0],k=[w,E],C={x:0,y:0},A=[{x:w,y:E}];x&&f<=0&&(C={x:w,y:E});for(var L=0;L<=_;L+=1){if(w=(p=function(e,t,n,i,o,s,l,u,c,d){var f=Math.abs,h=Math.sin,p=Math.cos,v=Math.sqrt,g=Math.PI,m=f(n),y=f(i),b=g/180*((o%360+360)%360);if(e===u&&t===c)return{x:e,y:t};if(0===m||0===y)return(0,r.segmentLineFactory)(e,t,u,c,d).point;var _=(e-u)/2,x=(t-c)/2,w={x:p(b)*_+h(b)*x,y:-h(b)*_+p(b)*x},E=Math.pow(w.x,2)/Math.pow(m,2)+Math.pow(w.y,2)/Math.pow(y,2);E>1&&(m*=v(E),y*=v(E));var M=(Math.pow(m,2)*Math.pow(y,2)-Math.pow(m,2)*Math.pow(w.y,2)-Math.pow(y,2)*Math.pow(w.x,2))/(Math.pow(m,2)*Math.pow(w.y,2)+Math.pow(y,2)*Math.pow(w.x,2)),S=(s!==l?1:-1)*v(M=M<0?0:M),k={x:S*(m*w.y/y),y:S*(-(y*w.x)/m)},C={x:p(b)*k.x-h(b)*k.y+(e+u)/2,y:h(b)*k.x+p(b)*k.y+(t+c)/2},A={x:(w.x-k.x)/m,y:(w.y-k.y)/y},L=a({x:1,y:0},A),P=a(A,{x:(-w.x-k.x)/m,y:(-w.y-k.y)/y});!l&&P>0?P-=2*g:l&&P<0&&(P+=2*g);var N=L+(P%=2*g)*d,O=m*p(N),I=y*h(N);return{x:p(b)*O-h(b)*I+C.x,y:h(b)*O+p(b)*I+C.y};}(e,t,n,o,s,l,u,c,d,L/_)).x,E=p.y,g&&A.push({x:w,y:E}),y&&(M+=(0,i.distanceSquareRoot)(k,[w,E])),k=[w,E],x&&M>=f&&f>S[2]){var P=(M-f)/(M-S[2]);C={x:k[0]*(1-P)+S[0]*P,y:k[1]*(1-P)+S[1]*P};}S=[w,E,M];}return x&&f>=M&&(C={x:c,y:d}),{length:M,point:C,min:{x:Math.min.apply(null,A.map(function(e){return e.x;})),y:Math.min.apply(null,A.map(function(e){return e.y;}))},max:{x:Math.max.apply(null,A.map(function(e){return e.x;})),y:Math.max.apply(null,A.map(function(e){return e.y;}))}};}},"0877494d":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("72b9f8f3")),a=r._(n("5457be05")),o=r._(n("5f17371e")),s=r._(n("c7b53fd1")),l={heatmap:o.default,heatmap3d:o.default,grid:i.default,grid3d:a.default,hexagon:s.default};},"0910777e":function(e,t,n){"use strict";function r(e){let t=+this._x.call(null,e),n=+this._y.call(null,e),r=+this._z.call(null,e);return i(this.cover(t,n,r),t,n,r,e);}function i(e,t,n,r,i){if(isNaN(t)||isNaN(n)||isNaN(r))return e;var a,o,s,l,u,c,d,f,h,p,v,g,m=e._root,y={data:i},b=e._x0,_=e._y0,x=e._z0,w=e._x1,E=e._y1,M=e._z1;if(!m)return e._root=y,e;for(;m.length;)if((f=t>=(o=(b+w)/2))?b=o:w=o,(h=n>=(s=(_+E)/2))?_=s:E=s,(p=r>=(l=(x+M)/2))?x=l:M=l,a=m,!(m=m[v=p<<2|h<<1|f]))return a[v]=y,e;if(u=+e._x.call(null,m.data),c=+e._y.call(null,m.data),d=+e._z.call(null,m.data),t===u&&n===c&&r===d)return y.next=m,a?a[v]=y:e._root=y,e;do a=a?a[v]=Array(8):e._root=Array(8),(f=t>=(o=(b+w)/2))?b=o:w=o,(h=n>=(s=(_+E)/2))?_=s:E=s,(p=r>=(l=(x+M)/2))?x=l:M=l;while((v=p<<2|h<<1|f)==(g=(d>=l)<<2|(c>=s)<<1|u>=o))return a[g]=m,a[v]=y,e;}function a(e){Array.isArray(e)||(e=Array.from(e));let t=e.length,n=new Float64Array(t),r=new Float64Array(t),a=new Float64Array(t),o=1/0,s=1/0,l=1/0,u=-1/0,c=-1/0,d=-1/0;for(let i=0,f,h,p,v;i<t;++i)!(isNaN(h=+this._x.call(null,f=e[i]))||isNaN(p=+this._y.call(null,f))||isNaN(v=+this._z.call(null,f)))&&(n[i]=h,r[i]=p,a[i]=v,h<o&&(o=h),h>u&&(u=h),p<s&&(s=p),p>c&&(c=p),v<l&&(l=v),v>d&&(d=v));if(o>u||s>c||l>d)return this;this.cover(o,s,l).cover(u,c,d);for(let o=0;o<t;++o)i(this,n[o],r[o],a[o],e[o]);return this;}n.d(t,"__esModule",{value:!0}),n.e(t,{addAll:function(){return a;},default:function(){return r;}});},"0916dbe6":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("c1058a90")),a=r._(n("0340f449")),o=r._(n("b0ea6077")),s=o.default&&o.default.isTypedArray,l=s?(0,a.default)(s):i.default;},"092be86a":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"useLayerManager",{enumerable:!0,get:function(){return a;}});var r=n("9d065c04"),i=n("ae6890f9"),a=function(){var e=(0,r.useContext)(i.LarkMapContext);if(!e)throw Error("The useLayerManager must be used in the LarkMap container");return e.layerManager;};},"092f4a86":function(e,t,n){var r=n("ce906886"),i=n("5bf20808").Graph,a=n("f9a6a7aa");e.exports=function(e,t){if(1>=e.nodeCount())return[];var n,u,c,d,f,h,p=(n=t||o,u=new i,c=0,d=0,r.forEach(e.nodes(),function(e){u.setNode(e,{v:e,in:0,out:0});}),r.forEach(e.edges(),function(e){var t=u.edge(e.v,e.w)||0,r=n(e);u.setEdge(e.v,e.w,t+r),d=Math.max(d,u.node(e.v).out+=r),c=Math.max(c,u.node(e.w).in+=r);}),f=r.range(d+c+3).map(function(){return new a;}),h=c+1,r.forEach(u.nodes(),function(e){l(f,h,u.node(e));}),{graph:u,buckets:f,zeroIdx:h}),v=function(e,t,n){for(var r,i=[],a=t[t.length-1],o=t[0];e.nodeCount();){for(;r=o.dequeue();)s(e,t,n,r);for(;r=a.dequeue();)s(e,t,n,r);if(e.nodeCount()){for(var l=t.length-2;l>0;--l)if(r=t[l].dequeue()){i=i.concat(s(e,t,n,r,!0));break;}}}return i;}(p.graph,p.buckets,p.zeroIdx);return r.flatten(r.map(v,function(t){return e.outEdges(t.v,t.w);}),!0);};var o=r.constant(1);function s(e,t,n,i,a){var o=a?[]:void 0;return r.forEach(e.inEdges(i.v),function(r){var i=e.edge(r),s=e.node(r.v);a&&o.push({v:r.v,w:r.w}),s.out-=i,l(t,n,s);}),r.forEach(e.outEdges(i.v),function(r){var i=e.edge(r),a=r.w,o=e.node(a);o.in-=i,l(t,n,o);}),e.removeNode(i.v),o;}function l(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n);}},"0946fcfa":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"EdgeInsets",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("d812e418")),a=r._(n("be334174")),o=n("f9562c3c");class s{constructor(e=0,t=0,n=0,r=0){if((0,i.default)(this,"top",void 0),(0,i.default)(this,"bottom",void 0),(0,i.default)(this,"left",void 0),(0,i.default)(this,"right",void 0),isNaN(e)||e<0||isNaN(t)||t<0||isNaN(n)||n<0||isNaN(r)||r<0)throw Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=n,this.right=r;}interpolate(e,t,n){return null!=t.top&&null!=e.top&&(this.top=o.interpolates.number(e.top,t.top,n)),null!=t.bottom&&null!=e.bottom&&(this.bottom=o.interpolates.number(e.bottom,t.bottom,n)),null!=t.left&&null!=e.left&&(this.left=o.interpolates.number(e.left,t.left,n)),null!=t.right&&null!=e.right&&(this.right=o.interpolates.number(e.right,t.right,n)),this;}getCenter(e,t){let n=(0,o.clamp)((this.left+e-this.right)/2,0,e),r=(0,o.clamp)((this.top+t-this.bottom)/2,0,t);return new a.default(n,r);}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right;}clone(){return new s(this.top,this.bottom,this.left,this.right);}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right};}}},"09544081":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r={},i=function(e){return r[e=e||"g"]?r[e]+=1:r[e]=1,e+r[e];};},"09bf3f04":function(e,t,n){var r=n("ed2bf8a3");e.exports=function(e,t,n){r.isArray(t)||(t=[t]);var i=(e.isDirected()?e.successors:e.neighbors).bind(e),a=[],o={};return r.each(t,function(t){if(!e.hasNode(t))throw Error("Graph does not have node: "+t);(function e(t,n,i,a,o,s){!r.has(a,n)&&(a[n]=!0,i||s.push(n),r.each(o(n),function(n){e(t,n,i,a,o,s);}),i&&s.push(n));})(e,t,"post"===n,o,i,a);}),a;};},"0a222680":function(e,t,n){var r=n("fdf787eb"),i=n("d26a46d3"),a=n("3f78af0a");e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(a||i),string:new r};};},"0a2d5f8b":function(e,t,n){"use strict";function r(){return this._root;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"0a3b822d":function(e,t,n){e.exports=function(e){return e.split("");};},"0a498565":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("2445cd68")),i=function(e,t,n){"__proto__"==t&&r.default?(0,r.default)(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n;};},"0b7aa9a0":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return d;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("daaa1548")),o=r._(n("d812e418")),s=n("d9b661b3"),l=n("fb1ec05a"),u=r._(n("755bc4f8")),c=n("f717bab4");class d extends u.default{constructor(...e){super(...e),(0,o.default)(this,"texture",void 0),(0,o.default)(this,"colorTexture",void 0);}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9});}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,a.default)((0,a.default)({},e.uniformsOption),t.uniformsOption);}getCommonUniformsInfo(){let{opacity:e=1,clampLow:t=!0,clampHigh:n=!0,noDataValue:r=-9999999,domain:i,rampColors:a}=this.layer.getLayerConfig(),o=i||(0,l.getDefaultDomain)(a);this.colorTexture=this.layer.textureService.getColorTexture(a,o);let s={u_domain:o,u_opacity:e||1,u_noDataValue:r,u_clampLow:t?1:0,u_clampHigh:(void 0!==n?n:t)?1:0,u_rasterTexture:this.texture,u_colorTexture:this.colorTexture};return this.textures=[this.texture,this.colorTexture],this.getUniformsBufferInfo(s);}getRasterData(e){return(0,i.default)(function*(){if(Array.isArray(e.data))return{data:e.data,width:e.width,height:e.height};{let{rasterData:t,width:n,height:r}=yield e.data;return{data:Array.from(t),width:n,height:r};}})();}initModels(){var e=this;return(0,i.default)(function*(){return e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){e.initUniformsBuffer();let t=e.layer.getSource(),{createTexture2D:n,queryVerdorInfo:r}=e.rendererService,i=t.data.dataArray[0],{data:a,width:o,height:l}=yield e.getRasterData(i);return e.texture=n({data:new Float32Array(a),width:o,height:l,format:"WebGL1"===r()?s.gl.LUMINANCE:s.gl.RED,type:s.gl.FLOAT,alignment:1}),[(yield e.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\nlayout(std140) uniform commonUniforms {\n  vec2 u_domain;\n  float u_opacity;\n  float u_noDataValue;\n  float u_clampLow;\n  float u_clampHigh;\n};\n\nout vec2 v_texCoord;\n\n#pragma include "projection"\n\nvoid main() {\n  v_texCoord = a_Uv;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));\n}\n',fragmentShader:"layout(std140) uniform commonUniforms {\n  vec2 u_domain;\n  float u_opacity;\n  float u_noDataValue;\n  float u_clampLow;\n  float u_clampHigh;\n};\n\nuniform sampler2D u_rasterTexture;\nuniform sampler2D u_colorTexture;\n\nin vec2 v_texCoord;\n\nbool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }\n\nout vec4 outputColor;\n\nvoid main() {\n  // Can use any component here since u_rasterTexture is under luminance format.\n  float value = texture(SAMPLER_2D(u_rasterTexture), vec2(v_texCoord.x, v_texCoord.y)).r;\n  if (value == u_noDataValue || isnan_emu(value)) {\n    discard;\n  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {\n    discard;\n  } else {\n    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);\n    vec4 color = texture(SAMPLER_2D(u_colorTexture), vec2(normalisedValue, 0));\n    \n    outputColor = color;\n    outputColor.a = outputColor.a * u_opacity ;\n    if (outputColor.a < 0.01)\n      discard;\n  }\n}\n",defines:e.getDefines(),triangulation:c.RasterImageTriangulation,primitive:s.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1}))];})();}clearModels(){var e,t;null===(e=this.texture)||void 0===e||e.destroy(),null===(t=this.colorTexture)||void 0===t||t.destroy();}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:s.AttributeType.Attribute,descriptor:{shaderLocation:this.attributeLocation.UV,name:"a_Uv",buffer:{usage:s.gl.DYNAMIC_DRAW,data:[],type:s.gl.FLOAT},size:2,update:(e,t,n)=>[n[3],n[4]]}});}}},"0b8e6291":function(e,t,n){var r=n("29595ef2");e.exports=function(e,t,n){for(var i=-1,a=e.criteria,o=t.criteria,s=a.length,l=n.length;++i<s;){var u=r(a[i],o[i]);if(u){if(i>=l)return u;return u*("desc"==n[i]?-1:1);}}return e.index-t.index;};},"0c1d8df4":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("1a978c65");},"0c45e2fa":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("d812e418")),i=n("fb1ec05a");class a{constructor(e){(0,r.default)(this,"layer",void 0),(0,r.default)(this,"rendererService",void 0),(0,r.default)(this,"colorTexture",void 0),(0,r.default)(this,"key",void 0),this.layer=e;let t=this.layer.getContainer();this.rendererService=t.rendererService;}getColorTexture(e,t){let n=this.getTextureKey(e,t);return this.key===n||(this.createColorTexture(e,t),this.key=n),this.colorTexture;}createColorTexture(e,t){let{createTexture2D:n}=this.rendererService,r=this.getColorRampBar(e,t),i=n({data:new Uint8Array(r.data),width:r.width,height:r.height,flipY:!1,unorm:!0});return this.colorTexture=i,i;}setColorTexture(e,t,n){this.key=this.getTextureKey(t,n),this.colorTexture=e;}destroy(){var e;null===(e=this.colorTexture)||void 0===e||e.destroy();}getColorRampBar(e,t){switch(e.type){case"cat":return(0,i.generateCatRamp)(e);case"quantize":return(0,i.generateQuantizeRamp)(e);case"custom":return(0,i.generateCustomRamp)(e,t);case"linear":return(0,i.generateLinearRamp)(e,t);default:return(0,i.generateColorRamp)(e);}}getTextureKey(e,t){var n;return`${e.colors.join("_")}_${null==e||null===(n=e.positions)||void 0===n?void 0:n.join("_")}_${e.type}_${null==t?void 0:t.join("_")}`;}}},"0ca866ed":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("3e4beef3")),i=Object.create,a=function(){function e(){}return function(t){if(!(0,r.default)(t))return{};if(i)return i(t);e.prototype=t;var n=new e;return e.prototype=void 0,n;};}();},"0cf0a3f9":function(e,t,n){e.exports=function(e,t,n){for(var r=-1,i=e.length,a=t.length,o={};++r<i;){var s=r<a?t[r]:void 0;n(o,e[r],s);}return o;};},"0d154dce":function(e,t,n){"use strict";function r(e){return e[0];}function i(e){return arguments.length?(this._x=e,this):this._x;}n.d(t,"__esModule",{value:!0}),n.e(t,{default:function(){return i;},defaultX:function(){return r;}});},"0d2f64a6":function(e,t,n){var r=n("cdf1a659");e.exports=function(e,t){return r(t,function(t){return e[t];});};},"0d5f117c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{Swipe:function(){return c;},default:function(){return c;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("d812e418")),o=n("d9b661b3"),s=n("1686747a"),l=n("fb1ec05a"),u=n("9d431275");class c extends u.Control{constructor(...e){super(...e),(0,a.default)(this,"isMoving",!1),(0,a.default)(this,"maskLayer",void 0),(0,a.default)(this,"move",e=>{switch(e.stopPropagation(),e.type){case"touchcancel":case"touchend":case"mouseup":var t;this.isMoving=!1,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(e=>{document.removeEventListener(e,this.move);}),null===(t=this.scene)||void 0===t||t.render();break;case"mousedown":case"touchstart":this.isMoving=!0,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(e=>{document.addEventListener(e,this.move);});case"mousemove":case"touchmove":if(this.isMoving){if("vertical"===this.controlOption.orientation){let t;if("pageX"in e?t=e.pageX:e.touches&&e.touches.length&&e.touches[0].pageX?t=e.touches[0].pageX:e.changedTouches&&e.changedTouches.length&&(t=e.changedTouches[0].pageX),!t)break;let n=this.getContainerDOMRect(),r=this.getContainerSize(),i=r[0],a=i-Math.min(Math.max(0,i-(t-((null==n?void 0:n.left)||0)+window.scrollX-document.documentElement.clientLeft)),i),o=a/i;this.setOptions({ratio:o}),this.emit("moving",{size:[a,r[1]],ratio:[o,0]});}else{let t;if("pageY"in e?t=e.pageY:e.touches&&e.touches.length&&e.touches[0].pageY?t=e.touches[0].pageY:e.changedTouches&&e.changedTouches.length&&(t=e.changedTouches[0].pageY),!t)break;let n=this.getContainerDOMRect(),r=this.getContainerSize(),i=r[1],a=i-Math.min(Math.max(0,i-(t-((null==n?void 0:n.top)||0)+window.scrollY-document.documentElement.clientTop)),i),o=a/i;this.setOptions({ratio:o}),this.emit("moving",{size:[r[0],a],ratio:[0,o]});}}}}),(0,a.default)(this,"getMaskLayer",()=>(console.log(this.getMaskGeoData()),new s.PolygonLayer({visible:!1}).source(this.getMaskGeoData()).shape("fill").color("red").style({opacity:.1}))),(0,a.default)(this,"updateMask",()=>{var e;if(!this.mapsService)return;let t=this.getMaskGeoData();null===(e=this.maskLayer)||void 0===e||e.setData(t);});}getDefault(){return(0,i.default)((0,i.default)({},super.getDefault()),{},{layers:[],rightLayers:[],ratio:.5,orientation:"vertical"});}onAdd(){let e=l.DOM.create("div","l7-control-swipe");l.DOM.create("button","l7-control-swipe__button",e);let{orientation:t="vertical",ratio:n=.5}=this.controlOption;return"horizontal"===t?(e.style.top=100*n+"%",e.style.left=""):(e.style.left=100*n+"%",e.style.top=""),e.classList.add(t),e;}addTo(e){this.mapsService=e.mapService,this.renderService=e.rendererService,this.layerService=e.layerService,this.controlService=e.controlService,this.configService=e.globalConfigService,this.scene=e.sceneService,this.sceneContainer=e,this.isShow=!0,this.container=this.onAdd();let{className:t,style:n,layers:r,rightLayers:i}=this.controlOption;t&&this.setClassName(t),n&&this.setStyle(n),this.mapsService.getMarkerContainer().appendChild(this.container),this.maskLayer=this.getMaskLayer(),this.registerEvent();let a=(0,o.createLayerContainer)(e);return this.maskLayer.setContainer(a),this.scene.addLayer(this.maskLayer),this.addMaskToLayers(r,!1),this.addMaskToLayers(i,!0),this.emit("add",this),this;}onRemove(){if(this.maskLayer){var e;let{layers:t,rightLayers:n}=this.controlOption;this.removeMaskFromLayers(t),this.removeMaskFromLayers(n),null===(e=this.layerService)||void 0===e||e.remove(this.maskLayer);}this.unRegisterEvent(),this.removeAllListeners();}show(){var e;let t=this.container;l.DOM.removeClass(t,"l7-control-swipe_hide");let{layers:n,rightLayers:r}=this.controlOption;n.forEach(e=>e.enableMask()),r.forEach(e=>e.enableMask()),null===(e=this.scene)||void 0===e||e.render(),this.isShow=!0,this.emit("show",this);}hide(){var e;let t=this.container;l.DOM.addClass(t,"l7-control-swipe_hide");let{layers:n,rightLayers:r}=this.controlOption;n.forEach(e=>e.disableMask()),r.forEach(e=>e.disableMask()),null===(e=this.scene)||void 0===e||e.render(),this.isShow=!1,this.emit("hide",this);}setOptions(e){let t=(0,i.default)((0,i.default)({},this.controlOption),e);if(e.className&&this.setClassName(e.className),e.style&&this.setStyle(e.style),(e.orientation||void 0!==e.ratio)&&this.setOrientationAndRatio(t.orientation,t.ratio),e.layers){let t=e.layers,n=this.controlOption.layers;this.setLayers(t,n,!1);}if(e.rightLayers){let t=e.rightLayers,n=this.controlOption.rightLayers;this.setLayers(t,n,!0);}this.controlOption=t,this.updateMask();}registerEvent(){this.container.addEventListener("mousedown",this.move),this.container.addEventListener("touchstart",this.move),this.mapsService.on("camerachange",this.updateMask);}unRegisterEvent(){var e;this.container.removeEventListener("mousedown",this.move),this.container.removeEventListener("touchstart",this.move),null===(e=this.mapsService)||void 0===e||e.off("camerachange",this.updateMask);}setOrientationAndRatio(e="vertical",t=.5){this.container.classList.remove("horizontal","vertical"),this.container.classList.add(e),"horizontal"===e?(this.container.style.top=100*t+"%",this.container.style.left=""):(this.container.style.left=100*t+"%",this.container.style.top="");}setLayers(e,t,n=!1){let r=e.filter(e=>!1===t.includes(e)),i=t.filter(t=>!1===e.includes(t));this.addMaskToLayers(r,n),this.removeMaskFromLayers(i);}addMaskToLayers(e,t){e.forEach(e=>{e.updateLayerConfig({maskInside:!t}),e.addMask(this.maskLayer);});}removeMaskFromLayers(e){e.forEach(e=>{e.updateLayerConfig({maskInside:!0}),e.removeMask(this.maskLayer);});}getMaskGeoData(){let e;let{ratio:t=.5,orientation:n="vertical"}=this.controlOption,[r,i]=this.getBounds(),[a,o]=r,[s,l]=i;if("vertical"===n){let n=a+(s-a)*t;e=[[a,l],[n,l],[n,o],r,[a,l]];}else{let n=this.getContainerSize(),r=this.mapsService.containerToLngLat([n[0],n[1]*t]).lat;e=[[a,l],i,[s,r],[a,r],[a,l]];}return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[e]}}]};}getContainerDOMRect(){var e;return null===(e=this.mapsService.getContainer())||void 0===e?void 0:e.getBoundingClientRect();}getContainerSize(){return this.mapsService.getSize();}getBounds(){return this.mapsService.getBounds();}addLayer(e,t=!1){let n=Array.isArray(e)?e:[e];if(t){let e=this.controlOption.rightLayers.concat(...n);this.setOptions({rightLayers:e});}else{let e=this.controlOption.layers.concat(...n);this.setOptions({layers:e});}}removeLayer(e){let t=Array.isArray(e)?e:[e],n=this.controlOption.layers.filter(e=>t.includes(e)),r=this.controlOption.rightLayers.filter(e=>t.includes(e));this.setOptions({layers:n,rightLayers:r});}removeLayers(){this.setOptions({layers:[],rightLayers:[]});}}},"0d884ee9":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0});var r=n("d1751d7c");r._(n("61b1131d"),t),r._(n("31f92b48"),t),r._(n("eccaef7c"),t);},"0de27c0d":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("9d065c04"),i=(0,n("80c79fc1").createUpdateEffect)(r.useEffect);},"0e5acdfc":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("a12bb5bb")),a=r._(n("b0c50986")),o=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r+=1)!function e(t,n,r,o){for(var s in r=r||0,o=o||5,n)if(function(e,t){if(Object.hasOwn)return Object.hasOwn(e,t);if(null==e)throw TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(e),t);}(n,s)){var l=n[s];null!==l&&(0,a.default)(l)?((0,a.default)(t[s])||(t[s]={}),r<o?e(t[s],l,r+1,o):t[s]=n[s]):(0,i.default)(l)?(t[s]=[],t[s]=t[s].concat(l)):void 0!==l&&(t[s]=l);}}(e,t[r]);return e;};},"0e8eb136":function(e,t,n){"use strict";var r;n.d(t,"__esModule",{value:!0}),n.d(t,"MapType",{enumerable:!0,get:function(){return i;}});let i=((r={}).GAODE="GAODE",r.MAPBOX="MAPBOX",r.DEFAULT="DEFAUlTMAP",r.SIMPLE="SIMPLE",r.GLOBEL="GLOBEL",r);},"0ea4ba5a":function(e,t,n){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e];}),n;};},"0ee4a6af":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"loadImage",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("f89fb776"));function i(e){return a.apply(this,arguments);}function a(){return(a=(0,r.default)(function*(e){if(window.createImageBitmap){let t=yield fetch(e);return yield createImageBitmap((yield t.blob()));}{let t=new window.Image;return new Promise(n=>{t.onload=()=>n(t),t.src=e,t.crossOrigin="Anonymous";});}})).apply(this,arguments);}},"0f03385d":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=n("d9b661b3"),s=r._(n("755bc4f8")),l=n("909eb2d3"),u=n("f717bab4");class c extends s.default{constructor(...e){super(...e),(0,a.default)(this,"meter2coord",1),(0,a.default)(this,"texture",void 0),(0,a.default)(this,"isMeter",!1),(0,a.default)(this,"radian",0),(0,a.default)(this,"updateTexture",()=>{let{createTexture2D:e}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),this.layerService.throttleRenderLayers();return;}this.texture=e({data:this.iconService.getCanvas(),mag:o.gl.LINEAR,min:o.gl.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0}),this.textures=[this.texture];});}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,UV:11});}getCommonUniformsInfo(){let{raisingHeight:e=0,heightfixed:t=!1,unit:n="pixel"}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var r;null===(r=this.texture)||void 0===r||r.bind();}let i={u_textSize:[1024,this.iconService.canvasHeight||128],u_heightfixed:Number(t),u_raisingHeight:Number(e),u_size_unit:l.SizeUnitType[n]};return this.getUniformsBufferInfo(i);}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),u.PointFillTriangulation);}initModels(){var e=this;return(0,i.default)(function*(){return e.iconService.on("imageUpdate",e.updateTexture),e.updateTexture(),e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\nlayout(std140) uniform commonUniform {\n  vec2 u_textSize;\n  float u_heightfixed;\n  float u_raisingHeight;\n  float u_size_unit;\n};\n\nout vec2 v_uv;\nout vec2 v_Iconuv;\nout float v_opacity;\n\n#pragma include "projection"\n#pragma include "picking"\n#pragma include "rotation_2d"\n\nvoid main() {\n  vec3 extrude = a_Extrude;\n  v_uv = (a_Extrude.xy + 1.0) / 2.0;\n  v_uv.y = 1.0 - v_uv.y;\n  v_Iconuv = a_Uv;\n  v_opacity = opacity;\n  float newSize = a_Size;\n  if (u_size_unit == 1.0) {\n    newSize = newSize * u_PixelsPerMeter.z;\n  }\n\n  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);\n  vec2 offset = extrude.xy * newSize + offsets;\n\n  offset = rotate_matrix(offset, rotation);\n\n  offset = project_pixel(offset);\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'in vec2 v_uv;// \u672C\u8EAB\u7684 uv \u5750\u6807\nin vec2 v_Iconuv;\nin float v_opacity;\nout vec4 outputColor;\n\nuniform sampler2D u_texture;\nlayout(std140) uniform commonUniform {\n  vec2 u_textSize;\n  float u_heightfixed: 0.0;\n  float u_raisingHeight: 0.0;\n  float u_size_unit;\n};\n\n#pragma include "scene_uniforms"\n#pragma include "sdf_2d"\n#pragma include "picking"\n\nvoid main() {\n  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;\n  outputColor = texture(SAMPLER_2D(u_texture), pos);\n  outputColor.a *= v_opacity;\n  outputColor = filterColor(outputColor);\n}\n',triangulation:u.PointFillTriangulation,depth:{enable:!1},defines:e.getDefines(),inject:e.getInject(),cull:{enable:!0,face:o.gl.FRONT}}))];})();}clearModels(){var e;this.iconService.off("imageUpdate",this.updateTexture),null===(e=this.texture)||void 0===e||e.destroy();}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:o.AttributeType.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:2,update:e=>{let t=this.iconService.getIconMap(),{shape:n}=e,{x:r,y:i}=t[n]||{x:-64,y:-64};return[r,i];}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:o.AttributeType.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:3,update:(e,t,n,r)=>{let i=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],a=r%4*3;return[i[a],i[a+1],i[a+2]];}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:o.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:1,update:e=>{let{size:t=5}=e;return Array.isArray(t)?[t[0]]:[t];}}});}}},"0f0d54c3":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"useScene",{enumerable:!0,get:function(){return a;}});var r=n("9d065c04"),i=n("ae6890f9"),a=function(){var e=(0,r.useContext)(i.LarkMapContext);if(!e)throw Error("The useScene must be used in the LarkMap container");return e.scene;};},"0f21b56b":function(e,t,n){var r=n("860e2ef1"),i=n("0341a906"),a=n("011deb24"),o=n("adda482a"),s=n("c3eae33c"),l=n("8c5cea5d"),u=n("d7dbbb4d"),c=n("5c29df5b"),d=n("ef21f553"),f=n("80d2cf98"),h=n("f91bf332"),p=n("ef51a61d"),v=n("f7dd79d0"),g=n("979aa57d"),m=n("b9363c23"),y=n("c0051812"),b=n("85163435"),_=n("5a08cc31"),x=n("7c1db5f7"),w=n("a6d08c6a"),E=n("16ec8ed6"),M=n("baa3a209"),S="[object Arguments]",k="[object Function]",C="[object Object]",A={};A[S]=A["[object Array]"]=A["[object ArrayBuffer]"]=A["[object DataView]"]=A["[object Boolean]"]=A["[object Date]"]=A["[object Float32Array]"]=A["[object Float64Array]"]=A["[object Int8Array]"]=A["[object Int16Array]"]=A["[object Int32Array]"]=A["[object Map]"]=A["[object Number]"]=A[C]=A["[object RegExp]"]=A["[object Set]"]=A["[object String]"]=A["[object Symbol]"]=A["[object Uint8Array]"]=A["[object Uint8ClampedArray]"]=A["[object Uint16Array]"]=A["[object Uint32Array]"]=!0,A["[object Error]"]=A[k]=A["[object WeakMap]"]=!1,e.exports=function e(t,n,L,P,N,O){var I,R=1&n,D=2&n,z=4&n;if(L&&(I=N?L(t,P,N,O):L(t)),void 0!==I)return I;if(!x(t))return t;var B=y(t);if(B){if(I=v(t),!R)return u(t,I);}else{var U=p(t),F=U==k||"[object GeneratorFunction]"==U;if(b(t))return l(t,R);if(U==C||U==S||F&&!N){if(I=D||F?{}:m(t),!R)return D?d(t,s(I,t)):c(t,o(I,t));}else{if(!A[U])return N?t:{};I=g(t,U,R);}}O||(O=new r);var j=O.get(t);if(j)return j;O.set(t,I),w(t)?t.forEach(function(r){I.add(e(r,n,L,r,t,O));}):_(t)&&t.forEach(function(r,i){I.set(i,e(r,n,L,i,t,O));});var V=z?D?h:f:D?M:E,G=B?void 0:V(t);return i(G||t,function(r,i){G&&(r=t[i=r]),a(I,i,e(r,n,L,i,t,O));}),I;};},"0f43f2a7":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("a556cf14"));function i(e){var t,n,i,a=(0,r.default)(.1);function o(e){for(var r,a=0,o=t.length;a<o;++a)r=t[a],r.vx+=(i[a]-r.x)*n[a]*e;}function s(){if(t){var r,o=t.length;for(r=0,n=Array(o),i=Array(o);r<o;++r)n[r]=isNaN(i[r]=+e(t[r],r,t))?0:+a(t[r],r,t);}}return"function"!=typeof e&&(e=(0,r.default)(null==e?0:+e)),o.initialize=function(e){t=e,s();},o.strength=function(e){return arguments.length?(a="function"==typeof e?e:(0,r.default)(+e),s(),o):a;},o.x=function(t){return arguments.length?(e="function"==typeof t?t:(0,r.default)(+t),s(),o):e;},o;}},"0f65c46b":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("a12bb5bb")),a=r._(n("10576492")),o=function(e,t){if((0,i.default)(e)){for(var n,r=-1/0,o=0;o<e.length;o++){var s=e[o],l=(0,a.default)(t)?t(s):s[t];l>r&&(n=s,r=l);}return n;}};},"0f809895":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"toPaddingOptions",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("daaa1548"));function i(e={}){if("number"==typeof e)return{top:e,right:e,bottom:e,left:e};if(Array.isArray(e)){if(4===e.length)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(2===e.length)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};}return(0,r.default)((0,r.default)({},{top:0,right:0,bottom:0,left:0}),e);}},"0f9cdec1":function(e,t,n){"use strict";function r(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"0fab4c74":function(e,t,n){var r="\ud800-\udfff",i="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",a="\ud83c[\udffb-\udfff]",o="[^"+r+"]",s="(?:\ud83c[\udde6-\uddff]){2}",l="[\ud800-\udbff][\udc00-\udfff]",u="(?:"+i+"|"+a+")?",c="[\\ufe0e\\ufe0f]?",d="(?:\\u200d(?:"+[o,s,l].join("|")+")"+c+u+")*",f=RegExp(a+"(?="+a+")|(?:"+[o+i+"?",i,s,l,"["+r+"]"].join("|")+")"+(c+u+d),"g");e.exports=function(e){return e.match(f)||[];};},10576492:function(e,t,n){"use strict";function r(e){return"function"==typeof e;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"10e0f52e":function(e,t,n){var r=n("1f86664c"),i=n("2e6bd01b"),a=n("c0051812"),o=n("05d6656f"),s=n("be56823a"),l=n("c4fc35e5");e.exports=function(e,t,n){t=r(t,e);for(var u=-1,c=t.length,d=!1;++u<c;){var f=l(t[u]);if(!(d=null!=e&&n(e,f)))break;e=e[f];}return d||++u!=c?d:!!(c=null==e?0:e.length)&&s(c)&&o(f,c)&&(a(e)||i(e));};},"10ffe1f0":function(e,t,n){Object.prototype.hasOwnProperty;},11002994:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"isFunction",{enumerable:!0,get:function(){return r;}});var r=function(e){return"function"==typeof e;};},"126c0ad9":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=n("d9b661b3"),o=n("fb1ec05a"),s=r._(n("755bc4f8")),l=n("f717bab4");let{isNumber:u}=o.lodashUtil;class c extends s.default{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,NORMAL:9,UV:10});}getCommonUniformsInfo(){let{opacity:e=1}=this.layer.getLayerConfig(),t={u_opacity:u(e)?e:1};return this.getUniformsBufferInfo(t);}initModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),e.buildModels();})();}clearModels(){return"";}buildModels(){var e=this;return(0,i.default)(function*(){return e.layer.zIndex=-997,[(yield e.layer.buildLayerModel({moduleName:"earthAtmoSphere",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\nlayout(std140) uniform commonUniforms {\n float u_opacity;\n};\n\n#pragma include "scene_uniforms"\nout vec3 vVertexNormal;\nout vec4 v_Color;\nout float v_offset;\n\nvoid main() {\n    float EARTH_RADIUS = 100.0;\n\n    v_Color = a_Color;\n\n    v_offset = min(((length(u_CameraPosition) - EARTH_RADIUS)/600.0) * 0.5 + 0.4, 1.0);\n    vVertexNormal = a_Normal;\n\n    gl_Position = u_ViewProjectionMatrix * u_ModelMatrix * vec4(a_Position, 1.0);\n}\n',fragmentShader:'\nlayout(std140) uniform commonUniforms {\n float u_opacity;\n};\nin vec3 vVertexNormal;\nin float v_offset;\nin vec4 v_Color;\n\n#pragma include "scene_uniforms"\nout vec4 outputColor;\nvoid main() {\n    \n    \n    // float intensity = pow(0.5 + dot(normalize(vVertexNormal), normalize(u_CameraPosition)), 3.0);\n    float intensity = pow(v_offset + dot(normalize(vVertexNormal), normalize(u_CameraPosition)), 3.0);\n    // \u53BB\u9664\u80CC\u9762\n    if(intensity > 1.0) intensity = 0.0;\n\n    outputColor = vec4(v_Color.rgb, v_Color.a * intensity * u_opacity);\n}\n',defines:e.getDefines(),triangulation:l.earthTriangulation,depth:{enable:!1},blend:e.getBlend()}))];})();}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:a.AttributeType.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:a.gl.STATIC_DRAW,data:[],type:a.gl.FLOAT},size:3,update:(e,t,n,r,i)=>i}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:a.AttributeType.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:a.gl.DYNAMIC_DRAW,data:[],type:a.gl.FLOAT},size:2,update:(e,t,n)=>[n[3],n[4]]}});}}},"12c23ac4":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("98ccb8b6")),a=r._(n("3a2d63e9")),o=function(e){return null!=e&&(0,a.default)(e.length)&&!(0,i.default)(e);};},"12fce91f":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r,i=n("777fffbe")._(n("3a7214af")),a=(r=/[^.]+$/.exec(i.default&&i.default.keys&&i.default.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",o=function(e){return!!a&&a in e;};},"13056af7":function(e,t,n){var r=n("a056a353");e.exports=function(e){return null==e?"":r(e);};},"13060ce4":function(e,t,n){var r=n("020a7b3d"),i=n("f28dfa76");e.exports=function e(t,n,a,o,s){return t===n||(null!=t&&null!=n&&(i(t)||i(n))?r(t,n,a,o,e,s):t!=t&&n!=n);};},"14d0d13c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"createDeepCompareEffect",{enumerable:!0,get:function(){return a;}});var r=n("9d065c04"),i=n("b59c4694"),a=function(e){return function(t,n){var a=(0,r.useRef)(void 0),o=(0,r.useRef)(0);void 0!==n&&(0,i.depsEqual)(n,a.current)||(o.current+=1),a.current=n,e(t,[o.current]);};};},"15c12ce8":function(e,t,n){var r=n("8d15a3f4");e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this;};},"16235f10":function(e,t,n){"use strict";var r,i,a,o,s,l;n.d(t,"__esModule",{value:!0}),n.e(t,{CompositeLayerEvent:function(){return i;},CoreLayerEvent:function(){return r;},LayerGroupEvent:function(){return a;},OriginLayerEventList:function(){return c;},OriginMouseLayerEventList:function(){return u;}});let u=["click","dblclick","unclick","undblclick","contextmenu","uncontextmenu","mouseenter","unmouseenter","mousemove","unmousemove","mouseout","mouseup","unmouseup","mousedown","unpick"],c=["show","hide","dataUpdate","destroy","legend","legend:color","legend:size",...u];(o=r||(r={})).CREATED="created",o.INITED="inited",o.ADD="add",o.REMOVE="remove",(s=i||(i={})).CREATED="created",s.INITED="inited",s.ADD="add",s.REMOVE="remove",(l=a||(a={})).INITED_LAYER="inited-layer",l.INITED_LAYERS="inited-layers";},"1632ee7b":function(e,t,n){"use strict";function r(e){return(e()-.5)*1e-6;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"1686747a":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{BaseLayer:function(){return s.default;},BaseModel:function(){return l.default;},CanvasLayer:function(){return a.default;},CityBuildingLayer:function(){return o.default;},EarthLayer:function(){return y.default;},GeometryLayer:function(){return u.default;},HeatmapLayer:function(){return c.default;},ImageLayer:function(){return d.default;},LineLayer:function(){return f.default;},MaskLayer:function(){return b.default;},PointLayer:function(){return h.default;},PolygonLayer:function(){return p.default;},RasterLayer:function(){return v.default;},TileDebugLayer:function(){return m.default;},TileLayer:function(){return g.default;},WindLayer:function(){return _.default;}});var r=n("d1751d7c"),i=n("777fffbe"),a=i._(n("484a8f02")),o=i._(n("b2dd89c0")),s=i._(n("4ce96d25")),l=i._(n("755bc4f8")),u=i._(n("e34c617b")),c=i._(n("892fbddc")),d=i._(n("fb04a60c")),f=i._(n("fa52488c")),h=i._(n("f1ed3b6a")),p=i._(n("b6ae0420")),v=i._(n("ebd74549")),g=i._(n("98fd032f")),m=i._(n("a8505623")),y=i._(n("a60993e0")),b=i._(n("86852c8f")),_=i._(n("3bc448aa"));r._(n("909eb2d3"),t);},"16b3b059":function(e,t,n){var r=n("95fb21b4"),i="object"==typeof self&&self&&self.Object===Object&&self,a=r||i||Function("return this")();e.exports=a;},"16ec8ed6":function(e,t,n){var r=n("69f7008f"),i=n("7988eeca"),a=n("481b6514");e.exports=function(e){return a(e)?r(e):i(e);};},"17ed734c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"getPointAtLength",{enumerable:!0,get:function(){return a;}});var r=n("b594a703"),i=n("1d595a1a");function a(e,t,n){return(0,i.pathLengthFactory)(e,t,(0,r.__assign)((0,r.__assign)({},n),{bbox:!1,length:!0})).point;}},"183d4520":function(e,t,n){"use strict";function r(e){return e.map(e=>("string"==typeof e&&(e=[e,{}]),e));}function i(e,t,n,i){let a=e.multiPassRenderer;return a.add(i("render")),r(t).forEach(e=>{let[t,r]=e;a.add(n(t),r);}),a.add(n("copy")),a;}n.d(t,"__esModule",{value:!0}),n.e(t,{createMultiPassRenderer:function(){return i;},normalizePasses:function(){return r;}});},"1911a24b":function(e,t,n){e.exports=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e;};},"1955a375":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"findShortestPath",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("71ba123c")),i=function(e,t,n,i,a){var o=(0,r.default)(e,t,i,a),s=o.length,l=o.path,u=o.allPath;return{length:s[n],path:l[n],allPath:u[n]};};},"19783d72":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=n("d9b661b3"),o=n("fb1ec05a"),s=r._(n("755bc4f8")),l=n("f717bab4");let{isNumber:u}=o.lodashUtil;class c extends s.default{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,NORMAL:9,UV:10});}getCommonUniformsInfo(){let{opacity:e=1}=this.layer.getLayerConfig(),t={u_opacity:u(e)?e:1};return this.getUniformsBufferInfo(t);}initModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),e.buildModels();})();}clearModels(){return"";}buildModels(){var e=this;return(0,i.default)(function*(){return e.layer.zIndex=-999,[(yield e.layer.buildLayerModel({moduleName:"earthBloom",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\nlayout(std140) uniform commonUniforms {\n float u_opacity;\n};\n#pragma include "scene_uniforms"\n\nout vec3 vVertexNormal;\nout vec4 v_Color;\n\nvoid main() {\n    v_Color = a_Color;\n\n    vVertexNormal = a_Normal;\n\n    gl_Position = u_ViewProjectionMatrix * u_ModelMatrix * vec4(a_Position, 1.0);\n}\n',fragmentShader:'\nin vec3 vVertexNormal;\nin vec4 v_Color;\n\nlayout(std140) uniform commonUniforms {\n float u_opacity;\n};\nout vec4 outputColor;\n#pragma include "scene_uniforms"\nvoid main() {\n    float intensity =  - dot(normalize(vVertexNormal), normalize(u_CameraPosition));\n    // \u53BB\u9664\u80CC\u9762\n    if(intensity > 1.0) intensity = 0.0;\n\n    outputColor = vec4(v_Color.rgb, v_Color.a * intensity * u_opacity);\n}\n',defines:e.getDefines(),triangulation:l.earthOuterTriangulation,depth:{enable:!1},blend:e.getBlend()}))];})();}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:a.AttributeType.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:a.gl.STATIC_DRAW,data:[],type:a.gl.FLOAT},size:3,update:(e,t,n,r,i)=>i}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:a.AttributeType.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:a.gl.DYNAMIC_DRAW,data:[],type:a.gl.FLOAT},size:2,update:(e,t,n)=>[n[3],n[4]]}});}}},"19f20421":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return d;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=n("d9b661b3"),s=n("fb1ec05a"),l=r._(n("755bc4f8")),u=n("f717bab4");let c={solid:0,dash:1};class d extends l.default{constructor(...e){super(...e),(0,a.default)(this,"texture",void 0),(0,a.default)(this,"updateTexture",()=>{let{createTexture2D:e}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return;}this.texture=e({data:this.iconService.getCanvas(),mag:o.gl.NEAREST,min:o.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture];});}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12});}getCommonUniformsInfo(){let{sourceColor:e,targetColor:t,textureBlend:n="normal",lineType:r="solid",dashArray:i=[10,5],lineTexture:a=!1,iconStep:o=100,segmentNumber:l=30}=this.layer.getLayerConfig(),{animateOption:u}=this.layer.getLayerConfig();if(2===i.length&&i.push(0,0),this.rendererService.getDirty()){var d;null===(d=this.texture)||void 0===d||d.bind();}let f=0,h=[0,0,0,0],p=[0,0,0,0];e&&t&&(h=(0,s.rgb2arr)(e),p=(0,s.rgb2arr)(t),f=1);let v=this.layer.getLayerAnimateTime();isNaN(v)&&(v=0);let g={u_animate:this.animateOption2Array(u),u_dash_array:i,u_sourceColor:h,u_targetColor:p,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:l,u_line_type:c[r]||0,u_icon_step:o,u_line_texture:a?1:0,u_textureBlend:"normal"===n?0:1,u_time:v,u_linearColor:f};return this.getUniformsBufferInfo(g);}initModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),e.updateTexture(),e.iconService.on("imageUpdate",e.updateTexture),e.buildModels();})();}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture);}buildModels(){var e=this;return(0,i.default)(function*(){let{segmentNumber:t=30}=e.layer.getLayerConfig();return[(yield e.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:'#define LineTypeSolid (0.0)\n#define LineTypeDash (1.0)\n#define Animate (0.0)\n#define LineTexture (1.0)\n\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;\nlayout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;\n\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_dash_array: [10.0, 5., 0, 0];\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float segmentNumber;\n  float u_line_type: 0.0;\n  float u_icon_step: 100;\n  float u_line_texture: 0.0;\n  float u_textureBlend;\n  float u_time;\n  float u_linearColor: 0;\n};\n\nout vec4 v_dash_array;\nout vec4 v_color;\nout vec2 v_iconMapUV;\nout vec4 v_line_data;\nout float v_distance_ratio;\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat maps(float value, float start1, float stop1, float start2, float stop2) {\n  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));\n}\n\nfloat getSegmentRatio(float index) {\n  return index / (segmentNumber - 1.0);\n}\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n  vec2 x = mix(source, target, ratio);\n  vec2 center = mix(source, target, 0.5);\n  float dSourceCenter = distance(source, center);\n  float dXCenter = distance(x, center);\n  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n  float vertex_height = paraboloid(source, target, segmentRatio);\n\n  return vec3(mix(source, target, segmentRatio), sqrt(max(0.0, vertex_height)));\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  return dir_screenspace.xy * sign(offset_direction);\n}\nfloat getAngularDist(vec2 source, vec2 target) {\n  vec2 delta = source - target;\n  vec2 sin_half_delta = sin(delta / 2.0);\n  float a =\n    sin_half_delta.y * sin_half_delta.y +\n    cos(source.y) * cos(target.y) * sin_half_delta.x * sin_half_delta.x;\n  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));\n}\n\nvec2 midPoint(vec2 source, vec2 target) {\n  vec2 center = target - source;\n  float r = length(center);\n  float theta = atan(center.y, center.x);\n  float thetaOffset = 0.314;\n  float r2 = r / 2.0 / cos(thetaOffset);\n  float theta2 = theta + thetaOffset;\n  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);\n  return mid;\n}\nfloat bezier3(vec3 arr, float t) {\n  float ut = 1.0 - t;\n  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;\n}\n\nvec2 interpolate(vec2 source, vec2 target, float angularDist, float t) {\n  if (abs(angularDist - PI) < 0.001) {\n    return (1.0 - t) * source + t * target;\n  }\n  float a = sin((1.0 - t) * angularDist) / sin(angularDist);\n  float b = sin(t * angularDist) / sin(angularDist);\n  vec2 sin_source = sin(source);\n  vec2 cos_source = cos(source);\n  vec2 sin_target = sin(target);\n  vec2 cos_target = cos(target);\n  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;\n  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;\n  float z = a * sin_source.y + b * sin_target.y;\n  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));\n\n}\n\nvoid main() {\n  v_color = a_Color;\n  v_color.a = v_color.a * opacity;\n  vec2 source = radians(a_Instance.rg);\n  vec2 target = radians(a_Instance.ba);\n  float angularDist = getAngularDist(source, target);\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n\n  if (u_line_type == LineTypeDash) {\n    v_distance_ratio = segmentIndex / segmentNumber;\n    float total_Distance = pixelDistance(source, target) / 2.0 * PI;\n    total_Distance = total_Distance * 16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;\n  }\n\n  if (u_animate.x == Animate) {\n    v_distance_ratio = segmentIndex / segmentNumber;\n  }\n\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  v_distance_ratio = segmentIndex / segmentNumber;\n\n  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0), a_Instance64Low.xy);\n  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0), a_Instance64Low.zw);\n\n  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));\n  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));\n  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));\n\n  v_line_data.g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F\n  if (LineTexture == u_line_texture) {\n    float d_arcDistrance = length(source - target);\n    d_arcDistrance = project_pixel(d_arcDistrance);\n\n    float d_pixelLen = project_pixel(u_icon_step) / 8.0;\n    v_line_data.b = floor(d_arcDistrance / d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF\n\n    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\n    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB\n    v_line_data.a = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C\n\n    v_iconMapUV = a_iconMapUV;\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));\n  setPickingColor(a_PickingColor);\n}\n\n',fragmentShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\n\nuniform sampler2D u_texture;\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_dash_array: [10.0, 5., 0, 0];\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float segmentNumber;\n  float u_line_type: 0.0;\n  float u_icon_step: 100;\n  float u_line_texture: 0.0;\n  float u_textureBlend;\n  float u_time;\n  float u_linearColor: 0;\n};\n\nin vec4 v_dash_array;\nin vec4 v_color;\nin vec2 v_iconMapUV;\nin vec4 v_line_data;\nin float v_distance_ratio;\n\nout vec4 outputColor;\n#pragma include "picking"\n#pragma include "project"\n#pragma include "projection"\n\nvoid main() {\n\n  float animateSpeed = 0.0;\n  float d_segmentIndex = v_line_data.g;\n\n  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272\n  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272\n    outputColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);\n    outputColor.a *= v_color.a;\n  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272\n    outputColor = v_color;\n  }\n\n  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));\n  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));\n  if(u_line_type == LineTypeDash) {\n    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n      // \u5B9E\u7EBF\u90E8\u5206\n    } else {\n      // \u865A\u7EBF\u90E8\u5206\n      discard;\n    };\n  }\n\n  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F\n  if(u_animate.x == Animate) {\n      animateSpeed = u_time / u_animate.y;\n      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);\n      alpha = (alpha + u_animate.w -1.0) / u_animate.w;\n      alpha = smoothstep(0., 1., alpha);\n      outputColor.a *= alpha;\n  }\n\n  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE\n  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) {\n    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));\n    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);\n    float count = v_line_data.b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF\n    float u = fract(arcRadio * count - animateSpeed * count);\n    // float u = fract(arcRadio * count - animateSpeed);\n    if(u_animate.x == Animate) {\n      u = outputColor.a/v_color.a;\n    }\n\n    float v = v_line_data.a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C\n\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);\n\n    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      outputColor = filterColor(outputColor + pattern);\n    } else { // replace\n        pattern.a *= v_color.a;\n        if(outputColor.a <= 0.0) {\n          pattern.a = 0.0;\n        }\n        outputColor = filterColor(pattern);\n    }\n  } else {\n    outputColor = filterColor(outputColor);\n  }\n\n  // gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:u.LineArcTriangulation,styleOption:{segmentNumber:t},defines:e.getDefines(),inject:e.getInject(),depth:{enable:!1}}))];})();}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:o.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:1,update:e=>{let{size:t=1}=e;return Array.isArray(t)?[t[0]]:[t];}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:o.AttributeType.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:o.gl.STATIC_DRAW,data:[],type:o.gl.FLOAT},size:4,update:(e,t,n)=>[n[3],n[4],n[5],n[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:o.AttributeType.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:o.gl.STATIC_DRAW,data:[],type:o.gl.FLOAT},size:4,update:(e,t,n)=>[(0,s.fp64LowPart)(n[3]),(0,s.fp64LowPart)(n[4]),(0,s.fp64LowPart)(n[5]),(0,s.fp64LowPart)(n[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:o.AttributeType.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:2,update:e=>{let t=this.iconService.getIconMap(),{texture:n}=e,{x:r,y:i}=t[n]||{x:0,y:0};return[r,i];}}});}}},"19fbb40b":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("a420544c")),a=r._(n("323ab2ac")),o=function(e,t){return e&&(0,i.default)(t,(0,a.default)(t),e);};},"1a33586c":function(e,t,n){"use strict";function r(e,t,n){if(isNaN(e=+e)||isNaN(t=+t)||isNaN(n=+n))return this;var r=this._x0,i=this._y0,a=this._z0,o=this._x1,s=this._y1,l=this._z1;if(isNaN(r))o=(r=Math.floor(e))+1,s=(i=Math.floor(t))+1,l=(a=Math.floor(n))+1;else{for(var u,c,d=o-r||1,f=this._root;r>e||e>=o||i>t||t>=s||a>n||n>=l;)switch(c=(n<a)<<2|(t<i)<<1|e<r,(u=Array(8))[c]=f,f=u,d*=2,c){case 0:o=r+d,s=i+d,l=a+d;break;case 1:r=o-d,s=i+d,l=a+d;break;case 2:o=r+d,i=s-d,l=a+d;break;case 3:r=o-d,i=s-d,l=a+d;break;case 4:o=r+d,s=i+d,a=l-d;break;case 5:r=o-d,s=i+d,a=l-d;break;case 6:o=r+d,i=s-d,a=l-d;break;case 7:r=o-d,i=s-d,a=l-d;}this._root&&this._root.length&&(this._root=f);}return this._x0=r,this._y0=i,this._z0=a,this._x1=o,this._y1=s,this._z1=l,this;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"1a87dd23":function(e,t,n){var r=n("885a1eb4"),i=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(i,""):e;};},"1a8a13fa":function(e,t,n){e.exports=function(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return -1;};},"1a978c65":function(e,t,n){Object.prototype.hasOwnProperty;},"1ac6edf9":function(e,t,n){var r=n("d5f60c89"),i=n("a6555055");e.exports=function(e,t){return r(e,t,function(t,n){return i(e,n);});};},"1ad88e4c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t;};},"1ae5fa66":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("777fffbe"),n("5dc7140d"),n("cf7441db");},"1b287fd2":function(e,t,n){var r=n("9a0f9519"),i=n("4a5f2e09"),a=n("6b4089d5"),o=n("37baa790"),s=n("c5fd2ecb"),l=n("5e913e76");e.exports=function(e,t,n){var u=-1,c=i,d=e.length,f=!0,h=[],p=h;if(n)f=!1,c=a;else if(d>=200){var v=t?null:s(e);if(v)return l(v);f=!1,c=o,p=new r;}else p=t?[]:h;e:for(;++u<d;){var g=e[u],m=t?t(g):g;if(g=n||0!==g?g:0,f&&m==m){for(var y=p.length;y--;)if(p[y]===m)continue e;t&&p.push(m),h.push(g);}else c(p,m,n)||(p!==h&&p.push(m),h.push(g));}return h;};},"1b6336a3":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{ArrowLineTriangulation:function(){return s;},FlowHalfArrowFillTriangulation:function(){return a;},FlowLineTriangulation:function(){return o;}});var r=n("777fffbe")._(n("daaa1548")),i=n("ff3d9f81");function a(e){let t=e.coordinates.flat();return{vertices:[1,0,0,...t,1,2,-3,...t,1,1,-3,...t,0,1,0,...t,0,0,0,...t,1,0,0,...t,1,2,-3,...t,1,1,-3,...t,0,1,0,...t,0,0,0,...t],normals:[-1,2,1,2,-1,1,1,-1,1,1,-1,1,-1,-1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7};}function o(e,t){return t?s(e,t):a(e);}function s(e,t){let n=e.coordinates.flat(),{target:r="classic",source:a="circle"}=t,o=l((0,i.getSymbol)(a,"source"),n,0,0),s=(0,i.lineArrowPath)(n,o.vertices.length/7,t),u=l((0,i.getSymbol)(r,"target"),n,1,o.vertices.length/7+s.vertices.length/7);return{vertices:[...o.vertices,...s.vertices,...u.vertices],indices:[...o.outLineIndices,...s.outLineIndices,...u.outLineIndices,...o.indices,...s.indices,...u.indices],normals:[...o.normals,...s.normals,...u.normals],size:7};}function l(e,t,n=1,i=0){let a=[],{vertices:o,indices:s,dimensions:u,outLineIndices:c}=e;for(let e=0;e<o.length;e+=u)a.push(n,o[e+1],o[e],...t);return(0,r.default)((0,r.default)({},e),{},{vertices:a,indices:s.map(e=>e+i),outLineIndices:c.map(e=>e+i)});}},"1c52dcc2":function(e,t,n){e.exports=function(e){return function(t){return null==t?void 0:t[e];};};},"1c5ac11e":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r.default;}});var r=n("777fffbe")._(n("7850ca64"));},"1ca82f45":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("95189ca1");},"1cbbcd12":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{LayerPopup:function(){return u;},default:function(){return u;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("d812e418")),o=n("fb1ec05a"),s=r._(n("2eabba1c"));let{get:l}=o.lodashUtil;class u extends s.default{constructor(...e){super(...e),(0,a.default)(this,"layerClickCountByFrame",0),(0,a.default)(this,"layerConfigMap",new WeakMap),(0,a.default)(this,"displayFeatureInfo",void 0),(0,a.default)(this,"onLayerClick",(e,t)=>{requestAnimationFrame(()=>{if(this.popupOption.closeOnClick&&this.layerClickCountByFrame++,this.isShow&&this.isSameFeature(e,t.featureId))this.hide();else{let{title:n,content:r}=this.getLayerInfoFrag(e,t);this.setDOMContent(r),this.setLnglat(t.lngLat),this.setTitle(n),this.setDisplayFeatureInfo({layer:e,featureId:t.featureId}),this.show();}});}),(0,a.default)(this,"onSceneClick",()=>{this.layerClickCountByFrame=0,requestAnimationFrame(()=>{this.layerClickCountByFrame||this.hide();});}),(0,a.default)(this,"onLayerHide",()=>{this.hide(),this.setDisplayFeatureInfo(void 0);}),(0,a.default)(this,"updateCloseOnClick",()=>{});}get layerConfigItems(){var e;let{config:t,items:n}=this.popupOption;return null!==(e=null!=t?t:n)&&void 0!==e?e:[];}addTo(e){return super.addTo(e),this.bindLayerEvent(),this.hide(),this;}remove(){return super.remove(),this.unbindLayerEvent(),this;}setOptions(e){this.unbindLayerEvent();let t=(0,i.default)({},e),n=t.trigger||this.popupOption.trigger,r=t.items||this.popupOption.items,a=(null==r?void 0:r.length)===0;t.followCursor="hover"===n&&!a;let o=this.isShow;return super.setOptions(t),this.bindLayerEvent(),(a||!o)&&this.hide(),this;}getDefault(e){let t="click"!==e.trigger;return(0,i.default)((0,i.default)({},super.getDefault(e)),{},{trigger:"hover",followCursor:t,lngLat:{lng:0,lat:0},offsets:[0,10],closeButton:!1,closeOnClick:!0,autoClose:!1,closeOnEsc:!1});}bindLayerEvent(){let{trigger:e,closeOnClick:t}=this.popupOption;this.layerConfigItems.forEach(n=>{var r,a;let o=this.getLayerByConfig(n);if(!o)return;let s=(0,i.default)({},n);if("hover"===e){let e=this.onLayerMouseMove.bind(this,o),t=this.onLayerMouseOut.bind(this,o);s.onMouseMove=e,s.onMouseOut=t,null==o||o.on("mousemove",e),null==o||o.on("mouseout",t);}else{let e=this.onLayerClick.bind(this,o);s.onClick=e,null==o||o.on("click",e);let n=null===(a=this.mapsService)||void 0===a?void 0:a.getMapContainer();n&&t&&n.addEventListener("click",this.onSceneClick);}let l=null==o||null===(r=o.getSource)||void 0===r?void 0:r.call(o),u=this.onSourceUpdate.bind(this);null==l||l.on("update",u),s.onSourceUpdate=u,this.layerConfigMap.set(o,s);});}unbindLayerEvent(){this.layerConfigItems.forEach(e=>{var t,n;let r=this.getLayerByConfig(e),i=r&&this.layerConfigMap.get(r);if(!i)return;let{onMouseMove:a,onMouseOut:o,onClick:s,onSourceUpdate:l}=i;a&&r.off("mousemove",a),o&&r.off("mouseout",o),s&&r.off("click",s),l&&(null==r||null===(n=r.getSource())||void 0===n||n.off("update",l));let u=null===(t=this.mapsService)||void 0===t?void 0:t.getMapContainer();u&&u.removeEventListener("click",this.onSceneClick);});}onLayerMouseMove(e,t){if(!this.isSameFeature(e,t.featureId)){let{title:n,content:r}=this.getLayerInfoFrag(e,t);this.setDOMContent(r),this.setTitle(n),this.setDisplayFeatureInfo({layer:e,featureId:t.featureId}),this.show();}}onLayerMouseOut(e,t){this.setDisplayFeatureInfo(void 0),this.isShow&&this.hide();}onSourceUpdate(){this.hide(),this.setDisplayFeatureInfo(void 0);}getLayerInfoFrag(e,t){let n;let r=this.layerConfigMap.get(e),i=document.createDocumentFragment();if(r){let e=t.feature;"Feature"===e.type&&"properties"in e&&"geometry"in e&&(e=e.properties);let{title:a,fields:s,customContent:u}=r;if(a){n=document.createDocumentFragment();let t=a instanceof Function?a(e):a;o.DOM.appendElementType(n,t);}if(u){let t=u instanceof Function?u(e):u;o.DOM.appendElementType(i,t);}else null!=s&&s.length&&(null==s||s.forEach(n=>{var r,a;let{field:s,formatField:u,formatValue:c,getValue:d}="string"==typeof n?{field:n}:n,f=o.DOM.create("div","l7-layer-popup__row"),h=d?d(t.feature):l(e,s),p=null!==(r=u instanceof Function?u(s,e):u)&&void 0!==r?r:s,v=null!==(a=c instanceof Function?c(h,e):c)&&void 0!==a?a:h,g=o.DOM.create("span","l7-layer-popup__key",f);o.DOM.appendElementType(g,p),o.DOM.appendElementType(g,document.createTextNode("\uFF1A"));let m=o.DOM.create("span","l7-layer-popup__value",f);Array.isArray(v)&&v.every(e=>!(e instanceof Object))&&(v=v.map(e=>String(e)).join(",")),o.DOM.appendElementType(m,v),i.appendChild(f);}));}return{title:n,content:i};}getLayerByConfig(e){let t=e.layer;return t instanceof Object?t:"string"==typeof t?this.layerService.getLayer(t)||this.layerService.getLayerByName(t):void 0;}isSameFeature(e,t){let n=this.displayFeatureInfo;return n&&e===n.layer&&t===n.featureId;}setDisplayFeatureInfo(e){let t=this.displayFeatureInfo;t&&t.layer.off("hide",this.onLayerHide),e&&e.layer.on("hide",this.onLayerHide),this.displayFeatureInfo=e;}}},"1cd52fb4":function(e,t,n){"use strict";function r(e,t){for(var n in t)t.hasOwnProperty(n)&&"constructor"!==n&&void 0!==t[n]&&(e[n]=t[n]);}function i(e,t,n,i){return t&&r(e,t),n&&r(e,n),i&&r(e,i),e;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});},"1cfebee7":function(e,t,n){var r=n("481b6514"),i=n("f28dfa76");e.exports=function(e){return i(e)&&r(e);};},"1d48c64c":function(e,t,n){var r=n("0d2f64a6"),i=n("16ec8ed6");e.exports=function(e){return null==e?[]:r(e,i(e));};},"1d52ce54":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{isTileGroup:function(){return i;},tileVectorParser:function(){return r;}});let r=["mvt","geojsonvt","testTile"];function i(e){let t=e.getSource();return r.includes(t.parser.type);}},"1d595a1a":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"pathLengthFactory",{enumerable:!0,get:function(){return l;}});var r=n("5e61b478"),i=n("b1a0b97a"),a=n("085e1ebd"),o=n("65f3d028"),s=n("5727e4c3");function l(e,t,n){for(var l,u,c,d,f,h,p,v,g,m=(0,r.normalizePath)(e),y="number"==typeof t,b=[],_=0,x=0,w=0,E=0,M=[],S=[],k=0,C={x:0,y:0},A=C,L=C,P=C,N=0,O=0,I=m.length;O<I;O+=1)b=(p="M"===(v=(g=m[O])[0]))?b:[_,x].concat(g.slice(1)),p?(A=C={x:w=g[1],y:E=g[2]},k=0,y&&t<.001&&(P=C)):"L"===v?(k=(l=(0,i.segmentLineFactory)(b[0],b[1],b[2],b[3],(t||0)-N)).length,C=l.min,A=l.max,L=l.point):"A"===v?(k=(u=(0,a.segmentArcFactory)(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],(t||0)-N,n||{})).length,C=u.min,A=u.max,L=u.point):"C"===v?(k=(c=(0,o.segmentCubicFactory)(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],(t||0)-N,n||{})).length,C=c.min,A=c.max,L=c.point):"Q"===v?(k=(d=(0,s.segmentQuadFactory)(b[0],b[1],b[2],b[3],b[4],b[5],(t||0)-N,n||{})).length,C=d.min,A=d.max,L=d.point):"Z"===v&&(b=[_,x,w,E],k=(f=(0,i.segmentLineFactory)(b[0],b[1],b[2],b[3],(t||0)-N)).length,C=f.min,A=f.max,L=f.point),y&&N<t&&N+k>=t&&(P=L),S.push(A),M.push(C),N+=k,_=(h="Z"!==v?g.slice(-2):[w,E])[0],x=h[1];return y&&t>=N&&(P={x:_,y:x}),{length:N,point:P,min:{x:Math.min.apply(null,M.map(function(e){return e.x;})),y:Math.min.apply(null,M.map(function(e){return e.y;}))},max:{x:Math.max.apply(null,S.map(function(e){return e.x;})),y:Math.max.apply(null,S.map(function(e){return e.y;}))}};}},"1d6abaf5":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"SimpleMapCoord",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("d812e418"));class i{constructor(e){(0,r.default)(this,"size",1e4),this.size=e||1e4;}setSize(e){this.size=e;}getSize(){return[this.size,this.size];}mercatorXfromLng(e){return(180+e)/360*this.size;}mercatorYfromLat(e){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360)*this.size;}lngFromMercatorX(e){return e/this.size*360-180;}latFromMercatorY(e){return 360/Math.PI*Math.atan(Math.exp((180-(1-e/this.size)*360)*Math.PI/180))-90;}project(e){return[this.mercatorXfromLng(e[0]),this.mercatorYfromLat(e[1])];}unproject(e){return[this.lngFromMercatorX(e[0]),this.latFromMercatorY(e[1])];}}},"1d726f2c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=n("201ec6be"),a=r._(n("a556cf14")),o=r._(n("2eb295f7")),s=n("afe81a74");function l(){var e,t,n,r,l,u=(0,a.default)(-30),c=1,d=1/0,f=.81;function h(n){var a,o=e.length,l=(0,i.quadtree)(e,s.x,s.y).visitAfter(v);for(r=n,a=0;a<o;++a)t=e[a],l.visit(g);}function p(){if(e){var t,n,r=e.length;for(t=0,l=Array(r);t<r;++t)l[(n=e[t]).index]=+u(n,t,e);}}function v(e){var t,n,r,i,a,o=0,s=0;if(e.length){for(r=i=a=0;a<4;++a)(t=e[a])&&(n=Math.abs(t.value))&&(o+=t.value,s+=n,r+=n*t.x,i+=n*t.y);e.x=r/s,e.y=i/s;}else{(t=e).x=t.data.x,t.y=t.data.y;do o+=l[t.data.index];while(t=t.next)}e.value=o;}function g(e,i,a,s){if(!e.value)return!0;var u=e.x-t.x,h=e.y-t.y,p=s-i,v=u*u+h*h;if(p*p/f<v)return v<d&&(0===u&&(v+=(u=(0,o.default)(n))*u),0===h&&(v+=(h=(0,o.default)(n))*h),v<c&&(v=Math.sqrt(c*v)),t.vx+=u*e.value*r/v,t.vy+=h*e.value*r/v),!0;if(!e.length&&!(v>=d)){(e.data!==t||e.next)&&(0===u&&(v+=(u=(0,o.default)(n))*u),0===h&&(v+=(h=(0,o.default)(n))*h),v<c&&(v=Math.sqrt(c*v)));do e.data!==t&&(p=l[e.data.index]*r/v,t.vx+=u*p,t.vy+=h*p);while(e=e.next)}}return h.initialize=function(t,r){e=t,n=r,p();},h.strength=function(e){return arguments.length?(u="function"==typeof e?e:(0,a.default)(+e),p(),h):u;},h.distanceMin=function(e){return arguments.length?(c=e*e,h):Math.sqrt(c);},h.distanceMax=function(e){return arguments.length?(d=e*e,h):Math.sqrt(d);},h.theta=function(e){return arguments.length?(f=e*e,h):Math.sqrt(f);},h;}},"1ecef0ca":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{Scale:function(){return l;},default:function(){return l;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("d812e418")),o=n("fb1ec05a"),s=n("9d431275");class l extends s.Control{constructor(...e){super(...e),(0,a.default)(this,"mScale",void 0),(0,a.default)(this,"iScale",void 0),(0,a.default)(this,"update",()=>{let e=this.mapsService,{maxWidth:t}=this.controlOption,n=e.getSize()[1]/2,r=e.containerToLngLat([0,n]),i=e.containerToLngLat([t,n]),a=(0,o.lnglatDistance)([r.lng,r.lat],[i.lng,i.lat]);this.updateScales(a);});}getDefault(e){return(0,i.default)((0,i.default)({},super.getDefault(e)),{},{name:"scale",position:s.PositionType.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,lockWidth:!0});}onAdd(){let e=o.DOM.create("div","l7-control-scale");this.resetScaleLines(e);let{updateWhenIdle:t}=this.controlOption;return this.mapsService.on(t?"moveend":"mapmove",this.update),this.mapsService.on(t?"zoomend":"zoomchange",this.update),e;}onRemove(){let{updateWhenIdle:e}=this.controlOption;this.mapsService.off(e?"zoomend":"zoomchange",this.update),this.mapsService.off(e?"moveend":"mapmove",this.update);}setOptions(e){super.setOptions(e),this.checkUpdateOption(e,["lockWidth","maxWidth","metric","updateWhenIdle","imperial"])&&this.resetScaleLines(this.container);}updateScales(e){let{metric:t,imperial:n}=this.controlOption;t&&e&&this.updateMetric(e),n&&e&&this.updateImperial(e);}resetScaleLines(e){o.DOM.clearChildren(e);let{metric:t,imperial:n,maxWidth:r,lockWidth:i}=this.controlOption;i&&o.DOM.addStyle(e,`width: ${r}px`),t&&(this.mScale=o.DOM.create("div","l7-control-scale-line",e)),n&&(this.iScale=o.DOM.create("div","l7-control-scale-line",e)),this.update();}updateScale(e,t,n){let{maxWidth:r}=this.controlOption;e.style.width=Math.round(r*n)+"px",e.innerHTML=t;}getRoundNum(e){let t=Math.pow(10,(Math.floor(e)+"").length-1),n=e/t;return t*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1);}updateMetric(e){let t=this.getRoundNum(e);this.updateScale(this.mScale,t<1e3?t+" m":t/1e3+" km",t/e);}updateImperial(e){let t,n,r;let i=3.2808399*e;i>5280?(t=i/5280,n=this.getRoundNum(t),this.updateScale(this.iScale,n+" mi",n/t)):(r=this.getRoundNum(i),this.updateScale(this.iScale,r+" ft",r/i));}}},"1f86664c":function(e,t,n){var r=n("c0051812"),i=n("49f9401f"),a=n("63bd4b56"),o=n("13056af7");e.exports=function(e,t){return r(e)?e:i(e,t)?[e]:a(o(e));};},"1fc00f58":function(e,t,n){var r=n("7bc08ef6"),i=n("31e26024"),a=n("ea7bb476"),o=n("baa3a209"),s=Object.prototype,l=s.hasOwnProperty,u=r(function(e,t){e=Object(e);var n=-1,r=t.length,u=r>2?t[2]:void 0;for(u&&a(t[0],t[1],u)&&(r=1);++n<r;)for(var c=t[n],d=o(c),f=-1,h=d.length;++f<h;){var p=d[f],v=e[p];(void 0===v||i(v,s[p])&&!l.call(e,p))&&(e[p]=c[p]);}return e;});e.exports=u;},"1fc5e31d":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return function e(t){let n;let r=[];function i(e){return null==e?n:e;}return i.invert=i,i.domain=i.range=e=>e?(r=e,e):r,i.unknown=e=>e?(n=e,e):n,i.copy=()=>e(t).unknown(n),i;};}});},"201ec6be":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"quadtree",{enumerable:!0,get:function(){return r.default;}});var r=n("777fffbe")._(n("01b31941"));},"2071b9b5":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"Plugin",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe"),i=r._(n("1316cf9d")),a=r._(n("3d495adb")),o=r._(n("66a06515")),s=r._(n("20defe2a")),l=n("597eee67"),u=function(){function e(){(0,i.default)(this,e);}return(0,a.default)(e,[{key:"apply",value:function(t,n){var r=this,i=t.renderingService,a=t.renderingContext,o=t.config;this.context=t;var s=a.root.ownerDocument.defaultView,l=function(e){i.hooks.pointerMove.call(e);},u=function(e){i.hooks.pointerUp.call(e);},c=function(e){i.hooks.pointerDown.call(e);},d=function(e){i.hooks.pointerOver.call(e);},f=function(e){i.hooks.pointerOut.call(e);},h=function(e){i.hooks.pointerCancel.call(e);},p=function(e){i.hooks.pointerWheel.call(e);},v=function(e){i.hooks.click.call(e);},g=function(e){n.globalThis.document.addEventListener("pointermove",l,!0),e.addEventListener("pointerdown",c,!0),e.addEventListener("pointerleave",f,!0),e.addEventListener("pointerover",d,!0),n.globalThis.addEventListener("pointerup",u,!0),n.globalThis.addEventListener("pointercancel",h,!0);},m=function(e){e.addEventListener("touchstart",c,!0),e.addEventListener("touchend",u,!0),e.addEventListener("touchmove",l,!0),e.addEventListener("touchcancel",h,!0);},y=function(e){n.globalThis.document.addEventListener("mousemove",l,!0),e.addEventListener("mousedown",c,!0),e.addEventListener("mouseout",f,!0),e.addEventListener("mouseover",d,!0),n.globalThis.addEventListener("mouseup",u,!0);},b=function(e){n.globalThis.document.removeEventListener("pointermove",l,!0),e.removeEventListener("pointerdown",c,!0),e.removeEventListener("pointerleave",f,!0),e.removeEventListener("pointerover",d,!0),n.globalThis.removeEventListener("pointerup",u,!0),n.globalThis.removeEventListener("pointercancel",h,!0);},_=function(e){e.removeEventListener("touchstart",c,!0),e.removeEventListener("touchend",u,!0),e.removeEventListener("touchmove",l,!0),e.removeEventListener("touchcancel",h,!0);},x=function(e){n.globalThis.document.removeEventListener("mousemove",l,!0),e.removeEventListener("mousedown",c,!0),e.removeEventListener("mouseout",f,!0),e.removeEventListener("mouseover",d,!0),n.globalThis.removeEventListener("mouseup",u,!0);};i.hooks.init.tap(e.tag,function(){var e=r.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(e.style.msContentZooming="none",e.style.msTouchAction="none"):s.supportsPointerEvents&&(e.style.touchAction="none"),s.supportsPointerEvents?g(e):y(e),s.supportsTouchEvents&&m(e),o.useNativeClickEvent&&e.addEventListener("click",v,!0),e.addEventListener("wheel",p,{passive:!0,capture:!0});}),i.hooks.destroy.tap(e.tag,function(){var e=r.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(e.style.msContentZooming="",e.style.msTouchAction=""):s.supportsPointerEvents&&(e.style.touchAction=""),s.supportsPointerEvents?b(e):x(e),s.supportsTouchEvents&&_(e),o.useNativeClickEvent&&e.removeEventListener("click",v,!0),e.removeEventListener("wheel",p,!0);});}}]);}();u.tag="DOMInteraction";var c=function(e){function t(){var e;(0,i.default)(this,t);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=(0,o.default)(this,t,[].concat(r))).name="dom-interaction",e;}return(0,s.default)(t,e),(0,a.default)(t,[{key:"init",value:function(){this.addRenderingPlugin(new u);}},{key:"destroy",value:function(){this.removeAllRenderingPlugins();}}]);}(l.AbstractRendererPlugin);},"20a478c1":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"BlendTypes",{enumerable:!0,get:function(){return i;}});var r=n("d9b661b3");let i={[r.BlendType.additive]:{enable:!0,func:{srcRGB:r.gl.ONE,dstRGB:r.gl.ONE,srcAlpha:1,dstAlpha:1}},[r.BlendType.none]:{enable:!1},[r.BlendType.normal]:{enable:!0,func:{srcRGB:r.gl.SRC_ALPHA,dstRGB:r.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}},[r.BlendType.subtractive]:{enable:!0,func:{srcRGB:r.gl.ONE,dstRGB:r.gl.ONE,srcAlpha:r.gl.ZERO,dstAlpha:r.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:r.gl.FUNC_SUBTRACT,alpha:r.gl.FUNC_SUBTRACT}},[r.BlendType.max]:{enable:!0,func:{srcRGB:r.gl.ONE,dstRGB:r.gl.ONE},equation:{rgb:r.gl.MAX_EXT}},[r.BlendType.min]:{enable:!0,func:{srcRGB:r.gl.ONE,dstRGB:r.gl.ONE},equation:{rgb:r.gl.MIN_EXT}}};},"20bfb153":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("a12bb5bb")),i=function(e){if("object"!=typeof e||null===e)return e;if((0,r.default)(e)){t=[];for(var t,n=0,a=e.length;n<a;n++)"object"==typeof e[n]&&null!=e[n]?t[n]=i(e[n]):t[n]=e[n];}else for(var o in t={},e)"object"==typeof e[o]&&null!=e[o]?t[o]=i(e[o]):t[o]=e[o];return t;},a=i;},"20e820cd":function(e,t,n){"use strict";var r=n("ce906886");e.exports=function(e){var t={},n=r.filter(e.nodes(),function(t){return!e.children(t).length;}),i=r.max(r.map(n,function(t){return e.node(t).rank;})),a=r.map(r.range(i+1),function(){return[];}),o=r.sortBy(n,function(t){return e.node(t).rank;});return r.forEach(o,function n(i){r.has(t,i)||(t[i]=!0,a[e.node(i).rank].push(i),r.forEach(e.successors(i),n));}),a;};},"2191408c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("99ff515c"));function i(e){if((0,r.default)(e))return e[0];}},21962781:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe")._(n("05a4af02")),i=r.default?r.default.prototype:void 0,a=i?i.valueOf:void 0,o=function(e){return a?Object(a.call(e)):{};};},"21e77288":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{default:function(){return f;},generateLightingUniforms:function(){return d;}});var r=n("777fffbe"),i=r._(n("b131ee44")),a=r._(n("daaa1548"));let o=["type"],s={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},l={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},u={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},c={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function d(e){let t={u_DirectionalLights:[,,,].fill((0,a.default)({},u)),u_NumOfDirectionalLights:0,u_SpotLights:[,,,].fill((0,a.default)({},c)),u_NumOfSpotLights:0};return e&&e.length||(e=[l]),e.forEach(e=>{let{type:n="directional"}=e,r=(0,i.default)(e,o),l=s[n].lights,u=s[n].num,c=t[u];t[l][c]=(0,a.default)((0,a.default)({},t[l][c]),r),t[u]++;}),t;}class f{apply(e){e.hooks.beforeRender.tap("LightingPlugin",()=>{let{enableLighting:t}=e.getLayerConfig();t&&e.models.forEach(e=>e.addUniforms((0,a.default)({},d())));});}}},"2268cb10":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"ClickZoomHandler",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("d812e418")),i=n("42fc1d72");class a{constructor(e){(0,r.default)(this,"_tr",void 0),(0,r.default)(this,"_enabled",void 0),(0,r.default)(this,"_active",void 0),this._tr=new i.TransformProvider(e),this.reset();}reset(){this._active=!1;}dblclick(e,t){return e.preventDefault(),{cameraAnimation:n=>{n.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(t)},{originalEvent:e});}};}enable(){this._enabled=!0;}disable(){this._enabled=!1,this.reset();}isEnabled(){return this._enabled;}isActive(){return this._active;}}},"226a180d":function(e,t,n){"use strict";function r(e){let t=.5,n=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0;break;default:t=.5;}switch(e){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0;break;default:n=.5;}return{horizontalAlign:t,verticalAlign:n};}function i(e,t,n,r,i){if(!i)return;let a=e[r],o=a.glyph;if(o){let s=t[o].advance*a.scale,l=(e[r].x+s)*i;for(let t=n;t<=r;t++)e[t].x-=l;}}function a(e,t,n,r,i,a,o){let s=(t-n)*i,l=(-r*o+.5)*a;for(let t of e)t.x+=s,t.y+=l;}function o(e,t,n,s,l,u,c=[0,0],d){let f=e.split("\n"),h=[],p={positionedGlyphs:h,top:c[1],bottom:c[1],left:c[0],right:c[0],lineCount:f.length,text:e};return d?function(e,t,n,o,s,l,u){let c=0,d=-8,f=0,h=e.positionedGlyphs,p="right"===l?1:"left"===l?0:.5,v=h.length;n.forEach(e=>{let n=t[e];n&&(h.push({glyph:e,x:n.advance/2,y:d+0,vertical:!1,scale:1,metrics:n}),c+=n.advance+u),h.length!==v&&(f=Math.max(c-u,f),i(h,t,v,h.length-1,p)),c=0,d-=o+5;});let{horizontalAlign:g,verticalAlign:m}=r(s);a(h,p,g,m,f,o,n.length);let y=d- -8;e.top+=-m*y,e.bottom=e.top-y,e.left+=-g*f,e.right=e.left+f;}(p,t,f,n,s,l,u):function(e,t,n,o,s,l,u){let c=0,d=-8,f=0,h=e.positionedGlyphs,p="right"===l?1:"left"===l?0:.5,v=h.length;n.forEach(e=>{e.split("").forEach(e=>{let n=t[e];n&&(h.push({glyph:e,x:c,y:d+0,vertical:!1,scale:1,metrics:n}),c+=n.advance+u);}),h.length!==v&&(f=Math.max(c-u,f),i(h,t,v,h.length-1,p)),c=0,d-=o+5;});let{horizontalAlign:g,verticalAlign:m}=r(s);a(h,p,g,m,f,o,n.length);let y=d- -8;e.top+=-m*y,e.bottom=e.top-y,e.left+=-g*f,e.right=e.left+f;}(p,t,f,n,s,l,u),!!h.length&&p;}function s(e,t=[0,0],n){let{positionedGlyphs:r=[]}=e,i=[];for(let e of r){let r=e.metrics,a=r.advance*e.scale/2,o=n?[e.x+a,e.y]:[0,0],s=n?[0,0]:[e.x+a+t[0],e.y+t[1]],l=-4*e.scale-a+s[0],u=-4*e.scale+s[1],c=l+r.width*e.scale,d=u+r.height*e.scale,f={x:l,y:u},h={x:c,y:u},p={x:l,y:d},v={x:c,y:d};i.push({tl:f,tr:h,bl:p,br:v,tex:r,glyphOffset:o});}return i;}n.d(t,"__esModule",{value:!0}),n.e(t,{getGlyphQuads:function(){return s;},shapeText:function(){return o;}});},"2321866b":function(e,t,n){"use strict";function r(e){return null===e;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"232edce3":function(e,t,n){var r=n("1c52dcc2")("length");e.exports=r;},"2339bf2f":function(e,t,n){var r=RegExp("[\\u200d\ud800-\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return r.test(e);};},"23fe6e23":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("a12bb5bb")),a=r._(n("10576492")),o=Object.prototype.hasOwnProperty,s=function(e,t){if(!t||!(0,i.default)(e))return{};for(var n,r={},s=(0,a.default)(t)?t:function(e){return e[t];},l=0;l<e.length;l++){var u=e[l];n=s(u),o.call(r,n)?r[n].push(u):r[n]=[u];}return r;};},"2445cd68":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("a8be75a3")),i=function(){try{var e=(0,r.default)(Object,"defineProperty");return e({},"",{}),e;}catch(e){}}();},"2460dbf0":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("3e4beef3")),a=r._(n("7e78caeb")),o=r._(n("cd0631a9")),s=Object.prototype.hasOwnProperty,l=function(e){if(!(0,i.default)(e))return(0,o.default)(e);var t=(0,a.default)(e),n=[];for(var r in e)"constructor"==r&&(t||!s.call(e,r))||n.push(r);return n;};},"248f82c8":function(e,t,n){"use strict";var r=n("ce906886"),i=n("b192169f"),a=n("d0820664").positionX;e.exports=function(e){var t,n,o,s;t=e=i.asNonCompoundGraph(e),n=i.buildLayerMatrix(t),o=t.graph().ranksep,s=0,r.forEach(n,function(e){var n=r.max(r.map(e,function(e){return t.node(e).height;}));r.forEach(e,function(e){t.node(e).y=s+n/2;}),s+=n+o;}),r.forEach(a(e),function(t,n){e.node(n).x=t;});};},"24aea557":function(e,t,n){"use strict";function r(e){var t=e.slice(1).map(function(t,n,r){return n?r[n-1].slice(-2).concat(t.slice(1)):e[0].slice(1).concat(t.slice(1));}).map(function(e){return e.map(function(t,n){return e[e.length-n-2*(1-n%2)];});}).reverse();return[["M"].concat(t[0].slice(0,2))].concat(t.map(function(e){return["C"].concat(e.slice(2));}));}n.d(t,"__esModule",{value:!0}),n.d(t,"reverseCurve",{enumerable:!0,get:function(){return r;}});},"24be8624":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("391ac29e")),a=r._(n("6986dfc1")),o=function(e,t){return void 0===t&&(t=[]),(0,i.default)(e,function(e){return!(0,a.default)(t,e);});};},"2546cc51":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe"),i=r._(n("95795444")),a=r._(n("7372f057")),o=r._(n("99d99dd5")),s=r._(n("05869b42")),l=r._(n("d3b4f9a2"));function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1]);}}u.prototype.clear=i.default,u.prototype.delete=a.default,u.prototype.get=o.default,u.prototype.has=s.default,u.prototype.set=l.default;var c=u;},"262487a2":function(e,t,n){var r=n("d038e143");e.exports=function(e,t){var n=[];return r(e,function(e,r,i){t(e,r,i)&&n.push(e);}),n;};},"262c4dce":function(e,t,n){"use strict";let r;n.d(t,"__esModule",{value:!0}),n.d(t,"browser",{enumerable:!0,get:function(){return a;}});var i=n("28756b3b");let a={now:"undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:e=>new Promise((t,n)=>{let r=requestAnimationFrame(t);e.signal.addEventListener("abort",()=>{cancelAnimationFrame(r),n((0,i.createAbortError)());});}),get prefersReducedMotion(){if(!window.matchMedia)return!1;return null==r&&(r=window.matchMedia("(prefers-reduced-motion: reduce)")),r.matches;}};},"268fe8f9":function(e,t,n){var r=n("16b3b059")["__core-js_shared__"];e.exports=r;},"26c960bc":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"CooperativeGesturesHandler",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("d812e418")),i=n("e31a659c");class a{constructor(e,t){(0,r.default)(this,"_options",void 0),(0,r.default)(this,"_map",void 0),(0,r.default)(this,"_container",void 0),(0,r.default)(this,"_bypassKey",-1!==navigator.userAgent.indexOf("Mac")?"metaKey":"ctrlKey"),(0,r.default)(this,"_enabled",void 0),this._map=e,this._options=t,this._enabled=!1;}isActive(){return!1;}reset(){}_setupUI(){if(this._container)return;let e=this._map.getCanvasContainer();e.classList.add("l7-cooperative-gestures"),this._container=i.DOM.create("div","l7-cooperative-gesture-screen",e);let t=document.createElement("div");t.className="l7-desktop-message",t.textContent="Missing UI string",this._container.appendChild(t);let n=document.createElement("div");n.className="l7-mobile-message",n.textContent="Missing UI string",this._container.appendChild(n),this._container.setAttribute("aria-hidden","true");}_destoryUI(){this._container&&(i.DOM.remove(this._container),this._map.getCanvasContainer().classList.remove("l7-cooperative-gestures")),delete this._container;}enable(){this._setupUI(),this._enabled=!0;}disable(){this._enabled=!1,this._destoryUI();}isEnabled(){return this._enabled;}touchmove(e){this._onCooperativeGesture(1===e.touches.length);}wheel(e){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!e[this._bypassKey]);}_onCooperativeGesture(e){this._enabled&&e&&(this._container.classList.add("l7-show"),setTimeout(()=>{this._container.classList.remove("l7-show");},100));}}},"26fccf8d":function(e,t,n){"use strict";function r(e){return 10===e||13===e||8232===e||8233===e||32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e);}n.d(t,"__esModule",{value:!0}),n.d(t,"isSpace",{enumerable:!0,get:function(){return r;}});},"26fe17ea":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r={wind:n("777fffbe")._(n("6b41e0ef")).default};},"271c9ad5":function(e,t,n){var r=n("e3d5f8e1");e.exports=function(e,t,n){for(var i=-1,a=e.length;++i<a;){var o=e[i],s=t(o);if(null!=s&&(void 0===l?s==s&&!r(s):n(s,l)))var l=s,u=o;}return u;};},"2774291e":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("629a34cc")),a=r._(n("0340f449")),o=r._(n("b0ea6077")),s=o.default&&o.default.isSet,l=s?(0,a.default)(s):i.default;},"27db1f6b":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("4086b076")),a=r._(n("3a988df8")),o=function(e){return(0,a.default)(e)&&"[object Arguments]"==(0,i.default)(e);};},"28176a60":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("a483b73f")),a=r._(n("6cd126a9")),o=r._(n("e7fea481")),s=function(e,t,n){var r=e,s=(0,a.default)(t)?t.split("."):t;return s.forEach(function(e,t){t<s.length-1?((0,i.default)(r[e])||(r[e]=(0,o.default)(s[t+1])?[]:{}),r=r[e]):r[e]=n;}),e;};},"28756b3b":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{ABORT_ERROR:function(){return r;},createAbortError:function(){return i;}});let r="AbortError";function i(){return Error(r);}},"2879839f":function(e,t,n){var r=n("062d75f7")(Object.keys,Object);e.exports=r;},"288b8a90":function(e,t,n){var r=n("8d15a3f4"),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e);};},"2942ce4b":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("80e60ee8");},"29595ef2":function(e,t,n){var r=n("e3d5f8e1");e.exports=function(e,t){if(e!==t){var n=void 0!==e,i=null===e,a=e==e,o=r(e),s=void 0!==t,l=null===t,u=t==t,c=r(t);if(!l&&!c&&!o&&e>t||o&&s&&u&&!l&&!c||i&&s&&u||!n&&u||!a)return 1;if(!i&&!o&&!c&&e<t||c&&n&&a&&!i&&!o||l&&n&&a||!s&&a||!u)return -1;}return 0;};},29680974:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("99ff515c")),i=function(e,t){if(!(0,r.default)(e))return -1;var n=Array.prototype.indexOf;if(n)return n.call(e,t);for(var i=-1,a=0;a<e.length;a++)if(e[a]===t){i=a;break;}return i;};},"296a0a99":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("b6081162")),i=function(e){return(0,r.default)(e,"Number");};},"296f3d59":function(e,t,n){var r=Object.prototype.toString;e.exports=function(e){return r.call(e);};},"297109c8":function(e,t,n){e.exports=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n));};};},"2a1c9565":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{default:function(){return f;},x:function(){return s;},y:function(){return l;},z:function(){return u;}});var r=n("777fffbe"),i=n("b0d099be"),a=n("382eef13"),o=r._(n("8e5ff89f"));function s(e){return e.x;}function l(e){return e.y;}function u(e){return e.z;}var c=Math.PI*(3-Math.sqrt(5)),d=20*Math.PI/(9+Math.sqrt(221));function f(e,t){var n,r=Math.min(3,Math.max(1,Math.round(t=t||2))),s=1,l=.001,u=1-Math.pow(.001,1/300),f=0,h=.6,p=new Map,v=(0,a.timer)(y),g=(0,i.dispatch)("tick","end"),m=(0,o.default)();function y(){b(),g.call("tick",n),s<l&&(v.stop(),g.call("end",n));}function b(t){var i,a,o=e.length;void 0===t&&(t=1);for(var l=0;l<t;++l)for(s+=(f-s)*u,p.forEach(function(e){e(s);}),i=0;i<o;++i)null==(a=e[i]).fx?a.x+=a.vx*=h:(a.x=a.fx,a.vx=0),r>1&&(null==a.fy?a.y+=a.vy*=h:(a.y=a.fy,a.vy=0)),r>2&&(null==a.fz?a.z+=a.vz*=h:(a.z=a.fz,a.vz=0));return n;}function _(){for(var t,n=0,i=e.length;n<i;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),null!=t.fz&&(t.z=t.fz),isNaN(t.x)||r>1&&isNaN(t.y)||r>2&&isNaN(t.z)){var a=10*(r>2?Math.cbrt(.5+n):r>1?Math.sqrt(.5+n):n),o=n*c,s=n*d;1===r?t.x=a:2===r?(t.x=a*Math.cos(o),t.y=a*Math.sin(o)):(t.x=a*Math.sin(o)*Math.cos(s),t.y=a*Math.cos(o),t.z=a*Math.sin(o)*Math.sin(s));}(isNaN(t.vx)||r>1&&isNaN(t.vy)||r>2&&isNaN(t.vz))&&(t.vx=0,r>1&&(t.vy=0),r>2&&(t.vz=0));}}function x(t){return t.initialize&&t.initialize(e,m,r),t;}return null==e&&(e=[]),_(),n={tick:b,restart:function(){return v.restart(y),n;},stop:function(){return v.stop(),n;},numDimensions:function(e){return arguments.length?(r=Math.min(3,Math.max(1,Math.round(e))),p.forEach(x),n):r;},nodes:function(t){return arguments.length?(e=t,_(),p.forEach(x),n):e;},alpha:function(e){return arguments.length?(s=+e,n):s;},alphaMin:function(e){return arguments.length?(l=+e,n):l;},alphaDecay:function(e){return arguments.length?(u=+e,n):+u;},alphaTarget:function(e){return arguments.length?(f=+e,n):f;},velocityDecay:function(e){return arguments.length?(h=1-e,n):1-h;},randomSource:function(e){return arguments.length?(m=e,p.forEach(x),n):m;},force:function(e,t){return arguments.length>1?(null==t?p.delete(e):p.set(e,x(t)),n):p.get(e);},find:function(){var t,n,i,a,o,s,l=Array.prototype.slice.call(arguments),u=l.shift()||0,c=(r>1?l.shift():null)||0,d=(r>2?l.shift():null)||0,f=l.shift()||1/0,h=0,p=e.length;for(f*=f,h=0;h<p;++h)(a=(t=u-(o=e[h]).x)*t+(n=c-(o.y||0))*n+(i=d-(o.z||0))*i)<f&&(s=o,f=a);return s;},on:function(e,t){return arguments.length>1?(g.on(e,t),n):g.on(e);}};}},"2a3589a9":function(e,t,n){var r=n("6e3a9823"),i=n("c0051812"),a=n("f28dfa76");e.exports=function(e){return"string"==typeof e||!i(e)&&a(e)&&"[object String]"==r(e);};},"2abedd64":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"arcToCubic",{enumerable:!0,get:function(){return function e(t,n,i,a,o,s,l,u,c,d){var f,h,p,v,g,m=t,y=n,b=i,_=a,x=u,w=c,E=120*Math.PI/180,M=Math.PI/180*(+o||0),S=[];if(d)h=d[0],p=d[1],v=d[2],g=d[3];else{m=(f=(0,r.rotateVector)(m,y,-M)).x,y=f.y,x=(f=(0,r.rotateVector)(x,w,-M)).x,w=f.y;var k=(m-x)/2,C=(y-w)/2,A=k*k/(b*b)+C*C/(_*_);A>1&&(b*=A=Math.sqrt(A),_*=A);var L=b*b,P=_*_,N=(s===l?-1:1)*Math.sqrt(Math.abs((L*P-L*C*C-P*k*k)/(L*C*C+P*k*k)));v=N*b*C/_+(m+x)/2,g=-(N*_)*k/b+(y+w)/2,h=Math.asin(((y-g)/_*1e9>>0)/1e9),p=Math.asin(((w-g)/_*1e9>>0)/1e9),h=m<v?Math.PI-h:h,p=x<v?Math.PI-p:p,h<0&&(h=2*Math.PI+h),p<0&&(p=2*Math.PI+p),l&&h>p&&(h-=2*Math.PI),!l&&p>h&&(p-=2*Math.PI);}var O=p-h;if(Math.abs(O)>E){var I=p,R=x,D=w;S=e(x=v+b*Math.cos(p=h+E*(l&&p>h?1:-1)),w=g+_*Math.sin(p),b,_,o,0,l,R,D,[p,I,v,g]);}O=p-h;var z=Math.cos(h),B=Math.cos(p),U=Math.tan(O/4),F=4/3*b*U,j=4/3*_*U,V=[m,y],G=[m+F*Math.sin(h),y-j*z],H=[x+F*Math.sin(p),w-j*B],W=[x,w];if(G[0]=2*V[0]-G[0],G[1]=2*V[1]-G[1],d)return G.concat(H,W,S);S=G.concat(H,W,S);for(var Z=[],q=0,Y=S.length;q<Y;q+=1)Z[q]=q%2?(0,r.rotateVector)(S[q-1],S[q],M).y:(0,r.rotateVector)(S[q],S[q+1],M).x;return Z;};}});var r=n("41869dfc");},"2af89dec":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("10576492")),a=r._(n("3b07959f")),o=r._(n("a12bb5bb")),s=r._(n("b0c50986")),l=function(e,t){if(!(0,o.default)(e))return null;if((0,i.default)(t)&&(n=t),(0,s.default)(t)&&(n=function(e){return(0,a.default)(e,t);}),n){for(var n,r=0;r<e.length;r+=1)if(n(e[r]))return e[r];}return null;};},"2b090ae9":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{MapMouseEvent:function(){return u;},MapTouchEvent:function(){return c;},MapWheelEvent:function(){return d;}});var r=n("777fffbe"),i=r._(n("d812e418")),a=n("b448a57d"),o=r._(n("be334174")),s=n("e31a659c"),l=n("1d6abaf5");class u extends a.Event{preventDefault(){this._defaultPrevented=!0;}get defaultPrevented(){return this._defaultPrevented;}constructor(e,t,n,r={}){super(e,r),(0,i.default)(this,"target",void 0),(0,i.default)(this,"originalEvent",void 0),(0,i.default)(this,"point",void 0),(0,i.default)(this,"lngLat",void 0),(0,i.default)(this,"_defaultPrevented",void 0);let a=s.DOM.mousePos(t.getCanvasContainer(),n),o=t.unproject(a);if(this.point=a,this.lngLat=o,this.originalEvent=n,this._defaultPrevented=!1,this.target=t,"SIMPLE"===t.version){let[e,n]=new l.SimpleMapCoord(t.mapSize).project([o.lng,o.lat]);this.lngLat={lng:e,lat:n};}}}class c extends a.Event{preventDefault(){this._defaultPrevented=!0;}get defaultPrevented(){return this._defaultPrevented;}constructor(e,t,n){super(e),(0,i.default)(this,"target",void 0),(0,i.default)(this,"originalEvent",void 0),(0,i.default)(this,"lngLat",void 0),(0,i.default)(this,"point",void 0),(0,i.default)(this,"points",void 0),(0,i.default)(this,"lngLats",void 0),(0,i.default)(this,"_defaultPrevented",void 0);let r="touchend"===e?n.changedTouches:n.touches,a=s.DOM.touchPos(t.getCanvasContainer(),r),l=a.map(e=>t.unproject(e)),u=a.reduce((e,t,n,r)=>e.add(t.div(r.length)),new o.default(0,0)),c=t.unproject(u);this.target=t,this.points=a,this.point=u,this.lngLats=l,this.lngLat=c,this.originalEvent=n,this._defaultPrevented=!1;}}class d extends a.Event{preventDefault(){this._defaultPrevented=!0;}get defaultPrevented(){return this._defaultPrevented;}constructor(e,t,n){super(e),(0,i.default)(this,"target",void 0),(0,i.default)(this,"originalEvent",void 0),(0,i.default)(this,"_defaultPrevented",void 0),this.target=t,this._defaultPrevented=!1,this.originalEvent=n;}}},"2b312dbf":function(e,t,n){},"2b4400a7":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r={fill:n("777fffbe")._(n("e06a3031")).default};},"2ba5f788":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){return null!==e&&"function"!=typeof e&&isFinite(e.length);};},"2c226e10":function(e,t,n){window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function(e){try{var t=(t=document.getElementsByTagName("script"))[t.length-1],n=t.getAttribute("data-injectcss"),t=t.getAttribute("data-disable-injectsvg");if(!t){var r,i,a,o,s,l=function(e,t){t.parentNode.insertBefore(e,t);};if(n&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>");}catch(e){console&&console.log(e);}}r=function(){var t,n=document.createElement("div");n.innerHTML=e._iconfont_svg_string_3580659,(n=n.getElementsByTagName("svg")[0])&&(n.setAttribute("aria-hidden","true"),n.style.position="absolute",n.style.width=0,n.style.height=0,n.style.overflow="hidden",(t=document.body).firstChild?l(n,t.firstChild):t.appendChild(n));},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(r,0):(i=function(){document.removeEventListener("DOMContentLoaded",i,!1),r();},document.addEventListener("DOMContentLoaded",i,!1)):document.attachEvent&&(a=r,o=e.document,s=!1,function e(){try{o.documentElement.doScroll("left");}catch(t){return void setTimeout(e,50);}u();}(),o.onreadystatechange=function(){"complete"==o.readyState&&(o.onreadystatechange=null,u());});}function u(){s||(s=!0,a());}}catch(e){}}(window);},"2c2fd53f":function(e,t,n){var r=n("b570c735");e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map;};},"2c505294":function(e,t,n){var r=n("ce906886"),i=n("5bf20808").Graph;e.exports=function(e,t,n){var a=function(e){for(var t;e.hasNode(t=r.uniqueId("_root")););return t;}(e),o=new i({compound:!0}).setGraph({root:a}).setDefaultNodeLabel(function(t){return e.node(t);});return r.forEach(e.nodes(),function(i){var s=e.node(i),l=e.parent(i);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(o.setNode(i),o.setParent(i,l||a),r.forEach(e[n](i),function(t){var n=t.v===i?t.w:t.v,a=o.edge(n,i),s=r.isUndefined(a)?0:a.weight;o.setEdge(n,i,{weight:e.edge(t).weight+s});}),r.has(s,"minRank")&&o.setNode(i,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}));}),o;};},"2c8d9d54":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("966a4071");},"2cebf917":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("9d065c04"),i=function(e){var t=(0,r.useRef)(e);return t.current=e,t;};},"2d0197c2":function(e,t,n){"use strict";function r(e){return e[0];}function i(e){return arguments.length?(this._x=e,this):this._x;}n.d(t,"__esModule",{value:!0}),n.e(t,{default:function(){return i;},defaultX:function(){return r;}});},"2da13b12":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r={},i=function(e){return r[e=e||"g"]?r[e]+=1:r[e]=1,e+r[e];};},"2db08bc9":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"TapZoomHandler",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe")._(n("d812e418")),i=n("714a8a5a"),a=n("42fc1d72");class o{constructor(e){(0,r.default)(this,"_tr",void 0),(0,r.default)(this,"_enabled",void 0),(0,r.default)(this,"_active",void 0),(0,r.default)(this,"_zoomIn",void 0),(0,r.default)(this,"_zoomOut",void 0),this._tr=new a.TransformProvider(e),this._zoomIn=new i.TapRecognizer({numTouches:1,numTaps:2}),this._zoomOut=new i.TapRecognizer({numTouches:2,numTaps:1}),this.reset();}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset();}touchstart(e,t,n){this._zoomIn.touchstart(e,t,n),this._zoomOut.touchstart(e,t,n);}touchmove(e,t,n){this._zoomIn.touchmove(e,t,n),this._zoomOut.touchmove(e,t,n);}touchend(e,t,n){let r=this._zoomIn.touchend(e,t,n),i=this._zoomOut.touchend(e,t,n),a=this._tr;return r?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:a.zoom+1,around:a.unproject(r)},{originalEvent:e})}):i?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:a.zoom-1,around:a.unproject(i)},{originalEvent:e})}):void 0;}touchcancel(){this.reset();}enable(){this._enabled=!0;}disable(){this._enabled=!1,this.reset();}isEnabled(){return this._enabled;}isActive(){return this._active;}}},"2dde1176":function(e,t,n){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this;};},"2e6bd01b":function(e,t,n){var r=n("3f2a9250"),i=n("f28dfa76"),a=Object.prototype,o=a.hasOwnProperty,s=a.propertyIsEnumerable,l=r(function(){return arguments;}())?r:function(e){return i(e)&&o.call(e,"callee")&&!s.call(e,"callee");};e.exports=l;},"2eabba1c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{Popup:function(){return u;},default:function(){return u;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("d812e418")),o=n("fb1ec05a"),s=n("f86d399e"),l=n("631fd3ae");class u extends s.EventEmitter{get lngLat(){var e;return null!==(e=this.popupOption.lngLat)&&void 0!==e?e:{lng:0,lat:0};}set lngLat(e){this.popupOption.lngLat=e;}constructor(e){super(),(0,a.default)(this,"popupOption",void 0),(0,a.default)(this,"mapsService",void 0),(0,a.default)(this,"sceneService",void 0),(0,a.default)(this,"layerService",void 0),(0,a.default)(this,"scene",void 0),(0,a.default)(this,"closeButton",void 0),(0,a.default)(this,"container",void 0),(0,a.default)(this,"content",void 0),(0,a.default)(this,"contentTitle",void 0),(0,a.default)(this,"contentPanel",void 0),(0,a.default)(this,"tip",void 0),(0,a.default)(this,"isShow",!0),(0,a.default)(this,"onMouseMove",e=>{var t;let n=this.mapsService.getMapContainer(),{left:r=0,top:i=0}=null!==(t=null==n?void 0:n.getBoundingClientRect())&&void 0!==t?t:{};this.setPopupPosition(e.clientX-r,e.clientY-i);}),(0,a.default)(this,"updateLngLatPosition",()=>{if(!this.mapsService||this.popupOption.followCursor)return;let{lng:e,lat:t}=this.lngLat,{x:n,y:r}=this.mapsService.lngLatToContainer([e,t]);this.setPopupPosition(n,r);}),(0,a.default)(this,"updateLngLatPositionWhenZoom",e=>{if(!this.mapsService||this.popupOption.followCursor)return;let t=e.map,n=t.getSize();n.x=n.x/2,n.y=n.y/2;let r=e.center,i=e.zoom,a=t.DE(this.lngLat,i,r);a.x=Math.round(a.x),a.y=Math.round(a.y),this.setPopupPosition(a.x,a.y,!0);}),(0,a.default)(this,"onKeyDown",e=>{27===e.keyCode&&this.remove();}),(0,a.default)(this,"onCloseButtonClick",e=>{e.stopPropagation&&e.stopPropagation(),this.hide();}),(0,a.default)(this,"updatePosition",(e,t=!0)=>{let n=!!this.lngLat,{className:r,style:i,maxWidth:a,anchor:s,stopPropagation:l}=this.popupOption;if(!this.mapsService||!n||!this.content)return;let u=this.mapsService.getMarkerContainer();if(!this.container&&u&&(this.container=o.DOM.create("div",`l7-popup ${null!=r?r:""} ${this.isShow?"":"l7-popup-hide"}`,u),i&&this.container.setAttribute("style",i),this.tip=o.DOM.create("div","l7-popup-tip",this.container),this.container.appendChild(this.content),l&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(e=>{this.container.addEventListener(e,e=>{e.stopPropagation();});}),this.container.style.whiteSpace="nowrap"),t?this.updateLngLatPositionWhenZoom(e):this.updateLngLatPosition(),o.DOM.setTransform(this.container,`${o.anchorTranslate[s]}`),(0,o.applyAnchorClass)(this.container,s,"popup"),a){let{width:e}=this.container.getBoundingClientRect();e>parseFloat(a)&&(this.container.style.width=a);}else this.container.style.removeProperty("width");}),(0,a.default)(this,"updateWhenZoom",e=>{this.updatePosition(e,!0);}),(0,a.default)(this,"update",()=>{this.updatePosition(null,!1);}),this.popupOption=(0,i.default)((0,i.default)({},this.getDefault(null!=e?e:{})),e);let{lngLat:t}=this.popupOption;t&&(this.lngLat=t);}getIsShow(){return this.isShow;}addTo(e){this.mapsService=e.mapService,this.sceneService=e.sceneService,this.layerService=e.layerService,this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=e,this.update(),this.updateCloseOnClick(),this.updateCloseOnEsc(),this.updateFollowCursor();let{html:t,text:n,title:r}=this.popupOption;return t?this.setHTML(t):n&&this.setText(n),r&&this.setTitle(r),this.emit("open"),this;}remove(){if(this!==null&&void 0!==this&&this.isOpen())return this.content&&o.DOM.remove(this.content),this.container&&(o.DOM.remove(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.updateCloseOnClick(!0),this.updateCloseOnEsc(!0),this.updateFollowCursor(!0),delete this.mapsService),this.emit("close"),this;}getOptions(){return this.popupOption;}setOptions(e){var t,n;this.show();let{className:r}=this.popupOption;return this.popupOption=(0,i.default)((0,i.default)({},this.popupOption),e),this.checkUpdateOption(e,["html","text","title","closeButton","closeButtonOffsets","maxWidth","anchor","stopPropagation","lngLat","offsets"])&&(this.container&&(o.DOM.remove(this.container),this.container=void 0),this.popupOption.html?this.setHTML(this.popupOption.html):this.popupOption.text&&this.setText(this.popupOption.text),this.popupOption.title&&this.setTitle(this.popupOption.title)),this.checkUpdateOption(e,["closeOnEsc"])&&this.updateCloseOnEsc(),this.checkUpdateOption(e,["closeOnClick"])&&this.updateCloseOnClick(),this.checkUpdateOption(e,["followCursor"])&&this.updateFollowCursor(),this.checkUpdateOption(e,["html"])&&e.html?this.setHTML(e.html):this.checkUpdateOption(e,["text"])&&e.text&&this.setText(e.text),this.checkUpdateOption(e,["className"])&&(r&&this.container.classList.remove(null!=r?r:""),this.container.classList.add(null!==(t=e.className)&&void 0!==t?t:"")),this.checkUpdateOption(e,["style"])&&o.DOM.addStyle(this.container,null!==(n=e.style)&&void 0!==n?n:""),this.checkUpdateOption(e,["lngLat"])&&e.lngLat&&this.setLnglat(e.lngLat),this;}open(){return this.addTo(this.scene),this;}close(){return this.remove(),this;}show(){if(!this.isShow)return this.container&&o.DOM.removeClass(this.container,"l7-popup-hide"),this.isShow=!0,this.emit("show"),this;}hide(){if(this.isShow)return this.container&&o.DOM.addClass(this.container,"l7-popup-hide"),this.isShow=!1,this.emit("hide"),this;}setHTML(e){return this.popupOption.html=e,this.setDOMContent(e);}setText(e){return this.popupOption.text=e,this.setDOMContent(window.document.createTextNode(e));}setTitle(e){this.show(),this.popupOption.title=e,e?(this.contentTitle||(this.contentTitle=o.DOM.create("div","l7-popup-content__title"),this.content.firstChild?this.content.insertBefore(this.contentTitle,this.content.firstChild):this.content.append(this.contentTitle)),o.DOM.clearChildren(this.contentTitle),o.DOM.appendElementType(this.contentTitle,e)):this.contentTitle&&(o.DOM.remove(this.contentTitle),this.contentTitle=void 0);}panToPopup(){let{lng:e,lat:t}=this.lngLat;return this.popupOption.autoPan&&this.mapsService.panTo([e,t]),this;}setLngLat(e){return this.setLnglat(e);}setLnglat(e){return this.show(),this.lngLat=e,Array.isArray(e)&&(this.lngLat={lng:e[0],lat:e[1]}),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this.popupOption.autoPan&&setTimeout(()=>{this.panToPopup();},0),this;}getLnglat(){return this.lngLat;}setMaxWidth(e){return this.popupOption.maxWidth=e,this.update(),this;}isOpen(){return!!this.mapsService;}getDefault(e){return{closeButton:!0,closeOnClick:!1,maxWidth:"240px",offsets:[0,0],anchor:o.anchorType.BOTTOM,stopPropagation:!0,autoPan:!1,autoClose:!0,closeOnEsc:!1,followCursor:!1};}setDOMContent(e){return this.show(),this.createContent(),o.DOM.appendElementType(this.contentPanel,e),this.update(),this;}updateCloseOnClick(e){let t=this.mapsService;t&&(null==t||t.off("click",this.onCloseButtonClick),this.popupOption.closeOnClick&&!e&&requestAnimationFrame(()=>{null==t||t.on("click",this.onCloseButtonClick);}));}updateCloseOnEsc(e){window.removeEventListener("keydown",this.onKeyDown),this.popupOption.closeOnEsc&&!e&&window.addEventListener("keydown",this.onKeyDown);}updateFollowCursor(e){var t;let n=null===(t=this.mapsService)||void 0===t?void 0:t.getContainer();n&&(null==n||n.removeEventListener("mousemove",this.onMouseMove),this.popupOption.followCursor&&!e&&(null==n||n.addEventListener("mousemove",this.onMouseMove)));}createContent(){if(this.content&&o.DOM.remove(this.content),this.contentTitle=void 0,this.content=o.DOM.create("div","l7-popup-content",this.container),this.setTitle(this.popupOption.title),this.popupOption.closeButton){let e=(0,l.createL7Icon)("l7-icon-guanbi");o.DOM.addClass(e,"l7-popup-close-button"),this.content.appendChild(e),this.popupOption.closeButtonOffsets&&(e.style.right=this.popupOption.closeButtonOffsets[0]+"px",e.style.top=this.popupOption.closeButtonOffsets[1]+"px"),e.setAttribute("aria-label","Close popup"),e.addEventListener("click",()=>{this.hide();}),e.addEventListener("pointerup",e=>{e.stopPropagation();}),e.addEventListener("pointerdown",e=>{e.stopPropagation();}),this.closeButton=e;}else this.closeButton=void 0;this.contentPanel=o.DOM.create("div","l7-popup-content__panel",this.content);}setPopupPosition(e,t,n=!1){if(this.container){let{offsets:r}=this.popupOption;this.container.style.left=e+r[0]+"px",this.container.style.top=t-r[1]+"px",n?this.container.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)":this.container.style.transition="";}}checkUpdateOption(e,t){return t.some(t=>t in e);}}},"2eb295f7":function(e,t,n){"use strict";function r(e){return(e()-.5)*1e-6;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"2f0d6cbf":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe"),i=r._(n("b131ee44")),a=r._(n("daaa1548")),o=r._(n("f89fb776")),s=r._(n("ebd74549")),l=r._(n("bec2d0e3"));let u=["rasterData"];class c extends l.default{initTileLayer(){var e=this;return(0,o.default)(function*(){let t=e.parent.getLayerAttributeConfig(),n=e.getLayerOptions(),r=e.getSourceOption(),i=new s.default((0,a.default)({},n)).source(r.data,r.options);t&&Object.keys(t).forEach(e=>{var n,r;i[e](null===(n=t[e])||void 0===n?void 0:n.field,null===(r=t[e])||void 0===r?void 0:r.values);}),yield e.addLayer(i),e.isLoaded=!0;})();}getSourceOption(){let e=this.parent.getSource(),t=this.sourceTile.data.data,{rasterData:n}=t,r=(0,i.default)(t,u);return{data:n,options:{parser:(0,a.default)({type:"rasterRgb",extent:this.sourceTile.bounds},r),transforms:e.transforms}};}}},"2fc3731c":function(e,t,n){"use strict";function r(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"3036e156":function(e,t,n){"use strict";var r=n("ed2bf8a3");function i(e){this._isDirected=!r.has(e,"directed")||e.directed,this._isMultigraph=!!r.has(e,"multigraph")&&e.multigraph,this._isCompound=!!r.has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=r.constant(void 0),this._defaultEdgeLabelFn=r.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={};}function a(e,t){e[t]?e[t]++:e[t]=1;}function o(e,t){--e[t]||delete e[t];}function s(e,t,n,i){var a=""+t,o=""+n;if(!e&&a>o){var s=a;a=o,o=s;}return a+"\x01"+o+"\x01"+(r.isUndefined(i)?"\0":i);}function l(e,t){return s(e,t.v,t.w,t.name);}e.exports=i,i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected;},i.prototype.isMultigraph=function(){return this._isMultigraph;},i.prototype.isCompound=function(){return this._isCompound;},i.prototype.setGraph=function(e){return this._label=e,this;},i.prototype.graph=function(){return this._label;},i.prototype.setDefaultNodeLabel=function(e){return r.isFunction(e)||(e=r.constant(e)),this._defaultNodeLabelFn=e,this;},i.prototype.nodeCount=function(){return this._nodeCount;},i.prototype.nodes=function(){return r.keys(this._nodes);},i.prototype.sources=function(){var e=this;return r.filter(this.nodes(),function(t){return r.isEmpty(e._in[t]);});},i.prototype.sinks=function(){var e=this;return r.filter(this.nodes(),function(t){return r.isEmpty(e._out[t]);});},i.prototype.setNodes=function(e,t){var n=arguments,i=this;return r.each(e,function(e){n.length>1?i.setNode(e,t):i.setNode(e);}),this;},i.prototype.setNode=function(e,t){return r.has(this._nodes,e)?arguments.length>1&&(this._nodes[e]=t):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]="\0",this._children[e]={},this._children["\0"][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount),this;},i.prototype.node=function(e){return this._nodes[e];},i.prototype.hasNode=function(e){return r.has(this._nodes,e);},i.prototype.removeNode=function(e){var t=this;if(r.has(this._nodes,e)){var n=function(e){t.removeEdge(t._edgeObjs[e]);};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],r.each(this.children(e),function(e){t.setParent(e);}),delete this._children[e]),r.each(r.keys(this._in[e]),n),delete this._in[e],delete this._preds[e],r.each(r.keys(this._out[e]),n),delete this._out[e],delete this._sucs[e],--this._nodeCount;}return this;},i.prototype.setParent=function(e,t){if(!this._isCompound)throw Error("Cannot set parent in a non-compound graph");if(r.isUndefined(t))t="\0";else{t+="";for(var n=t;!r.isUndefined(n);n=this.parent(n))if(n===e)throw Error("Setting "+t+" as parent of "+e+" would create a cycle");this.setNode(t);}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this;},i.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e];},i.prototype.parent=function(e){if(this._isCompound){var t=this._parent[e];if("\0"!==t)return t;}},i.prototype.children=function(e){if(r.isUndefined(e)&&(e="\0"),this._isCompound){var t=this._children[e];if(t)return r.keys(t);}else if("\0"===e)return this.nodes();else if(this.hasNode(e))return[];},i.prototype.predecessors=function(e){var t=this._preds[e];if(t)return r.keys(t);},i.prototype.successors=function(e){var t=this._sucs[e];if(t)return r.keys(t);},i.prototype.neighbors=function(e){var t=this.predecessors(e);if(t)return r.union(t,this.successors(e));},i.prototype.isLeaf=function(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length;},i.prototype.filterNodes=function(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var n=this;r.each(this._nodes,function(n,r){e(r)&&t.setNode(r,n);}),r.each(this._edgeObjs,function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,n.edge(e));});var i={};return this._isCompound&&r.each(t.nodes(),function(e){t.setParent(e,function e(r){var a=n.parent(r);return void 0===a||t.hasNode(a)?(i[r]=a,a):a in i?i[a]:e(a);}(e));}),t;},i.prototype.setDefaultEdgeLabel=function(e){return r.isFunction(e)||(e=r.constant(e)),this._defaultEdgeLabelFn=e,this;},i.prototype.edgeCount=function(){return this._edgeCount;},i.prototype.edges=function(){return r.values(this._edgeObjs);},i.prototype.setPath=function(e,t){var n=this,i=arguments;return r.reduce(e,function(e,r){return i.length>1?n.setEdge(e,r,t):n.setEdge(e,r),r;}),this;},i.prototype.setEdge=function(){var e,t,n,i,o=!1,l=arguments[0];"object"==typeof l&&null!==l&&"v"in l?(e=l.v,t=l.w,n=l.name,2==arguments.length&&(i=arguments[1],o=!0)):(e=l,t=arguments[1],n=arguments[3],arguments.length>2&&(i=arguments[2],o=!0)),e=""+e,t=""+t,r.isUndefined(n)||(n=""+n);var u=s(this._isDirected,e,t,n);if(r.has(this._edgeLabels,u))return o&&(this._edgeLabels[u]=i),this;if(!r.isUndefined(n)&&!this._isMultigraph)throw Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[u]=o?i:this._defaultEdgeLabelFn(e,t,n);var c=function(e,t,n,r){var i=""+t,a=""+n;if(!e&&i>a){var o=i;i=a,a=o;}var s={v:i,w:a};return r&&(s.name=r),s;}(this._isDirected,e,t,n);return e=c.v,t=c.w,Object.freeze(c),this._edgeObjs[u]=c,a(this._preds[t],e),a(this._sucs[e],t),this._in[t][u]=c,this._out[e][u]=c,this._edgeCount++,this;},i.prototype.edge=function(e,t,n){var r=1==arguments.length?l(this._isDirected,arguments[0]):s(this._isDirected,e,t,n);return this._edgeLabels[r];},i.prototype.hasEdge=function(e,t,n){var i=1==arguments.length?l(this._isDirected,arguments[0]):s(this._isDirected,e,t,n);return r.has(this._edgeLabels,i);},i.prototype.removeEdge=function(e,t,n){var r=1==arguments.length?l(this._isDirected,arguments[0]):s(this._isDirected,e,t,n),i=this._edgeObjs[r];return i&&(e=i.v,t=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],o(this._preds[t],e),o(this._sucs[e],t),delete this._in[t][r],delete this._out[e][r],this._edgeCount--),this;},i.prototype.inEdges=function(e,t){var n=this._in[e];if(n){var i=r.values(n);return t?r.filter(i,function(e){return e.v===t;}):i;}},i.prototype.outEdges=function(e,t){var n=this._out[e];if(n){var i=r.values(n);return t?r.filter(i,function(e){return e.w===t;}):i;}},i.prototype.nodeEdges=function(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t));};},"30ad71e9":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=new Map;function i(e,t,n){return void 0===n&&(n=128),function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=t?t.apply(this,i):i[0];r.has(e)||r.set(e,function(e){var t,n,r,i=e||1;function a(e,a){++t>i&&(r=n,o(1),++t),n[e]=a;}function o(e){t=0,n=Object.create(null),e||(r=Object.create(null));}return o(),{clear:o,has:function(e){return void 0!==n[e]||void 0!==r[e];},get:function(e){var t=n[e];return void 0!==t?t:void 0!==(t=r[e])?(a(e,t),t):void 0;},set:function(e,t){void 0!==n[e]?n[e]=t:a(e,t);}};}(n));var s=r.get(e);if(s.has(o))return s.get(o);var l=e.apply(this,i);return s.set(o,l),l;};}},"314af657":function(e,t,n){var r=n("e06645db")(n("16b3b059"),"Promise");e.exports=r;},31710123:function(e,t,n){var r=n("ed2bf8a3");e.exports=function(e){var t,n={},i=[];return r.each(e.nodes(),function(a){t=[],function i(a){r.has(n,a)||(n[a]=!0,t.push(a),r.each(e.successors(a),i),r.each(e.predecessors(a),i));}(a),t.length&&i.push(t);}),i;};},"3173d47c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(){this.__data__=[],this.size=0;};},"3189a4b2":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"Plugin",{enumerable:!0,get:function(){return F;}});var r=n("777fffbe"),i=r._(n("d812e418")),a=r._(n("1316cf9d")),o=r._(n("3d495adb")),s=r._(n("66a06515")),l=r._(n("20defe2a")),u=n("597eee67"),c=r._(n("d38f5467")),d=r._(n("83128d43")),f=r._(n("f89fb776")),h=n("71293cfd"),p=r._(n("82f98358")),v=n("e1f276f6"),g=n("0d884ee9"),m=r._(n("daaa1548")),y=h.vec3.create(),b=h.vec3.create(),_=h.vec3.create(),x=h.mat4.create(),w=function(){function e(){var t=this;(0,a.default)(this,e),this.isHit=function(e,n,r,i){var a=t.context.pointInPathPickerFactory[e.nodeName];if(a){var o=h.mat4.invert(x,r),s=h.vec3.transformMat4(b,h.vec3.set(_,n[0],n[1],0),o);if(a(e,new u.Point(s[0],s[1]),i,t.isPointInPath,t.context,t.runtime))return!0;}return!1;},this.isPointInPath=function(e,n){var r=t.runtime.offscreenCanvasCreator.getOrCreateContext(t.context.config.offscreenCanvas),i=t.context.pathGeneratorFactory[e.nodeName];return i&&(r.beginPath(),i(r,e.parsedStyle),r.closePath()),r.isPointInPath(n.x,n.y);};}return(0,o.default)(e,[{key:"apply",value:function(t,n){var r,i,a=this,o=t.renderingService,s=t.renderingContext;this.context=t,this.runtime=n;var l=null===(i=s.root)||void 0===i?void 0:i.ownerDocument;o.hooks.pick.tapPromise(e.tag,(r=(0,f.default)((0,d.default)().mark(function e(t){return(0,d.default)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.pick(l,t));case 1:case"end":return e.stop();}},e);})),function(e){return r.apply(this,arguments);})),o.hooks.pickSync.tap(e.tag,function(e){return a.pick(l,e);});}},{key:"pick",value:function(e,t){var n,r=t.topmost,i=t.position,a=i.x,o=i.y,s=h.vec3.set(y,a,o,0),l=e.elementsFromBBox(s[0],s[1],s[0],s[1]),d=[],f=(0,c.default)(l);try{for(f.s();!(n=f.n()).done;){var p=n.value,v=p.getWorldTransform();if(this.isHit(p,s,v,!1)){var g=(0,u.findClosestClipPathTarget)(p);if(g){var m=g.parsedStyle.clipPath;if(this.isHit(m,s,m.getWorldTransform(),!0)){if(r)return t.picked=[p],t;d.push(p);}}else{if(r)return t.picked=[p],t;d.push(p);}}}}catch(e){f.e(e);}finally{f.f();}return t.picked=d,t;}}]);}();function E(e,t,n){var r=e.parsedStyle,i=r.cx,a=r.cy,o=r.r,s=r.fill,l=r.stroke,c=r.lineWidth,d=r.increasedLineWidthForHitTesting,f=r.pointerEvents,h=((void 0===c?1:c)+(void 0===d?0:d))/2,g=(0,v.distance)(void 0===i?0:i,void 0===a?0:a,t.x,t.y),m=(0,u.isFillOrStrokeAffected)(void 0===f?"auto":f,s,l),y=(0,p.default)(m,2),b=y[0],_=y[1];return b&&_||n?g<=o+h:b?g<=o:!!_&&g>=o-h&&g<=o+h;}function M(e,t,n){var r,i,a,o,s,l,c=e.parsedStyle,d=c.cx,f=void 0===d?0:d,h=c.cy,v=void 0===h?0:h,g=c.rx,m=c.ry,y=c.fill,b=c.stroke,_=c.lineWidth,x=c.increasedLineWidthForHitTesting,w=c.pointerEvents,E=t.x,M=t.y,S=(0,u.isFillOrStrokeAffected)(void 0===w?"auto":w,y,b),k=(0,p.default)(S,2),C=k[0],A=k[1],L=((void 0===_?1:_)+(void 0===x?0:x))/2,P=(E-f)*(E-f),N=(M-v)*(M-v);return C&&A||n?1>=P/((r=g+L)*r)+N/((i=m+L)*i):C?1>=P/(g*g)+N/(m*m):!!A&&P/((a=g-L)*a)+N/((o=m-L)*o)>=1&&1>=P/((s=g+L)*s)+N/((l=m+L)*l);}function S(e,t,n,r,i,a){return i>=e&&i<=e+n&&a>=t&&a<=t+r;}function k(e,t,n,r,i,a,o,s){var l=(Math.atan2(s-t,o-e)+2*Math.PI)%(2*Math.PI),u={x:e+n*Math.cos(l),y:t+n*Math.sin(l)};return(0,v.distance)(u.x,u.y,o,s)<=a/2;}function C(e,t,n,r,i,a,o){var s=Math.min(e,n),l=Math.max(e,n),u=Math.min(t,r),c=Math.max(t,r),d=i/2;return a>=s-d&&a<=l+d&&o>=u-d&&o<=c+d&&(0,v.linePointToLine)(e,t,n,r,a,o)<=i/2;}function A(e,t,n,r,i){var a=e.length;if(a<2)return!1;for(var o=0;o<a-1;o++)if(C(e[o][0],e[o][1],e[o+1][0],e[o+1][1],t,n,r))return!0;if(i){var s=e[0],l=e[a-1];if(C(s[0],s[1],l[0],l[1],t,n,r))return!0;}return!1;}function L(e){return 1e-6>Math.abs(e)?0:e<0?-1:1;}function P(e,t,n){var r=!1,i=e.length;if(i<=2)return!1;for(var a=0;a<i;a++){var o,s=e[a],l=e[(a+1)%i];if(((o=[t,n])[0]-s[0])*(l[1]-s[1])==(l[0]-s[0])*(o[1]-s[1])&&Math.min(s[0],l[0])<=o[0]&&o[0]<=Math.max(s[0],l[0])&&Math.min(s[1],l[1])<=o[1]&&o[1]<=Math.max(s[1],l[1]))return!0;L(s[1]-n)>0!=L(l[1]-n)>0&&0>L(t-(n-s[1])*(s[0]-l[0])/(s[1]-l[1])-s[0])&&(r=!r);}return r;}function N(e,t,n){for(var r=!1,i=0;i<e.length&&!(r=P(e[i],t,n));i++);return r;}function O(e,t,n){var r=e.parsedStyle,i=r.x1,a=r.y1,o=r.x2,s=r.y2,l=r.lineWidth,c=void 0===l?1:l,d=r.increasedLineWidthForHitTesting,f=r.pointerEvents,h=r.fill,v=r.stroke,g=(0,u.isFillOrStrokeAffected)(void 0===f?"auto":f,h,v);return(!!(0,p.default)(g,2)[1]||!!n)&&!!c&&C(i,a,o,s,c+(void 0===d?0:d),t.x,t.y);}function I(e,t,n,r,i,a){var o=e.parsedStyle,s=o.lineWidth,l=o.increasedLineWidthForHitTesting,c=o.stroke,d=o.fill,f=o.d,h=o.pointerEvents,m=f.segments,y=f.hasArc,b=f.polylines,_=f.polygons,x=(0,u.isFillOrStrokeAffected)(void 0===h?"auto":h,(null==_?void 0:_.length)&&d,c),w=(0,p.default)(x,2),E=w[0],M=w[1],k=(0,u.getOrCalculatePathTotalLength)(e),A=!1;return E||n?A=y?r(e,t):N(_,t.x,t.y)||N(b,t.x,t.y):((M||n)&&(A=function(e,t,n,r,i){for(var a=!1,o=t/2,s=0;s<e.length;s++){var l=e[s],u=l.currentPoint,c=l.params,d=l.prePoint,f=l.box;if(!f||S(f.x-o,f.y-o,f.width+t,f.height+t,n,r))switch(l.command){case"L":case"Z":if(a=C(d[0],d[1],u[0],u[1],t,n,r))return!0;break;case"Q":if(a=(0,v.quadPointDistance)(d[0],d[1],c[1],c[2],c[3],c[4],n,r)<=t/2)return!0;break;case"C":if(a=(0,v.cubicPointDistance)(d[0],d[1],c[1],c[2],c[3],c[4],c[5],c[6],n,r,i)<=t/2)return!0;break;case"A":l.cubicParams||(l.cubicParams=(0,g.arcToCubic)(d[0],d[1],c[1],c[2],c[3],c[4],c[5],c[6],c[7],void 0));for(var h=l.cubicParams,p=d,m=0;m<h.length;m+=6){var y=(0,v.cubicPointDistance)(p[0],p[1],h[m],h[m+1],h[m+2],h[m+3],h[m+4],h[m+5],n,r,i);if(p=[h[m+4],h[m+5]],a=y<=t/2)return!0;}}}return a;}(m,(void 0===s?1:s)+(void 0===l?0:l),t.x,t.y,k)),A);}function R(e,t,n){var r=e.parsedStyle,i=r.stroke,a=r.fill,o=r.lineWidth,s=r.increasedLineWidthForHitTesting,l=r.points,c=r.pointerEvents,d=(0,u.isFillOrStrokeAffected)(void 0===c?"auto":c,a,i),f=(0,p.default)(d,2),h=f[0],v=f[1],g=!1;return(v||n)&&(g=A(l.points,(void 0===o?1:o)+(void 0===s?0:s),t.x,t.y,!0)),!g&&(h||n)&&(g=P(l.points,t.x,t.y)),g;}function D(e,t,n){var r=e.parsedStyle,i=r.lineWidth,a=void 0===i?1:i,o=r.increasedLineWidthForHitTesting,s=r.points,l=r.pointerEvents,c=r.fill,d=r.stroke,f=(0,u.isFillOrStrokeAffected)(void 0===l?"auto":l,c,d);return(!!(0,p.default)(f,2)[1]||!!n)&&!!a&&A(s.points,a+(void 0===o?0:o),t.x,t.y,!1);}function z(e,t,n,r,i){var a,o,s,l=e.parsedStyle,c=l.radius,d=l.fill,f=l.stroke,h=l.lineWidth,v=l.increasedLineWidthForHitTesting,m=l.x,y=void 0===m?0:m,b=l.y,_=void 0===b?0:b,x=l.width,w=l.height,E=l.pointerEvents,M=(0,u.isFillOrStrokeAffected)(void 0===E?"auto":E,d,f),A=(0,p.default)(M,2),L=A[0],P=A[1],N=c&&c.some(function(e){return 0!==e;}),O=(void 0===h?1:h)+(void 0===v?0:v);if(N){var I,R,D,z,B,U,F,j,V=!1;return(P||n)&&(I=c.map(function(e){return(0,g.clamp)(e,0,Math.min(Math.abs(x)/2,Math.abs(w)/2));}),R=t.x,D=t.y,B=(z=(0,p.default)(I,4))[0],U=z[1],F=z[2],j=z[3],V=C(y+B,_,y+x-U,_,O,R,D)||C(y+x,_+U,y+x,_+w-F,O,R,D)||C(y+x-F,_+w,y+j,_+w,O,R,D)||C(y,_+w-j,y,_+B,O,R,D)||k(y+x-U,_+U,U,1.5*Math.PI,2*Math.PI,O,R,D)||k(y+x-F,_+w-F,F,0,.5*Math.PI,O,R,D)||k(y+j,_+w-j,j,.5*Math.PI,Math.PI,O,R,D)||k(y+B,_+B,B,Math.PI,1.5*Math.PI,O,R,D)),!V&&(L||n)&&(V=r(e,t)),V;}var G=O/2;return L&&P||n?S(y-G,_-G,x+G,w+G,t.x,t.y):L?S(y,_,x,w,t.x,t.y):!!P&&(a=t.x,o=t.y,S(y-(s=O/2),_-s,x,O,a,o)||S(y+x-s,_-s,O,w,a,o)||S(y+s,_+w-s,x,O,a,o)||S(y-s,_+s,O,w,a,o));}function B(e,t,n,r,i,a){var o=e.parsedStyle,s=o.pointerEvents,l=o.x,c=o.y,d=o.width,f=o.height;if("non-transparent-pixel"===(void 0===s?"auto":s)){var h=i.config.offscreenCanvas,p=a.offscreenCanvasCreator.getOrCreateCanvas(h),v=a.offscreenCanvasCreator.getOrCreateContext(h,{willReadFrequently:!0});return p.width=d,p.height=f,i.defaultStyleRendererFactory[u.Shape.IMAGE].render(v,(0,m.default)((0,m.default)({},e.parsedStyle),{},{x:0,y:0}),e,void 0,void 0,void 0),v.getImageData(t.x-(void 0===l?0:l),t.y-(void 0===c?0:c),1,1).data.every(function(e){return 0!==e;});}return!0;}function U(e,t,n,r){var i=e.getGeometryBounds();return t.x>=i.min[0]&&t.y>=i.min[1]&&t.x<=i.max[0]&&t.y<=i.max[1];}w.tag="CanvasPicker";var F=function(e){function t(){var e;(0,a.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,s.default)(this,t,[].concat(r))).name="canvas-picker",e;}return(0,l.default)(t,e),(0,o.default)(t,[{key:"init",value:function(){var e,t=(e={},(0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)(e,u.Shape.CIRCLE,E),u.Shape.ELLIPSE,M),u.Shape.RECT,z),u.Shape.LINE,O),u.Shape.POLYLINE,D),u.Shape.POLYGON,R),u.Shape.PATH,I),u.Shape.TEXT,U),u.Shape.GROUP,null),u.Shape.IMAGE,B),(0,i.default)((0,i.default)(e,u.Shape.HTML,null),u.Shape.MESH,null));this.context.pointInPathPickerFactory=t,this.addRenderingPlugin(new w);}},{key:"destroy",value:function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins();}}]);}(u.AbstractRendererPlugin);},"318fb8cd":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("b6081162")),i=function(e){return Array.isArray?Array.isArray(e):(0,r.default)(e,"Array");};},"3198c185":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{ButtonControl:function(){return s;},default:function(){return s;}});var r=n("777fffbe"),i=r._(n("d812e418")),a=n("fb1ec05a"),o=r._(n("9e4ac071"));class s extends o.default{constructor(...e){super(...e),(0,i.default)(this,"isDisable",!1),(0,i.default)(this,"button",void 0),(0,i.default)(this,"buttonText",void 0),(0,i.default)(this,"buttonIcon",void 0);}setIsDisable(e){var t,n;this.isDisable=e,e?null===(t=this.button)||void 0===t||t.setAttribute("disabled","true"):null===(n=this.button)||void 0===n||n.removeAttribute("disabled");}createButton(e=""){return a.DOM.create("button",`l7-button-control ${e}`);}onAdd(){this.button=this.createButton(),this.isDisable=!1;let{title:e,btnText:t,btnIcon:n}=this.controlOption;return this.setBtnTitle(e),this.setBtnText(t),this.setBtnIcon(n),this.button;}onRemove(){this.button=this.buttonIcon=this.buttonText=void 0,this.isDisable=!1;}setOptions(e){let{title:t,btnText:n,btnIcon:r}=e;this.checkUpdateOption(e,["title"])&&this.setBtnTitle(t),this.checkUpdateOption(e,["btnIcon"])&&this.setBtnIcon(r),this.checkUpdateOption(e,["btnText"])&&this.setBtnText(n),super.setOptions(e);}setBtnTitle(e){var t;null===(t=this.button)||void 0===t||t.setAttribute("title",null!=e?e:"");}setBtnIcon(e){if(this.buttonIcon&&a.DOM.remove(this.buttonIcon),e){var t,n,r;let i=null===(t=this.button)||void 0===t?void 0:t.firstChild;i?null===(n=this.button)||void 0===n||n.insertBefore(e,i):null===(r=this.button)||void 0===r||r.appendChild(e),this.buttonIcon=e;}}setBtnText(e){if(this.button){if(a.DOM.removeClass(this.button,"l7-button-control--row"),a.DOM.removeClass(this.button,"l7-button-control--column"),e){let n=this.buttonText;if(!n){var t;n=a.DOM.create("div","l7-button-control__text"),null===(t=this.button)||void 0===t||t.appendChild(n),this.buttonText=n;}n.innerText=e,a.DOM.addClass(this.button,this.controlOption.vertical?"l7-button-control--column":"l7-button-control--row");}else!e&&this.buttonText&&(a.DOM.remove(this.buttonText),this.buttonText=void 0);}}}},"31e26024":function(e,t,n){e.exports=function(e,t){return e===t||e!=e&&t!=t;};},"31ebf18c":function(e,t,n){var r=n("81e8f94e"),i=1/0;e.exports=function(e){return e?(e=r(e))===i||e===-i?(e<0?-1:1)*17976931348623157e292:e==e?e:0:0===e?e:0;};},"31f4de56":function(e,t,n){var r=n("1a8a13fa"),i=n("9a05af2a"),a=n("bcaa694c");e.exports=function(e,t,n){return t==t?a(e,t,n):r(e,i,n);};},"31f92b48":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{assign:function(){return W.default;},clamp:function(){return h.default;},clone:function(){return z.default;},debounce:function(){return B.default;},deepMix:function(){return F.default;},difference:function(){return i.default;},filter:function(){return d.default;},find:function(){return a.default;},flatten:function(){return o.default;},get:function(){return Z.default;},groupBy:function(){return f.default;},head:function(){return u.default;},identity:function(){return J.default;},indexOf:function(){return j.default;},isArray:function(){return M.default;},isBoolean:function(){return S.default;},isDate:function(){return k.default;},isElement:function(){return D.default;},isEmpty:function(){return V.default;},isEqual:function(){return G.default;},isFunction:function(){return C.default;},isNil:function(){return A.default;},isNull:function(){return L.default;},isNumber:function(){return P.default;},isNumberEqual:function(){return p.default;},isObject:function(){return N.default;},isPlainObject:function(){return O.default;},isString:function(){return I.default;},isUndefined:function(){return R.default;},keys:function(){return _.default;},last:function(){return c.default;},lowerFirst:function(){return x.default;},mapValues:function(){return H.default;},max:function(){return v.default;},maxBy:function(){return g.default;},memoize:function(){return U.default;},min:function(){return m.default;},minBy:function(){return y.default;},mix:function(){return W.default;},mod:function(){return b.default;},noop:function(){return Q.default;},omit:function(){return X.default;},pick:function(){return Y.default;},reduce:function(){return s.default;},set:function(){return q.default;},size:function(){return ee.default;},substitute:function(){return w.default;},throttle:function(){return $.default;},uniq:function(){return l.default;},uniqueId:function(){return K.default;},upperFirst:function(){return E.default;}});var r=n("777fffbe"),i=r._(n("24be8624")),a=r._(n("2af89dec")),o=r._(n("512c1c45")),s=r._(n("59975c13")),l=r._(n("776af75c")),u=r._(n("2191408c")),c=r._(n("a2981759")),d=r._(n("391ac29e")),f=r._(n("23fe6e23")),h=r._(n("b81723ce")),p=r._(n("57393183")),v=r._(n("a3cf44d4")),g=r._(n("0f65c46b")),m=r._(n("b00d7788")),y=r._(n("a164e3cf")),b=r._(n("4f35dca7")),_=r._(n("fa245667")),x=r._(n("8b6f13b3")),w=r._(n("33f98e1e")),E=r._(n("b72baeac")),M=r._(n("a12bb5bb")),S=r._(n("ba644deb")),k=r._(n("a32673e9")),C=r._(n("10576492")),A=r._(n("6ca3854b")),L=r._(n("2321866b")),P=r._(n("e7fea481")),N=r._(n("a483b73f")),O=r._(n("b0c50986")),I=r._(n("6cd126a9")),R=r._(n("3a846b89")),D=r._(n("c86554bb")),z=r._(n("20bfb153")),B=r._(n("a6933970")),U=r._(n("30ad71e9")),F=r._(n("0e5acdfc")),j=r._(n("29680974")),V=r._(n("e4f46be2")),G=r._(n("4a43ed9d")),H=r._(n("348e9ce0")),W=r._(n("1cd52fb4")),Z=r._(n("a5305083")),q=r._(n("28176a60")),Y=r._(n("02e3140a")),X=r._(n("bf67755d")),$=r._(n("6b042c5e")),K=r._(n("09544081")),Q=r._(n("ad8315ce")),J=r._(n("adc931d0")),ee=r._(n("532ff1e0"));},"323ab2ac":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("594bd64a")),a=r._(n("2460dbf0")),o=r._(n("12c23ac4")),s=function(e){return(0,o.default)(e)?(0,i.default)(e,!0):(0,a.default)(e);};},"325a7ff6":function(e,t,n){var r=n("0341a906"),i=n("d038e143"),a=n("528719b1"),o=n("c0051812");e.exports=function(e,t){return(o(e)?r:i)(e,a(t));};},"3292e451":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("a420544c")),a=r._(n("d781f976")),o=function(e,t){return(0,i.default)(e,(0,a.default)(e),t);};},"32a7b72b":function(e,t,n){"use strict";function r(){let e=1;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"32c3612d":function(e,t,n){!function(){function e(){this.map={};}e.prototype.has=function(e){return void 0!==this.map[e];},e.prototype.get=function(e,t){var n=this.map[e];return void 0===n?t:n;},e.prototype.set=function(e,t){this.map[e]=t;},e.prototype.clear=function(){this.map={};},e.prototype.delete=function(e){delete this.map[e];},e.prototype.size=function(){return Object.keys(this.map).length;};}();},"32cc0c09":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("dbd10968")),a=r._(n("6751161d"));class o extends i.default{getServiceConstructor(){return a.default;}}},"32f27622":function(e,t,n){var r=n("c50b12a0"),i=n("ee80be28"),a=n("81d598f3"),o=n("c0051812"),s=n("799da683");e.exports=function(e){return"function"==typeof e?e:null==e?a:"object"==typeof e?o(e)?i(e[0],e[1]):r(e):s(e);};},"33ba83b5":function(e,t,n){var r=n("cc74f26d"),i=n("2e6bd01b"),a=n("c0051812"),o=r?r.isConcatSpreadable:void 0;e.exports=function(e){return a(e)||i(e)||!!(o&&e&&e[o]);};},"33da6861":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("a8be75a3")),a=r._(n("731b2a36")),o=(0,i.default)(a.default,"WeakMap");},"33ea99bb":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("594bd64a")),a=r._(n("8c9788de")),o=r._(n("12c23ac4")),s=function(e){return(0,o.default)(e)?(0,i.default)(e):(0,a.default)(e);};},"33f98e1e":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e,t){return e&&t?e.replace(/\\?\{([^{}]+)\}/g,function(e,n){return"\\"===e.charAt(0)?e.slice(1):void 0===t[n]?"":t[n];}):e;};},"3453eb7f":function(e,t,n){e.exports=function(e,t){return null==e?void 0:e[t];};},"348e9ce0":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("6ca3854b")),a=r._(n("a483b73f")),o=function(e){return e;},s=function(e,t){void 0===t&&(t=o);var n={};return(0,a.default)(e)&&!(0,i.default)(e)&&Object.keys(e).forEach(function(r){n[r]=t(e[r],r);}),n;};},"35422ad4":function(e,t,n){var r=n("2c2fd53f");e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t;};},"3552f5f3":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return m;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("b131ee44")),o=r._(n("f89fb776")),s=r._(n("d812e418")),l=n("d9b661b3"),u=n("3aa02964"),c=n("fb1ec05a"),d=n("71293cfd"),f=r._(n("4f2bad25")),h=r._(n("80dad29a")),p=r._(n("f8e0e235"));let v=["id","mapInstance","center","token","version","libraries","minZoom","maxZoom","rotation","pitch","mapSize","logoVisible"];!function(e,t){var n="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,r="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram);if(!n&&!r&&(t||(t=document),t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i);}var o=t.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o);}}(`img[src*='//mapapi.qq.com/web/jsapi/logo/logo_def.png'],.logo-text
{
  display: none !important;
}

.tencent-map > canvas + div {
  z-index: 3 !important;
}
`);let g={mapmove:"center_changed",camerachange:["drag","pan","rotate","pitch","zoom"],zoomchange:"zoom",dragging:"drag"};class m extends h.default{constructor(...e){super(...e),(0,s.default)(this,"viewport",null),(0,s.default)(this,"evtCbProxyMap",new Map),(0,s.default)(this,"handleCameraChanged",()=>{this.emit("mapchange");let e=this.map,{lng:t,lat:n}=e.getCenter(),r={center:[t,n],viewportHeight:e.getContainer().clientHeight,viewportWidth:e.getContainer().clientWidth,bearing:e.getHeading(),pitch:e.getPitch(),zoom:e.getZoom()-1};this.viewport.syncWithMapCamera(r),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport);});}init(){var e=this;return(0,o.default)(function*(){var t;e.viewport=new f.default;let n=e.config,{id:r,mapInstance:o,center:s=[121.30654632240122,31.25744185633306],token:l="OB4BZ-D4W3U-B7VVO-4PJWW-6TKDJ-WPB77",version:u="1.exp",libraries:d=[],minZoom:h=3,maxZoom:g=18,rotation:m=0,pitch:y=0,mapSize:b=1e4,logoVisible:_=!0}=n,x=(0,a.default)(n,v);if(window.TMap||o||(yield p.default.load({key:l,version:u,libraries:d})),o)e.map=o,e.$mapContainer=e.map.getContainer(),!1===_&&e.hideLogo();else{if(!r)throw Error("No container id specified");let t=c.DOM.getContainer(r),n=new TMap.Map(t,(0,i.default)({maxZoom:g,minZoom:h,rotation:m,pitch:y,showControl:!1,center:new TMap.LatLng(s[1],s[0])},x));e.map=n,e.$mapContainer=n.getContainer(),!1===_&&e.hideLogo();}e.map.canvasContainer.style.position="absolute",e.map.drawContainer.classList.add("tencent-map");let w=null===(t=e.map.controlManager.controlContainer)||void 0===t?void 0:t.parentNode;w&&(w.style.zIndex=2),e.simpleMapCoord.setSize(b),e.map.on("drag",e.handleCameraChanged),e.map.on("pan",e.handleCameraChanged),e.map.on("rotate",e.handleCameraChanged),e.map.on("pitch",e.handleCameraChanged),e.map.on("zoom",e.handleCameraChanged),e.handleCameraChanged();})();}destroy(){this.map.destroy();}onCameraChanged(e){this.cameraChangedCallback=e;}addMarkerContainer(){let e=this.map.getContainer();this.markerContainer=c.DOM.create("div","l7-marker-container",e),this.markerContainer.setAttribute("tabindex","-1"),this.markerContainer.style.zIndex="2";}getMarkerContainer(){return this.markerContainer;}on(e,t){if(-1!==l.MapServiceEvent.indexOf(e))this.eventEmitter.on(e,t);else{let n=e=>{let n=this.evtCbProxyMap.get(e);if(n||this.evtCbProxyMap.set(e,n=new Map),n.get(t))return;let r=(...e)=>{!e[0]||"object"!=typeof e[0]||e[0].lngLat||e[0].lnglat||(e[0].lngLat=e[0].latlng||e[0].latLng),t(...e);};n.set(t,r),this.map.on(e,r);};Array.isArray(g[e])?g[e].forEach(t=>{n(t||e);}):n(g[e]||e);}}off(e,t){if(-1!==l.MapServiceEvent.indexOf(e)){this.eventEmitter.off(e,t);return;}let n=n=>{var r,i;let a=null===(r=this.evtCbProxyMap.get(e))||void 0===r?void 0:r.get(t);a&&(null===(i=this.evtCbProxyMap.get(n))||void 0===i||i.delete(t),this.map.off(n,a));};Array.isArray(g[e])?g[e].forEach(t=>{n(t||e);}):n(g[e]||e);}once(){throw Error("Method not implemented.");}getContainer(){return this.map.getContainer();}getSize(){return[this.map.width,this.map.height];}getMinZoom(){return this.map.transform._minZoom;}getMaxZoom(){return this.map.transform._maxZoom;}getType(){return"tmap";}getZoom(){return this.map.getZoom();}getCenter(){let{lng:e,lat:t}=this.map.getCenter();return{lng:e,lat:t};}getPitch(){return this.map.getPitch();}getRotation(){return this.map.getRotation();}getBounds(){let e=this.map.getBounds().getNorthEast(),t=this.map.getBounds().getSouthWest();return[[t.lng,t.lat],[e.lng,e.lat]];}getMapContainer(){return this.map.getContainer();}getMapCanvasContainer(){var e;return null===(e=this.map.getContainer())||void 0===e?void 0:e.getElementsByTagName("canvas")[0];}getCanvasOverlays(){var e;return null===(e=this.getMapCanvasContainer())||void 0===e||null===(e=e.nextSibling)||void 0===e?void 0:e.firstChild;}getMapStyleConfig(){throw Error("Method not implemented.");}setBgColor(e){this.bgColor=e;}setMapStyle(e){this.map.setMapStyleId(e);}setRotation(e){this.map.setRotation(e);}zoomIn(){this.map.setZoom(this.getZoom()+1);}zoomOut(){this.map.setZoom(this.getZoom()-1);}panTo([e,t]){this.map.panTo(new TMap.LatLng(t,e));}panBy(e,t){this.map.panBy([e,t]);}fitBounds(e,t){let[n,r]=e,i=new TMap.LatLng(n[1],n[0]),a=new TMap.LatLng(r[1],r[0]),o=new TMap.LatLngBounds(i,a);this.map.fitBounds(o,t);}setZoomAndCenter(e,[t,n]){this.map.setCenter(new TMap.LatLng(n,t)),this.map.setZoom(e);}setCenter([e,t]){this.map.setCenter(new TMap.LatLng(t,e));}setPitch(e){this.map.setPitch(e);}setZoom(e){this.map.setZoom(e);}setMapStatus(e){Object.keys(e).map(t=>{switch(t){case"doubleClickZoom":this.map.setDoubleClickZoom(!!e.doubleClickZoom);break;case"dragEnable":this.map.setDraggable(!!e.dragEnable);break;case"rotateEnable":this.map.setRotatable(!!e.rotateEnable);break;case"zoomEnable":this.map.setDoubleClickZoom(!!e.zoomEnable),this.map.setScrollable(!!e.zoomEnable);break;case"keyboardEnable":case"resizeEnable":case"showIndoorMap":throw Error("Options may bot be supported");}});}meterToCoord([e,t],[n,r]){let i=TMap.geometry.computeDistance([new TMap.LatLng(t,e),new TMap.LatLng(r,n)]),[a,o]=this.lngLatToCoord([e,t]),[s,l]=this.lngLatToCoord([n,r]);return Math.sqrt(Math.pow(a-s,2)+Math.pow(o-l,2))/i;}pixelToLngLat([e,t]){let{lng:n,lat:r}=this.map.getCenter(),{x:i,y:a}=this.lngLatToPixel([n,r]),{x:o,y:s}=this.lngLatToContainer([n,r]),{lng:l,lat:u}=this.map.unprojectFromContainer(new TMap.Point(o+(e-i),s+(t-a)));return this.containerToLngLat([l,u]);}lngLatToPixel([e,t]){let{x:n,y:r}=this.map.projectToWorldPlane(new TMap.LatLng(t,e));return{x:n,y:r};}containerToLngLat([e,t]){let{lng:n,lat:r}=this.map.unprojectFromContainer(new TMap.Point(e,t));return{lng:n,lat:r};}lngLatToContainer([e,t]){let{x:n,y:r}=this.map.projectToContainer(new TMap.LatLng(t,e));return{x:n,y:r};}lngLatToCoord([e,t]){let{x:n,y:r}=this.lngLatToPixel([e,t]);return[n,-r];}lngLatToCoords(e){return e.map(e=>Array.isArray(e[0])?this.lngLatToCoords(e):this.lngLatToCoord(e));}lngLatToMercator(e,t){let{x:n=0,y:r=0,z:i=0}=u.MercatorCoordinate.fromLngLat(e,t);return{x:n,y:r,z:i};}getModelMatrix(e,t,n,r=[1,1,1]){let i=this.viewport.projectFlat(e),a=d.mat4.create();return d.mat4.translate(a,a,d.vec3.fromValues(i[0],i[1],t)),d.mat4.scale(a,a,d.vec3.fromValues(r[0],r[1],r[2])),d.mat4.rotateX(a,a,n[0]),d.mat4.rotateY(a,a,n[1]),d.mat4.rotateZ(a,a,n[2]),a;}getCustomCoordCenter(){throw Error("Method not implemented.");}exportMap(e){let t=this.getMapCanvasContainer();return"jpg"===e?null==t?void 0:t.toDataURL("image/jpeg"):null==t?void 0:t.toDataURL("image/png");}rotateY(){throw Error("Method not implemented.");}hideLogo(){let e=this.map.getContainer();e&&c.DOM.addClass(e,"tmap-contianer--hide-logo");}}},"3656a04e":function(e,t,n){var r=n("062d75f7")(Object.getPrototypeOf,Object);e.exports=r;},"36ba8608":function(e,t,n){var r=n("7988eeca"),i=n("ef51a61d"),a=n("2e6bd01b"),o=n("c0051812"),s=n("481b6514"),l=n("85163435"),u=n("3d3bd3f9"),c=n("c31b66bd"),d=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(s(e)&&(o(e)||"string"==typeof e||"function"==typeof e.splice||l(e)||c(e)||a(e)))return!e.length;var t=i(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(u(e))return!r(e).length;for(var n in e)if(d.call(e,n))return!1;return!0;};},"36c59252":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{MultipleOfFourNumber:function(){return o;},getPolygonSurfaceIndices:function(){return s;}});var r=n("777fffbe"),i=n("fb1ec05a"),a=r._(n("20d317f9"));function o(e){return Math.max(4*Math.ceil(e/4),4);}function s(e,t,n,r=!0){let o=3===n;if(r){e=e.slice();let t=[];for(let r=0;r<e.length;r+=n){t[0]=e[r],t[1]=e[r+1],o&&(t[2]=e[r+2]);let n=(0,i.lngLatToMeters)(t,!0,{enable:!1,decimal:1});e[r]=n[0],e[r+1]=n[1],o&&(e[r+2]=n[2]);}}return(0,a.default)(e,t,n);}},37216398:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("4a8d04f1"));function i(e){var t,n,i,a=(0,r.default)(.1);function o(e){for(var r,a=0,o=t.length;a<o;++a)r=t[a],r.vx+=(i[a]-r.x)*n[a]*e;}function s(){if(t){var r,o=t.length;for(r=0,n=Array(o),i=Array(o);r<o;++r)n[r]=isNaN(i[r]=+e(t[r],r,t))?0:+a(t[r],r,t);}}return"function"!=typeof e&&(e=(0,r.default)(null==e?0:+e)),o.initialize=function(e){t=e,s();},o.strength=function(e){return arguments.length?(a="function"==typeof e?e:(0,r.default)(+e),s(),o):a;},o.x=function(t){return arguments.length?(e="function"==typeof t?t:(0,r.default)(+t),s(),o):e;},o;}},"375055b0":function(e,t,n){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t;};},"379470e1":function(e,t,n){var r=n("ef51a61d"),i=n("f28dfa76");e.exports=function(e){return i(e)&&"[object Set]"==r(e);};},"37baa790":function(e,t,n){e.exports=function(e,t){return e.has(t);};},"37cb8cdf":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe")._(n("05a4af02")),i=Object.prototype,a=i.hasOwnProperty,o=i.toString,s=r.default?r.default.toStringTag:void 0,l=function(e){var t=a.call(e,s),n=e[s];try{e[s]=void 0;var r=!0;}catch(e){}var i=o.call(e);return r&&(t?e[s]=n:delete e[s]),i;};},"382eef13":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"timer",{enumerable:!0,get:function(){return r.timer;}});var r=n("559da11b");},"382f6ca4":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{BaiduMap:function(){return o.default;},Earth:function(){return s.default;},GaodeMap:function(){return p;},GaodeMapV1:function(){return v;},GaodeMapV2:function(){return g;},GoogleMap:function(){return l.default;},Map:function(){return u.default;},MapLibre:function(){return d.default;},Mapbox:function(){return c.default;},TMap:function(){return f.default;},TencentMap:function(){return h.default;}});var r=n("d1751d7c"),i=n("777fffbe"),a=i._(n("6ea93842")),o=i._(n("d2667e75")),s=i._(n("80c793c2")),l=i._(n("3e9b0be5")),u=i._(n("e3492f1a")),c=i._(n("68c0b55c")),d=i._(n("e1705225")),f=i._(n("32cc0c09")),h=i._(n("aaf3e953"));r._(n("e1364649"),t);let p=a.default,v=a.default,g=a.default;},"383ce26f":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"paramsCount",{enumerable:!0,get:function(){return r;}});var r={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};},"388a74b8":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(){return!1;};},"38de6db6":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"TwoFingersTouchZoomRotateHandler",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("d812e418"));class i{constructor(e,t,n,i){(0,r.default)(this,"_el",void 0),(0,r.default)(this,"_touchZoom",void 0),(0,r.default)(this,"_touchRotate",void 0),(0,r.default)(this,"_tapDragZoom",void 0),(0,r.default)(this,"_rotationDisabled",void 0),(0,r.default)(this,"_enabled",void 0),this._el=e,this._touchZoom=t,this._touchRotate=n,this._tapDragZoom=i,this._rotationDisabled=!1,this._enabled=!0;}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("l7-touch-zoom-rotate");}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("l7-touch-zoom-rotate");}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled();}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive();}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable();}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable();}}},"391a4293":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0});var r=n("777fffbe")._(n("9499af61"));!function(){function e(){this.linkedList=new r.default;}e.prototype.isEmpty=function(){return!this.linkedList.head;},e.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null;},e.prototype.enqueue=function(e){this.linkedList.append(e);},e.prototype.dequeue=function(){var e=this.linkedList.deleteHead();return e?e.value:null;},e.prototype.toString=function(e){return this.linkedList.toString(e);};}();},"391ac29e":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("99ff515c")),i=function(e,t){if(!(0,r.default)(e))return e;for(var n=[],i=0;i<e.length;i++){var a=e[i];t(a,i)&&n.push(a);}return n;};},"391cdac3":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n;};},"392ae700":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("a556cf14"));function i(e){var t,n,i,a=(0,r.default)(.1);function o(e){for(var r,a=0,o=t.length;a<o;++a)r=t[a],r.vy+=(i[a]-r.y)*n[a]*e;}function s(){if(t){var r,o=t.length;for(r=0,n=Array(o),i=Array(o);r<o;++r)n[r]=isNaN(i[r]=+e(t[r],r,t))?0:+a(t[r],r,t);}}return"function"!=typeof e&&(e=(0,r.default)(null==e?0:+e)),o.initialize=function(e){t=e,s();},o.strength=function(e){return arguments.length?(a="function"==typeof e?e:(0,r.default)(+e),s(),o):a;},o.y=function(t){return arguments.length?(e="function"==typeof t?t:(0,r.default)(+t),s(),o):e;},o;}},"395d808c":function(e,t,n){"use strict";function r(e,t,n,r,i,a){return[1/3*e+2/3*n,1/3*t+2/3*r,1/3*i+2/3*n,1/3*a+2/3*r,i,a];}n.d(t,"__esModule",{value:!0}),n.d(t,"quadToCubic",{enumerable:!0,get:function(){return r;}});},"396286a4":function(e,t,n){"use strict";function r(e){var t=e.index,n=e.pathValue,r=n.charCodeAt(t);if(48===r){e.param=0,e.index+=1;return;}if(49===r){e.param=1,e.index+=1;return;}e.err='[path-util]: invalid Arc flag "'.concat(n[t],'", expecting 0 or 1 at index ').concat(t);}n.d(t,"__esModule",{value:!0}),n.d(t,"scanFlag",{enumerable:!0,get:function(){return r;}});},"396c85ce":function(e,t,n){"use strict";function r(e){if(isNaN(e=+e))return this;var t=this._x0,n=this._x1;if(isNaN(t))n=(t=Math.floor(e))+1;else{for(var r,i,a=n-t||1,o=this._root;t>e||e>=n;)switch(i=+(e<t),(r=[,,])[i]=o,o=r,a*=2,i){case 0:n=t+a;break;case 1:t=n-a;}this._root&&this._root.length&&(this._root=o);}return this._x0=t,this._x1=n,this;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"397243de":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=!1;},"399c1f06":function(e,t,n){var r=n("49100cc9"),i=n("636528d5")(r);e.exports=i;},"39a6347f":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e;}),n;};},"39b8b27a":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"Camera",{enumerable:!0,get:function(){return f;}});var r=n("777fffbe"),i=r._(n("d812e418")),a=r._(n("be334174")),o=n("5c93f055"),s=n("d092a378"),l=n("a807b8b1"),u=n("262c4dce"),c=n("b448a57d"),d=n("f9562c3c");class f extends c.Evented{constructor(e,t){super(),(0,i.default)(this,"transform",void 0),(0,i.default)(this,"handlers",void 0),(0,i.default)(this,"_moving",void 0),(0,i.default)(this,"_zooming",void 0),(0,i.default)(this,"_rotating",void 0),(0,i.default)(this,"_pitching",void 0),(0,i.default)(this,"_padding",void 0),(0,i.default)(this,"_bearingSnap",void 0),(0,i.default)(this,"_easeStart",void 0),(0,i.default)(this,"_easeOptions",void 0),(0,i.default)(this,"_easeId",void 0),(0,i.default)(this,"_onEaseFrame",void 0),(0,i.default)(this,"_onEaseEnd",void 0),(0,i.default)(this,"_easeFrameId",void 0),(0,i.default)(this,"_requestedCameraState",void 0),(0,i.default)(this,"transformCameraUpdate",void 0),(0,i.default)(this,"_renderFrameCallback",()=>{let e=Math.min((u.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop();}),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=t.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState;});}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat);}setCenter(e,t){return this.jumpTo({center:e},t);}panBy(e,t,n){return e=a.default.convert(e).mult(-1),this.panTo(this.transform.center,(0,d.extend)({offset:e},t),n);}panTo(e,t,n){return this.easeTo((0,d.extend)({center:e},t),n);}getZoom(){return this.transform.zoom;}setZoom(e,t){return this.jumpTo({zoom:e},t),this;}zoomTo(e,t,n){return this.easeTo((0,d.extend)({zoom:e},t),n);}zoomIn(e,t){return this.zoomTo(this.getZoom()+1,e,t),this;}zoomOut(e,t){return this.zoomTo(this.getZoom()-1,e,t),this;}getBearing(){return this.transform.bearing;}setBearing(e,t){return this.jumpTo({bearing:e},t),this;}getPadding(){return this.transform.padding;}setPadding(e,t){return this.jumpTo({padding:e},t),this;}rotateTo(e,t,n){return this.easeTo((0,d.extend)({bearing:e},t),n);}resetNorth(e,t){return this.rotateTo(0,(0,d.extend)({duration:1e3},e),t),this;}resetNorthPitch(e,t){return this.easeTo((0,d.extend)({bearing:0,pitch:0,duration:1e3},e),t),this;}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this;}getPitch(){return this.transform.pitch;}setPitch(e,t){return this.jumpTo({pitch:e},t),this;}cameraForBounds(e,t){e=s.LngLatBounds.convert(e);let n=t&&t.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),n,t);}_cameraForBoxAndBearing(e,t,n,r){let i={top:0,bottom:0,right:0,left:0};if("number"==typeof(r=(0,d.extend)({padding:i,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding){let e=r.padding;r.padding={top:e,bottom:e,right:e,left:e};}r.padding=(0,d.extend)(i,r.padding);let o=this.transform,l=o.padding,u=new s.LngLatBounds(e,t),c=o.project(u.getNorthWest()),f=o.project(u.getNorthEast()),h=o.project(u.getSouthEast()),p=o.project(u.getSouthWest()),v=(0,d.degreesToRadians)(-n),g=c.rotate(v),m=f.rotate(v),y=h.rotate(v),b=p.rotate(v),_=new a.default(Math.max(g.x,m.x,b.x,y.x),Math.max(g.y,m.y,b.y,y.y)),x=new a.default(Math.min(g.x,m.x,b.x,y.x),Math.min(g.y,m.y,b.y,y.y)),w=_.sub(x),E=(o.width-(l.left+l.right+r.padding.left+r.padding.right))/w.x,M=(o.height-(l.top+l.bottom+r.padding.top+r.padding.bottom))/w.y;if(M<0||E<0){(0,d.warnOnce)("Map cannot fit within canvas with the given bounds, padding, and/or offset.");return;}let S=Math.min(o.scaleZoom(o.scale*Math.min(E,M)),r.maxZoom),k=a.default.convert(r.offset),C=(r.padding.left-r.padding.right)/2,A=(r.padding.top-r.padding.bottom)/2,L=new a.default(C,A).rotate((0,d.degreesToRadians)(n)),P=k.add(L).mult(o.scale/o.zoomScale(S));return{center:o.unproject(c.add(h).div(2).sub(P)),zoom:S,bearing:n};}fitBounds(e,t,n){return this._fitInternal(this.cameraForBounds(e,t),t,n);}fitScreenCoordinates(e,t,n,r,i){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.default.convert(e)),this.transform.pointLocation(a.default.convert(t)),n,r),r,i);}_fitInternal(e,t,n){return e?(t=(0,d.extend)(e,t),delete t.padding,t.linear?this.easeTo(t,n):this.flyTo(t,n)):this;}jumpTo(e,t){this.stop();let n=this._getTransformForUpdate(),r=!1,i=!1,a=!1;return"zoom"in e&&n.zoom!==+e.zoom&&(r=!0,n.zoom=+e.zoom),void 0!==e.center&&(n.center=o.LngLat.convert(e.center)),"bearing"in e&&n.bearing!==+e.bearing&&(i=!0,n.bearing=+e.bearing),"pitch"in e&&n.pitch!==+e.pitch&&(a=!0,n.pitch=+e.pitch),null==e.padding||n.isPaddingEqual(e.padding)||(n.padding=e.padding),this._applyUpdatedTransform(n),this.fire(new c.Event("movestart",t)).fire(new c.Event("move",t)),r&&this.fire(new c.Event("zoomstart",t)).fire(new c.Event("zoom",t)).fire(new c.Event("zoomend",t)),i&&this.fire(new c.Event("rotatestart",t)).fire(new c.Event("rotate",t)).fire(new c.Event("rotateend",t)),a&&this.fire(new c.Event("pitchstart",t)).fire(new c.Event("pitch",t)).fire(new c.Event("pitchend",t)),this.fire(new c.Event("moveend",t));}calculateCameraOptionsFromTo(e,t,n,r=0){let i=l.MercatorCoordinate.fromLngLat(e,t),a=l.MercatorCoordinate.fromLngLat(n,r),o=a.x-i.x,s=a.y-i.y,u=a.z-i.z,c=Math.hypot(o,s,u);if(0===c)throw Error("Can't calculate camera options with same From and To");let d=Math.hypot(o,s),f=this.transform.scaleZoom(this.transform.cameraToCenterDistance/c/this.transform.tileSize),h=180*Math.atan2(o,-s)/Math.PI,p=180*Math.acos(d/c)/Math.PI;return p=u<0?90-p:90+p,{center:a.toLngLat(),zoom:f,pitch:p,bearing:h};}easeTo(e,t){var n;let r,i;this._stop(!1,e.easeId),(!1===(e=(0,d.extend)({offset:[0,0],duration:500,easing:d.defaultEasing},e)).animate||!e.essential&&u.browser.prefersReducedMotion)&&(e.duration=0);let s=this._getTransformForUpdate(),l=this.getZoom(),c=this.getBearing(),f=this.getPitch(),h=this.getPadding(),p="bearing"in e?this._normalizeBearing(e.bearing,c):c,v="pitch"in e?+e.pitch:f,g="padding"in e?e.padding:s.padding,m=a.default.convert(e.offset),y=s.centerPoint.add(m),b=s.pointLocation(y),{center:_,zoom:x}=s.getConstrained(o.LngLat.convert(e.center||b),null!==(n=e.zoom)&&void 0!==n?n:l);this._normalizeCenter(_);let w=s.project(b),E=s.project(_).sub(w),M=s.zoomScale(x-l);e.around&&(r=o.LngLat.convert(e.around),i=s.locationPoint(r));let S={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||x!==l,this._rotating=this._rotating||c!==p,this._pitching=this._pitching||v!==f,this._padding=!s.isPaddingEqual(g),this._easeId=e.easeId,this._prepareEase(t,e.noMoveStart,S),this._ease(e=>{if(this._zooming&&(s.zoom=d.interpolates.number(l,x,e)),this._rotating&&(s.bearing=d.interpolates.number(c,p,e)),this._pitching&&(s.pitch=d.interpolates.number(f,v,e)),this._padding&&(s.interpolatePadding(h,g,e),y=s.centerPoint.add(m)),r)s.setLocationAtPoint(r,i);else{let t=s.zoomScale(s.zoom-l),n=Math.pow(x>l?Math.min(2,M):Math.max(.5,M),1-e),r=s.unproject(w.add(E.mult(e*n)).mult(t));s.setLocationAtPoint(s.renderWorldCopies?r.wrap():r,y);}this._applyUpdatedTransform(s),this._fireMoveEvents(t);},e=>{this._afterEase(t,e);},e),this;}_prepareEase(e,t,n={}){this._moving=!0,t||n.moving||this.fire(new c.Event("movestart",e)),this._zooming&&!n.zooming&&this.fire(new c.Event("zoomstart",e)),this._rotating&&!n.rotating&&this.fire(new c.Event("rotatestart",e)),this._pitching&&!n.pitching&&this.fire(new c.Event("pitchstart",e));}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform;}_applyUpdatedTransform(e){if(!this.transformCameraUpdate)return;let t=e.clone(),{center:n,zoom:r,pitch:i,bearing:a,elevation:o}=this.transformCameraUpdate(t);n&&(t.center=n),void 0!==r&&(t.zoom=r),void 0!==i&&(t.pitch=i),void 0!==a&&(t.bearing=a),void 0!==o&&(t.elevation=o),this.transform.apply(t);}_fireMoveEvents(e){this.fire(new c.Event("move",e)),this._zooming&&this.fire(new c.Event("zoom",e)),this._rotating&&this.fire(new c.Event("rotate",e)),this._pitching&&this.fire(new c.Event("pitch",e));}_afterEase(e,t){if(this._easeId&&t&&this._easeId===t)return;delete this._easeId;let n=this._zooming,r=this._rotating,i=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,n&&this.fire(new c.Event("zoomend",e)),r&&this.fire(new c.Event("rotateend",e)),i&&this.fire(new c.Event("pitchend",e)),this.fire(new c.Event("moveend",e));}flyTo(e,t){var n;if(!e.essential&&u.browser.prefersReducedMotion){let n=(0,d.pick)(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(n,t);}this.stop(),e=(0,d.extend)({offset:[0,0],speed:1.2,curve:1.42,easing:d.defaultEasing},e);let r=this._getTransformForUpdate(),i=this.getZoom(),s=this.getBearing(),l=this.getPitch(),c=this.getPadding(),f="bearing"in e?this._normalizeBearing(e.bearing,s):s,h="pitch"in e?+e.pitch:l,p="padding"in e?e.padding:r.padding,v=a.default.convert(e.offset),g=r.centerPoint.add(v),m=r.pointLocation(g),{center:y,zoom:b}=r.getConstrained(o.LngLat.convert(e.center||m),null!==(n=e.zoom)&&void 0!==n?n:i);this._normalizeCenter(y);let _=r.zoomScale(b-i),x=r.project(m),w=r.project(y).sub(x),E=e.curve,M=Math.max(r.width,r.height),S=M/_,k=w.mag();if("minZoom"in e){let t=(0,d.clamp)(Math.min(e.minZoom,i,b),r.minZoom,r.maxZoom);E=Math.sqrt(M/r.zoomScale(t-i)/k*2);}let C=E*E;function A(e){let t=(S*S-M*M+(e?-1:1)*C*C*k*k)/(2*(e?S:M)*C*k);return Math.log(Math.sqrt(t*t+1)-t);}function L(e){return(Math.exp(e)-Math.exp(-e))/2;}function P(e){return(Math.exp(e)+Math.exp(-e))/2;}let N=A(!1),O=function(e){return P(N)/P(N+E*e);},I=function(e){var t;return M*((P(N)*(L(t=N+E*e)/P(t))-L(N))/C)/k;},R=(A(!0)-N)/E;if(1e-6>Math.abs(k)||!isFinite(R)){if(1e-6>Math.abs(M-S))return this.easeTo(e,t);let n=S<M?-1:1;R=Math.abs(Math.log(S/M))/E,I=()=>0,O=e=>Math.exp(n*E*e);}if("duration"in e)e.duration=+e.duration;else{let t="screenSpeed"in e?+e.screenSpeed/E:+e.speed;e.duration=1e3*R/t;}return e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=s!==f,this._pitching=h!==l,this._padding=!r.isPaddingEqual(p),this._prepareEase(t,!1),this._ease(e=>{let n=e*R,a=1/O(n);r.zoom=1===e?b:i+r.scaleZoom(a),this._rotating&&(r.bearing=d.interpolates.number(s,f,e)),this._pitching&&(r.pitch=d.interpolates.number(l,h,e)),this._padding&&(r.interpolatePadding(c,p,e),g=r.centerPoint.add(v));let o=1===e?y:r.unproject(x.add(w.mult(I(n))).mult(a));r.setLocationAtPoint(r.renderWorldCopies?o.wrap():o,g),this._applyUpdatedTransform(r),this._fireMoveEvents(t);},()=>{this._afterEase(t);},e),this;}isEasing(){return!!this._easeFrameId;}stop(){return this._stop();}_stop(e,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let e=this._onEaseEnd;delete this._onEaseEnd,e.call(this,t);}if(!e){var n;null===(n=this.handlers)||void 0===n||n.stop(!1);}return this;}_ease(e,t,n){!1===n.animate||0===n.duration?(e(1),t()):(this._easeStart=u.browser.now(),this._easeOptions=n,this._onEaseFrame=e,this._onEaseEnd=t,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback));}_normalizeBearing(e,t){let n=Math.abs((e=(0,d.wrap)(e,-180,180))-t);return Math.abs(e-360-t)<n&&(e-=360),Math.abs(e+360-t)<n&&(e+=360),e;}_normalizeCenter(e){let t=this.transform;if(!t.renderWorldCopies||t.lngRange)return;let n=e.lng-t.center.lng;e.lng+=n>180?-360:n<-180?360:0;}}},"39fbb7f2":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"isCurveArray",{enumerable:!0,get:function(){return i;}});var r=n("ba9d7bc5");function i(e){return(0,r.isNormalizedArray)(e)&&e.every(function(e){var t=e[0];return"MC".includes(t);});}},"3a08efab":function(e,t,n){"use strict";var r=n("ce906886"),i=n("20e820cd"),a=n("cff8ffe1"),o=n("5430cf47"),s=n("2c505294"),l=n("00247819"),u=n("5bf20808").Graph,c=n("b192169f");function d(e,t,n){return r.map(t,function(t){return s(e,t,n);});}function f(e,t){r.forEach(t,function(t){r.forEach(t,function(t,n){e.node(t).order=n;});});}e.exports=function(e){var t=c.maxRank(e),n=d(e,r.range(1,t+1),"inEdges"),s=d(e,r.range(t-1,-1,-1),"outEdges"),h=i(e);f(e,h);for(var p,v=Number.POSITIVE_INFINITY,g=0,m=0;m<4;++g,++m){(function(e,t){var n=new u;r.forEach(e,function(e){var i=e.graph().root,a=o(e,i,n,t);r.forEach(a.vs,function(t,n){e.node(t).order=n;}),l(e,n,a.vs);});})(g%2?n:s,g%4>=2),h=c.buildLayerMatrix(e);var y=a(e,h);y<v&&(m=0,p=r.cloneDeep(h),v=y);}f(e,p);};},"3a2d63e9":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991;};},"3a2da975":function(e,t,n){var r=n("6e3a9823"),i=n("3656a04e"),a=n("f28dfa76"),o=Object.prototype,s=Function.prototype.toString,l=o.hasOwnProperty,u=s.call(Object);e.exports=function(e){if(!a(e)||"[object Object]"!=r(e))return!1;var t=i(e);if(null===t)return!0;var n=l.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&s.call(n)==u;};},"3a41b8e4":function(e,t,n){"use strict";var r=n("ce906886"),i=n("6fd2fa26"),a=n("afa361e1").slack,o=n("afa361e1").longestPath,s=n("5bf20808").alg.preorder,l=n("5bf20808").alg.postorder,u=n("b192169f").simplify;function c(e){o(e=u(e));var t,n,r=i(e);for(h(r),d(r,e);t=p(r);)n=v(r,e,t),g(r,e,t,n);}function d(e,t){var n=l(e,e.nodes());n=n.slice(0,n.length-1),r.forEach(n,function(n){var r;r=e.node(n).parent,e.edge(n,r).cutvalue=f(e,t,n);});}function f(e,t,n){var i=e.node(n).parent,a=!0,o=t.edge(n,i),s=0;return o||(a=!1,o=t.edge(i,n)),s=o.weight,r.forEach(t.nodeEdges(n),function(r){var o=r.v===n,l=o?r.w:r.v;if(l!==i){var u=o===a,c=t.edge(r).weight;if(s+=u?c:-c,e.hasEdge(n,l)){var d=e.edge(n,l).cutvalue;s+=u?-d:d;}}}),s;}function h(e,t){arguments.length<2&&(t=e.nodes()[0]),function e(t,n,i,a,o){var s=i,l=t.node(a);return n[a]=!0,r.forEach(t.neighbors(a),function(o){r.has(n,o)||(i=e(t,n,i,o,a));}),l.low=s,l.lim=i++,o?l.parent=o:delete l.parent,i;}(e,{},1,t);}function p(e){return r.find(e.edges(),function(t){return e.edge(t).cutvalue<0;});}function v(e,t,n){var i=n.v,o=n.w;t.hasEdge(i,o)||(i=n.w,o=n.v);var s=e.node(i),l=e.node(o),u=s,c=!1;s.lim>l.lim&&(u=l,c=!0);var d=r.filter(t.edges(),function(t){return c===m(e,e.node(t.v),u)&&c!==m(e,e.node(t.w),u);});return r.minBy(d,function(e){return a(t,e);});}function g(e,t,n,i){var a,o,l=n.v,u=n.w;e.removeEdge(l,u),e.setEdge(i.v,i.w,{}),h(e),d(e,t),a=r.find(e.nodes(),function(e){return!t.node(e).parent;}),o=(o=s(e,a)).slice(1),r.forEach(o,function(n){var r=e.node(n).parent,i=t.edge(n,r),a=!1;i||(i=t.edge(r,n),a=!0),t.node(n).rank=t.node(r).rank+(a?i.minlen:-i.minlen);});}function m(e,t,n){return n.low<=t.lim&&t.lim<=n.lim;}e.exports=c,c.initLowLimValues=h,c.initCutValues=d,c.calcCutValue=f,c.leaveEdge=p,c.enterEdge=v,c.exchangeEdges=g;},"3a7214af":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=n("777fffbe")._(n("731b2a36")).default["__core-js_shared__"];},"3a846b89":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){return void 0===e;};},"3a988df8":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){return null!=e&&"object"==typeof e;};},"3aa02964":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{Map:function(){return i.Map;},MercatorCoordinate:function(){return r.MercatorCoordinate;}});var r=n("a807b8b1"),i=n("7ea96697");},"3af9c24c":function(e,t,n){var r=n("cdf1a659"),i=n("32f27622"),a=n("dc323adb"),o=n("c0051812");e.exports=function(e,t){return(o(e)?r:a)(e,i(t,3));};},"3b07959f":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("6ca3854b")),a=r._(n("fa245667")),o=function(e,t){var n=(0,a.default)(t),r=n.length;if((0,i.default)(e))return!r;for(var o=0;o<r;o+=1){var s=n[o];if(t[s]!==e[s]||!(s in e))return!1;}return!0;};},"3b603d4c":function(e,t,n){e.exports="0.8.5";},"3bc448aa":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=r._(n("4ce96d25")),s=r._(n("26fe17ea"));class l extends o.default{constructor(...e){super(...e),(0,a.default)(this,"type","WindLayer");}buildModels(){var e=this;return(0,i.default)(function*(){let t=e.getModelType();e.layerModel=new s.default[t](e),yield e.initLayerModels();})();}renderModels(e={}){return this.layerModel&&this.layerModel.render(e),this;}getDefaultConfig(){return({wind:{}})[this.getModelType()];}getModelType(){return"wind";}}},"3bd3be8f":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"MouseMoveStateManager",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe")._(n("d812e418")),i=n("e31a659c");let a={0:1,2:2};class o{constructor(e){(0,r.default)(this,"_eventButton",void 0),(0,r.default)(this,"_correctEvent",void 0),this._correctEvent=e.checkCorrectEvent;}startMove(e){let t=i.DOM.mouseButton(e);this._eventButton=t;}endMove(e){delete this._eventButton;}isValidStartEvent(e){return this._correctEvent(e);}isValidMoveEvent(e){return!function(e,t){let n=a[t];return void 0===e.buttons||(e.buttons&n)!==n;}(e,this._eventButton);}isValidEndEvent(e){return i.DOM.mouseButton(e)===this._eventButton;}}},"3c3019cc":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("a8be75a3")),a=r._(n("731b2a36")),o=(0,i.default)(a.default,"DataView");},"3c9d1159":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"TapDragZoomHandler",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("d812e418")),i=n("714a8a5a");class a{constructor(){(0,r.default)(this,"_enabled",void 0),(0,r.default)(this,"_active",void 0),(0,r.default)(this,"_swipePoint",void 0),(0,r.default)(this,"_swipeTouch",void 0),(0,r.default)(this,"_tapTime",void 0),(0,r.default)(this,"_tapPoint",void 0),(0,r.default)(this,"_tap",void 0),this._tap=new i.TapRecognizer({numTouches:1,numTaps:1}),this.reset();}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset();}touchstart(e,t,n){if(!this._swipePoint){if(this._tapTime){let r=t[0],a=e.timeStamp-this._tapTime<i.MAX_TAP_INTERVAL,o=this._tapPoint.dist(r)<i.MAX_DIST;a&&o?n.length>0&&(this._swipePoint=r,this._swipeTouch=n[0].identifier):this.reset();}else this._tap.touchstart(e,t,n);}}touchmove(e,t,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;let r=t[0],i=r.y-this._swipePoint.y;return this._swipePoint=r,e.preventDefault(),this._active=!0,{zoomDelta:i/128};}}else this._tap.touchmove(e,t,n);}touchend(e,t,n){if(this._tapTime)this._swipePoint&&0===n.length&&this.reset();else{let r=this._tap.touchend(e,t,n);r&&(this._tapTime=e.timeStamp,this._tapPoint=r);}}touchcancel(){this.reset();}enable(){this._enabled=!0;}disable(){this._enabled=!1,this.reset();}isEnabled(){return this._enabled;}isActive(){return this._active;}}},"3cb21ffa":function(e,t,n){var r=n("afa9632d"),i=n("88bde59d"),a=n("7bc08ef6"),o=n("ea7bb476"),s=a(function(e,t){if(null==e)return[];var n=t.length;return n>1&&o(e,t[0],t[1])?t=[]:n>2&&o(t[0],t[1],t[2])&&(t=[t[0]]),i(e,r(t,1),[]);});e.exports=s;},"3cd8f8f5":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("439d162e")),a=r._(n("0340f449")),o=r._(n("b0ea6077")),s=o.default&&o.default.isMap,l=s?(0,a.default)(s):i.default;},"3cd9af1a":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{forceCenter:function(){return i.default;},forceCollide:function(){return a.default;},forceLink:function(){return o.default;},forceManyBody:function(){return s.default;},forceRadial:function(){return l.default;},forceSimulation:function(){return u.default;},forceX:function(){return c.default;},forceY:function(){return d.default;}});var r=n("777fffbe"),i=r._(n("eaf99dcc")),a=r._(n("8549ce27")),o=r._(n("8494a095")),s=r._(n("1d726f2c")),l=r._(n("8851df56")),u=r._(n("afe81a74")),c=r._(n("0f43f2a7")),d=r._(n("392ae700"));},"3cfdc073":function(e,t,n){var r=n("31ebf18c");e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0;};},"3d05bb3e":function(e,t,n){var r=n("ef666486");e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1];};},"3d15f15b":function(e,t,n){e.exports={Graph:n("3036e156"),version:n("cb5f3e10")};},"3d18b149":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=n("d9b661b3"),s=n("fb1ec05a"),l=r._(n("755bc4f8")),u=n("f717bab4");class c extends l.default{constructor(...e){super(...e),(0,a.default)(this,"texture",void 0);}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9});}getCommonUniformsInfo(){let{opacity:e,brightness:t,contrast:n,saturation:r,gamma:i}=this.layer.getLayerConfig(),a={u_opacity:(0,s.defaultValue)(e,1),u_brightness:(0,s.defaultValue)(t,1),u_contrast:(0,s.defaultValue)(n,1),u_saturation:(0,s.defaultValue)(r,1),u_gamma:(0,s.defaultValue)(i,1)};return this.textures=[this.texture],this.getUniformsBufferInfo(a);}initModels(){var e=this;return(0,i.default)(function*(){return yield e.loadTexture(),e.buildModels();})();}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy();}loadTexture(){var e=this;return(0,i.default)(function*(){let{createTexture2D:t}=e.rendererService,n=e.layer.getSource(),r=yield n.data.images;e.texture=t({data:r[0],width:r[0].width,height:r[0].height,mag:o.gl.LINEAR,min:o.gl.LINEAR});})();}buildModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\nlayout(std140) uniform commonUniforms {\n    float u_opacity:1.0;\n    float u_brightness:1.0;\n    float u_contrast:1.0;\n    float u_saturation:1.0;\n    float u_gamma:1.0;\n};\n\nout vec2 v_texCoord;\n#pragma include "projection"\n\nvoid main() {\n  v_texCoord = a_Uv;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));\n}\n',fragmentShader:"uniform sampler2D u_texture;\nlayout(std140) uniform commonUniforms {\n    float u_opacity:1.0;\n    float u_brightness:1.0;\n    float u_contrast:1.0;\n    float u_saturation:1.0;\n    float u_gamma:1.0;\n};\n\nin vec2 v_texCoord;\nout vec4 outputColor;\nvec3 setContrast(vec3 rgb, float contrast) {\n  vec3 color = mix(vec3(0.5), rgb, contrast);\n  color = clamp(color, 0.0, 1.0);\n  return color;\n}\nvec3 setSaturation(vec3 rgb, float adjustment) {\n  const vec3 grayVector = vec3(0.2125, 0.7154, 0.0721);\n  vec3 intensity = vec3(dot(rgb, grayVector));\n  vec3 color = mix(intensity, rgb, adjustment);\n  color = clamp(color, 0.0, 1.0);\n  return color;\n}\nvoid main() {\n  vec4 color = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y));\n  //brightness\n  color.rgb = mix(vec3(0.0, 0.0, 0.0), color.rgb, u_brightness);\n  //contrast\n  color.rgb = setContrast(color.rgb, u_contrast);\n  // saturation\n  color.rgb = setSaturation(color.rgb, u_saturation);\n  // gamma\n  color.rgb = pow(color.rgb, vec3(u_gamma));\n  outputColor = color;\n  outputColor.a *= u_opacity;\n  if(outputColor.a < 0.01)\n    discard;\n}\n",defines:e.getDefines(),triangulation:u.RasterImageTriangulation,primitive:o.gl.TRIANGLES,blend:{enable:!0},depth:{enable:!1},pickingEnabled:!1}))];})();}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:o.AttributeType.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:2,update:(e,t,n)=>[n[3],n[4]]}});}}},"3d1ed70c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("581b88dd")),i=function(e){return(0,r.default)(e,5);};},"3d3bd3f9":function(e,t,n){var r=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r);};},"3d56238c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r={}.toString,i=function(e,t){return r.call(e)==="[object "+t+"]";};},"3dab17b9":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return h;}});var r=n("777fffbe"),i=r._(n("98ccb8b6")),a=r._(n("12fce91f")),o=r._(n("3e4beef3")),s=r._(n("cb5e6d96")),l=/^\[object .+?Constructor\]$/,u=Object.prototype,c=Function.prototype.toString,d=u.hasOwnProperty,f=RegExp("^"+c.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),h=function(e){return!(!(0,o.default)(e)||(0,a.default)(e))&&((0,i.default)(e)?f:l).test((0,s.default)(e));};},"3dfdf06f":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("a24d4a8c"),n("56792f9b"),n("44a4680f");},"3e4beef3":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t);};},"3e5a5661":function(e,t,n){var r=n("5861a980");e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t;};},"3e985af3":function(e,t,n){var r=n("13060ce4");e.exports=function(e,t){return r(e,t);};},"3e9b0be5":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("dbd10968")),a=r._(n("50468873"));class o extends i.default{getServiceConstructor(){return a.default;}}},"3f2a9250":function(e,t,n){var r=n("6e3a9823"),i=n("f28dfa76");e.exports=function(e){return i(e)&&"[object Arguments]"==r(e);};},"3f78af0a":function(e,t,n){var r=n("e06645db")(n("16b3b059"),"Map");e.exports=r;},"402ce633":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("895bdbd3"),n("f3e186ab");},"4086b076":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("05a4af02")),a=r._(n("37cb8cdf")),o=r._(n("c9ee7715")),s=i.default?i.default.toStringTag:void 0,l=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?(0,a.default)(e):(0,o.default)(e);};},"416bfed3":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=Array.isArray;},"41869dfc":function(e,t,n){"use strict";function r(e,t,n){return{x:e*Math.cos(n)-t*Math.sin(n),y:e*Math.sin(n)+t*Math.cos(n)};}n.d(t,"__esModule",{value:!0}),n.d(t,"rotateVector",{enumerable:!0,get:function(){return r;}});},"42fc1d72":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"TransformProvider",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("d812e418")),a=r._(n("be334174"));class o{constructor(e){(0,i.default)(this,"_map",void 0),this._map=e;}get transform(){return this._map._requestedCameraState||this._map.transform;}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat};}get zoom(){return this.transform.zoom;}get pitch(){return this.transform.pitch;}get bearing(){return this.transform.bearing;}unproject(e){return this.transform.pointLocation(a.default.convert(e));}}},"4310d456":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=n("d9b661b3"),s=r._(n("63855282"));class l{constructor(){(0,a.default)(this,"mapService",void 0);}apply(e){var t=this;this.mapService=e.getContainer().mapService,e.hooks.init.tapPromise("DataSourcePlugin",(0,i.default)(function*(){e.log(o.IDebugLog.SourceInitStart,o.ILayerStage.INIT);let n=e.getSource();if(!n){let{data:t,options:r}=e.sourceOption||e.defaultSourceConfig;n=new s.default(t,r),e.setSource(n);}n.inited?(t.updateClusterData(e),e.log(o.IDebugLog.SourceInitEnd,o.ILayerStage.INIT)):yield new Promise(r=>{n.on("update",n=>{"inited"===n.type&&(t.updateClusterData(e),e.log(o.IDebugLog.SourceInitEnd,o.ILayerStage.INIT)),r(null);});});})),e.hooks.beforeRenderData.tapPromise("DataSourcePlugin",(0,i.default)(function*(){let n=t.updateClusterData(e),r=e.dataState.dataSourceNeedUpdate;return e.dataState.dataSourceNeedUpdate=!1,n||r;}));}updateClusterData(e){if(e.isTileLayer||e.tileLayer||!e.getSource())return!1;let t=e.getSource(),n=t.cluster,{zoom:r=0}=t.clusterOptions,i=this.mapService.getZoom()-1,a=e.dataState.dataSourceNeedUpdate;return n&&a&&t.updateClusterData(Math.floor(i)),!!(n&&Math.abs(e.clusterZoom-i)>=1)&&(r!==Math.floor(i)&&t.updateClusterData(Math.floor(i)),e.clusterZoom=i,!0);}}},"439d162e":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("ebc8c370")),a=r._(n("3a988df8")),o=function(e){return(0,a.default)(e)&&"[object Map]"==(0,i.default)(e);};},"441fab0c":function(e,t,n){"use strict";function r(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},44862772:function(e,t,n){var r=n("54e1c10f")({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"});e.exports=r;},"44a4680f":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("90d6521d");},"44a82fba":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("494da66d")),i=function(e,t){var n=this.__data__,i=(0,r.default)(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this;};},"452b1871":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});class r{apply(e){e.hooks.afterInit.tap("LayerStylePlugin",()=>{let{autoFit:t,fitBoundsOptions:n}=e.getLayerConfig();t&&e.fitBounds(n),e.styleNeedUpdate=!1;});}}},"45557e8b":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e;};},"45716cfa":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("296a0a99");},"458dc274":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{MAX_VALID_LATITUDE:function(){return f;},Transform:function(){return h;}});var r=n("777fffbe"),i=r._(n("d812e418")),a=r._(n("be334174")),o=n("71293cfd"),s=n("f9562c3c"),l=n("0946fcfa"),u=n("5c93f055"),c=n("d092a378"),d=n("a807b8b1");let f=85.051129;class h{constructor(e,t,n,r,a){(0,i.default)(this,"tileSize",void 0),(0,i.default)(this,"tileZoom",void 0),(0,i.default)(this,"lngRange",void 0),(0,i.default)(this,"latRange",void 0),(0,i.default)(this,"scale",void 0),(0,i.default)(this,"width",void 0),(0,i.default)(this,"height",void 0),(0,i.default)(this,"angle",void 0),(0,i.default)(this,"rotationMatrix",void 0),(0,i.default)(this,"pixelsToGLUnits",void 0),(0,i.default)(this,"cameraToCenterDistance",void 0),(0,i.default)(this,"mercatorMatrix",void 0),(0,i.default)(this,"projMatrix",void 0),(0,i.default)(this,"invProjMatrix",void 0),(0,i.default)(this,"alignedProjMatrix",void 0),(0,i.default)(this,"pixelMatrix",void 0),(0,i.default)(this,"pixelMatrix3D",void 0),(0,i.default)(this,"pixelMatrixInverse",void 0),(0,i.default)(this,"glCoordMatrix",void 0),(0,i.default)(this,"labelPlaneMatrix",void 0),(0,i.default)(this,"minElevationForCurrentTile",void 0),(0,i.default)(this,"_fov",void 0),(0,i.default)(this,"_pitch",void 0),(0,i.default)(this,"_zoom",void 0),(0,i.default)(this,"_unmodified",void 0),(0,i.default)(this,"_renderWorldCopies",void 0),(0,i.default)(this,"_minZoom",void 0),(0,i.default)(this,"_maxZoom",void 0),(0,i.default)(this,"_minPitch",void 0),(0,i.default)(this,"_maxPitch",void 0),(0,i.default)(this,"_center",void 0),(0,i.default)(this,"_elevation",void 0),(0,i.default)(this,"_pixelPerMeter",void 0),(0,i.default)(this,"_edgeInsets",void 0),(0,i.default)(this,"_constraining",void 0),(0,i.default)(this,"_posMatrixCache",void 0),(0,i.default)(this,"_alignedPosMatrixCache",void 0),this.tileSize=512,this._renderWorldCopies=void 0===a||!!a,this._minZoom=e||0,this._maxZoom=t||22,this._minPitch=null==n?0:n,this._maxPitch=null==r?60:r,this.setMaxBounds(),this.width=0,this.height=0,this._center=new u.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new l.EdgeInsets,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0;}clone(){let e=new h(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e;}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this.minElevationForCurrentTile=e.minElevationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices();}get minZoom(){return this._minZoom;}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e));}get maxZoom(){return this._maxZoom;}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e));}get minPitch(){return this._minPitch;}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e));}get maxPitch(){return this._maxPitch;}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e));}get renderWorldCopies(){return this._renderWorldCopies;}set renderWorldCopies(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e;}get worldSize(){return this.tileSize*this.scale;}get centerOffset(){return this.centerPoint._sub(this.size._div(2));}get size(){return new a.default(this.width,this.height);}get bearing(){return-this.angle/Math.PI*180;}set bearing(e){let t=-(0,s.wrap)(e,-180,180)*Math.PI/180;this.angle!==t&&(this._unmodified=!1,this.angle=t,this._calcMatrices(),this.rotationMatrix=o.mat2.create(),o.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle));}get pitch(){return this._pitch/Math.PI*180;}set pitch(e){let t=(0,s.clamp)(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==t&&(this._unmodified=!1,this._pitch=t,this._calcMatrices());}get fov(){return this._fov/Math.PI*180;}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices());}get zoom(){return this._zoom;}set zoom(e){let t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._zoom=t,this.tileZoom=Math.max(0,Math.floor(t)),this.scale=this.zoomScale(t),this._constrain(),this._calcMatrices());}get center(){return this._center;}set center(e){(e.lat!==this._center.lat||e.lng!==this._center.lng)&&(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices());}get elevation(){return this._elevation;}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices());}get padding(){return this._edgeInsets.toJSON();}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices());}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height);}isPaddingEqual(e){return this._edgeInsets.equals(e);}interpolatePadding(e,t,n){this._unmodified=!1,this._edgeInsets.interpolate(e,t,n),this._constrain(),this._calcMatrices();}coveringZoomLevel(e){return Math.max(0,(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize)));}resize(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices();}get unmodified(){return this._unmodified;}zoomScale(e){return Math.pow(2,e);}scaleZoom(e){return Math.log(e)/Math.LN2;}project(e){let t=(0,s.clamp)(e.lat,-f,f);return new a.default((0,d.mercatorXfromLng)(e.lng)*this.worldSize,(0,d.mercatorYfromLat)(t)*this.worldSize);}unproject(e){return new d.MercatorCoordinate(e.x/this.worldSize,e.y/this.worldSize).toLngLat();}get point(){return this.project(this.center);}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation};}setLocationAtPoint(e,t){let n=this.pointCoordinate(t),r=this.pointCoordinate(this.centerPoint),i=this.locationCoordinate(e),a=new d.MercatorCoordinate(i.x-(n.x-r.x),i.y-(n.y-r.y));this.center=this.coordinateLocation(a),this._renderWorldCopies&&(this.center=this.center.wrap());}locationPoint(e){return this.coordinatePoint(this.locationCoordinate(e));}pointLocation(e){return this.coordinateLocation(this.pointCoordinate(e));}locationCoordinate(e){return d.MercatorCoordinate.fromLngLat(e);}coordinateLocation(e){return e&&e.toLngLat();}pointCoordinate(e){let t=[e.x,e.y,0,1],n=[e.x,e.y,1,1];o.vec4.transformMat4(t,t,this.pixelMatrixInverse),o.vec4.transformMat4(n,n,this.pixelMatrixInverse);let r=t[3],i=n[3],a=t[0]/r,l=n[0]/i,u=t[1]/r,c=n[1]/i,f=t[2]/r,h=n[2]/i,p=f===h?0:(0-f)/(h-f);return new d.MercatorCoordinate(s.interpolates.number(a,l,p)/this.worldSize,s.interpolates.number(u,c,p)/this.worldSize);}coordinatePoint(e,t=0,n=this.pixelMatrix){let r=[e.x*this.worldSize,e.y*this.worldSize,t,1];return o.vec4.transformMat4(r,r,n),new a.default(r[0]/r[3],r[1]/r[3]);}getBounds(){let e=Math.max(0,this.height/2-this.getHorizon());return new c.LngLatBounds().extend(this.pointLocation(new a.default(0,e))).extend(this.pointLocation(new a.default(this.width,e))).extend(this.pointLocation(new a.default(this.width,this.height))).extend(this.pointLocation(new a.default(0,this.height)));}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new c.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null;}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85;}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-f,f]);}customLayerMatrix(){return this.mercatorMatrix.slice();}getConstrained(e,t){let n,r;t=(0,s.clamp)(+t,this.minZoom,this.maxZoom);let i={center:new u.LngLat(e.lng,e.lat),zoom:t},o=this.lngRange;this._renderWorldCopies||null!==o||(o=[-(180-1e-10),180-1e-10]);let l=this.tileSize*this.zoomScale(i.zoom),c=0,f=l,h=0,p=l,v=0,g=0,{x:m,y:y}=this.size;if(this.latRange){let e=this.latRange;c=(0,d.mercatorYfromLat)(e[1])*l,(f=(0,d.mercatorYfromLat)(e[0])*l)-c<y&&(v=y/(f-c));}o&&(h=(0,s.wrap)((0,d.mercatorXfromLng)(o[0])*l,0,l),(p=(0,s.wrap)((0,d.mercatorXfromLng)(o[1])*l,0,l))<h&&(p+=l),p-h<m&&(g=m/(p-h)));let{x:b,y:_}=this.project.call({worldSize:l},e),x=Math.max(g||0,v||0);if(x){let e=new a.default(g?(p+h)/2:b,v?(f+c)/2:_);return i.center=this.unproject.call({worldSize:l},e).wrap(),i.zoom+=this.scaleZoom(x),i;}if(this.latRange){let e=y/2;_-e<c&&(r=c+e),_+e>f&&(r=f-e);}if(o){let e=(h+p)/2,t=b;this._renderWorldCopies&&(t=(0,s.wrap)(b,e-l/2,e+l/2));let r=m/2;t-r<h&&(n=h+r),t+r>p&&(n=p-r);}if(void 0!==n||void 0!==r){var w,E;let e=new a.default(null!==(w=n)&&void 0!==w?w:b,null!==(E=r)&&void 0!==E?E:_);i.center=this.unproject.call({worldSize:l},e).wrap();}return i;}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let e=this._unmodified,{center:t,zoom:n}=this.getConstrained(this.center,this.zoom);this.center=t,this.zoom=n,this._unmodified=e,this._constraining=!1;}_calcMatrices(){if(!this.height)return;let e=this._fov/2,t=this.centerOffset,n=this.point.x,r=this.point.y;this.cameraToCenterDistance=.5/Math.tan(e)*this.height,this._pixelPerMeter=(0,d.mercatorZfromAltitude)(1,this.center.lat)*this.worldSize;let i=o.mat4.identity(new Float64Array(16));o.mat4.scale(i,i,[this.width/2,-this.height/2,1]),o.mat4.translate(i,i,[1,-1,0]),this.labelPlaneMatrix=i,i=o.mat4.identity(new Float64Array(16)),o.mat4.scale(i,i,[1,-1,1]),o.mat4.translate(i,i,[-1,-1,0]),o.mat4.scale(i,i,[2/this.width,2/this.height,1]),this.glCoordMatrix=i;let a=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),l=Math.min(this.elevation,this.minElevationForCurrentTile),u=a-l*this._pixelPerMeter/Math.cos(this._pitch),c=l<0?u:a,f=Math.PI/2+this._pitch,h=this._fov*(.5+t.y/this.height),p=Math.sin(h)*c/Math.sin((0,s.clamp)(Math.PI-f-h,.01,Math.PI-.01)),v=this.getHorizon(),g=2*Math.atan(v/this.cameraToCenterDistance)*(.5+t.y/(2*v)),m=Math.min(p,Math.sin(g)*c/Math.sin((0,s.clamp)(Math.PI-f-g,.01,Math.PI-.01))),y=(Math.cos(Math.PI/2-this._pitch)*m+c)*1.01,b=this.height/50;i=new Float64Array(16),o.mat4.perspective(i,this._fov,this.width/this.height,b,y),i[8]=-(2*t.x)/this.width,i[9]=2*t.y/this.height,o.mat4.scale(i,i,[1,-1,1]),o.mat4.translate(i,i,[0,0,-this.cameraToCenterDistance]),o.mat4.rotateX(i,i,this._pitch),o.mat4.rotateZ(i,i,this.angle),o.mat4.translate(i,i,[-n,-r,0]),this.mercatorMatrix=o.mat4.scale([],i,[this.worldSize,this.worldSize,this.worldSize]),o.mat4.scale(i,i,[1,1,this._pixelPerMeter]),this.pixelMatrix=o.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,i),o.mat4.translate(i,i,[0,0,-this.elevation]),this.projMatrix=i,this.invProjMatrix=o.mat4.invert([],i),this.pixelMatrix3D=o.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,i);let _=this.width%2/2,x=this.height%2/2,w=Math.cos(this.angle),E=Math.sin(this.angle),M=n-Math.round(n)+w*_+E*x,S=r-Math.round(r)+w*x+E*_,k=new Float64Array(i);if(o.mat4.translate(k,k,[M>.5?M-1:M,S>.5?S-1:S,0]),this.alignedProjMatrix=k,!(i=o.mat4.invert(new Float64Array(16),this.pixelMatrix)))throw Error("failed to invert matrix");this.pixelMatrixInverse=i,this._posMatrixCache={},this._alignedPosMatrixCache={};}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;let e=this.pointCoordinate(new a.default(0,0)),t=[e.x*this.worldSize,e.y*this.worldSize,0,1];return o.vec4.transformMat4(t,t,this.pixelMatrix)[3]/this.cameraToCenterDistance;}getCameraPoint(){let e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.default(0,e));}getCameraQueryGeometry(e){let t=this.getCameraPoint();if(1===e.length)return[e[0],t];{let n=t.x,r=t.y,i=t.x,o=t.y;for(let t of e)n=Math.min(n,t.x),r=Math.min(r,t.y),i=Math.max(i,t.x),o=Math.max(o,t.y);return[new a.default(n,r),new a.default(i,r),new a.default(i,o),new a.default(n,o),new a.default(n,r)];}}lngLatToCameraDepth(e,t){let n=this.locationCoordinate(e),r=[n.x*this.worldSize,n.y*this.worldSize,t,1];return o.vec4.transformMat4(r,r,this.projMatrix),r[2]/r[3];}}},"45c563b0":function(e,t,n){var r=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;e.exports=function(e){return r.test(e);};},"45e3b1d7":function(e,t,n){"use strict";function r(e){return e[1];}function i(e){return arguments.length?(this._y=e,this):this._y;}n.d(t,"__esModule",{value:!0}),n.e(t,{default:function(){return i;},defaultY:function(){return r;}});},"4610f244":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("4d809c36"));function i(e){var t,n,i,a,o=[],s=this._root;for(s&&o.push(new r.default(s,this._x0,this._x1));t=o.pop();)if(!e(s=t.node,i=t.x0,a=t.x1)&&s.length){var l=(i+a)/2;(n=s[1])&&o.push(new r.default(n,l,a)),(n=s[0])&&o.push(new r.default(n,i,l));}return this;}},"462c8966":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{getTileLayer:function(){return s;},isNeedMask:function(){return l;}});var r=n("777fffbe"),i=r._(n("fa52488c")),a=r._(n("f1ed3b6a")),o=r._(n("b6ae0420"));function s(e){return"PolygonLayer"===e?o.default:"LineLayer"===e?i.default:a.default;}function l(e){return -1!==["PolygonLayer","LineLayer"].indexOf(e);}},46423930:function(e,t,n){var r=n("e06645db")(n("16b3b059"),"Set");e.exports=r;},"46cf8fa6":function(e,t,n){var r=n("232edce3"),i=n("2339bf2f"),a=n("568405a4");e.exports=function(e){return i(e)?a(e):r(e);};},"477f9224":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"Graph",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe")._(n("6e60059a")),i=n("a326d8ee"),a=n("083a713c");class o extends r.default{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(e){if(super(),!e)return;e.nodes&&this.addNodes(e.nodes),e.edges&&this.addEdges(e.edges),e.tree&&this.addTree(e.tree),e.onChanged&&(this.onChanged=e.onChanged);}batch=e=>{this.batchCount+=1,e(),this.batchCount-=1,this.batchCount||this.commit();};commit(){let e=this.changes;this.changes=[];let t={graph:this,changes:e};this.emit("changed",t),this.onChanged(t);}reduceChanges(e){let t=[];return e.forEach(e=>{switch(e.type){case"NodeRemoved":{let n=!1;t=t.filter(t=>{if("NodeAdded"===t.type){let r=t.value.id===e.value.id;return r&&(n=!0),!r;}return"NodeDataUpdated"===t.type?t.id!==e.value.id:"TreeStructureChanged"!==t.type||t.nodeId!==e.value.id;}),n||t.push(e);break;}case"EdgeRemoved":{let n=!1;t=t.filter(t=>{if("EdgeAdded"===t.type){let r=t.value.id===e.value.id;return r&&(n=!0),!r;}return"EdgeDataUpdated"!==t.type&&"EdgeUpdated"!==t.type||t.id!==e.value.id;}),n||t.push(e);break;}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{let n=t.findIndex(t=>t.type===e.type&&t.id===e.id&&(void 0===e.propertyName||t.propertyName===e.propertyName)),r=t[n];r?void 0!==e.propertyName?r.newValue=e.newValue:(t.splice(n,1),t.push(e)):t.push(e);break;}case"TreeStructureDetached":(t=t.filter(t=>"TreeStructureAttached"===t.type?t.treeKey!==e.treeKey:"TreeStructureChanged"!==t.type||t.treeKey!==e.treeKey)).push(e);break;case"TreeStructureChanged":{let n=t.find(t=>"TreeStructureChanged"===t.type&&t.treeKey===e.treeKey&&t.nodeId===e.nodeId);n?n.newParentId=e.newParentId:t.push(e);break;}default:t.push(e);}}),t;}checkNodeExistence(e){this.getNode(e);}hasNode(e){return this.nodeMap.has(e);}areNeighbors(e,t){return this.getNeighbors(t).some(t=>t.id===e);}getNode(e){let t=this.nodeMap.get(e);if(!t)throw Error("Node not found for id: "+e);return t;}getRelatedEdges(e,t){return(this.checkNodeExistence(e),"in"===t)?Array.from(this.inEdgesMap.get(e)):"out"===t?Array.from(this.outEdgesMap.get(e)):Array.from(this.bothEdgesMap.get(e));}getDegree(e,t){return this.getRelatedEdges(e,t).length;}getSuccessors(e){return Array.from(new Set(this.getRelatedEdges(e,"out").map(e=>this.getNode(e.target))));}getPredecessors(e){return Array.from(new Set(this.getRelatedEdges(e,"in").map(e=>this.getNode(e.source))));}getNeighbors(e){return Array.from(new Set([...this.getPredecessors(e),...this.getSuccessors(e)]));}doAddNode(e){if(this.hasNode(e.id))throw Error("Node already exists: "+e.id);this.nodeMap.set(e.id,e),this.inEdgesMap.set(e.id,new Set),this.outEdgesMap.set(e.id,new Set),this.bothEdgesMap.set(e.id,new Set),this.treeIndices.forEach(t=>{t.childrenMap.set(e.id,new Set);}),this.changes.push({type:"NodeAdded",value:e});}addNodes(e){this.batch(()=>{for(let t of e)this.doAddNode(t);});}addNode(e){this.addNodes([e]);}doRemoveNode(e){let t=this.getNode(e),n=this.bothEdgesMap.get(e);null==n||n.forEach(e=>this.doRemoveEdge(e.id)),this.nodeMap.delete(e),this.treeIndices.forEach(n=>{var r,i;null===(r=n.childrenMap.get(e))||void 0===r||r.forEach(e=>{n.parentMap.delete(e.id);});let a=n.parentMap.get(e);a&&(null===(i=n.childrenMap.get(a.id))||void 0===i||i.delete(t)),n.parentMap.delete(e),n.childrenMap.delete(e);}),this.bothEdgesMap.delete(e),this.inEdgesMap.delete(e),this.outEdgesMap.delete(e),this.changes.push({type:"NodeRemoved",value:t});}removeNodes(e){this.batch(()=>{e.forEach(e=>this.doRemoveNode(e));});}removeNode(e){this.removeNodes([e]);}updateNodeDataProperty(e,t,n){let r=this.getNode(e);this.batch(()=>{let i=r.data[t];r.data[t]=n,this.changes.push({type:"NodeDataUpdated",id:e,propertyName:t,oldValue:i,newValue:n});});}mergeNodeData(e,t){this.batch(()=>{Object.entries(t).forEach(([t,n])=>{this.updateNodeDataProperty(e,t,n);});});}updateNodeData(...e){let t;let n=e[0],r=this.getNode(n);if("string"==typeof e[1]){this.updateNodeDataProperty(n,e[1],e[2]);return;}"function"==typeof e[1]?t=(0,e[1])(r.data):"object"==typeof e[1]&&(t=e[1]),this.batch(()=>{let e=r.data,i=t;r.data=t,this.changes.push({type:"NodeDataUpdated",id:n,oldValue:e,newValue:i});});}checkEdgeExistence(e){if(!this.hasEdge(e))throw Error("Edge not found for id: "+e);}hasEdge(e){return this.edgeMap.has(e);}getEdge(e){return this.checkEdgeExistence(e),this.edgeMap.get(e);}getEdgeDetail(e){let t=this.getEdge(e);return{edge:t,source:this.getNode(t.source),target:this.getNode(t.target)};}doAddEdge(e){if(this.hasEdge(e.id))throw Error("Edge already exists: "+e.id);this.checkNodeExistence(e.source),this.checkNodeExistence(e.target),this.edgeMap.set(e.id,e);let t=this.inEdgesMap.get(e.target),n=this.outEdgesMap.get(e.source),r=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);t.add(e),n.add(e),r.add(e),i.add(e),this.changes.push({type:"EdgeAdded",value:e});}addEdges(e){this.batch(()=>{for(let t of e)this.doAddEdge(t);});}addEdge(e){this.addEdges([e]);}doRemoveEdge(e){let t=this.getEdge(e),n=this.outEdgesMap.get(t.source),r=this.inEdgesMap.get(t.target),i=this.bothEdgesMap.get(t.source),a=this.bothEdgesMap.get(t.target);n.delete(t),r.delete(t),i.delete(t),a.delete(t),this.edgeMap.delete(e),this.changes.push({type:"EdgeRemoved",value:t});}removeEdges(e){this.batch(()=>{e.forEach(e=>this.doRemoveEdge(e));});}removeEdge(e){this.removeEdges([e]);}updateEdgeSource(e,t){let n=this.getEdge(e);this.checkNodeExistence(t);let r=n.source;this.outEdgesMap.get(r).delete(n),this.bothEdgesMap.get(r).delete(n),this.outEdgesMap.get(t).add(n),this.bothEdgesMap.get(t).add(n),n.source=t,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:e,propertyName:"source",oldValue:r,newValue:t});});}updateEdgeTarget(e,t){let n=this.getEdge(e);this.checkNodeExistence(t);let r=n.target;this.inEdgesMap.get(r).delete(n),this.bothEdgesMap.get(r).delete(n),this.inEdgesMap.get(t).add(n),this.bothEdgesMap.get(t).add(n),n.target=t,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:e,propertyName:"target",oldValue:r,newValue:t});});}updateEdgeDataProperty(e,t,n){let r=this.getEdge(e);this.batch(()=>{let i=r.data[t];r.data[t]=n,this.changes.push({type:"EdgeDataUpdated",id:e,propertyName:t,oldValue:i,newValue:n});});}updateEdgeData(...e){let t;let n=e[0],r=this.getEdge(n);if("string"==typeof e[1]){this.updateEdgeDataProperty(n,e[1],e[2]);return;}"function"==typeof e[1]?t=(0,e[1])(r.data):"object"==typeof e[1]&&(t=e[1]),this.batch(()=>{let e=r.data,i=t;r.data=t,this.changes.push({type:"EdgeDataUpdated",id:n,oldValue:e,newValue:i});});}mergeEdgeData(e,t){this.batch(()=>{Object.entries(t).forEach(([t,n])=>{this.updateEdgeDataProperty(e,t,n);});});}checkTreeExistence(e){if(!this.hasTreeStructure(e))throw Error("Tree structure not found for treeKey: "+e);}hasTreeStructure(e){return this.treeIndices.has(e);}attachTreeStructure(e){this.treeIndices.has(e)||(this.treeIndices.set(e,{parentMap:new Map,childrenMap:new Map}),this.batch(()=>{this.changes.push({type:"TreeStructureAttached",treeKey:e});}));}detachTreeStructure(e){this.checkTreeExistence(e),this.treeIndices.delete(e),this.batch(()=>{this.changes.push({type:"TreeStructureDetached",treeKey:e});});}addTree(e,t){this.batch(()=>{this.attachTreeStructure(t);let n=[],r=Array.isArray(e)?e:[e];for(;r.length;){let e=r.shift();n.push(e),e.children&&r.push(...e.children);}this.addNodes(n),n.forEach(e=>{var n;null===(n=e.children)||void 0===n||n.forEach(n=>{this.setParent(n.id,e.id,t);});});});}getRoots(e){return this.checkTreeExistence(e),this.getAllNodes().filter(t=>!this.getParent(t.id,e));}getChildren(e,t){return this.checkNodeExistence(e),this.checkTreeExistence(t),Array.from(this.treeIndices.get(t).childrenMap.get(e)||[]);}getParent(e,t){return this.checkNodeExistence(e),this.checkTreeExistence(t),this.treeIndices.get(t).parentMap.get(e)||null;}getAncestors(e,t){let n;let r=[],i=this.getNode(e);for(;n=this.getParent(i.id,t);)r.push(n),i=n;return r;}setParent(e,t,n){var r,i;this.checkTreeExistence(n);let a=this.treeIndices.get(n);if(!a)return;let o=this.getNode(e),s=a.parentMap.get(e);if((null==s?void 0:s.id)===t)return;if(null==t){s&&(null===(r=a.childrenMap.get(s.id))||void 0===r||r.delete(o)),a.parentMap.delete(e);return;}let l=this.getNode(t);a.parentMap.set(e,l),s&&(null===(i=a.childrenMap.get(s.id))||void 0===i||i.delete(o));let u=a.childrenMap.get(l.id);u||(u=new Set,a.childrenMap.set(l.id,u)),u.add(o),this.batch(()=>{this.changes.push({type:"TreeStructureChanged",treeKey:n,nodeId:e,oldParentId:null==s?void 0:s.id,newParentId:l.id});});}dfsTree(e,t,n){return(0,a.doDFS)(this.getNode(e),new Set,t,e=>this.getChildren(e,n));}bfsTree(e,t,n){return(0,a.doBFS)([this.getNode(e)],new Set,t,e=>this.getChildren(e,n));}getAllNodes(){return Array.from(this.nodeMap.values());}getAllEdges(){return Array.from(this.edgeMap.values());}bfs(e,t,n="out"){let r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];return(0,a.doBFS)([this.getNode(e)],new Set,t,r);}dfs(e,t,n="out"){let r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];return(0,a.doDFS)(this.getNode(e),new Set,t,r);}clone(){let e=new o({nodes:this.getAllNodes().map(e=>({...e,data:{...e.data}})),edges:this.getAllEdges().map(e=>({...e,data:{...e.data}}))});return this.treeIndices.forEach(({parentMap:t,childrenMap:n},r)=>{let i=new Map;t.forEach((t,n)=>{i.set(n,e.getNode(t.id));});let a=new Map;n.forEach((t,n)=>{a.set(n,new Set(Array.from(t).map(t=>e.getNode(t.id))));}),e.treeIndices.set(r,{parentMap:i,childrenMap:a});}),e;}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()});}createView(e){return new i.GraphView({graph:this,...e});}}},"478fb4e7":function(e,t,n){var r=n("e06645db"),i=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e;}catch(e){}}();e.exports=i;},"481b6514":function(e,t,n){var r=n("d59953b5"),i=n("be56823a");e.exports=function(e){return null!=e&&i(e.length)&&!r(e);};},"4831edc3":function(e,t,n){var r=n("0f21b56b");e.exports=function(e){return r(e,5);};},"484a8f02":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("f89fb776")),o=r._(n("d812e418")),s=r._(n("4ce96d25")),l=n("964e43bc");class u extends s.default{constructor(...e){super(...e),(0,o.default)(this,"type","CanvasLayer");}getDefaultConfig(){return{zIndex:3,contextType:"canvas2d",trigger:"change"};}buildModels(){var e=this;return(0,a.default)(function*(){e.layerModel=new l.CanvasModel(e),yield e.initLayerModels();})();}getModelType(){return this.getLayerConfig().contextType||"canvas2d";}draw(e){return this.updateLayerConfig({draw:e}),this.render(),this;}getLayerConfig(){let e=(0,i.default)((0,i.default)({},this.getDefaultConfig()),super.getLayerConfig());return e.zIndex<3&&(e.zIndex=3),e;}render(){var e;return null===(e=this.layerModel)||void 0===e||e.renderCanvas(),this;}getCanvas(){var e;return null===(e=this.layerModel)||void 0===e?void 0:e.canvas;}show(){let e=this.getCanvas();return e&&(e.style.display="unset"),this;}hide(){let e=this.getCanvas();return e&&(e.style.display="none"),this;}destroy(){this.layerModel.removeCanvas(),super.destroy();}}},"486a3722":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{Logo:function(){return a;},default:function(){return a;}});var r=n("fb1ec05a"),i=n("9d431275");class a extends i.Control{getDefault(){return{position:i.PositionType.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"};}onAdd(){let e=r.DOM.create("div","l7-control-logo");return this.setLogoContent(e),e;}onRemove(){return null;}setOptions(e){super.setOptions(e),this.checkUpdateOption(e,["img","href"])&&(r.DOM.clearChildren(this.container),this.setLogoContent(this.container));}setLogoContent(e){let{href:t,img:n}=this.controlOption,i=r.DOM.create("img");if(i.setAttribute("src",n),i.setAttribute("aria-label","AntV logo"),r.DOM.setUnDraggable(i),t){let n=r.DOM.create("a","l7-control-logo-link");n.target="_blank",n.href=t,n.rel="noopener nofollow",n.setAttribute("rel","noopener nofollow"),n.appendChild(i),e.appendChild(n);}else e.appendChild(i);}}},"48ddba2e":function(e,t,n){var r=n("2c2fd53f");e.exports=function(e){return r(this,e).has(e);};},"49100cc9":function(e,t,n){var r=n("df18c8e8"),i=n("478fb4e7"),a=n("81d598f3"),o=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0});}:a;e.exports=o;},"494da66d":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("aa15234a")),i=function(e,t){for(var n=e.length;n--;)if((0,r.default)(e[n][0],t))return n;return -1;};},49612516:function(e,t,n){var r=n("a40f740e"),i=n("45c563b0"),a=n("13056af7"),o=n("9148c331");e.exports=function(e,t,n){return(e=a(e),void 0===(t=n?void 0:t))?i(e)?o(e):r(e):e.match(t)||[];};},"49ebc2f1":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("d812e418")),i=class{constructor(e,t,n){(0,r.default)(this,"boxCells",[]),(0,r.default)(this,"xCellCount",void 0),(0,r.default)(this,"yCellCount",void 0),(0,r.default)(this,"boxKeys",void 0),(0,r.default)(this,"bboxes",void 0),(0,r.default)(this,"width",void 0),(0,r.default)(this,"height",void 0),(0,r.default)(this,"xScale",void 0),(0,r.default)(this,"yScale",void 0),(0,r.default)(this,"boxUid",void 0);let i=this.boxCells;this.xCellCount=Math.ceil(e/n),this.yCellCount=Math.ceil(t/n);for(let e=0;e<this.xCellCount*this.yCellCount;e++)i.push([]);this.boxKeys=[],this.bboxes=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0;}insert(e,t,n,r,i){this.forEachCell(t,n,r,i,this.insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i);}query(e,t,n,r,i){return this.queryHitTest(e,t,n,r,!1,i);}hitTest(e,t,n,r,i){return this.queryHitTest(e,t,n,r,!0,i);}insertBoxCell(e,t,n,r,i,a){this.boxCells[i].push(a);}queryHitTest(e,t,n,r,i,a){if(n<0||e>this.width||r<0||t>this.height)return!i&&[];let o=[];if(e<=0&&t<=0&&this.width<=n&&this.height<=r){if(i)return!0;for(let e=0;e<this.boxKeys.length;e++)o.push({key:this.boxKeys[e],x1:this.bboxes[4*e],y1:this.bboxes[4*e+1],x2:this.bboxes[4*e+2],y2:this.bboxes[4*e+3]});return a?o.filter(a):o;}return this.forEachCell(e,t,n,r,this.queryCell,o,{hitTest:i,seenUids:{box:{},circle:{}}},a),i?o.length>0:o;}queryCell(e,t,n,r,i,a,o,s){let l=o.seenUids,u=this.boxCells[i];if(null!==u){let i=this.bboxes;for(let c of u)if(!l.box[c]){l.box[c]=!0;let u=4*c;if(e<=i[u+2]&&t<=i[u+3]&&n>=i[u+0]&&r>=i[u+1]&&(!s||s(this.boxKeys[c]))){if(o.hitTest)return a.push(!0),!0;a.push({key:this.boxKeys[c],x1:i[u],y1:i[u+1],x2:i[u+2],y2:i[u+3]});}}}return!1;}forEachCell(e,t,n,r,i,a,o,s){let l=this.convertToXCellCoord(e),u=this.convertToYCellCoord(t),c=this.convertToXCellCoord(n),d=this.convertToYCellCoord(r);for(let f=l;f<=c;f++)for(let l=u;l<=d;l++){let u=this.xCellCount*l+f;if(i.call(this,e,t,n,r,u,a,o,s))return;}}convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)));}convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)));}};},"49f9401f":function(e,t,n){var r=n("c0051812"),i=n("e3d5f8e1"),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!!("number"==n||"symbol"==n||"boolean"==n||null==e||i(e))||o.test(e)||!a.test(e)||null!=t&&e in Object(t);};},"4a43ed9d":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("ae336fe3")),a=r._(n("99ff515c")),o=r._(n("6cd126a9")),s=function(e,t){if(e===t)return!0;if(!e||!t||(0,o.default)(e)||(0,o.default)(t))return!1;if((0,a.default)(e)||(0,a.default)(t)){if(e.length!==t.length)return!1;for(var n=!0,r=0;r<e.length&&(n=s(e[r],t[r]));r++);return n;}if((0,i.default)(e)||(0,i.default)(t)){var l=Object.keys(e),u=Object.keys(t);if(l.length!==u.length)return!1;for(var n=!0,r=0;r<l.length&&(n=s(e[l[r]],t[l[r]]));r++);return n;}return!1;},l=s;},"4a5f2e09":function(e,t,n){var r=n("31f4de56");e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1;};},"4a8d04f1":function(e,t,n){"use strict";function r(e){return function(){return e;};}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"4adafcdb":function(e,t,n){var r=n("ef666486");e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this;};},"4b5ee90c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("fc59e6b8");},"4b80ecba":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){return this.__data__.has(e);};},"4b858df8":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"skipSpaces",{enumerable:!0,get:function(){return i;}});var r=n("26fccf8d");function i(e){for(var t=e.pathValue,n=e.max;e.index<n&&(0,r.isSpace)(t.charCodeAt(e.index));)e.index+=1;}},"4bbd8d21":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("4a8d04f1"));function i(e){var t,n,i,a=(0,r.default)(.1);function o(e){for(var r,a=0,o=t.length;a<o;++a)r=t[a],r.vy+=(i[a]-r.y)*n[a]*e;}function s(){if(t){var r,o=t.length;for(r=0,n=Array(o),i=Array(o);r<o;++r)n[r]=isNaN(i[r]=+e(t[r],r,t))?0:+a(t[r],r,t);}}return"function"!=typeof e&&(e=(0,r.default)(null==e?0:+e)),o.initialize=function(e){t=e,s();},o.strength=function(e){return arguments.length?(a="function"==typeof e?e:(0,r.default)(+e),s(),o):a;},o.y=function(t){return arguments.length?(e="function"==typeof t?t:(0,r.default)(+t),s(),o):e;},o;}},"4c60d287":function(e,t,n){var r=n("ad32fc63"),i=n("644ac1e2")(function(e,t,n){return t=t.toLowerCase(),e+(n?r(t):t);});e.exports=i;},"4cbeec94":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("4a8d04f1"));function i(e,t,n,i){var a,o,s,l,u=(0,r.default)(.1);function c(e){for(var r=0,u=a.length;r<u;++r){var c=a[r],d=c.x-t||1e-6,f=(c.y||0)-n||1e-6,h=(c.z||0)-i||1e-6,p=Math.sqrt(d*d+f*f+h*h),v=(l[r]-p)*s[r]*e/p;c.vx+=d*v,o>1&&(c.vy+=f*v),o>2&&(c.vz+=h*v);}}function d(){if(a){var t,n=a.length;for(t=0,s=Array(n),l=Array(n);t<n;++t)l[t]=+e(a[t],t,a),s[t]=isNaN(l[t])?0:+u(a[t],t,a);}}return"function"!=typeof e&&(e=(0,r.default)(+e)),null==t&&(t=0),null==n&&(n=0),null==i&&(i=0),c.initialize=function(e,...t){a=e,o=t.find(e=>[1,2,3].includes(e))||2,d();},c.strength=function(e){return arguments.length?(u="function"==typeof e?e:(0,r.default)(+e),d(),c):u;},c.radius=function(t){return arguments.length?(e="function"==typeof t?t:(0,r.default)(+t),d(),c):e;},c.x=function(e){return arguments.length?(t=+e,c):t;},c.y=function(e){return arguments.length?(n=+e,c):n;},c.z=function(e){return arguments.length?(i=+e,c):i;},c;}},"4ce96d25":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return C;}});var r=n("777fffbe"),i=r._(n("b131ee44")),a=r._(n("f89fb776")),o=r._(n("daaa1548")),s=r._(n("d812e418")),l=n("5ec226fe"),u=n("d9b661b3"),c=n("63855282"),d=n("fb1ec05a"),f=n("f86d399e"),h=n("a429c6c2"),p=n("20a478c1"),v=n("183d4520"),g=r._(n("b6d05ee2")),m=r._(n("0c45e2fa"));let y=["passes"],b=["moduleName","vertexShader","fragmentShader","defines","inject","triangulation","styleOption","pickingEnabled"],{isEqual:_,isFunction:x,isNumber:w,isObject:E,isPlainObject:M,isUndefined:S}=d.lodashUtil,k=0;class C extends f.EventEmitter{get shaderModuleService(){return this.container.shaderModuleService;}get cameraService(){return this.container.cameraService;}get coordinateService(){return this.container.coordinateSystemService;}get iconService(){return this.container.iconService;}get fontService(){return this.container.fontService;}get pickingService(){return this.container.pickingService;}get rendererService(){return this.container.rendererService;}get layerService(){return this.container.layerService;}get debugService(){return this.container.debugService;}get interactionService(){return this.container.interactionService;}get mapService(){var e;return null===(e=this.container)||void 0===e?void 0:e.mapService;}get normalPassFactory(){return this.container.normalPassFactory;}constructor(e={}){super(),(0,s.default)(this,"id",`${k++}`),(0,s.default)(this,"name",`${k}`),(0,s.default)(this,"parent",void 0),(0,s.default)(this,"coordCenter",void 0),(0,s.default)(this,"type",void 0),(0,s.default)(this,"visible",!0),(0,s.default)(this,"zIndex",0),(0,s.default)(this,"minZoom",void 0),(0,s.default)(this,"maxZoom",void 0),(0,s.default)(this,"inited",!1),(0,s.default)(this,"layerModelNeedUpdate",!1),(0,s.default)(this,"pickedFeatureID",null),(0,s.default)(this,"selectedFeatureID",null),(0,s.default)(this,"styleNeedUpdate",!1),(0,s.default)(this,"rendering",void 0),(0,s.default)(this,"forceRender",!1),(0,s.default)(this,"clusterZoom",0),(0,s.default)(this,"layerType",void 0),(0,s.default)(this,"triangulation",void 0),(0,s.default)(this,"layerPickService",void 0),(0,s.default)(this,"textureService",void 0),(0,s.default)(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),(0,s.default)(this,"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,s.default)(this,"hooks",{init:new l.AsyncSeriesBailHook,afterInit:new l.SyncBailHook,beforeRender:new l.SyncBailHook,beforeRenderData:new l.AsyncWaterfallHook,afterRender:new l.SyncHook,beforePickingEncode:new l.SyncHook,afterPickingEncode:new l.SyncHook,beforeHighlight:new l.SyncHook(["pickedColor"]),afterHighlight:new l.SyncHook,beforeSelect:new l.SyncHook(["pickedColor"]),afterSelect:new l.SyncHook,beforeDestroy:new l.SyncHook,afterDestroy:new l.SyncHook}),(0,s.default)(this,"models",[]),(0,s.default)(this,"multiPassRenderer",void 0),(0,s.default)(this,"plugins",void 0),(0,s.default)(this,"startInit",!1),(0,s.default)(this,"sourceOption",void 0),(0,s.default)(this,"layerModel",void 0),(0,s.default)(this,"shapeOption",void 0),(0,s.default)(this,"tileLayer",void 0),(0,s.default)(this,"layerChildren",[]),(0,s.default)(this,"masks",[]),(0,s.default)(this,"configService",u.globalConfigService),(0,s.default)(this,"styleAttributeService",void 0),(0,s.default)(this,"layerSource",void 0),(0,s.default)(this,"postProcessingPassFactory",void 0),(0,s.default)(this,"animateOptions",{enable:!1}),(0,s.default)(this,"relativeOrigin",[0,0]),(0,s.default)(this,"originalExtent",[0,0,0,0]),(0,s.default)(this,"absoluteDataArray",[]),(0,s.default)(this,"container",void 0),(0,s.default)(this,"encodedData",void 0),(0,s.default)(this,"currentPickId",null),(0,s.default)(this,"rawConfig",void 0),(0,s.default)(this,"needUpdateConfig",void 0),(0,s.default)(this,"encodeStyleAttribute",{}),(0,s.default)(this,"enableShaderEncodeStyles",[]),(0,s.default)(this,"enableDataEncodeStyles",[]),(0,s.default)(this,"pendingStyleAttributes",[]),(0,s.default)(this,"scaleOptions",{}),(0,s.default)(this,"animateStartTime",void 0),(0,s.default)(this,"animateStatus",!1),(0,s.default)(this,"isDestroyed",!1),(0,s.default)(this,"uniformBuffers",[]),(0,s.default)(this,"encodeDataLength",0),(0,s.default)(this,"sourceEvent",()=>{this.dataState.dataSourceNeedUpdate=!0,this.processRelativeCoordinates();let e=this.getLayerConfig();e&&e.autoFit&&this.fitBounds(e.fitBoundsOptions),this.layerSource.getSourceCfg().autoRender&&setTimeout(()=>{this.reRender();},10);}),this.name=e.name||this.id,this.zIndex=e.zIndex||0,this.rawConfig=e,this.masks=e.maskLayers||[];}addMask(e){this.masks.push(e),this.updateLayerConfig({maskLayers:this.masks}),this.enableMask();}removeMask(e){let t=this.masks.indexOf(e);t>-1&&this.masks.splice(t,1),this.updateLayerConfig({maskLayers:this.masks});}disableMask(){this.updateLayerConfig({enableMask:!1});}enableMask(){this.updateLayerConfig({enableMask:!0});}addMaskLayer(e){this.masks.push(e);}removeMaskLayer(e){let t=this.masks.indexOf(e);t>-1&&this.masks.splice(t,1),e.destroy();}getAttribute(e){return this.styleAttributeService.getLayerStyleAttribute(e);}getLayerConfig(){return this.configService.getLayerConfig(this.id);}updateLayerConfig(e){if(Object.keys(e).map(t=>{t in this.rawConfig&&(this.rawConfig[t]=e[t]);}),this.startInit){let t=this.container.id;this.configService.setLayerConfig(t,this.id,(0,o.default)((0,o.default)((0,o.default)({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),e)),this.needUpdateConfig={};}else this.needUpdateConfig=(0,o.default)((0,o.default)({},this.needUpdateConfig),e);}setContainer(e){this.container=e;}getContainer(){return this.container;}addPlugin(e){return this.plugins.push(e),this;}init(){var e=this;return(0,a.default)(function*(){let t=e.container.id;e.startInit=!0,e.configService.setLayerConfig(t,e.id,e.rawConfig),e.layerType=e.rawConfig.layerType;let{enableMultiPassRenderer:n,passes:r}=e.getLayerConfig();for(let t of(n&&null!=r&&r.length&&r.length>0&&e.mapService.on("mapAfterFrameChange",()=>{e.renderLayers();}),e.postProcessingPassFactory=e.container.postProcessingPassFactory,e.styleAttributeService=e.container.styleAttributeService,n&&(e.multiPassRenderer=e.container.multiPassRenderer,e.multiPassRenderer.setLayer(e)),e.pendingStyleAttributes.forEach(({attributeName:t,attributeField:n,attributeValues:r,updateOptions:i})=>{e.styleAttributeService.updateStyleAttribute(t,{scale:(0,o.default)({field:n},e.splitValuesAndCallbackInAttribute(r,n?void 0:e.getLayerConfig()[t]))},i);}),e.pendingStyleAttributes=[],e.plugins=(0,h.createPlugins)(),e.plugins))t.apply(e,e.container);e.layerPickService=new g.default(e),e.textureService=new m.default(e),e.log(u.IDebugLog.LayerInitStart),yield e.hooks.init.promise(),e.log(u.IDebugLog.LayerInitEnd),e.inited=!0,e.emit("inited",{target:e,type:"inited"}),e.emit("add",{target:e,type:"add"}),e.hooks.afterInit.call();})();}log(e,t="init"){var n;if(this.tileLayer||this.isTileLayer)return;let r=`${this.id}.${t}.${e}`,i={id:this.id,type:this.type};null===(n=this.debugService)||void 0===n||n.log(r,i);}updateModelData(e){e.attributes&&e.elements?this.models.map(t=>{t.updateAttributesAndElements(e.attributes,e.elements);}):console.warn("data error");}setLayerPickService(e){this.layerPickService=e;}prepareBuildModel(){0!==Object.keys(this.needUpdateConfig||{}).length&&this.updateLayerConfig({});let{animateOption:e}=this.getLayerConfig();null!=e&&e.enable&&(this.layerService.startAnimate(),this.animateStatus=!0);}color(e,t,n){return this.updateStyleAttribute("color",e,t,n),this;}texture(e,t,n){return this.updateStyleAttribute("texture",e,t,n),this;}rotate(e,t,n){return this.updateStyleAttribute("rotate",e,t,n),this;}size(e,t,n){return this.updateStyleAttribute("size",e,t,n),this;}filter(e,t,n){let r=this.updateStyleAttribute("filter",e,t,n);return this.dataState.dataSourceNeedUpdate=r&&this.inited,this;}shape(e,t,n){this.shapeOption={field:e,values:t};let r=this.updateStyleAttribute("shape",e,t,n);return this.dataState.dataSourceNeedUpdate=r&&this.inited,this;}label(e,t,n){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:e,attributeValues:t,updateOptions:n}),this;}animate(e){let t={};return E(e)?(t.enable=!0,t=(0,o.default)((0,o.default)({},t),e)):t.enable=e,this.updateLayerConfig({animateOption:t}),this;}source(e,t){return(null==e?void 0:e.type)==="source"?this.setSource(e):(this.sourceOption={data:e,options:t},this.clusterZoom=0),this;}setData(e,t){return this.inited?(this.dataUpdatelog(),this.layerSource.setData(e,t)):this.on("inited",()=>{this.dataUpdatelog(),this.layerSource.setData(e,t);}),this;}dataUpdatelog(){this.log(u.IDebugLog.SourceInitStart,u.ILayerStage.UPDATE),this.layerSource.once("update",()=>{this.log(u.IDebugLog.SourceInitEnd,u.ILayerStage.UPDATE);});}style(e){let{passes:t}=e,n=(0,i.default)(e,y);return t&&(0,v.normalizePasses)(t).forEach(e=>{let t=this.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(e[0]);t&&t.updateOptions(e[1]);}),n.borderColor&&(n.stroke=n.borderColor),n.borderWidth&&(n.strokeWidth=n.borderWidth),Object.keys(n).forEach(e=>{let t=n[e];!Array.isArray(t)||2!==t.length||w(t[0])||w(t[1])||(n[e]={field:t[0],value:t[1]});}),this.encodeStyle(n),this.updateLayerConfig(n),this;}encodeStyle(e){Object.keys(e).forEach(t=>{[...this.enableShaderEncodeStyles,...this.enableDataEncodeStyles].includes(t)&&M(e[t])&&(e[t].field||e[t].value)&&!_(this.encodeStyleAttribute[t],e[t])?(this.encodeStyleAttribute[t]=e[t],this.updateStyleAttribute(t,e[t].field,e[t].value),this.inited&&(this.dataState.dataMappingNeedUpdate=!0)):this.encodeStyleAttribute[t]&&(delete this.encodeStyleAttribute[t],this.dataState.dataSourceNeedUpdate=!0);});}scale(e,t){let n=(0,o.default)({},this.scaleOptions);if(E(e)?this.scaleOptions=(0,o.default)((0,o.default)({},this.scaleOptions),e):this.scaleOptions[e]=t,this.styleAttributeService&&!_(n,this.scaleOptions)){let n=E(e)?e:{[e]:t};this.styleAttributeService.updateScaleAttribute(n);}return this;}renderLayers(){this.rendering=!0,this.layerService.reRender(),this.rendering=!1;}prerender(){}render(e={}){return this.tileLayer?this.tileLayer.render():(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender||this.renderModels(e)),this;}renderMultiPass(){var e=this;return(0,a.default)(function*(){(!(e.encodeDataLength<=0)||e.forceRender)&&(e.multiPassRenderer&&e.multiPassRenderer.getRenderFlag()?yield e.multiPassRenderer.render():e.renderModels());})();}active(e){let t={};return t.enableHighlight=!!E(e)||e,E(e)?(t.enableHighlight=!0,e.color&&(t.highlightColor=e.color),e.mix&&(t.activeMix=e.mix)):t.enableHighlight=!!e,this.updateLayerConfig(t),this;}setActive(e,t){if(E(e)){let{x:n=0,y:r=0}=e;this.updateLayerConfig({highlightColor:E(t)?t.color:this.getLayerConfig().highlightColor,activeMix:E(t)?t.mix:this.getLayerConfig().activeMix}),this.pick({x:n,y:r});}else this.updateLayerConfig({pickedFeatureID:e,highlightColor:E(t)?t.color:this.getLayerConfig().highlightColor,activeMix:E(t)?t.mix:this.getLayerConfig().activeMix}),this.hooks.beforeHighlight.call((0,d.encodePickingColor)(e)).then(()=>{setTimeout(()=>{this.reRender();},1);});}select(e){let t={};return t.enableSelect=!!E(e)||e,E(e)?(t.enableSelect=!0,e.color&&(t.selectColor=e.color),e.mix&&(t.selectMix=e.mix)):t.enableSelect=!!e,this.updateLayerConfig(t),this;}setSelect(e,t){if(E(e)){let{x:n=0,y:r=0}=e;this.updateLayerConfig({selectColor:E(t)?t.color:this.getLayerConfig().selectColor,selectMix:E(t)?t.mix:this.getLayerConfig().selectMix}),this.pick({x:n,y:r});}else this.updateLayerConfig({pickedFeatureID:e,selectColor:E(t)?t.color:this.getLayerConfig().selectColor,selectMix:E(t)?t.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call((0,d.encodePickingColor)(e)).then(()=>{setTimeout(()=>{this.reRender();},1);});}setBlend(e){return this.updateLayerConfig({blend:e}),this.reRender(),this;}show(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this;}hide(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this;}setIndex(e){return this.zIndex=e,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this;}setCurrentPickId(e){this.currentPickId=e;}getCurrentPickId(){return this.currentPickId;}setCurrentSelectedId(e){this.selectedFeatureID=e;}getCurrentSelectedId(){return this.selectedFeatureID;}isVisible(){let e=this.mapService.getZoom(),{visible:t,minZoom:n=-1/0,maxZoom:r=1/0}=this.getLayerConfig();return!!t&&e>=n&&e<r;}setMultiPass(e,t){if(this.updateLayerConfig({enableMultiPassRenderer:e}),t&&this.updateLayerConfig({passes:t}),e){let{passes:e=[]}=this.getLayerConfig();this.multiPassRenderer=(0,v.createMultiPassRenderer)(this,e,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);let{width:t,height:n}=this.rendererService.getViewportSize();this.multiPassRenderer.resize(t,n);}return this;}setMinZoom(e){return this.updateLayerConfig({minZoom:e}),this;}getMinZoom(){let{minZoom:e}=this.getLayerConfig();return e;}getMaxZoom(){let{maxZoom:e}=this.getLayerConfig();return e;}get(e){return this.getLayerConfig()[e];}setMaxZoom(e){return this.updateLayerConfig({maxZoom:e}),this;}setAutoFit(e){return this.updateLayerConfig({autoFit:e}),this;}fitBounds(e){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;let t=this.getSource().extent;return t.some(e=>Math.abs(e)===1/0)||this.mapService.fitBounds([[t[0],t[1]],[t[2],t[3]]],e),this;}destroy(e=!0){var t,n,r,i,a;if(this.isDestroyed)return;null===(t=this.layerModel)||void 0===t||t.uniformBuffers.forEach(e=>{e.destroy();}),this.layerChildren.map(e=>e.destroy(!1)),this.layerChildren=[];let{maskfence:o}=this.getLayerConfig();o&&(this.masks.map(e=>e.destroy(!1)),this.masks=[]),this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),null===(n=this.multiPassRenderer)||void 0===n||n.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),null===(r=this.layerModel)||void 0===r||r.clearModels(e),null===(i=this.tileLayer)||void 0===i||i.destroy(),this.models=[],null===(a=this.debugService)||void 0===a||a.removeLog(this.id),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0;}clear(){this.styleAttributeService.clearAllAttributes();}clearModels(){var e;this.models.forEach(e=>e.destroy()),null===(e=this.layerModel)||void 0===e||e.clearModels(),this.models=[];}isDirty(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(e=>e.needRescale||e.needRemapping||e.needRegenerateVertices).length;}setSource(e){if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=e,this.clusterZoom=0,this.inited&&this.layerSource.cluster){let e=this.mapService.getZoom();this.layerSource.updateClusterData(e);}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",({type:e})=>{if(void 0===this.coordCenter){let e=this.layerSource.center;this.coordCenter=e;}if("update"===e){if(this.tileLayer){this.tileLayer.reload();return;}this.sourceEvent();}"inited"===e&&this.processRelativeCoordinates();});}getSource(){return this.layerSource;}getScaleOptions(){return this.scaleOptions;}setEncodedData(e){this.encodedData=e,this.encodeDataLength=e.length;}getEncodedData(){return this.encodedData;}getScale(e){return this.styleAttributeService.getLayerAttributeScale(e);}getLegend(e){var t,n,r;let i=this.styleAttributeService.getLayerStyleAttribute(e);return{type:null===(n=((null==i||null===(t=i.scale)||void 0===t?void 0:t.scalers)||[])[0])||void 0===n||null===(n=n.option)||void 0===n?void 0:n.type,field:null==i||null===(r=i.scale)||void 0===r?void 0:r.field,items:this.getLegendItems(e)};}getLegendItems(e){let t=this.styleAttributeService.getLayerAttributeScale(e);return t?t.invertExtent?t.range().map(n=>({value:t.invertExtent(n),[e]:n})):t.ticks?t.ticks().map(n=>({value:n,[e]:t(n)})):null!=t&&t.domain?t.domain().filter(e=>!S(e)).map(n=>({value:n,[e]:t(n)})):[]:[];}pick({x:e,y:t}){this.interactionService.triggerHover({x:e,y:t});}boxSelect(e,t){this.pickingService.boxPickLayer(this,e,t);}buildLayerModel(e){var t=this;return(0,a.default)(function*(){let{moduleName:n,vertexShader:r,fragmentShader:a,defines:s,inject:l,triangulation:c,styleOption:d,pickingEnabled:f=!0}=e,h=(0,i.default)(e,b);t.shaderModuleService.registerModule(n,{vs:r,fs:a,defines:s,inject:l});let{vs:v,fs:g,uniforms:m}=t.shaderModuleService.getModule(n),{createModel:y}=t.rendererService;return new Promise(e=>{let{attributes:n,elements:r,count:i}=t.styleAttributeService.createAttributesAndIndices(t.encodedData,c,d,t),a=[...t.layerModel.uniformBuffers,...t.rendererService.uniformBuffers];f&&a.push(t.getPickingUniformBuffer());let s=(0,o.default)({attributes:n,uniforms:m,fs:g,vs:v,elements:r,blend:p.BlendTypes[u.BlendType.normal],uniformBuffers:a,textures:t.layerModel.textures},h);i&&(s.count=i),e(y(s));});})();}createAttributes(e){let{triangulation:t}=e,{attributes:n}=this.styleAttributeService.createAttributes(this.encodedData,t);return n;}getTime(){return this.layerService.clock.getDelta();}setAnimateStartTime(){this.animateStartTime=this.layerService.clock.getElapsedTime();}stopAnimate(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}));}getLayerAnimateTime(){return this.layerService.clock.getElapsedTime()-this.animateStartTime;}needPick(e){let{enableHighlight:t=!0,enableSelect:n=!0}=this.getLayerConfig(),r=-1!==this.eventNames().indexOf(e)||-1!==this.eventNames().indexOf("un"+e);return("click"===e||"dblclick"===e)&&n&&(r=!0),"mousemove"===e&&(t||-1!==this.eventNames().indexOf("mouseenter")||-1!==this.eventNames().indexOf("unmousemove")||-1!==this.eventNames().indexOf("mouseout"))&&(r=!0),this.isVisible()&&r;}buildModels(){return(0,a.default)(function*(){throw Error("Method not implemented.");})();}rebuildModels(){var e=this;return(0,a.default)(function*(){yield e.buildModels();})();}renderMulPass(e){return(0,a.default)(function*(){yield e.render();})();}renderModels(e={}){return this.encodeDataLength<=0&&!this.forceRender?this.clearModels():(this.hooks.beforeRender.call(),this.models.forEach(t=>{t.draw({uniforms:this.layerModel.getUninforms(),blend:this.layerModel.getBlend(),stencil:this.layerModel.getStencil(e),textures:this.layerModel.textures},(null==e?void 0:e.ispick)||!1);}),this.hooks.afterRender.call()),this;}updateStyleAttribute(e,t,n,r){return!_((this.configService.getAttributeConfig(this.id)||{})[e],{field:t,values:n})&&(-1!==["color","size","texture","rotate","filter","label","shape"].indexOf(e)&&this.configService.setAttributeConfig(this.id,{[e]:{field:t,values:n}}),this.startInit?this.styleAttributeService.updateStyleAttribute(e,{scale:(0,o.default)({field:t},this.splitValuesAndCallbackInAttribute(n,this.getLayerConfig()[t]))},r):this.pendingStyleAttributes.push({attributeName:e,attributeField:t,attributeValues:n,updateOptions:r}),!0);}getLayerAttributeConfig(){return this.configService.getAttributeConfig(this.id);}getShaderPickStat(){return this.layerService.getShaderPickStat();}setEarthTime(e){console.warn("empty fn");}processData(e){return e;}getModelType(){throw Error("Method not implemented.");}getDefaultConfig(){return{};}processRelativeCoordinates(){if(!this.getLayerConfig().enableRelativeCoordinates||!this.layerSource||!this.layerSource.data)return;this.absoluteDataArray=[...this.layerSource.data.dataArray];let e=(0,c.processRelativeCoordinates)(this.layerSource.data.dataArray,{enableRelativeCoordinates:!0});this.layerSource.data.dataArray=e.dataArray,this.relativeOrigin=e.relativeOrigin,this.originalExtent=e.originalExtent;}getAbsoluteData(){return this.absoluteDataArray;}getRelativeOrigin(){return this.relativeOrigin;}getOriginalExtent(){return this.originalExtent;}initLayerModels(){var e=this;return(0,a.default)(function*(){e.models.forEach(e=>e.destroy()),e.models=[],e.uniformBuffers.forEach(e=>{e.destroy();}),e.uniformBuffers=[];let t=e.rendererService.createBuffer({data:new Float32Array(20).fill(0),isUBO:!0,label:"pickingUniforms"});e.uniformBuffers.push(t),e.models=yield e.layerModel.initModels();})();}getPickingUniformBuffer(){return this.uniformBuffers[0];}reRender(){this.inited&&this.layerService.reRender();}splitValuesAndCallbackInAttribute(e){return{values:x(e)?void 0:e,callback:x(e)?e:void 0};}}},"4cec1b4c":function(e,t,n){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n;};},"4d809c36":function(e,t,n){"use strict";function r(e,t,n){this.node=e,this.x0=t,this.x1=n;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"4dbf85f4":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=n("d9b661b3"),o=n("fb1ec05a"),s=r._(n("755bc4f8")),l=n("1b6336a3");class u extends s.default{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,NORMAL:12});}getCommonUniformsInfo(){let{gapWidth:e=2,strokeWidth:t=1,strokeOpacity:n=1}=this.layer.getLayerConfig();return this.getUniformsBufferInfo({u_gap_width:e,u_stroke_width:t,u_stroke_opacity:n});}initModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){return[(yield e.layer.buildLayerModel({moduleName:"flow_line",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;\nlayout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;\nlayout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\n\nlayout(std140) uniform commonUniorm {\n  float u_gap_width: 1.0;\n  float u_stroke_width: 1.0;\n  float u_stroke_opacity: 1.0;\n};\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nout vec4 v_color;\n\nvec2 project_pixel_offset(vec2 offsets) {\n  vec2 data = project_pixel(offsets);\n\n  return vec2(data.x, -data.y);\n}\n\nvec2 line_dir(vec2 target, vec2 source) {\n  return normalize(ProjectFlat(target) - ProjectFlat(source));\n}\n\n\nvoid main() {\n  // \u900F\u660E\u5EA6\u8BA1\u7B97\n  vec2 source_world = a_Instance.rg; // \u8D77\u70B9\n  vec2 target_world = a_Instance.ba; // \u7EC8\u70B9\n  vec2 flowlineDir = line_dir(target_world, source_world);\n  vec2 perpendicularDir = vec2(-flowlineDir.y, flowlineDir.x);\n\n  vec2 position = mix(source_world, target_world, a_Position.x);\n  vec2 position64Low = mix(a_Instance64Low.rg, a_Instance64Low.ba, a_Position.x);\n\n  float lengthCommon = length(\n    project_position(vec4(target_world, 0, 1)) - project_position(vec4(source_world, 0, 1))\n  );\n  vec2 offsetDistances = a_Size.x * project_pixel_offset(vec2(a_Position.y, a_Position.z)); // Mapbox || \u9AD8\u5FB7\n  vec2 limitedOffsetDistances = clamp(\n    offsetDistances,\n    project_pixel(-lengthCommon * 0.2),\n    project_pixel(lengthCommon * 0.2)\n  );\n\n  float startOffsetCommon = project_pixel(offsets[0]);\n  float endOffsetCommon = project_pixel(offsets[1]);\n  float endpointOffset = mix(\n    clamp(startOffsetCommon, 0.0, lengthCommon * 0.2),\n    -clamp(endOffsetCommon, 0.0, lengthCommon * 0.2),\n    a_Position.x\n  );\n\n  vec2 normalsCommon = u_stroke_width * project_pixel_offset(vec2(a_Normal.x, a_Normal.y));\n\n  float gapCommon = -1. * project_pixel(u_gap_width);\n  vec3 offsetCommon = vec3(\n    flowlineDir * (limitedOffsetDistances[1] + normalsCommon.y + endpointOffset * 1.05) -\n      perpendicularDir * (limitedOffsetDistances[0] + gapCommon + normalsCommon.x),\n    0.0\n  );\n\n  vec4 project_pos = project_position(vec4(position.xy, 0, 1.0), position64Low);\n\n  vec4 fillColor = vec4(a_Color.rgb, a_Color.a * opacity);\n  v_color = mix(fillColor, vec4(u_stroke.xyz, u_stroke.w * fillColor.w * u_stroke_opacity), a_Normal.z);\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy +  offsetCommon.xy, 0., 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'// #extension GL_OES_standard_derivatives : enable\n\nin vec4 v_color;\nout vec4 outputColor;\n\n\n// line texture\n\n#pragma include "picking"\n\nvoid main() {\n  outputColor = v_color;\n  outputColor = filterColor(outputColor);\n}\n',defines:e.getDefines(),inject:e.getInject(),triangulation:l.FlowLineTriangulation,styleOption:e.layer.getLayerConfig().symbol,primitive:a.gl.TRIANGLES,depth:{enable:!1},pick:!1}))];})();}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:a.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:a.gl.DYNAMIC_DRAW,data:[],type:a.gl.FLOAT},size:2,update:e=>{let{size:t=1}=e;return Array.isArray(t)?[t[0],t[1]]:[t,0];}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:a.AttributeType.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:a.gl.STATIC_DRAW,data:[],type:a.gl.FLOAT},size:4,update:(e,t,n)=>[n[3],n[4],n[5],n[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:a.AttributeType.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:a.gl.STATIC_DRAW,data:[],type:a.gl.FLOAT},size:4,update:(e,t,n)=>[(0,o.fp64LowPart)(n[3]),(0,o.fp64LowPart)(n[4]),(0,o.fp64LowPart)(n[5]),(0,o.fp64LowPart)(n[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:a.AttributeType.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:a.gl.STATIC_DRAW,data:[],type:a.gl.FLOAT},size:3,update:(e,t,n,r,i)=>i}});}}},"4dd8dc26":function(e,t,n){"use strict";function r(e,t){return{type:e.type,field:"value",items:e.positions.map((n,r)=>({[t]:r>=e.colors.length?null:e.colors[r],value:n}))};}n.d(t,"__esModule",{value:!0}),n.d(t,"rampColor2legend",{enumerable:!0,get:function(){return r;}});},"4e68b4c7":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"ImagePool",{enumerable:!0,get:function(){return _;}});var r,i,a=n("777fffbe"),o=a._(n("1316cf9d")),s=a._(n("3d495adb"));n("66a06515"),n("20defe2a");var l=n("ef642ab1"),u=a._(n("83128d43")),c=a._(n("daaa1548")),d=a._(n("82f98358")),f=a._(n("f89fb776")),h=n("0d884ee9"),p=n("71293cfd"),v=(0,s.default)(function e(){(0,o.default)(this,e),this.cacheStore=new Map;},[{key:"onRefAdded",value:function(e){}},{key:"has",value:function(e){return this.cacheStore.has(e);}},{key:"put",value:function(e,t,n){return!this.cacheStore.has(e)&&(this.cacheStore.set(e,{value:t,counter:new Set([n.entity])}),this.onRefAdded(n),!0);}},{key:"get",value:function(e,t){var n=this.cacheStore.get(e);return n?(n.counter.has(t.entity)||(n.counter.add(t.entity),this.onRefAdded(t)),n.value):null;}},{key:"update",value:function(e,t,n){var r=this.cacheStore.get(e);return!!r&&(r.value=(0,c.default)((0,c.default)({},r.value),t),r.counter.has(n.entity)||(r.counter.add(n.entity),this.onRefAdded(n)),!0);}},{key:"release",value:function(e,t){var n=this.cacheStore.get(e);return!!n&&(n.counter.delete(t.entity),n.counter.size<=0&&this.cacheStore.delete(e),!0);}},{key:"releaseRef",value:function(e){var t=this;Array.from(this.cacheStore.keys()).forEach(function(n){t.release(n,e);});}},{key:"getSize",value:function(){return this.cacheStore.size;}},{key:"clear",value:function(){this.cacheStore.clear();}}]),g=[],m=[],y=function(){function e(){(0,o.default)(this,e);}return(0,s.default)(e,null,[{key:"stop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.api;e.rafId&&(t.cancelAnimationFrame(e.rafId),e.rafId=null);}},{key:"executeTask",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.api;g.length<=0&&m.length<=0||(m.forEach(function(e){return e();}),m=g.splice(0,e.TASK_NUM_PER_FRAME),e.rafId=t.requestAnimationFrame(function(){e.executeTask(t);}));}},{key:"sliceImage",value:function(t,n,r,i){for(var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e.api,s=t.naturalWidth||t.width,l=t.naturalHeight||t.height,u=n-a,c=r-a,d=Math.ceil(s/u),f=Math.ceil(l/c),h={tileSize:[n,r],gridSize:[f,d],tiles:Array(f).fill(null).map(function(){return Array(d).fill(null);})},p=function(e){for(var a=function(a){g.push(function(){var d=a*u,f=e*c,p=[Math.min(n,s-d),Math.min(r,l-f)],v=p[0],g=p[1],m=o.createCanvas();m.width=n,m.height=r,m.getContext("2d").drawImage(t,d,f,v,g,0,0,v,g),h.tiles[e][a]={x:d,y:f,tileX:a,tileY:e,data:m},i();});},f=0;f<d;f++)a(f);},v=0;v<f;v++)p(v);return e.stop(),e.executeTask(),h;}}]);}();y.TASK_NUM_PER_FRAME=10;var b=new v;b.onRefAdded=function(e){var t=this;e.addEventListener(l.ElementEvent.DESTROY,function(){t.releaseRef(e);},{once:!0});};var _=(0,s.default)(function e(t,n){(0,o.default)(this,e),this.gradientCache={},this.patternCache={},this.context=t,this.runtime=n;},[{key:"getImageSync",value:function(e,t,n){var r=(0,h.isString)(e)?e:e.src;if(b.has(r)){var i=b.get(r,t);if(i.img.complete)return null==n||n(i),i;}return this.getOrCreateImage(e,t).then(function(e){null==n||n(e);}).catch(function(e){console.error(e);}),null;}},{key:"getOrCreateImage",value:function(e,t){var n=this,r=(0,h.isString)(e)?e:e.src;if(!(0,h.isString)(e)&&!b.has(r)){var i={img:e,size:[e.naturalWidth||e.width,e.naturalHeight||e.height],tileSize:x(e)};b.put(r,i,t);}if(b.has(r)){var a=b.get(r,t);return a.img.complete?Promise.resolve(a):new Promise(function(e,t){a.img.addEventListener("load",function(){a.size=[a.img.naturalWidth||a.img.width,a.img.naturalHeight||a.img.height],a.tileSize=x(a.img),e(a);}),a.img.addEventListener("error",function(e){t(e);});});}return new Promise(function(e,i){var a=n.context.config.createImage();if(a){var o={img:a,size:[0,0],tileSize:x(a)};b.put(r,o,t),a.onload=function(){o.size=[a.naturalWidth||a.width,a.naturalHeight||a.height],o.tileSize=x(o.img),e(o);},a.onerror=function(e){i(e);},a.crossOrigin="Anonymous",a.src=r;}});}},{key:"createDownSampledImage",value:(r=(0,f.default)((0,u.default)().mark(function e(t,n){var r,i,a,o,s,l,f,h,p,v,g,m,y,_;return(0,u.default)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getOrCreateImage(t,n);case 2:if(!(void 0!==(r=e.sent).downSamplingRate)){e.next=5;break;}return e.abrupt("return",r);case 5:if(s=void 0===(o=(a="boolean"==typeof(i=this.context.config.enableLargeImageOptimization)?{}:i).maxDownSampledImageSize)?2048:o,f=void 0===(l=a.downSamplingRateThreshold)?.5:l,h=this.runtime.globalThis.createImageBitmap,v=(p=(0,d.default)(r.size,2))[0],g=p[1],m=r.img,y=Math.min((s+s)/(v+g),Math.max(.01,Math.min(f,.5))),_=(0,c.default)((0,c.default)({},r),{},{downSamplingRate:y}),b.update(r.img.src,_,n),!h){e.next=25;break;}return e.prev=14,e.next=17,h(r.img,{resizeWidth:v*y,resizeHeight:g*y});case 17:m=e.sent,e.next=23;break;case 20:e.prev=20,e.t0=e.catch(14),y=1;case 23:e.next=26;break;case 25:y=1;case 26:return _=(0,c.default)((0,c.default)({},this.getImageSync(t,n)),{},{downSampled:m,downSamplingRate:y}),b.update(r.img.src,_,n),e.abrupt("return",_);case 29:case"end":return e.stop();}},e,this,[[14,20]]);})),function(e,t){return r.apply(this,arguments);})},{key:"createImageTiles",value:(i=(0,f.default)((0,u.default)().mark(function e(t,n,r,i){var a,o,s,d,f;return(0,u.default)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getOrCreateImage(t,i);case 2:return a=e.sent,s=(o=i.ownerDocument.defaultView).requestAnimationFrame,d=o.cancelAnimationFrame,y.api={requestAnimationFrame:s,cancelAnimationFrame:d,createCanvas:function(){return l.OffscreenCanvasCreator.createCanvas();}},f=(0,c.default)((0,c.default)({},a),y.sliceImage(a.img,a.tileSize[0],a.tileSize[0],r)),b.update(a.img.src,f,i),e.abrupt("return",f);case 8:case"end":return e.stop();}},e,this);})),function(e,t,n,r){return i.apply(this,arguments);})},{key:"releaseImage",value:function(e,t){b.release((0,h.isString)(e)?e:e.src,t);}},{key:"releaseImageRef",value:function(e){b.releaseRef(e);}},{key:"getOrCreatePatternSync",value:function(e,t,n,r,i,a,o){var s,u,c=this.generatePatternKey(t);if(c&&this.patternCache[c])return this.patternCache[c];var d=t.image,f=t.repetition,v=t.transform,g=!1;if((0,h.isString)(d)){var m=this.getImageSync(d,e,o);s=null==m?void 0:m.img;}else r?(s=r,g=!0):s=d;var y=s&&n.createPattern(s,f);return y&&(u=v?(0,l.parsedTransformToMat4)((0,l.parseTransform)(v),new l.DisplayObject({})):p.mat4.identity(p.mat4.create()),g&&p.mat4.scale(u,u,[1/i,1/i,1]),y.setTransform({a:u[0],b:u[1],c:u[4],d:u[5],e:u[12]+a[0],f:u[13]+a[1]})),c&&y&&(this.patternCache[c]=y),y;}},{key:"getOrCreateGradient",value:function(e,t){var n=this.generateGradientKey(e),r=e.type,i=e.steps,a=e.min,o=e.width,s=e.height,u=e.angle,c=e.cx,d=e.cy,f=e.size;if(this.gradientCache[n])return this.gradientCache[n];var h=null;if(r===l.GradientType.LinearGradient){var p=(0,l.computeLinearGradient)(a,o,s,u),v=p.x1,g=p.y1,m=p.x2,y=p.y2;h=t.createLinearGradient(v,g,m,y);}else if(r===l.GradientType.RadialGradient){var b=(0,l.computeRadialGradient)(a,o,s,c,d,f),_=b.x,x=b.y,w=b.r;h=t.createRadialGradient(_,x,0,_,x,w);}return h&&(i.forEach(function(e){var t,n=e.offset,r=e.color;n.unit===l.UnitType.kPercentage&&(null===(t=h)||void 0===t||t.addColorStop(n.value/100,r.toString()));}),this.gradientCache[n]=h),this.gradientCache[n];}},{key:"generateGradientKey",value:function(e){var t=e.type,n=e.min,r=e.width,i=e.height,a=e.steps,o=e.angle,s=e.cx,l=e.cy,u=e.size;return"gradient-".concat(t,"-").concat((null==o?void 0:o.toString())||0,"-").concat((null==s?void 0:s.toString())||0,"-").concat((null==l?void 0:l.toString())||0,"-").concat((null==u?void 0:u.toString())||0,"-").concat(n[0],"-").concat(n[1],"-").concat(r,"-").concat(i,"-").concat(a.map(function(e){var t=e.offset,n=e.color;return"".concat(t).concat(n);}).join("-"));}},{key:"generatePatternKey",value:function(e){var t=e.image,n=e.repetition;return(0,h.isString)(t)?"pattern-".concat(t,"-").concat(n):"rect"===t.nodeName?"pattern-".concat(t.entity,"-").concat(n):void 0;}}]);function x(e){if(!e.complete)return[0,0];var t=e.naturalWidth||e.width,n=e.naturalHeight||e.height,r=256;return[256,512].forEach(function(e){Math.ceil(n/e)*Math.ceil(t/e)<1e3&&(r=e);}),[r,r];}_.isSupportTile=!!l.OffscreenCanvasCreator.createCanvas(),function(){function e(){(0,o.default)(this,e);}return(0,s.default)(e,[{key:"apply",value:function(t){var n=t.renderingService,r=t.renderingContext,i=t.imagePool,a=r.root.ownerDocument.defaultView,o=function(e,t,n){var r=e.parsedStyle,i=r.width,a=r.height;i&&!a?e.setAttribute("height",n/t*i):!i&&a&&e.setAttribute("width",t/n*a);},s=function(e){var t=e.target,r=t.nodeName,a=t.attributes;if(r===l.Shape.IMAGE){var s=a.src,u=a.keepAspectRatio;i.getImageSync(s,t,function(e){var r=e.img,i=r.width,a=r.height;u&&o(t,i,a),t.renderable.dirty=!0,n.dirtify();});}},u=function(e){var t=e.target,r=e.attrName,a=e.prevValue,s=e.newValue;t.nodeName===l.Shape.IMAGE&&"src"===r&&(a!==s&&i.releaseImage(a,t),(0,h.isString)(s)&&i.getOrCreateImage(s,t).then(function(e){var r=e.img,i=r.width,a=r.height;t.attributes.keepAspectRatio&&o(t,i,a),t.renderable.dirty=!0,n.dirtify();}).catch(function(){}));};n.hooks.init.tap(e.tag,function(){a.addEventListener(l.ElementEvent.MOUNTED,s),a.addEventListener(l.ElementEvent.ATTR_MODIFIED,u);}),n.hooks.destroy.tap(e.tag,function(){a.removeEventListener(l.ElementEvent.MOUNTED,s),a.removeEventListener(l.ElementEvent.ATTR_MODIFIED,u);});}}]);}().tag="LoadImage",l.AbstractRendererPlugin;},"4ef6cfc6":function(e,t,n){"use strict";function r(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]];}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"4f2bad25":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("d812e418")),o=r._(n("1c5ac11e"));class s{constructor(){(0,a.default)(this,"viewport",new o.default);}syncWithMapCamera(e){let{center:t,zoom:n,pitch:r,bearing:a,viewportHeight:s,viewportWidth:l}=e,u={width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing};this.viewport=new o.default((0,i.default)((0,i.default)({},u),{},{width:l,height:s,longitude:t&&t[0],latitude:t&&t[1],zoom:n,pitch:r,bearing:a}));}getZoom(){return this.viewport.zoom;}getZoomScale(){return Math.pow(2,this.getZoom());}getCenter(){return[this.viewport.longitude,this.viewport.latitude];}getProjectionMatrix(){return this.viewport.projectionMatrix;}getModelMatrix(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];}getViewMatrix(){return this.viewport.viewMatrix;}getViewMatrixUncentered(){return this.viewport.viewMatrixUncentered;}getViewProjectionMatrix(){return this.viewport.viewProjectionMatrix;}getViewProjectionMatrixUncentered(){return this.viewport.viewProjectionMatrix;}getFocalDistance(){return 1;}projectFlat(e,t){return this.viewport.projectFlat(e,t);}}},"4f35dca7":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e,t){return(e%t+t)%t;};},"4f760119":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return d;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=n("d9b661b3"),s=n("fb1ec05a"),l=r._(n("755bc4f8")),u=n("f717bab4");let c={solid:0,dash:1};class d extends l.default{constructor(...e){super(...e),(0,a.default)(this,"texture",void 0),(0,a.default)(this,"updateTexture",()=>{let{createTexture2D:e}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return;}this.texture=e({data:this.iconService.getCanvas(),mag:o.gl.NEAREST,min:o.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture];});}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13});}getCommonUniformsInfo(){let{sourceColor:e,targetColor:t,textureBlend:n="normal",lineType:r="solid",dashArray:i=[10,5],forward:a=!0,lineTexture:o=!1,iconStep:l=100,segmentNumber:u=30}=this.layer.getLayerConfig(),{animateOption:d}=this.layer.getLayerConfig(),f=i;"dash"!==r&&(f=[0,0]),2===f.length&&f.push(0,0);let h=0,p=[0,0,0,0],v=[0,0,0,0];if(e&&t&&(p=(0,s.rgb2arr)(e),v=(0,s.rgb2arr)(t),h=1),this.rendererService.getDirty()){var g;null===(g=this.texture)||void 0===g||g.bind();}let m={u_animate:this.animateOption2Array(d),u_dash_array:f,u_sourceColor:p,u_targetColor:v,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:u,u_lineDir:a?1:-1,u_icon_step:l,u_line_texture:o?1:0,u_textureBlend:"normal"===n?0:1,u_blur:.9,u_line_type:c[r||"solid"],u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:h};return this.getUniformsBufferInfo(m);}initModels(){var e=this;return(0,i.default)(function*(){return e.updateTexture(),e.iconService.on("imageUpdate",e.updateTexture),e.buildModels();})();}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture);}getShaders(){return{frag:'\n#define Animate 0.0\n#define LineTexture 1.0\nuniform sampler2D u_texture;\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_dash_array;\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float segmentNumber;\n  float u_lineDir: 1.0;\n  float u_icon_step: 100;\n  float u_line_texture: 0.0;\n  float u_textureBlend;\n  float u_blur : 0.9;\n  float u_line_type: 0.0;\n  float u_time;\n  float u_linearColor: 0.0;\n};\n\nin vec4 v_color;\nin vec2 v_iconMapUV;\nin vec4 v_lineData;\n//dash\nin vec4 v_dash_array;\nin float v_distance_ratio;\n\nout vec4 outputColor;\n#pragma include "picking"\n\nvoid main() {\n  if(u_dash_array!=vec4(0.0)){\n    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {\n      discard;\n    };\n  }\n  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6\n  outputColor = v_color;\n  if(u_animate.x == Animate && u_line_texture != LineTexture) {\n      animateSpeed = u_time / u_animate.y;\n      float alpha =1.0 - fract( mod(1.0- v_lineData.b, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);\n      alpha = (alpha + u_animate.w -1.0) / u_animate.w;\n      // alpha = smoothstep(0., 1., alpha);\n      alpha = clamp(alpha, 0.0, 1.0);\n      outputColor.a *= alpha;\n  }\n\n  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE\n  if(u_line_texture == LineTexture) { // while load texture\n    float arcRadio = smoothstep( 0.0, 1.0, (v_lineData.r / segmentNumber));\n    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);\n\n    float count = v_lineData.g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF\n\n    float time = 0.0;\n    if(u_animate.x == Animate) {\n      time = u_time / u_animate.y;\n    }\n    float redioCount = arcRadio * count;\n\n    float u = fract(redioCount - time);\n    float v = v_lineData.a; // \u6A2A\u5411 v\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n\n    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);\n\n    if(u_animate.x == Animate) {\n      float currentPlane = floor(redioCount - time);\n      float textureStep = floor(count * u_animate.z);\n      float a = mod(currentPlane, textureStep);\n      if(a < textureStep - 1.0) {\n        pattern = vec4(0.0);\n      }\n    }\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      outputColor = filterColor(outputColor + pattern);\n    } else { // replace\n        pattern.a *= v_color.a;\n        if(outputColor.a <= 0.0) {\n          pattern.a = 0.0;\n        }\n        outputColor = filterColor(pattern);\n    }\n    \n  } else {\n     outputColor = filterColor(outputColor);\n  }\n}',vert:'#define Animate (0.0)\n#define LineTexture (1.0)\n\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;\nlayout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;\n\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_dash_array;\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float segmentNumber;\n  float u_lineDir: 1.0;\n  float u_icon_step: 100;\n  float u_line_texture: 0.0;\n  float u_textureBlend;\n  float u_blur : 0.9;\n  float u_line_type: 0.0;\n  float u_time;\n  float u_linearColor: 0.0;\n};\n\nout vec4 v_color;\nout vec2 v_iconMapUV;\nout vec4 v_lineData;\n//dash\nout vec4 v_dash_array;\nout float v_distance_ratio;\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat bezier3(vec3 arr, float t) {\n  float ut = 1.0 - t;\n  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;\n}\nvec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {\n  vec2 center = target - source;\n  float r = length(center);\n  float theta = atan(center.y, center.x);\n  float thetaOffset = arcThetaOffset;\n  float r2 = r / 2.0 / cos(thetaOffset);\n  float theta2 = theta + thetaOffset;\n  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);\n  if (u_lineDir == 1.0) {\n    // \u6B63\u5411\n    return mid;\n  } else {\n    // \u9006\u5411\n    // (mid + vmin)/2 = (s + t)/2\n    vec2 vmid = source + target - mid;\n    return vmid;\n  }\n  // return mid;\n}\nfloat getSegmentRatio(float index) {\n  // dash: index / (segmentNumber - 1.);\n  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));\n  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));\n  //  return index / (segmentNumber - 1.);\n}\nvec2 interpolate(vec2 source, vec2 target, float t, float arcThetaOffset) {\n  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation\n  vec2 mid = midPoint(source, target, arcThetaOffset);\n  vec3 x = vec3(source.x, mid.x, target.x);\n  vec3 y = vec3(source.y, mid.y, target.y);\n  return vec2(bezier3(x, t), bezier3(y, t));\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n   return dir_screenspace.xy * sign(offset_direction);\n}\n\nvoid main() {\n  //vs\u4E2D\u8BA1\u7B97\u6E10\u53D8\u8272\n  if (u_linearColor == 1.0) {\n    float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E\n    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex / segmentNumber);\n  } else {\n    v_color = a_Color;\n  }\n  v_color.a = v_color.a * opacity;\n\n  vec2 source_world = a_Instance.rg; // \u8D77\u59CB\u70B9\n  vec2 target_world = a_Instance.ba; // \u7EC8\u70B9\n\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n\n  // \u8BA1\u7B97 dashArray \u548C distanceRatio \u8F93\u51FA\u5230\u7247\u5143\n  float total_Distance = pixelDistance(source_world, target_world) / 2.0 * PI;\n  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;\n  v_distance_ratio = segmentIndex / segmentNumber;\n\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  float d_distance_ratio;\n\n  if(u_animate.x == Animate) {\n      d_distance_ratio = segmentIndex / segmentNumber;\n      if(u_lineDir != 1.0) {\n        d_distance_ratio = 1.0 - d_distance_ratio;\n      }\n  }\n\n  v_lineData.b = d_distance_ratio;\n\n  vec4 source = project_position(vec4(source_world, 0, 1.), a_Instance64Low.xy);\n  vec4 target = project_position(vec4(target_world, 0, 1.), a_Instance64Low.zw);\n\n  vec2 currPos = interpolate(source.xy, target.xy, segmentRatio, thetaOffset);\n  vec2 nextPos = interpolate(source.xy, target.xy, nextSegmentRatio, thetaOffset);\n\n  vec2 offset = project_pixel(\n    getExtrusionOffset((nextPos.xy - currPos.xy) * indexDir, a_Position.y)\n  );\n\n  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E\n  v_lineData.r = d_segmentIndex;\n\n  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F\n    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB\n    arcDistrance = project_pixel(arcDistrance);\n\n    v_iconMapUV = a_iconMapUV;\n\n    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8\n    float texCount = floor(arcDistrance / pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF\n    v_lineData.g = texCount;\n\n    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\n    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\n    v_lineData.a = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(currPos.xy + offset, 0, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',type:""};}buildModels(){var e=this;return(0,i.default)(function*(){e.initUniformsBuffer();let{segmentNumber:t=30}=e.layer.getLayerConfig(),{frag:n,vert:r,type:i}=e.getShaders();return[(yield e.layer.buildLayerModel({moduleName:"lineArc2d"+i,vertexShader:r,fragmentShader:n,defines:e.getDefines(),inject:e.getInject(),triangulation:u.LineArcTriangulation,depth:{enable:!1},styleOption:{segmentNumber:t}}))];})();}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:o.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:1,update:e=>{let{size:t=1}=e;return Array.isArray(t)?[t[0]]:[t];}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:o.AttributeType.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:o.gl.STATIC_DRAW,data:[],type:o.gl.FLOAT},size:4,update:(e,t,n)=>[n[3],n[4],n[5],n[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:o.AttributeType.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:o.gl.STATIC_DRAW,data:[],type:o.gl.FLOAT},size:4,update:(e,t,n)=>[(0,s.fp64LowPart)(n[3]),(0,s.fp64LowPart)(n[4]),(0,s.fp64LowPart)(n[5]),(0,s.fp64LowPart)(n[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:o.AttributeType.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:2,update:e=>{let t=this.iconService.getIconMap(),{texture:n}=e,{x:r,y:i}=t[n]||{x:0,y:0};return[r,i];}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:o.AttributeType.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:o.gl.STATIC_DRAW,data:[],type:o.gl.FLOAT},size:1,update:e=>{let{thetaOffset:t=1}=e;return[t];}}});}}},"4faea429":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("2942ce4b");},"4fcbbee8":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{getStencil:function(){return i;},getStencilMask:function(){return a;}});var r=n("d9b661b3");function i(e,t){return{enable:e,mask:255,func:{cmp:r.gl.EQUAL,ref:t?1:0,mask:1}};}function a(e){return e.maskOperation===r.MaskOperation.OR?{enable:!0,mask:255,func:{cmp:r.gl.ALWAYS,ref:1,mask:255},opFront:{fail:r.gl.KEEP,zfail:r.gl.REPLACE,zpass:r.gl.REPLACE}}:{enable:!0,mask:255,func:{cmp:e.stencilType===r.StencilType.SINGLE?r.gl.ALWAYS:0===e.stencilIndex?r.gl.ALWAYS:r.gl.LESS,ref:e.stencilType===r.StencilType.SINGLE?1:0===e.stencilIndex?2:1,mask:255},opFront:{fail:r.gl.KEEP,zfail:r.gl.REPLACE,zpass:r.gl.REPLACE}};}},50468873:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return m;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("b131ee44")),o=r._(n("f89fb776")),s=r._(n("d812e418")),l=n("d9b661b3"),u=n("3aa02964"),c=n("fb1ec05a"),d=n("71293cfd"),f=r._(n("4f2bad25")),h=r._(n("80dad29a")),p=r._(n("790e60a9"));let v=["id","mapInstance","center","token","minZoom","maxZoom","logoVisible"];!function(e,t){var n="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,r="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram);if(!n&&!r&&(t||(t=document),t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i);}var o=t.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o);}}(`img[src*='//mapapi.qq.com/web/jsapi/logo/logo_def.png'],.logo-text
{
  display: none !important;
}
`);let g={mapmove:"center_changed",camerachange:["drag","pan","rotate","tilt","zoom_changed"],zoomchange:"zoom_changed",dragging:"drag"};class m extends h.default{constructor(...e){super(...e),(0,s.default)(this,"viewport",null),(0,s.default)(this,"evtCbProxyMap",new Map),(0,s.default)(this,"handleCameraChanged",()=>{this.emit("mapchange");let e=this.map,{lng:t,lat:n}=e.getCenter(),r={center:[t(),n()],viewportHeight:e.getDiv().clientHeight,viewportWidth:e.getDiv().clientWidth,bearing:e.getHeading(),pitch:e.getTilt(),zoom:e.getZoom()-1};this.viewport.syncWithMapCamera(r),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport);});}init(){var e=this;return(0,o.default)(function*(){var t;e.viewport=new f.default;let n=e.config,{id:r,mapInstance:o,center:s=[121.30654632240122,31.25744185633306],token:l="AIzaSyDBDCfl4pvuDtaazdCog3LmhA7CQLhmcRE",minZoom:u=3,maxZoom:d=18,logoVisible:h=!0}=n,g=(0,a.default)(n,v);if(null!==(t=window.google)&&void 0!==t&&null!==(t=t.maps)&&void 0!==t&&t.Map||o||(yield p.default.load({key:l})),o)e.map=o,e.$mapContainer=e.map.getDiv(),!1===h&&e.hideLogo();else{if(!r)throw Error("No container id specified");let t=c.DOM.getContainer(r),n=new google.maps.Map(t,(0,i.default)({maxZoom:d,minZoom:u,zoomControl:!1,fullscreenControl:!1,center:new google.maps.LatLng(s[1],s[0])},g));e.map=n,e.$mapContainer=n.getDiv(),!1===h&&e.hideLogo();}google.maps.event.addListener(e.map,"drag",e.handleCameraChanged),google.maps.event.addListener(e.map,"pan",e.handleCameraChanged),google.maps.event.addListener(e.map,"rotate",e.handleCameraChanged),google.maps.event.addListener(e.map,"idle",e.handleCameraChanged),google.maps.event.addListener(e.map,"zoom_changed",e.handleCameraChanged),e.handleCameraChanged();})();}destroy(){this.map.setMap(null);}onCameraChanged(e){this.cameraChangedCallback=e;}addMarkerContainer(){}getMarkerContainer(){return this.markerContainer;}getCanvasOverlays(){return this.map.getDiv();}on(e,t){if(-1!==l.MapServiceEvent.indexOf(e))this.eventEmitter.on(e,t);else{let n=e=>{let n=this.evtCbProxyMap.get(e);if(n||this.evtCbProxyMap.set(e,n=new Map),n.get(t))return;let r=(...e)=>{!e[0]||"object"!=typeof e[0]||e[0].lngLat||e[0].lnglat||(e[0].lngLat=e[0].latlng||e[0].latLng),t(...e);};n.set(t,r),this.map.on(e,r);};Array.isArray(g[e])?g[e].forEach(t=>{n(t||e);}):n(g[e]||e);}}off(e,t){if(-1!==l.MapServiceEvent.indexOf(e)){this.eventEmitter.off(e,t);return;}let n=n=>{var r,i;let a=null===(r=this.evtCbProxyMap.get(e))||void 0===r?void 0:r.get(t);a&&(null===(i=this.evtCbProxyMap.get(n))||void 0===i||i.delete(t),this.map.off(n,a));};Array.isArray(g[e])?g[e].forEach(t=>{n(t||e);}):n(g[e]||e);}once(){throw Error("Method not implemented.");}getContainer(){return this.map.getDiv();}getSize(){return[this.map.width,this.map.height];}getMinZoom(){return this.map.transform._minZoom;}getMaxZoom(){return this.map.transform._maxZoom;}getType(){return"googlemap";}getZoom(){return this.map.getZoom();}getCenter(){let{lng:e,lat:t}=this.map.getCenter();return{lng:e(),lat:t()};}getPitch(){return this.map.getTilt();}getRotation(){return this.map.getHeading();}getBounds(){let e=this.map.getBounds(),t=null==e?void 0:e.getNorthEast(),n=null==e?void 0:e.getSouthWest();return[[n.lng(),n.lat()],[t.lng(),t.lat()]];}getMapContainer(){return this.map.getDiv();}getMapCanvasContainer(){var e;return null===(e=this.map.getDiv())||void 0===e?void 0:e.getElementsByTagName("canvas")[0];}getMapStyleConfig(){throw Error("Method not implemented.");}setBgColor(e){this.bgColor=e;}setMapStyle(e){this.map.setMapStyleId(e);}setRotation(e){this.map.setHeading(e);}zoomIn(){let e=this.map.getZoom();this.map.setZoom(e+1);}zoomOut(){let e=this.map.getZoom();this.map.setZoom(e-1);}panTo([e,t]){this.map.panTo({lat:t,lng:e});}panBy(e,t){this.map.panBy(e,t);}fitBounds(e,t){let[n,r]=e,i=new google.maps.LatLngBounds({lat:n[1],lng:n[0]},{lat:r[1],lng:r[0]});this.map.fitBounds(i,t);}setZoomAndCenter(e,[t,n]){this.map.setZoom(e),this.map.setCenter({lat:n,lng:t});}setCenter([e,t]){this.map.setCenter({lat:t,lng:e});}setPitch(e){this.map.setTilt(e);}setZoom(e){this.map.setZoom(e);}setMapStatus(e){Object.keys(e).map(t=>{switch(t){case"doubleClickZoom":this.map.setOptions({gestureHandling:e.doubleClickZoom?"auto":"none"});break;case"dragEnable":this.map.setOptions({draggable:e.dragEnable});break;case"rotateEnable":break;case"zoomEnable":this.map.setOptions({zoomControl:e.zoomEnable});break;case"keyboardEnable":case"resizeEnable":case"showIndoorMap":throw Error("Options may not be supported");}});}meterToCoord([e,t],[n,r]){let i=google.maps.geometry.spherical.computeDistanceBetween([new google.maps.LatLng(t,e),new google.maps.LatLng(r,n)]),[a,o]=this.lngLatToCoord([e,t]),[s,l]=this.lngLatToCoord([n,r]);return Math.sqrt(Math.pow(a-s,2)+Math.pow(o-l,2))/i;}pixelToLngLat([e,t]){let{lng:n,lat:r}=this.map.getCenter(),{x:i,y:a}=this.lngLatToPixel([n(),r()]),{x:o,y:s}=this.lngLatToContainer([n(),r()]),{lng:l,lat:u}=this.map.unprojectFromContainer(new google.maps.Point(o+(e-i),s+(t-a)));return this.containerToLngLat([l,u]);}lngLatToPixel([e,t]){let n=new google.maps.LatLng(t,e),r=this.map.getProjection().fromLatLngToPoint(n);return{x:r.x,y:r.y};}containerToLngLat([e,t]){var n;let r=new google.maps.Point(e,t),i=null===(n=this.map.getProjection())||void 0===n?void 0:n.fromPointToLatLng(r);return{lng:i.lng(),lat:i.lat()};}lngLatToContainer([e,t]){var n,r;let i=new google.maps.LatLng(t,e),a=null===(n=this.map.getProjection())||void 0===n||null===(r=n.fromLatLngToContainerPixel)||void 0===r?void 0:r.call(n,i);return{x:a.x,y:a.y};}lngLatToCoord([e,t]){let{x:n,y:r}=this.lngLatToPixel([e,t]);return[n,-r];}lngLatToCoords(e){return e.map(e=>Array.isArray(e[0])?this.lngLatToCoords(e):this.lngLatToCoord(e));}lngLatToMercator(e,t){let{x:n=0,y:r=0,z:i=0}=u.MercatorCoordinate.fromLngLat(e,t);return{x:n,y:r,z:i};}getModelMatrix(e,t,n,r=[1,1,1]){let i=this.viewport.projectFlat(e),a=d.mat4.create();return d.mat4.translate(a,a,d.vec3.fromValues(i[0],i[1],t)),d.mat4.scale(a,a,d.vec3.fromValues(r[0],r[1],r[2])),d.mat4.rotateX(a,a,n[0]),d.mat4.rotateY(a,a,n[1]),d.mat4.rotateZ(a,a,n[2]),a;}getCustomCoordCenter(){throw Error("Method not implemented.");}exportMap(e){let t=this.getMapCanvasContainer();return"jpg"===e?null==t?void 0:t.toDataURL("image/jpeg"):null==t?void 0:t.toDataURL("image/png");}rotateY(){throw Error("Method not implemented.");}hideLogo(){let e=this.map.getDiv();e&&c.DOM.addClass(e,"tmap-contianer--hide-logo");}}},"506db981":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=Object.prototype.hasOwnProperty,i=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&r.call(e,"index")&&(n.index=e.index,n.input=e.input),n;};},"50923b47":function(e,t,n){"use strict";var r,i,a=n("852bbaa9")._;n.d(t,"__esModule",{value:!0}),n.d(t,"createMap",{enumerable:!0,get:function(){return c;}});var o=n("c1f97feb");function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;})(e);}function l(){"use strict";l=function(){return t;};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value;},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{d({},"");}catch(e){d=function(e,t,n){return e[t]=n;};}function f(t,n,r,a){var o,s,l=Object.create((n&&n.prototype instanceof y?n:y).prototype);return i(l,"_invoke",{value:(o=new L(a||[]),s=p,function(n,i){if(s===v)throw Error("Generator is already running");if(s===g){if("throw"===n)throw i;return{value:e,done:!0};}for(o.method=n,o.arg=i;;){var a=o.delegate;if(a){var l=function t(n,r){var i=r.method,a=n.iterator[i];if(a===e)return r.delegate=null,"throw"===i&&n.iterator.return&&(r.method="return",r.arg=e,t(n,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=TypeError("The iterator does not provide a '"+i+"' method")),m;var o=h(a,n.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var s=o.arg;return s?s.done?(r[n.resultName]=s.value,r.next=n.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):s:(r.method="throw",r.arg=TypeError("iterator result is not an object"),r.delegate=null,m);}(a,o);if(l){if(l===m)continue;return l;}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(s===p)throw s=g,o.arg;o.dispatchException(o.arg);}else"return"===o.method&&o.abrupt("return",o.arg);s=v;var u=h(t,r,o);if("normal"===u.type){if(s=o.done?g:"suspendedYield",u.arg===m)continue;return{value:u.arg,done:o.done};}"throw"===u.type&&(s=g,o.method="throw",o.arg=u.arg);}})}),l;}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)};}catch(e){return{type:"throw",arg:e};}}t.wrap=f;var p="suspendedStart",v="executing",g="completed",m={};function y(){}function b(){}function _(){}var x={};d(x,o,function(){return this;});var w=Object.getPrototypeOf,E=w&&w(w(P([])));E&&E!==n&&r.call(E,o)&&(x=E);var M=_.prototype=y.prototype=Object.create(x);function S(e){["next","throw","return"].forEach(function(t){d(e,t,function(e){return this._invoke(t,e);});});}function k(e,t){var n;i(this,"_invoke",{value:function(i,a){function o(){return new t(function(n,o){!function n(i,a,o,l){var u=h(e[i],e,a);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==s(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){n("next",e,o,l);},function(e){n("throw",e,o,l);}):t.resolve(d).then(function(e){c.value=e,o(c);},function(e){return n("throw",e,o,l);});}l(u.arg);}(i,a,n,o);});}return n=n?n.then(o,o):o();}});}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function P(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n;};return a.next=a;}}throw TypeError(s(t)+" is not iterable");}return b.prototype=_,i(M,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:b,configurable:!0}),b.displayName=d(_,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,d(e,c,"GeneratorFunction")),e.prototype=Object.create(M),e;},t.awrap=function(e){return{__await:e};},S(k.prototype),d(k.prototype,u,function(){return this;}),t.AsyncIterator=k,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var o=new k(f(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then(function(e){return e.done?e.value:o.next();});},S(M),d(M,c,"Generator"),d(M,o,function(){return this;}),d(M,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e;}return e.done=!0,e;};},t.values=P,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e);},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i;}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc);}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc);}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break;}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(o);},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),m;}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n);}return i;}}throw Error("illegal catch attempt");},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),m;}},t;}function u(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value;}catch(e){n(e);return;}s.done?t(l):Promise.resolve(l).then(r,i);}var c=(r=l().mark(function e(t,r){return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("Map"!==t){e.next=2;break;}return e.abrupt("return",new o.Map(r));case 2:if("Gaode"!==t){e.next=6;break;}return e.abrupt("return",new o.GaodeMap(r));case 6:if("GaodeV1"!==t){e.next=10;break;}return e.abrupt("return",new o.GaodeMapV1(r));case 10:if("GaodeV2"!==t){e.next=12;break;}return e.abrupt("return",new o.GaodeMapV2(r));case 12:if("Tencent"!==t){e.next=14;break;}return e.abrupt("return",new o.TencentMap(r));case 14:if("Baidu"!==t){e.next=16;break;}return e.abrupt("return",new o.BaiduMap(r));case 16:return e.abrupt("return",Promise.resolve(Promise.all([n.ensure("vendors_3"),n.ensure("common"),n.ensure("vendors_0"),n.ensure("vendors_1"),n.ensure("vendors_2"),n.ensure("c1f97feb")]).then(n.dr(a,n.bind(n,"c1f97feb")))).then(function(e){return new e.Mapbox(r);}));case 17:case"end":return e.stop();}},e);}),i=function(){var e=this,t=arguments;return new Promise(function(n,i){var a=r.apply(e,t);function o(e){u(a,n,i,o,s,"next",e);}function s(e){u(a,n,i,o,s,"throw",e);}o(void 0);});},function(e,t){return i.apply(this,arguments);});},"50fa8f3d":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return f;}});var r=n("777fffbe"),i=n("655dca65"),a=n("201ec6be"),o=n("6495e7c6"),s=r._(n("4a8d04f1")),l=r._(n("1632ee7b"));function u(e){return e.x+e.vx;}function c(e){return e.y+e.vy;}function d(e){return e.z+e.vz;}function f(e){var t,n,r,f,h=1,p=1;function v(){for(var e,s,v,m,y,b,_,x,w=t.length,E=0;E<p;++E)for(e=0,s=(1===n?(0,i.binarytree)(t,u):2===n?(0,a.quadtree)(t,u,c):3===n?(0,o.octree)(t,u,c,d):null).visitAfter(g);e<w;++e)x=(_=r[(v=t[e]).index])*_,m=v.x+v.vx,n>1&&(y=v.y+v.vy),n>2&&(b=v.z+v.vz),s.visit(M);function M(e,t,r,i,a,o,s){var u=[t,r,i,a,o,s],c=u[0],d=u[1],p=u[2],g=u[n],w=u[n+1],E=u[n+2],M=e.data,S=e.r,k=_+S;if(M){if(M.index>v.index){var C=m-M.x-M.vx,A=n>1?y-M.y-M.vy:0,L=n>2?b-M.z-M.vz:0,P=C*C+A*A+L*L;P<k*k&&(0===C&&(P+=(C=(0,l.default)(f))*C),n>1&&0===A&&(P+=(A=(0,l.default)(f))*A),n>2&&0===L&&(P+=(L=(0,l.default)(f))*L),P=(k-(P=Math.sqrt(P)))/P*h,v.vx+=(C*=P)*(k=(S*=S)/(x+S)),n>1&&(v.vy+=(A*=P)*k),n>2&&(v.vz+=(L*=P)*k),M.vx-=C*(k=1-k),n>1&&(M.vy-=A*k),n>2&&(M.vz-=L*k));}return;}return c>m+k||g<m-k||n>1&&(d>y+k||w<y-k)||n>2&&(p>b+k||E<b-k);}}function g(e){if(e.data)return e.r=r[e.data.index];for(var t=e.r=0;t<Math.pow(2,n);++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r);}function m(){if(t){var n,i,a=t.length;for(n=0,r=Array(a);n<a;++n)r[(i=t[n]).index]=+e(i,n,t);}}return"function"!=typeof e&&(e=(0,s.default)(null==e?1:+e)),v.initialize=function(e,...r){t=e,f=r.find(e=>"function"==typeof e)||Math.random,n=r.find(e=>[1,2,3].includes(e))||2,m();},v.iterations=function(e){return arguments.length?(p=+e,v):p;},v.strength=function(e){return arguments.length?(h=+e,v):h;},v.radius=function(t){return arguments.length?(e="function"==typeof t?t:(0,s.default)(+t),m(),v):e;},v;}},"512c1c45":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("a12bb5bb")),i=function(e){if(!(0,r.default)(e))return[];for(var t=[],n=0;n<e.length;n++)t=t.concat(e[n]);return t;};},"5180c603":function(e,t,n){var r=n("cc74f26d"),i=Object.prototype,a=i.hasOwnProperty,o=i.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=a.call(e,s),n=e[s];try{e[s]=void 0;var r=!0;}catch(e){}var i=o.call(e);return r&&(t?e[s]=n:delete e[s]),i;};},"520d367a":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{GaodeMapStyleConfig:function(){return r;},MapboxMapStyleConfig:function(){return i;}});let r={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*qdFDSbvIalgAAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u6708\u5149\u94F6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d-vcRLzu8WIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u5E7B\u5F71\u9ED1",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*HMbRTI3XnpIAAAAAAAAAAAAADmJ7AQ/original"},fresh:{text:"\u8349\u8272\u9752",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kqaGQ5kjSiAAAAAAAAAAAAAADmJ7AQ/original"},grey:{text:"\u96C5\u58EB\u7070",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*XegrTpZIbqAAAAAAAAAAAAAADmJ7AQ/original"},graffiti:{text:"\u6D82\u9E26",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*G5g9SZ_Jg4cAAAAAAAAAAAAADmJ7AQ/original"},macaron:{text:"\u9A6C\u5361\u9F99",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*irVvQbDpQMwAAAAAAAAAAAAADmJ7AQ/original"},darkblue:{text:"\u6781\u591C\u84DD",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*lKRzQYB4iR0AAAAAAAAAAAAADmJ7AQ/original"},wine:{text:"\u9171\u7C7D",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*orY0T7QL-lwAAAAAAAAAAAAADmJ7AQ/original"}},i={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kIyZTok4Uk0AAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u4EAE",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*Z3JRQKDI-cIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u6697",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d7HCQbfmyaoAAAAAAAAAAAAADmJ7AQ/original"},satellite:{text:"\u536B\u661F",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*TytUT6pS9okAAAAAAAAAAAAADmJ7AQ/original"},outdoors:{text:"\u6237\u5916",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*hWwFSYJEFWsAAAAAAAAAAAAADmJ7AQ/original"}};},"528719b1":function(e,t,n){var r=n("81d598f3");e.exports=function(e){return"function"==typeof e?e:r;};},"52e00352":function(e,t,n){e.exports=function(e){return function(t,n,r){for(var i=-1,a=Object(t),o=r(t),s=o.length;s--;){var l=o[e?s:++i];if(!1===n(a[l],l,a))break;}return t;};};},"532ff1e0":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("6ca3854b")),a=r._(n("99ff515c"));function o(e){return(0,i.default)(e)?0:(0,a.default)(e)?e.length:Object.keys(e).length;}},"541d9c2f":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r;};},"5430cf47":function(e,t,n){var r=n("ce906886"),i=n("d8b05ce3"),a=n("aed3bcd2"),o=n("6891a51d");e.exports=function e(t,n,s,l){var u=t.children(n),c=t.node(n),d=c?c.borderLeft:void 0,f=c?c.borderRight:void 0,h={};d&&(u=r.filter(u,function(e){return e!==d&&e!==f;}));var p=i(t,u);r.forEach(p,function(n){if(t.children(n.v).length){var i=e(t,n.v,s,l);h[n.v]=i,r.has(i,"barycenter")&&(r.isUndefined(n.barycenter)?(n.barycenter=i.barycenter,n.weight=i.weight):(n.barycenter=(n.barycenter*n.weight+i.barycenter*i.weight)/(n.weight+i.weight),n.weight+=i.weight));}});var v=a(p,s);r.forEach(v,function(e){e.vs=r.flatten(e.vs.map(function(e){return h[e]?h[e].vs:e;}),!0);});var g=o(v,l);if(d&&(g.vs=r.flatten([d,g.vs,f],!0),t.predecessors(d).length)){var m=t.node(t.predecessors(d)[0]),y=t.node(t.predecessors(f)[0]);r.has(g,"barycenter")||(g.barycenter=0,g.weight=0),g.barycenter=(g.barycenter*g.weight+m.order+y.order)/(g.weight+2),g.weight+=2;}return g;};},"5457be05":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("daaa1548")),o=n("d9b661b3"),s=r._(n("755bc4f8")),l=n("f717bab4");class u extends s.default{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,POS:10,NORMAL:11});}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,a.default)((0,a.default)({},e.uniformsOption),t.uniformsOption);}getCommonUniformsInfo(){let{opacity:e,coverage:t,angle:n}=this.layer.getLayerConfig(),r={u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset],u_opacity:e||1,u_coverage:t||.9,u_angle:n||0};return this.getUniformsBufferInfo(r);}initModels(){var e=this;return(0,i.default)(function*(){return e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"heatmapGrid3d",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_POS) in vec3 a_Pos;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\n\nlayout(std140) uniform commonUniforms {\n  vec2 u_radius;\n  float u_opacity;\n  float u_coverage;\n  float u_angle;\n};\n\nout vec4 v_color;\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\n  vec2 offset = vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage);\n\n  vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u5B9E\u9645\u7684\u7ECF\u7EAC\u5EA6\n  vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));\n\n  float lightWeight = calc_lighting(project_pos);\n  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  gl_Position = project_common_position_to_clipspace(project_pos);\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'in vec4 v_color;\n\nlayout(std140) uniform commonUniforms {\n  vec2 u_radius;\n  float u_opacity;\n  float u_coverage;\n  float u_angle;\n};\n\n#pragma include "scene_uniforms"\n#pragma include "picking"\n\nout vec4 outputColor;\nvoid main() {\n  outputColor = v_color;\n  outputColor = filterColor(outputColor);\n}\n',defines:e.getDefines(),triangulation:l.PointExtrudeTriangulation,primitive:o.gl.TRIANGLES,depth:{enable:!0}}))];})();}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:o.AttributeType.Attribute,descriptor:{shaderLocation:this.attributeLocation.SIZE,name:"a_Size",buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:1,update:e=>{let{size:t}=e;return Array.isArray(t)?[t[0]]:[t];}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:o.AttributeType.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:o.gl.STATIC_DRAW,data:[],type:o.gl.FLOAT},size:3,update:(e,t,n,r,i)=>i}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:o.AttributeType.Attribute,descriptor:{name:"a_Pos",shaderLocation:this.attributeLocation.POS,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:3,update:e=>{let t=e.coordinates;return[t[0],t[1],0];}}});}}},"5474b795":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("f89fb776")),o=r._(n("ebd74549")),s=r._(n("bec2d0e3"));class l extends s.default{initTileLayer(){var e=this;return(0,a.default)(function*(){let t=e.parent.getLayerAttributeConfig(),n=e.getLayerOptions(),r=e.getSourceOption(),a=new o.default((0,i.default)({},n)).source(r.data,r.options);t&&Object.keys(t).forEach(e=>{var n,r;a[e](null===(n=t[e])||void 0===n?void 0:n.field,null===(r=t[e])||void 0===r?void 0:r.values);}),yield e.addLayer(a),e.isLoaded=!0;})();}getSourceOption(){let e=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:e.transforms}};}}},"54e1c10f":function(e,t,n){e.exports=function(e){return function(t){return null==e?void 0:e[t];};};},"559da11b":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{Timer:function(){return v;},now:function(){return h;},timer:function(){return g;},timerFlush:function(){return m;}});var r,i,a=0,o=0,s=0,l=0,u=0,c=0,d="object"==typeof performance&&performance.now?performance:Date,f="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17);};function h(){return u||(f(p),u=d.now()+c);}function p(){u=0;}function v(){this._call=this._time=this._next=null;}function g(e,t,n){var r=new v;return r.restart(e,t,n),r;}function m(){h(),++a;for(var e,t=r;t;)(e=u-t._time)>=0&&t._call.call(void 0,e),t=t._next;--a;}function y(){u=(l=d.now())+c,a=o=0;try{m();}finally{a=0,function(){for(var e,t,n=r,a=1/0;n;)n._call?(a>n._time&&(a=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:r=t);i=e,_(a);}(),u=0;}}function b(){var e=d.now(),t=e-l;t>1e3&&(c-=t,l=e);}function _(e){!a&&(o&&(o=clearTimeout(o)),e-u>24?(e<1/0&&(o=setTimeout(y,e-d.now()-c)),s&&(s=clearInterval(s))):(s||(l=d.now(),s=setInterval(b,1e3)),a=1,f(y)));}v.prototype=g.prototype={constructor:v,restart:function(e,t,n){if("function"!=typeof e)throw TypeError("callback is not a function");n=(null==n?h():+n)+(null==t?0:+t),this._next||i===this||(i?i._next=this:r=this,i=this),this._call=e,this._time=n,_();},stop:function(){this._call&&(this._call=null,this._time=1/0,_());}};},"56657ef2":function(e,t,n){var r=n("ce906886"),i=n("b192169f");function a(e,t,n,r,a,o){var s=a[t][o-1],l=i.addDummyNode(e,"border",{width:0,height:0,rank:o,borderType:t},n);a[t][o]=l,e.setParent(l,r),s&&e.setEdge(s,l,{weight:1});}e.exports=function(e){r.forEach(e.children(),function t(n){var i=e.children(n),o=e.node(n);if(i.length&&r.forEach(i,t),r.has(o,"minRank")){o.borderLeft=[],o.borderRight=[];for(var s=o.minRank,l=o.maxRank+1;s<l;++s)a(e,"borderLeft","_bl",n,o,s),a(e,"borderRight","_br",n,o,s);}});};},"56792f9b":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("a24d4a8c"),n("fcdc9f66"),n("90d6521d");},"568405a4":function(e,t,n){var r="\ud800-\udfff",i="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",a="\ud83c[\udffb-\udfff]",o="[^"+r+"]",s="(?:\ud83c[\udde6-\uddff]){2}",l="[\ud800-\udbff][\udc00-\udfff]",u="(?:"+i+"|"+a+")?",c="[\\ufe0e\\ufe0f]?",d="(?:\\u200d(?:"+[o,s,l].join("|")+")"+c+u+")*",f=RegExp(a+"(?="+a+")|(?:"+[o+i+"?",i,s,l,"["+r+"]"].join("|")+")"+(c+u+d),"g");e.exports=function(e){for(var t=f.lastIndex=0;f.test(e);)++t;return t;};},"56ad2936":function(e,t,n){var r=n("a59bcc62"),i=n("c34357ca")(function(e,t,n,i){r(e,t,n,i);});e.exports=i;},"570a7fd1":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"SimpleMapCoord",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("d812e418"));class i{constructor(e){(0,r.default)(this,"size",1e4),this.size=e||1e4;}setSize(e){this.size=e;}getSize(){return[this.size,this.size];}mercatorXfromLng(e){return(180+e)/360*this.size;}mercatorYfromLat(e){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360)*this.size;}lngFromMercatorX(e){return e/this.size*360-180;}latFromMercatorY(e){return 360/Math.PI*Math.atan(Math.exp((180-(1-e/this.size)*360)*Math.PI/180))-90;}project(e){return[this.mercatorXfromLng(e[0]),this.mercatorYfromLat(e[1])];}unproject(e){return[this.lngFromMercatorX(e[0]),this.latFromMercatorY(e[1])];}}},"5727e4c3":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"segmentQuadFactory",{enumerable:!0,get:function(){return i;}});var r=n("d1adb660");function i(e,t,n,i,a,o,s,l){var u,c=l.bbox,d=void 0===c||c,f=l.length,h=void 0===f||f,p=l.sampleSize,v=void 0===p?10:p,g="number"==typeof s,m=e,y=t,b=0,_=[m,y,0],x=[m,y],w={x:0,y:0},E=[{x:m,y:y}];g&&s<=0&&(w={x:m,y:y});for(var M=0;M<=v;M+=1){if(m=(u=function(e,t,n,r,i,a,o){var s=1-o;return{x:Math.pow(s,2)*e+2*s*o*n+Math.pow(o,2)*i,y:Math.pow(s,2)*t+2*s*o*r+Math.pow(o,2)*a};}(e,t,n,i,a,o,M/v)).x,y=u.y,d&&E.push({x:m,y:y}),h&&(b+=(0,r.distanceSquareRoot)(x,[m,y])),x=[m,y],g&&b>=s&&s>_[2]){var S=(b-s)/(b-_[2]);w={x:x[0]*(1-S)+_[0]*S,y:x[1]*(1-S)+_[1]*S};}_=[m,y,b];}return g&&s>=b&&(w={x:a,y:o}),{length:b,point:w,min:{x:Math.min.apply(null,E.map(function(e){return e.x;})),y:Math.min.apply(null,E.map(function(e){return e.y;}))},max:{x:Math.max.apply(null,E.map(function(e){return e.x;})),y:Math.max.apply(null,E.map(function(e){return e.y;}))}};}},57393183:function(e,t,n){"use strict";function r(e,t,n){return void 0===n&&(n=1e-5),e===t||Math.abs(e-t)<n;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"575c7ec2":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("441fab0c"));function i(e){var t,n=[],i=[];for(this._root&&n.push(new r.default(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var a=t.node;if(a.length){var o,s=t.x0,l=t.y0,u=t.x1,c=t.y1,d=(s+u)/2,f=(l+c)/2;(o=a[0])&&n.push(new r.default(o,s,l,d,f)),(o=a[1])&&n.push(new r.default(o,d,l,u,f)),(o=a[2])&&n.push(new r.default(o,s,f,d,c)),(o=a[3])&&n.push(new r.default(o,d,f,u,c));}i.push(t);}for(;t=i.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this;}},57634791:function(e,t,n){var r=n("09bf3f04");e.exports=function(e,t){return r(e,t,"post");};},"581b88dd":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return P;}});var r=n("777fffbe"),i=r._(n("84f4444b")),a=r._(n("bc3399ee")),o=r._(n("6f26c977")),s=r._(n("e58a514e")),l=r._(n("19fbb40b")),u=r._(n("948c20b5")),c=r._(n("1ad88e4c")),d=r._(n("ba4200d0")),f=r._(n("3292e451")),h=r._(n("dd837acc")),p=r._(n("6c166e16")),v=r._(n("ebc8c370")),g=r._(n("506db981")),m=r._(n("f070a4f1")),y=r._(n("8f2a3c48")),b=r._(n("416bfed3")),_=r._(n("e656c7f2")),x=r._(n("3cd8f8f5")),w=r._(n("3e4beef3")),E=r._(n("2774291e")),M=r._(n("33ea99bb")),S=r._(n("323ab2ac")),k="[object Arguments]",C="[object Function]",A="[object Object]",L={};L[k]=L["[object Array]"]=L["[object ArrayBuffer]"]=L["[object DataView]"]=L["[object Boolean]"]=L["[object Date]"]=L["[object Float32Array]"]=L["[object Float64Array]"]=L["[object Int8Array]"]=L["[object Int16Array]"]=L["[object Int32Array]"]=L["[object Map]"]=L["[object Number]"]=L[A]=L["[object RegExp]"]=L["[object Set]"]=L["[object String]"]=L["[object Symbol]"]=L["[object Uint8Array]"]=L["[object Uint8ClampedArray]"]=L["[object Uint16Array]"]=L["[object Uint32Array]"]=!0,L["[object Error]"]=L[C]=L["[object WeakMap]"]=!1;var P=function e(t,n,r,P,N,O){var I,R=1&n,D=2&n,z=4&n;if(r&&(I=N?r(t,P,N,O):r(t)),void 0!==I)return I;if(!(0,w.default)(t))return t;var B=(0,b.default)(t);if(B){if(I=(0,g.default)(t),!R)return(0,c.default)(t,I);}else{var U=(0,v.default)(t),F=U==C||"[object GeneratorFunction]"==U;if((0,_.default)(t))return(0,u.default)(t,R);if(U==A||U==k||F&&!N){if(I=D||F?{}:(0,y.default)(t),!R)return D?(0,f.default)(t,(0,l.default)(I,t)):(0,d.default)(t,(0,s.default)(I,t));}else{if(!L[U])return N?t:{};I=(0,m.default)(t,U,R);}}O||(O=new i.default);var j=O.get(t);if(j)return j;O.set(t,I),(0,E.default)(t)?t.forEach(function(i){I.add(e(i,n,r,i,t,O));}):(0,x.default)(t)&&t.forEach(function(i,a){I.set(a,e(i,n,r,a,t,O));});var V=z?D?p.default:h.default:D?S.default:M.default,G=B?void 0:V(t);return(0,a.default)(G||t,function(i,a){G&&(i=t[a=i]),(0,o.default)(I,a,e(i,n,r,a,t,O));}),I;};},"5861a980":function(e,t,n){var r=n("16b3b059").Uint8Array;e.exports=r;},"586e66d4":function(e,t,n){var r=n("e06645db")(n("16b3b059"),"DataView");e.exports=r;},"58b94788":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("f89fb776")),o=r._(n("86852c8f")),s=r._(n("bec2d0e3"));class l extends s.default{initTileLayer(){var e=this;return(0,a.default)(function*(){let t=e.parent.getLayerAttributeConfig(),n=e.getLayerOptions(),r=e.getSourceOption(),a=new o.default((0,i.default)({},n)).source(r.data,r.options);t&&Object.keys(t).forEach(e=>{var n,r;a[e](null===(n=t[e])||void 0===n?void 0:n.field,null===(r=t[e])||void 0===r?void 0:r.values);}),yield e.addLayer(a),e.isLoaded=!0;})();}getFeatures(e){return e?this.sourceTile.data.getTileData(e):[];}getSourceOption(){let e=this.parent.getSource(),{sourceLayer:t,featureId:n}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(t)},options:{parser:{type:"geojson",featureId:n},transforms:e.transforms}};}}},"58bc00e8":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return f;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=n("d9b661b3"),s=n("fb1ec05a"),l=r._(n("755bc4f8")),u=n("f717bab4"),c=n("6c357209");let d={solid:0,dash:1};class f extends l.default{constructor(...e){super(...e),(0,a.default)(this,"texture",void 0),(0,a.default)(this,"updateTexture",()=>{let{createTexture2D:e}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return;}this.texture=e({data:this.iconService.getCanvas(),mag:o.gl.NEAREST,min:o.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture];});}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13});}getCommonUniformsInfo(){let{sourceColor:e,targetColor:t,textureBlend:n="normal",lineType:r="solid",dashArray:i=[10,5],lineTexture:a=!1,iconStep:o=100,segmentNumber:l=30,globalArcHeight:u=10}=this.layer.getLayerConfig(),{animateOption:f}=this.layer.getLayerConfig();2===i.length&&i.push(0,0);let h=0,p=[0,0,0,0],v=[0,0,0,0];if(e&&t&&(p=(0,s.rgb2arr)(e),v=(0,s.rgb2arr)(t),h=1),this.rendererService.getDirty()){var g;null===(g=this.texture)||void 0===g||g.bind();}let m={u_animate:this.animateOption2Array(f),u_dash_array:i,u_sourceColor:p,u_targetColor:v,u_textSize:[1024,this.iconService.canvasHeight||128],u_globel:"GLOBEL"===this.mapService.version?1:0,u_globel_radius:c.EARTH_RADIUS,u_global_height:u,segmentNumber:l,u_line_type:d[r]||0,u_icon_step:o,u_line_texture:a?1:0,u_textureBlend:"normal"===n?0:1,u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:h};return this.getUniformsBufferInfo(m);}initModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),e.updateTexture(),e.iconService.on("imageUpdate",e.updateTexture),e.buildModels();})();}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture);}getShaders(){return{frag:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\n\nuniform sampler2D u_texture;\n\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_dash_array: [10.0, 5., 0, 0];\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float u_globel;\n  float u_globel_radius;\n  float u_global_height: 10;\n  float segmentNumber;\n  float u_line_type: 0.0;\n  float u_icon_step: 100;\n  float u_line_texture: 0.0;\n  float u_textureBlend;\n  float u_time;\n  float u_linearColor: 0.0;\n};\n\nin vec4 v_color;\nin vec4 v_dash_array;\nin float v_segmentIndex;\nin vec2 v_iconMapUV;\nin vec4 v_line_data;\n\nout vec4 outputColor;\n\n#pragma include "picking"\n\nvoid main() {\n  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6\n  float d_distance_ratio = v_line_data.g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B\n  outputColor = v_color;\n\n  if(u_line_type == LineTypeDash) {\n    float flag = 0.;\n    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n      flag = 1.;\n    }\n    outputColor.a *=flag;\n  }\n\n  if(u_animate.x == Animate && u_line_texture != LineTexture) {\n      animateSpeed = u_time / u_animate.y;\n      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);\n\n      alpha = (alpha + u_animate.w -1.0) / u_animate.w;\n      // alpha = smoothstep(0., 1., alpha);\n      alpha = clamp(alpha, 0.0, 1.0);\n      outputColor.a *= alpha;\n\n      // u_animate\n      // x enable\n      // y duration\n      // z interval\n      // w trailLength\n  }\n\n  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture\n    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));\n    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);\n    float count = v_line_data.b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF\n\n    float time = 0.0;\n    if(u_animate.x == Animate) {\n      time = u_time / u_animate.y;\n    }\n    float redioCount = arcRadio * count;\n\n    float u = fract(redioCount - time);\n\n    float v = v_line_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);\n\n    if(u_animate.x == Animate) {\n      float currentPlane = floor(redioCount - time);\n      float textureStep = floor(count * u_animate.z);\n      float a = mod(currentPlane, textureStep);\n      if(a < textureStep - 1.0) {\n        pattern = vec4(0.0);\n      }\n    }\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      outputColor = filterColor(outputColor + pattern);\n    } else { // replace\n        pattern.a *= v_color.a;\n        if(outputColor.a <= 0.0) {\n          pattern.a = 0.0;\n          discard;\n        } else {\n          outputColor = filterColor(pattern);\n        }\n    }\n\n  } else {\n    outputColor = filterColor(outputColor);\n  }\n}\n',vert:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\n\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;\nlayout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;\n\n\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_dash_array: [10.0, 5., 0, 0];\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float u_globel;\n  float u_globel_radius;\n  float u_global_height: 10;\n  float segmentNumber;\n  float u_line_type: 0.0;\n  float u_icon_step: 100;\n  float u_line_texture: 0.0;\n  float u_textureBlend;\n  float u_time;\n  float u_linearColor: 0.0;\n};\nout vec4 v_color;\nout vec4 v_dash_array;\nout float v_segmentIndex;\nout vec2 v_iconMapUV;\nout vec4 v_line_data;\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat maps (float value, float start1, float stop1, float start2, float stop2) {\n  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));\n}\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n  vec2 x = mix(source, target, ratio);\n  vec2 center = mix(source, target, 0.5);\n  float dSourceCenter = distance(source, center);\n  float dXCenter = distance(x, center);\n  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n  float vertex_height = paraboloid(source, target, segmentRatio);\n\n  return vec3(\n    mix(source, target, segmentRatio),\n    sqrt(max(0.0, vertex_height))\n  );\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  return dir_screenspace.xy * sign(offset_direction);\n}\n\nfloat torad(float deg) {\n  return (deg / 180.0) * acos(-1.0);\n}\n\nvec3 lglt2xyz(vec2 lnglat) {\n  float pi = 3.1415926;\n  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807\n  float lng = torad(lnglat.x) + pi / 2.0;\n  float lat = torad(lnglat.y);\n\n  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81\n  float radius = u_globel_radius;\n\n  float z = radius * cos(lat) * cos(lng);\n  float x = radius * cos(lat) * sin(lng);\n  float y = radius * sin(lat);\n  return vec3(x, y, z);\n}\n\nvoid main() {\n  //vs\u4E2D\u8BA1\u7B97\u6E10\u53D8\u8272\n  if(u_linearColor==1.0){\n    float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E\n    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);\n  }\n  else{\n    v_color = a_Color;\n  }\n  v_color.a = v_color.a * opacity;\n  vec2 source = project_position(vec4(a_Instance.rg, 0, 0), a_Instance64Low.xy).xy;\n  vec2 target = project_position(vec4(a_Instance.ba, 0, 0), a_Instance64Low.zw).xy;\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n\n  float d_distance_ratio;\n   if(u_line_type == LineTypeDash) {\n    d_distance_ratio = segmentIndex / segmentNumber;\n    float total_Distance = pixelDistance(source, target) / 2.0 * PI;\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);\n  }\n    if(u_animate.x == Animate) {\n      d_distance_ratio = segmentIndex / segmentNumber;\n  }\n  v_line_data.g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B\n\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  vec3 curr = getPos(source, target, segmentRatio);\n  vec3 next = getPos(source, target, nextSegmentRatio);\n  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);\n  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n\n\n  v_segmentIndex = a_Position.x;\n  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F\n\n    float arcDistrance = length(source - target);\n    float pixelLen =  project_pixel_texture(u_icon_step);\n    v_line_data.b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF\n\n    vec2 projectOffset = project_pixel(offset);\n    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\n    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB\n    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C\n\n    v_iconMapUV = a_iconMapUV;\n  }\n\n\n  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z * thetaOffset, 1.0));\n\n  // \u5730\u7403\u6A21\u5F0F\n  if(u_globel > 0.0) {\n    vec3 startLngLat = lglt2xyz(a_Instance.rg);\n    vec3 endLngLat = lglt2xyz(a_Instance.ba);\n    float globalRadius = length(startLngLat);\n\n    vec3 lineDir = normalize(endLngLat - startLngLat);\n    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);\n\n    // \u7EBF\u7684\u504F\u79FB\n    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;\n    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB\n    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;\n    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6\n    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;\n    // \u5730\u7403\u70B9\u4F4D\n    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;\n\n    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);\n  }\n\n\n  setPickingColor(a_PickingColor);\n}\n',type:""};}buildModels(){var e=this;return(0,i.default)(function*(){let{segmentNumber:t=30}=e.layer.getLayerConfig(),{frag:n,vert:r,type:i}=e.getShaders();return[(yield e.layer.buildLayerModel({moduleName:"lineArc3d"+i,vertexShader:r,fragmentShader:n,defines:e.getDefines(),inject:e.getInject(),triangulation:u.LineArcTriangulation,styleOption:{segmentNumber:t}}))];})();}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:o.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:1,update:e=>{let{size:t=1}=e;return Array.isArray(t)?[t[0]]:[t];}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:o.AttributeType.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:o.gl.STATIC_DRAW,data:[],type:o.gl.FLOAT},size:4,update:(e,t,n)=>[n[3],n[4],n[5],n[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:o.AttributeType.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:o.gl.STATIC_DRAW,data:[],type:o.gl.FLOAT},size:4,update:(e,t,n)=>[(0,s.fp64LowPart)(n[3]),(0,s.fp64LowPart)(n[4]),(0,s.fp64LowPart)(n[5]),(0,s.fp64LowPart)(n[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:o.AttributeType.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:2,update:e=>{let t=this.iconService.getIconMap(),{texture:n}=e,{x:r,y:i}=t[n]||{x:0,y:0};return[r,i];}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:o.AttributeType.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:o.gl.STATIC_DRAW,data:[],type:o.gl.FLOAT},size:1,update:e=>{let{thetaOffset:t=1}=e;return[t];}}});}}},"58ff8c62":function(e,t,n){var r=n("1b287fd2");e.exports=function(e){return e&&e.length?r(e):[];};},"591af935":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("a8be75a3")),a=r._(n("731b2a36")),o=(0,i.default)(a.default,"Set");},"594bd64a":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return d;}});var r=n("777fffbe"),i=r._(n("541d9c2f")),a=r._(n("f065ee2a")),o=r._(n("416bfed3")),s=r._(n("e656c7f2")),l=r._(n("8cac3abd")),u=r._(n("0916dbe6")),c=Object.prototype.hasOwnProperty,d=function(e,t){var n=(0,o.default)(e),r=!n&&(0,a.default)(e),d=!n&&!r&&(0,s.default)(e),f=!n&&!r&&!d&&(0,u.default)(e),h=n||r||d||f,p=h?(0,i.default)(e.length,String):[],v=p.length;for(var g in e)(t||c.call(e,g))&&!(h&&("length"==g||d&&("offset"==g||"parent"==g)||f&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||(0,l.default)(g,v)))&&p.push(g);return p;};},"5975dc71":function(e,t,n){e.exports=function(){this.__data__=[],this.size=0;};},"597eee67":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{AbstractRenderer:function(){return J;},AbstractRendererPlugin:function(){return Q;},CanvasEvent:function(){return i$;},DisplayObject:function(){return iL;},ElementEvent:function(){return rK;},GradientType:function(){return t_;},OffscreenCanvasCreator:function(){return rq;},Point:function(){return ec;},RenderReason:function(){return rY;},Shape:function(){return $;},UnitType:function(){return tl;},computeLinearGradient:function(){return tD;},computeRadialGradient:function(){return tz;},findClosestClipPathTarget:function(){return n7;},getOrCalculatePathTotalLength:function(){return nr;},isCSSRGB:function(){return tq;},isDisplayObject:function(){return iT;},isFillOrStrokeAffected:function(){return rt;},isPattern:function(){return tZ;},parseTransform:function(){return nE;},parsedTransformToMat4:function(){return rC;},setDOMSize:function(){return n6;}});var r,i,a,o,s,l,u,c,d,f,h,p,v,g,m,y,b,_,x,w,E,M,S,k,C,A,L=n("777fffbe"),P=L._(n("daaa1548")),N=L._(n("1316cf9d")),O=L._(n("3d495adb")),I=L._(n("6c762716")),R=L._(n("66a06515")),D=L._(n("20defe2a")),z=L._(n("82f98358")),B=L._(n("e90c9dbd")),U=n("71293cfd");n("2b312dbf");var F=n("0d884ee9"),j=L._(n("d812e418")),V=L._(n("0389e1e1")),G=n("e1f276f6"),H=L._(n("83128d43")),W=L._(n("f89fb776")),Z=L._(n("d38f5467")),q=L._(n("b131ee44"));let Y=n("7b266b54");"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==Y||"undefined"!=typeof self&&self;var X={exports:{}};r=function(){function e(e,t,n){var r=e[t];e[t]=e[n],e[n]=r;}function t(e,t){return e<t?-1:e>t?1:0;}var n=function(e){void 0===e&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear();};function r(e,t){i(e,0,e.children.length,t,e);}function i(e,t,n,r,i){i||(i=f(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=t;o<n;o++){var s=e.children[o];a(i,e.leaf?r(s):s);}return i;}function a(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e;}function o(e,t){return e.minX-t.minX;}function s(e,t){return e.minY-t.minY;}function l(e){return(e.maxX-e.minX)*(e.maxY-e.minY);}function u(e){return e.maxX-e.minX+(e.maxY-e.minY);}function c(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY;}function d(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY;}function f(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};}function h(n,r,i,a,o){for(var s=[r,i];s.length;)if(!((i=s.pop())-(r=s.pop())<=a)){var l=r+Math.ceil((i-r)/a/2)*a;(function t(n,r,i,a,o){for(;a>i;){if(a-i>600){var s=a-i+1,l=r-i+1,u=Math.log(s),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1),f=Math.max(i,Math.floor(r-l*c/s+d)),h=Math.min(a,Math.floor(r+(s-l)*c/s+d));t(n,r,f,h,o);}var p=n[r],v=i,g=a;for(e(n,i,r),o(n[a],p)>0&&e(n,i,a);v<g;){for(e(n,v,g),v++,g--;0>o(n[v],p);)v++;for(;o(n[g],p)>0;)g--;}0===o(n[i],p)?e(n,i,g):e(n,++g,a),g<=r&&(i=g+1),r<=g&&(a=g-1);}})(n,l,r||0,i||n.length-1,o||t),s.push(r,l,l,i);}}return n.prototype.all=function(){return this._all(this.data,[]);},n.prototype.search=function(e){var t=this.data,n=[];if(!d(e,t))return n;for(var r=this.toBBox,i=[];t;){for(var a=0;a<t.children.length;a++){var o=t.children[a],s=t.leaf?r(o):o;d(e,s)&&(t.leaf?n.push(o):c(e,s)?this._all(o,n):i.push(o));}t=i.pop();}return n;},n.prototype.collides=function(e){var t=this.data;if(!d(e,t))return!1;for(var n=[];t;){for(var r=0;r<t.children.length;r++){var i=t.children[r],a=t.leaf?this.toBBox(i):i;if(d(e,a)){if(t.leaf||c(e,a))return!0;n.push(i);}}t=n.pop();}return!1;},n.prototype.load=function(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(var t=0;t<e.length;t++)this.insert(e[t]);return this;}var n=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length){if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r;}this._insert(n,this.data.height-n.height-1,!0);}}else this.data=n;return this;},n.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this;},n.prototype.clear=function(){return this.data=f([]),this;},n.prototype.remove=function(e,t){if(!e)return this;for(var n,r,i,a=this.data,o=this.toBBox(e),s=[],l=[];a||s.length;){if(a||(a=s.pop(),r=s[s.length-1],n=l.pop(),i=!0),a.leaf){var u=function(e,t,n){if(!n)return t.indexOf(e);for(var r=0;r<t.length;r++)if(n(e,t[r]))return r;return -1;}(e,a.children,t);if(-1!==u){a.children.splice(u,1),s.push(a),this._condense(s);break;}}!i&&!a.leaf&&c(a,o)?(s.push(a),l.push(n),n=0,r=a,a=a.children[0]):r?(n++,a=r.children[n],i=!1):a=null;}return this;},n.prototype.toBBox=function(e){return e;},n.prototype.compareMinX=function(e,t){return e.minX-t.minX;},n.prototype.compareMinY=function(e,t){return e.minY-t.minY;},n.prototype.toJSON=function(){return this.data;},n.prototype.fromJSON=function(e){return this.data=e,this;},n.prototype._all=function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t;},n.prototype._build=function(e,t,n,i){var a,o=n-t+1,s=this._maxEntries;if(o<=s)return r(a=f(e.slice(t,n+1)),this.toBBox),a;i||(i=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,i-1))),(a=f([])).leaf=!1,a.height=i;var l=Math.ceil(o/s),u=l*Math.ceil(Math.sqrt(s));h(e,t,n,u,this.compareMinX);for(var c=t;c<=n;c+=u){var d=Math.min(c+u-1,n);h(e,c,d,l,this.compareMinY);for(var p=c;p<=d;p+=l){var v=Math.min(p+l-1,d);a.children.push(this._build(e,p,v,i-1));}}return r(a,this.toBBox),a;},n.prototype._chooseSubtree=function(e,t,n,r){for(;r.push(t),!t.leaf&&r.length-1!==n;){for(var i=1/0,a=1/0,o=void 0,s=0;s<t.children.length;s++){var u=t.children[s],c=l(u),d=(Math.max(u.maxX,e.maxX)-Math.min(u.minX,e.minX))*(Math.max(u.maxY,e.maxY)-Math.min(u.minY,e.minY))-c;d<a?(a=d,i=c<i?c:i,o=u):d===a&&c<i&&(i=c,o=u);}t=o||t.children[0];}return t;},n.prototype._insert=function(e,t,n){var r=n?e:this.toBBox(e),i=[],o=this._chooseSubtree(r,this.data,t,i);for(o.children.push(e),a(o,r);t>=0;)if(i[t].children.length>this._maxEntries)this._split(i,t),t--;else break;this._adjustParentBBoxes(r,i,t);},n.prototype._split=function(e,t){var n=e[t],i=n.children.length,a=this._minEntries;this._chooseSplitAxis(n,a,i);var o=this._chooseSplitIndex(n,a,i),s=f(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,r(n,this.toBBox),r(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s);},n.prototype._splitRoot=function(e,t){this.data=f([e,t]),this.data.height=e.height+1,this.data.leaf=!1,r(this.data,this.toBBox);},n.prototype._chooseSplitIndex=function(e,t,n){for(var r,a=1/0,o=1/0,s=t;s<=n-t;s++){var u=i(e,0,s,this.toBBox),c=i(e,s,n,this.toBBox),d=function(e,t){var n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY);return Math.max(0,Math.min(e.maxX,t.maxX)-n)*Math.max(0,Math.min(e.maxY,t.maxY)-r);}(u,c),f=l(u)+l(c);d<a?(a=d,r=s,o=f<o?f:o):d===a&&f<o&&(o=f,r=s);}return r||n-t;},n.prototype._chooseSplitAxis=function(e,t,n){var r=e.leaf?this.compareMinX:o,i=e.leaf?this.compareMinY:s;this._allDistMargin(e,t,n,r)<this._allDistMargin(e,t,n,i)&&e.children.sort(r);},n.prototype._allDistMargin=function(e,t,n,r){e.children.sort(r);for(var o=this.toBBox,s=i(e,0,t,o),l=i(e,n-t,n,o),c=u(s)+u(l),d=t;d<n-t;d++){var f=e.children[d];a(s,e.leaf?o(f):f),c+=u(s);}for(var h=n-t-1;h>=t;h--){var p=e.children[h];a(l,e.leaf?o(p):p),c+=u(l);}return c;},n.prototype._adjustParentBBoxes=function(e,t,n){for(var r=n;r>=0;r--)a(t[r],e);},n.prototype._condense=function(e){for(var t=e.length-1,n=void 0;t>=0;t--)0===e[t].children.length?t>0?(n=e[t-1].children).splice(n.indexOf(e[t]),1):this.clear():r(e[t],this.toBBox);},n;},X.exports=r(),X.exports;var $=((i={}).GROUP="g",i.FRAGMENT="fragment",i.CIRCLE="circle",i.ELLIPSE="ellipse",i.IMAGE="image",i.RECT="rect",i.LINE="line",i.POLYLINE="polyline",i.POLYGON="polygon",i.TEXT="text",i.PATH="path",i.HTML="html",i.MESH="mesh",i),K=((a={})[a.ZERO=0]="ZERO",a[a.NEGATIVE_ONE=1]="NEGATIVE_ONE",a),Q=(0,O.default)(function e(){(0,N.default)(this,e),this.plugins=[];},[{key:"addRenderingPlugin",value:function(e){this.plugins.push(e),this.context.renderingPlugins.push(e);}},{key:"removeAllRenderingPlugins",value:function(){var e=this;this.plugins.forEach(function(t){var n=e.context.renderingPlugins.indexOf(t);n>=0&&e.context.renderingPlugins.splice(n,1);});}}]),J=(0,O.default)(function e(t){(0,N.default)(this,e),this.clipSpaceNearZ=K.NEGATIVE_ONE,this.plugins=[],this.config=(0,P.default)({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0,enableRenderingOptimization:!1},t);},[{key:"registerPlugin",value:function(e){-1===this.plugins.findIndex(function(t){return t===e;})&&this.plugins.push(e);}},{key:"unregisterPlugin",value:function(e){var t=this.plugins.findIndex(function(t){return t===e;});t>-1&&this.plugins.splice(t,1);}},{key:"getPlugins",value:function(){return this.plugins;}},{key:"getPlugin",value:function(e){return this.plugins.find(function(t){return t.name===e;});}},{key:"getConfig",value:function(){return this.config;}},{key:"setConfig",value:function(e){Object.assign(this.config,e);}}]),ee=U.vec3.add,et=U.vec3.copy,en=U.vec3.max,er=U.vec3.min,ei=U.vec3.scale,ea=U.vec3.sub,eo=function(){function e(){(0,N.default)(this,e),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0];}return(0,O.default)(e,[{key:"update",value:function(e,t){et(this.center,e),et(this.halfExtents,t),ea(this.min,this.center,this.halfExtents),ee(this.max,this.center,this.halfExtents);}},{key:"setMinMax",value:function(e,t){ee(this.center,t,e),ei(this.center,this.center,.5),ea(this.halfExtents,t,e),ei(this.halfExtents,this.halfExtents,.5),et(this.min,e),et(this.max,t);}},{key:"getMin",value:function(){return this.min;}},{key:"getMax",value:function(){return this.max;}},{key:"add",value:function(t){if(!e.isEmpty(t)){if(e.isEmpty(this)){this.setMinMax(t.getMin(),t.getMax());return;}var n=this.center,r=n[0],i=n[1],a=n[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],c=r-s,d=r+s,f=i-l,h=i+l,p=a-u,v=a+u,g=t.center,m=g[0],y=g[1],b=g[2],_=t.halfExtents,x=_[0],w=_[1],E=_[2],M=m-x,S=m+x,k=y-w,C=y+w,A=b-E,L=b+E;M<c&&(c=M),S>d&&(d=S),k<f&&(f=k),C>h&&(h=C),A<p&&(p=A),L>v&&(v=L),n[0]=(c+d)*.5,n[1]=(f+h)*.5,n[2]=(p+v)*.5,o[0]=(d-c)*.5,o[1]=(h-f)*.5,o[2]=(v-p)*.5,this.min[0]=c,this.min[1]=f,this.min[2]=p,this.max[0]=d,this.max[1]=h,this.max[2]=v;}}},{key:"setFromTransformedAABB",value:function(e,t){var n=this.center,r=this.halfExtents,i=e.center,a=e.halfExtents,o=t[0],s=t[4],l=t[8],u=t[1],c=t[5],d=t[9],f=t[2],h=t[6],p=t[10],v=Math.abs(o),g=Math.abs(s),m=Math.abs(l),y=Math.abs(u),b=Math.abs(c),_=Math.abs(d),x=Math.abs(f),w=Math.abs(h),E=Math.abs(p);n[0]=t[12]+o*i[0]+s*i[1]+l*i[2],n[1]=t[13]+u*i[0]+c*i[1]+d*i[2],n[2]=t[14]+f*i[0]+h*i[1]+p*i[2],r[0]=v*a[0]+g*a[1]+m*a[2],r[1]=y*a[0]+b*a[1]+_*a[2],r[2]=x*a[0]+w*a[1]+E*a[2],ea(this.min,n,r),ee(this.max,n,r);}},{key:"intersects",value:function(e){var t=this.getMax(),n=this.getMin(),r=e.getMax(),i=e.getMin();return n[0]<=r[0]&&t[0]>=i[0]&&n[1]<=r[1]&&t[1]>=i[1]&&n[2]<=r[2]&&t[2]>=i[2];}},{key:"intersection",value:function(t){if(!this.intersects(t))return null;var n=new e,r=en([0,0,0],this.getMin(),t.getMin()),i=er([0,0,0],this.getMax(),t.getMax());return n.setMinMax(r,i),n;}},{key:"getNegativeFarPoint",value:function(e){return 273===e.pnVertexFlag?et([0,0,0],this.min):272===e.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===e.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===e.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===e.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===e.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===e.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]];}},{key:"getPositiveFarPoint",value:function(e){return 273===e.pnVertexFlag?et([0,0,0],this.max):272===e.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===e.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===e.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===e.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===e.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===e.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]];}}],[{key:"isEmpty",value:function(e){return!e||0===e.halfExtents[0]&&0===e.halfExtents[1]&&0===e.halfExtents[2];}}]);}(),es=(0,O.default)(function e(t,n){(0,N.default)(this,e),this.distance=t||0,this.normal=n||U.vec3.fromValues(0,1,0),this.updatePNVertexFlag();},[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0);}},{key:"distanceToPoint",value:function(e){return U.vec3.dot(e,this.normal)-this.distance;}},{key:"normalize",value:function(){var e=1/U.vec3.len(this.normal);U.vec3.scale(this.normal,this.normal,e),this.distance*=e;}},{key:"intersectsLine",value:function(e,t,n){var r=this.distanceToPoint(e),i=r/(r-this.distanceToPoint(t)),a=i>=0&&i<=1;return a&&n&&U.vec3.lerp(n,e,t,i),a;}}]),el=((o={})[o.OUTSIDE=4294967295]="OUTSIDE",o[o.INSIDE=0]="INSIDE",o[o.INDETERMINATE=2147483647]="INDETERMINATE",o),eu=(0,O.default)(function e(t){if((0,N.default)(this,e),this.planes=[],t)this.planes=t;else for(var n=0;n<6;n++)this.planes.push(new es);},[{key:"extractFromVPMatrix",value:function(e){var t=(0,z.default)(e,16),n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],d=t[9],f=t[10],h=t[11],p=t[12],v=t[13],g=t[14],m=t[15];U.vec3.set(this.planes[0].normal,a-n,u-o,h-c),this.planes[0].distance=m-p,U.vec3.set(this.planes[1].normal,a+n,u+o,h+c),this.planes[1].distance=m+p,U.vec3.set(this.planes[2].normal,a+r,u+s,h+d),this.planes[2].distance=m+v,U.vec3.set(this.planes[3].normal,a-r,u-s,h-d),this.planes[3].distance=m-v,U.vec3.set(this.planes[4].normal,a-i,u-l,h-f),this.planes[4].distance=m-g,U.vec3.set(this.planes[5].normal,a+i,u+l,h+f),this.planes[5].distance=m+g,this.planes.forEach(function(e){e.normalize(),e.updatePNVertexFlag();});}}]),ec=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,N.default)(this,e),this.x=0,this.y=0,this.x=t,this.y=n;}return(0,O.default)(e,[{key:"clone",value:function(){return new e(this.x,this.y);}},{key:"copyFrom",value:function(e){this.x=e.x,this.y=e.y;}}]);}(),ed=function(){function e(t,n,r,i){(0,N.default)(this,e),this.x=t,this.y=n,this.width=r,this.height=i,this.left=t,this.right=t+r,this.top=n,this.bottom=n+i;}return(0,O.default)(e,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(t){return new e(t.x,t.y,t.width,t.height);}},{key:"applyTransform",value:function(t,n){var r=U.vec4.fromValues(t.x,t.y,0,1),i=U.vec4.fromValues(t.x+t.width,t.y,0,1),a=U.vec4.fromValues(t.x,t.y+t.height,0,1),o=U.vec4.fromValues(t.x+t.width,t.y+t.height,0,1),s=U.vec4.create(),l=U.vec4.create(),u=U.vec4.create(),c=U.vec4.create();U.vec4.transformMat4(s,r,n),U.vec4.transformMat4(l,i,n),U.vec4.transformMat4(u,a,n),U.vec4.transformMat4(c,o,n);var d=Math.min(s[0],l[0],u[0],c[0]),f=Math.min(s[1],l[1],u[1],c[1]),h=Math.max(s[0],l[0],u[0],c[0]),p=Math.max(s[1],l[1],u[1],c[1]);return e.fromRect({x:d,y:f,width:h-d,height:p-f});}}]);}(),ef="Method not implemented.";function eh(e){return void 0===e?0:e>360||e<-360?e%360:e;}var ep=U.vec3.create();function ev(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return Array.isArray(e)&&3===e.length?r?U.vec3.clone(e):U.vec3.copy(ep,e):(0,F.isNumber)(e)?r?U.vec3.fromValues(e,t,n):U.vec3.set(ep,e,t,n):r?U.vec3.fromValues(e[0],e[1]||t,e[2]||n):U.vec3.set(ep,e[0],e[1]||t,e[2]||n);}var eg=Math.PI/180,em=180/Math.PI,ey=Math.PI/2;function eb(e,t){var n,r,i,a,o,s,l,u,c,d,f,h,p,v,g,m,y;return 16===t.length?(i=U.mat4.getScaling(U.vec3.create(),t),o=(a=(0,z.default)(i,3))[0],s=a[1],l=a[2],(u=Math.asin(-t[2]/o))<ey?u>-ey?(n=Math.atan2(t[6]/s,t[10]/l),r=Math.atan2(t[1]/o,t[0]/o)):(r=0,n=-Math.atan2(t[4]/s,t[5]/s)):(r=0,n=Math.atan2(t[4]/s,t[5]/s)),e[0]=n,e[1]=u,e[2]=r):(c=t[0],d=t[1],f=t[2],h=t[3],m=c*c+(p=d*d)+(v=f*f)+(g=h*h),(y=c*h-d*f)>.499995*m?(e[0]=ey,e[1]=2*Math.atan2(d,c),e[2]=0):y<-.499995*m?(e[0]=-ey,e[1]=2*Math.atan2(d,c),e[2]=0):(e[0]=Math.asin(2*(c*f-h*d)),e[1]=Math.atan2(2*(c*h+d*f),1-2*(v+g)),e[2]=Math.atan2(2*(c*d+f*h),1-2*(p+v)))),e;}function e_(e){var t=e[0],n=e[1],r=e[3],i=e[4],a=Math.sqrt(t*t+n*n),o=Math.sqrt(r*r+i*i);if(t*i-n*r<0&&(t<i?a=-a:o=-o),a){var s=1/a;t*=s,n*=s;}if(o){var l=1/o;r*=l,i*=l;}var u=Math.atan2(n,t)*em;return[e[6],e[7],a,o,u];}var ex=U.mat4.create(),ew=U.mat4.create(),eE=U.vec4.create(),eM=[U.vec3.create(),U.vec3.create(),U.vec3.create()],eT=U.vec3.create();function eS(e,t,n,r,i){e[0]=t[0]*r+n[0]*i,e[1]=t[1]*r+n[1]*i,e[2]=t[2]*r+n[2]*i;}var ek=((s={})[s.ORBITING=0]="ORBITING",s[s.EXPLORING=1]="EXPLORING",s[s.TRACKING=2]="TRACKING",s),eC=((l={})[l.DEFAULT=0]="DEFAULT",l[l.ROTATIONAL=1]="ROTATIONAL",l[l.TRANSLATIONAL=2]="TRANSLATIONAL",l[l.CINEMATIC=3]="CINEMATIC",l),eA=((u={})[u.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",u[u.PERSPECTIVE=1]="PERSPECTIVE",u),eL={UPDATED:"updated"},eP=(0,O.default)(function e(){(0,N.default)(this,e),this.clipSpaceNearZ=K.NEGATIVE_ONE,this.eventEmitter=new B.default,this.matrix=U.mat4.create(),this.right=U.vec3.fromValues(1,0,0),this.up=U.vec3.fromValues(0,1,0),this.forward=U.vec3.fromValues(0,0,1),this.position=U.vec3.fromValues(0,0,1),this.focalPoint=U.vec3.fromValues(0,0,0),this.distanceVector=U.vec3.fromValues(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=U.mat4.create(),this.projectionMatrixInverse=U.mat4.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=ek.EXPLORING,this.trackingMode=eC.DEFAULT,this.projectionMode=eA.PERSPECTIVE,this.frustum=new eu,this.orthoMatrix=U.mat4.create();},[{key:"isOrtho",value:function(){return this.projectionMode===eA.ORTHOGRAPHIC;}},{key:"getProjectionMode",value:function(){return this.projectionMode;}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix;}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse;}},{key:"getFrustum",value:function(){return this.frustum;}},{key:"getPosition",value:function(){return this.position;}},{key:"getFocalPoint",value:function(){return this.focalPoint;}},{key:"getDollyingStep",value:function(){return this.dollyingStep;}},{key:"getNear",value:function(){return this.near;}},{key:"getFar",value:function(){return this.far;}},{key:"getZoom",value:function(){return this.zoom;}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix;}},{key:"getView",value:function(){return this.view;}},{key:"setEnableUpdate",value:function(e){this.enableUpdate=e;}},{key:"setType",value:function(e,t){return this.type=e,this.type===ek.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===ek.TRACKING&&void 0!==t&&this.setTrackingMode(t),this;}},{key:"setProjectionMode",value:function(e){return this.projectionMode=e,this;}},{key:"setTrackingMode",value:function(e){if(this.type!==ek.TRACKING)throw Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=e,this;}},{key:"setWorldRotation",value:function(e){return this.rotateWorld=e,this._getAngles(),this;}},{key:"getViewTransform",value:function(){return U.mat4.invert(U.mat4.create(),this.matrix);}},{key:"getWorldTransform",value:function(){return this.matrix;}},{key:"jitterProjectionMatrix",value:function(e,t){var n=U.mat4.fromTranslation(U.mat4.create(),[e,t,0]);this.jitteredProjectionMatrix=U.mat4.multiply(U.mat4.create(),n,this.projectionMatrix);}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0;}},{key:"setMatrix",value:function(e){return this.matrix=e,this._update(),this;}},{key:"setProjectionMatrix",value:function(e){this.projectionMatrix=e;}},{key:"setFov",value:function(e){return this.setPerspective(this.near,this.far,e,this.aspect),this;}},{key:"setAspect",value:function(e){return this.setPerspective(this.near,this.far,this.fov,e),this;}},{key:"setNear",value:function(e){return this.projectionMode===eA.PERSPECTIVE?this.setPerspective(e,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,e,this.far),this;}},{key:"setFar",value:function(e){return this.projectionMode===eA.PERSPECTIVE?this.setPerspective(this.near,e,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,e),this;}},{key:"setViewOffset",value:function(e,t,n,r,i,a){return this.aspect=e/t,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.projectionMode===eA.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===eA.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"setZoom",value:function(e){return this.zoom=e,this.projectionMode===eA.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===eA.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this;}},{key:"setZoomByViewportPoint",value:function(e,t){var n=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),r=n.x,i=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(r,i),this.setFocalPoint(r,i),this.setZoom(e),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),s=o.x,l=o.y,u=U.vec3.fromValues(s-r,l-i,0),c=U.vec3.dot(u,this.right)/U.vec3.length(this.right),d=U.vec3.dot(u,this.up)/U.vec3.length(this.up),f=this.getPosition(),h=(0,z.default)(f,2),p=h[0],v=h[1],g=this.getFocalPoint(),m=(0,z.default)(g,2),y=m[0],b=m[1];return this.setPosition(p-c,v-d),this.setFocalPoint(y-c,b-d),this;}},{key:"setPerspective",value:function(e,t,n,r){this.projectionMode=eA.PERSPECTIVE,this.fov=n,this.near=e,this.far=t,this.aspect=r;var i,a=this.near*Math.tan(.5*this.fov*eg)/this.zoom,o=2*a,s=this.aspect*o,l=-.5*s;if(null!==(i=this.view)&&void 0!==i&&i.enabled){var u=this.view.fullWidth,c=this.view.fullHeight;l+=this.view.offsetX*s/u,a-=this.view.offsetY*o/c,s*=this.view.width/u,o*=this.view.height/c;}return!function(e,t,n,r,i,a,o){var s,l,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=2*a,d=n-t,f=r-i,h=o-a,p=o*a;u?(s=-o/h,l=-p/h):(s=-(o+a)/h,l=-2*p/h),e[0]=c/d,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c/f,e[6]=0,e[7]=0,e[8]=(n+t)/d,e[9]=(r+i)/f,e[10]=s,e[11]=-1,e[12]=0,e[13]=0,e[14]=l,e[15]=0;}(this.projectionMatrix,l,l+s,a-o,a,e,this.far,this.clipSpaceNearZ===K.ZERO),U.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this;}},{key:"setOrthographic",value:function(e,t,n,r,i,a){this.projectionMode=eA.ORTHOGRAPHIC,this.rright=t,this.left=e,this.top=n,this.bottom=r,this.near=i,this.far=a;var o,s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,d=u-s,f=u+s,h=c+l,p=c-l;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var v=(this.rright-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d+=v*this.view.offsetX,f=d+v*this.view.width,h-=g*this.view.offsetY,p=h-g*this.view.height;}return this.clipSpaceNearZ===K.NEGATIVE_ONE?U.mat4.ortho(this.projectionMatrix,d,f,h,p,i,a):U.mat4.orthoZO(this.projectionMatrix,d,f,h,p,i,a),U.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this;}},{key:"setPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2],r=ev(e,t,n);return this._setPosition(r),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this;}},{key:"setFocalPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],r=U.vec3.fromValues(0,1,0);if(this.focalPoint=ev(e,t,n),this.trackingMode===eC.CINEMATIC){var i=U.vec3.subtract(U.vec3.create(),this.focalPoint,this.position);e=i[0],t=i[1],n=i[2];var a=Math.asin(t/U.vec3.length(i))*em,o=90+Math.atan2(n,e)*em,s=U.mat4.create();U.mat4.rotateY(s,s,o*eg),U.mat4.rotateX(s,s,a*eg),r=U.vec3.transformMat4(U.vec3.create(),[0,1,0],s);}return U.mat4.invert(this.matrix,U.mat4.lookAt(U.mat4.create(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this;}},{key:"getDistance",value:function(){return this.distance;}},{key:"getDistanceVector",value:function(){return this.distanceVector;}},{key:"setDistance",value:function(e){if(this.distance===e||e<0)return this;this.distance=e,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var t=U.vec3.create();e=this.distance;var n=this.forward,r=this.focalPoint;return t[0]=e*n[0]+r[0],t[1]=e*n[1]+r[1],t[2]=e*n[2]+r[2],this._setPosition(t),this.triggerUpdate(),this;}},{key:"setMaxDistance",value:function(e){return this.maxDistance=e,this;}},{key:"setMinDistance",value:function(e){return this.minDistance=e,this;}},{key:"setAzimuth",value:function(e){return this.azimuth=eh(e),this.computeMatrix(),this._getAxes(),this.type===ek.ORBITING||this.type===ek.EXPLORING?this._getPosition():this.type===ek.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getAzimuth",value:function(){return this.azimuth;}},{key:"setElevation",value:function(e){return this.elevation=eh(e),this.computeMatrix(),this._getAxes(),this.type===ek.ORBITING||this.type===ek.EXPLORING?this._getPosition():this.type===ek.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getElevation",value:function(){return this.elevation;}},{key:"setRoll",value:function(e){return this.roll=eh(e),this.computeMatrix(),this._getAxes(),this.type===ek.ORBITING||this.type===ek.EXPLORING?this._getPosition():this.type===ek.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getRoll",value:function(){return this.roll;}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate();}},{key:"computeMatrix",value:function(){var e=U.quat.setAxisAngle(U.quat.create(),[0,0,1],this.roll*eg);U.mat4.identity(this.matrix);var t=U.quat.setAxisAngle(U.quat.create(),[1,0,0],(this.rotateWorld&&this.type!==ek.TRACKING||this.type===ek.TRACKING?1:-1)*this.elevation*eg),n=U.quat.setAxisAngle(U.quat.create(),[0,1,0],(this.rotateWorld&&this.type!==ek.TRACKING||this.type===ek.TRACKING?1:-1)*this.azimuth*eg),r=U.quat.multiply(U.quat.create(),n,t);r=U.quat.multiply(U.quat.create(),r,e);var i=U.mat4.fromQuat(U.mat4.create(),r);this.type===ek.ORBITING||this.type===ek.EXPLORING?(U.mat4.translate(this.matrix,this.matrix,this.focalPoint),U.mat4.multiply(this.matrix,this.matrix,i),U.mat4.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===ek.TRACKING&&(U.mat4.translate(this.matrix,this.matrix,this.position),U.mat4.multiply(this.matrix,this.matrix,i));}},{key:"_setPosition",value:function(e,t,n){this.position=ev(e,t,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix();}},{key:"_getAxes",value:function(){U.vec3.copy(this.right,ev(U.vec4.transformMat4(U.vec4.create(),[1,0,0,0],this.matrix))),U.vec3.copy(this.up,ev(U.vec4.transformMat4(U.vec4.create(),[0,1,0,0],this.matrix))),U.vec3.copy(this.forward,ev(U.vec4.transformMat4(U.vec4.create(),[0,0,1,0],this.matrix))),U.vec3.normalize(this.right,this.right),U.vec3.normalize(this.up,this.up),U.vec3.normalize(this.forward,this.forward);}},{key:"_getAngles",value:function(){var e=this.distanceVector[0],t=this.distanceVector[1],n=this.distanceVector[2],r=U.vec3.length(this.distanceVector);if(0===r){this.elevation=0,this.azimuth=0;return;}this.type===ek.TRACKING?(this.elevation=Math.asin(t/r)*em,this.azimuth=Math.atan2(-e,-n)*em):this.rotateWorld?(this.elevation=Math.asin(t/r)*em,this.azimuth=Math.atan2(-e,-n)*em):(this.elevation=-(Math.asin(t/r)*em),this.azimuth=-(Math.atan2(-e,-n)*em));}},{key:"_getPosition",value:function(){U.vec3.copy(this.position,ev(U.vec4.transformMat4(U.vec4.create(),[0,0,0,1],this.matrix))),this._getDistance();}},{key:"_getFocalPoint",value:function(){U.vec3.transformMat3(this.distanceVector,[0,0,-this.distance],U.mat3.fromMat4(U.mat3.create(),this.matrix)),U.vec3.add(this.focalPoint,this.position,this.distanceVector),this._getDistance();}},{key:"_getDistance",value:function(){this.distanceVector=U.vec3.subtract(U.vec3.create(),this.focalPoint,this.position),this.distance=U.vec3.length(this.distanceVector),this.dollyingStep=this.distance/100;}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===eA.ORTHOGRAPHIC){var e=this.position,t=U.quat.setAxisAngle(U.quat.create(),[0,0,1],-this.roll*Math.PI/180);U.mat4.fromRotationTranslationScaleOrigin(this.orthoMatrix,t,U.vec3.fromValues((this.rright-this.left)/2-e[0],(this.top-this.bottom)/2-e[1],0),U.vec3.fromValues(this.zoom,this.zoom,1),e);}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var e=this.getViewTransform(),t=U.mat4.multiply(U.mat4.create(),this.getPerspective(),e);this.getFrustum().extractFromVPMatrix(t),this.eventEmitter.emit(eL.UPDATED);}}},{key:"rotate",value:function(e,t,n){throw Error(ef);}},{key:"pan",value:function(e,t){throw Error(ef);}},{key:"dolly",value:function(e){throw Error(ef);}},{key:"createLandmark",value:function(e,t){throw Error(ef);}},{key:"gotoLandmark",value:function(e,t){throw Error(ef);}},{key:"cancelLandmarkAnimation",value:function(){throw Error(ef);}}]),eN=((c={})[c.Standard=0]="Standard",c),eO=((d={})[d.ADDED=0]="ADDED",d[d.REMOVED=1]="REMOVED",d[d.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",d),eI=U.vec3.create(),eR=U.mat4.create(),eD=U.quat.create();function ez(e){if(e.localDirtyFlag){if(0!==e.localSkew[0]||0!==e.localSkew[1]){U.mat4.fromRotationTranslationScaleOrigin(e.localTransform,e.localRotation,e.localPosition,U.vec3.fromValues(1,1,1),e.origin),(0!==e.localSkew[0]||0!==e.localSkew[1])&&(U.mat4.identity(eR),eR[4]=Math.tan(e.localSkew[0]),eR[1]=Math.tan(e.localSkew[1]),U.mat4.multiply(e.localTransform,e.localTransform,eR));var t=U.mat4.fromRotationTranslationScaleOrigin(eR,U.quat.set(eD,0,0,0,1),U.vec3.set(eI,1,1,1),e.localScale,e.origin);U.mat4.multiply(e.localTransform,e.localTransform,t);}else{var n=e.localTransform,r=e.localPosition,i=e.localRotation,a=e.localScale,o=e.origin,s=0!==r[0]||0!==r[1]||0!==r[2],l=1!==i[3]||0!==i[0]||0!==i[1]||0!==i[2],u=1!==a[0]||1!==a[1]||1!==a[2],c=0!==o[0]||0!==o[1]||0!==o[2];l||u||c?U.mat4.fromRotationTranslationScaleOrigin(n,i,r,a,o):s?U.mat4.fromTranslation(n,r):U.mat4.identity(n);}e.localDirtyFlag=!1;}}var eB={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new ed(0,0,0,0)},eU=((f={}).COORDINATE="<coordinate>",f.COLOR="<color>",f.PAINT="<paint>",f.NUMBER="<number>",f.ANGLE="<angle>",f.OPACITY_VALUE="<opacity-value>",f.SHADOW_BLUR="<shadow-blur>",f.LENGTH="<length>",f.PERCENTAGE="<percentage>",f.LENGTH_PERCENTAGE="<length> | <percentage>",f.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",f.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",f.LIST_OF_POINTS="<list-of-points>",f.PATH="<path>",f.FILTER="<filter>",f.Z_INDEX="<z-index>",f.OFFSET_DISTANCE="<offset-distance>",f.DEFINED_PATH="<defined-path>",f.MARKER="<marker>",f.TRANSFORM="<transform>",f.TRANSFORM_ORIGIN="<transform-origin>",f.TEXT="<text>",f.TEXT_TRANSFORM="<text-transform>",f);function eF(e,t,n){e.prototype=t.prototype=n,n.constructor=e;}function ej(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n;}function eV(){}var eG="\\s*([+-]?\\d+)\\s*",eH="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",eW="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",eZ=/^#([0-9a-f]{3,8})$/,eq=RegExp(`^rgb\\(${eG},${eG},${eG}\\)$`),eY=RegExp(`^rgb\\(${eW},${eW},${eW}\\)$`),eX=RegExp(`^rgba\\(${eG},${eG},${eG},${eH}\\)$`),e$=RegExp(`^rgba\\(${eW},${eW},${eW},${eH}\\)$`),eK=RegExp(`^hsl\\(${eH},${eW},${eW}\\)$`),eQ=RegExp(`^hsla\\(${eH},${eW},${eW},${eH}\\)$`),eJ={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function e0(){return this.rgb().formatHex();}function e1(){return this.rgb().formatRgb();}function e2(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=eZ.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?e3(t):3===n?new e4(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?e5(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?e5(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=eq.exec(e))?new e4(t[1],t[2],t[3],1):(t=eY.exec(e))?new e4(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=eX.exec(e))?e5(t[1],t[2],t[3],t[4]):(t=e$.exec(e))?e5(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=eK.exec(e))?tt(t[1],t[2]/100,t[3]/100,1):(t=eQ.exec(e))?tt(t[1],t[2]/100,t[3]/100,t[4]):eJ.hasOwnProperty(e)?e3(eJ[e]):"transparent"===e?new e4(NaN,NaN,NaN,0):null;}function e3(e){return new e4(e>>16&255,e>>8&255,255&e,1);}function e5(e,t,n,r){return r<=0&&(e=t=n=NaN),new e4(e,t,n,r);}function e4(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r;}function e7(){return`#${te(this.r)}${te(this.g)}${te(this.b)}`;}function e6(){let e=e8(this.opacity);return`${1===e?"rgb(":"rgba("}${e9(this.r)}, ${e9(this.g)}, ${e9(this.b)}${1===e?")":`, ${e})`}`;}function e8(e){return isNaN(e)?1:Math.max(0,Math.min(1,e));}function e9(e){return Math.max(0,Math.min(255,Math.round(e)||0));}function te(e){return((e=e9(e))<16?"0":"")+e.toString(16);}function tt(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new tr(e,t,n,r);}function tn(e){if(e instanceof tr)return new tr(e.h,e.s,e.l,e.opacity);if(e instanceof eV||(e=e2(e)),!e)return new tr;if(e instanceof tr)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=t===a?(n-r)/s+(n<r)*6:n===a?(r-t)/s+2:(t-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new tr(o,s,l,e.opacity);}function tr(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r;}function ti(e){return(e=(e||0)%360)<0?e+360:e;}function ta(e){return Math.max(0,Math.min(1,e||0));}function to(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255;}function ts(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw TypeError("Expected a function");var n=function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=t?t.apply(this,i):i[0],s=n.cache;if(s.has(o))return s.get(o);var l=e.apply(this,i);return n.cache=s.set(o,l)||s,l;};return n.cache=new(ts.Cache||Map),ts.cacheList.push(n.cache),n;}eF(eV,e2,{copy(e){return Object.assign(new this.constructor,this,e);},displayable(){return this.rgb().displayable();},hex:e0,formatHex:e0,formatHex8:function(){return this.rgb().formatHex8();},formatHsl:function(){return tn(this).formatHsl();},formatRgb:e1,toString:e1}),eF(e4,function(e,t,n,r){var i;return 1==arguments.length?((i=e)instanceof eV||(i=e2(i)),i)?new e4((i=i.rgb()).r,i.g,i.b,i.opacity):new e4:new e4(e,t,n,null==r?1:r);},ej(eV,{brighter(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new e4(this.r*e,this.g*e,this.b*e,this.opacity);},darker(e){return e=null==e?.7:Math.pow(.7,e),new e4(this.r*e,this.g*e,this.b*e,this.opacity);},rgb(){return this;},clamp(){return new e4(e9(this.r),e9(this.g),e9(this.b),e8(this.opacity));},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1;},hex:e7,formatHex:e7,formatHex8:function(){return`#${te(this.r)}${te(this.g)}${te(this.b)}${te((isNaN(this.opacity)?1:this.opacity)*255)}`;},formatRgb:e6,toString:e6})),eF(tr,function(e,t,n,r){return 1==arguments.length?tn(e):new tr(e,t,n,null==r?1:r);},ej(eV,{brighter(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new tr(this.h,this.s,this.l*e,this.opacity);},darker(e){return e=null==e?.7:Math.pow(.7,e),new tr(this.h,this.s,this.l*e,this.opacity);},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new e4(to(e>=240?e-240:e+120,i,r),to(e,i,r),to(e<120?e+240:e-120,i,r),this.opacity);},clamp(){return new tr(ti(this.h),ta(this.s),ta(this.l),e8(this.opacity));},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1;},formatHsl(){let e=e8(this.opacity);return`${1===e?"hsl(":"hsla("}${ti(this.h)}, ${100*ta(this.s)}%, ${100*ta(this.l)}%${1===e?")":`, ${e})`}`;}})),ts.Cache=Map,ts.cacheList=[],ts.clearCache=function(){ts.cacheList.forEach(function(e){return e.clear();});};var tl=((h={})[h.kUnknown=0]="kUnknown",h[h.kNumber=1]="kNumber",h[h.kPercentage=2]="kPercentage",h[h.kEms=3]="kEms",h[h.kPixels=4]="kPixels",h[h.kRems=5]="kRems",h[h.kDegrees=6]="kDegrees",h[h.kRadians=7]="kRadians",h[h.kGradians=8]="kGradians",h[h.kTurns=9]="kTurns",h[h.kMilliseconds=10]="kMilliseconds",h[h.kSeconds=11]="kSeconds",h[h.kInteger=12]="kInteger",h),tu=((p={})[p.kUNumber=0]="kUNumber",p[p.kUPercent=1]="kUPercent",p[p.kULength=2]="kULength",p[p.kUAngle=3]="kUAngle",p[p.kUTime=4]="kUTime",p[p.kUOther=5]="kUOther",p),tc=((v={})[v.kYes=0]="kYes",v[v.kNo=1]="kNo",v),td=((g={})[g.kYes=0]="kYes",g[g.kNo=1]="kNo",g),tf=[{name:"em",unit_type:tl.kEms},{name:"px",unit_type:tl.kPixels},{name:"deg",unit_type:tl.kDegrees},{name:"rad",unit_type:tl.kRadians},{name:"grad",unit_type:tl.kGradians},{name:"ms",unit_type:tl.kMilliseconds},{name:"s",unit_type:tl.kSeconds},{name:"rem",unit_type:tl.kRems},{name:"turn",unit_type:tl.kTurns}],th=((m={})[m.kUnknownType=0]="kUnknownType",m[m.kUnparsedType=1]="kUnparsedType",m[m.kKeywordType=2]="kKeywordType",m[m.kUnitType=3]="kUnitType",m[m.kSumType=4]="kSumType",m[m.kProductType=5]="kProductType",m[m.kNegateType=6]="kNegateType",m[m.kInvertType=7]="kInvertType",m[m.kMinType=8]="kMinType",m[m.kMaxType=9]="kMaxType",m[m.kClampType=10]="kClampType",m[m.kTransformType=11]="kTransformType",m[m.kPositionType=12]="kPositionType",m[m.kURLImageType=13]="kURLImageType",m[m.kColorType=14]="kColorType",m[m.kUnsupportedColorType=15]="kUnsupportedColorType",m),tp=function(e){switch(e){case tl.kNumber:case tl.kInteger:return tu.kUNumber;case tl.kPercentage:return tu.kUPercent;case tl.kPixels:return tu.kULength;case tl.kMilliseconds:case tl.kSeconds:return tu.kUTime;case tl.kDegrees:case tl.kRadians:case tl.kGradians:case tl.kTurns:return tu.kUAngle;default:return tu.kUOther;}},tv=function(e){switch(e){case tu.kUNumber:return tl.kNumber;case tu.kULength:return tl.kPixels;case tu.kUPercent:return tl.kPercentage;case tu.kUTime:return tl.kSeconds;case tu.kUAngle:return tl.kDegrees;default:return tl.kUnknown;}},tg=function(e){var t=1;switch(e){case tl.kPixels:case tl.kDegrees:case tl.kSeconds:break;case tl.kMilliseconds:t=.001;break;case tl.kRadians:t=180/Math.PI;break;case tl.kGradians:t=.9;break;case tl.kTurns:t=360;}return t;},tm=function(e){switch(e){case tl.kNumber:case tl.kInteger:break;case tl.kPercentage:return"%";case tl.kEms:return"em";case tl.kRems:return"rem";case tl.kPixels:return"px";case tl.kDegrees:return"deg";case tl.kRadians:return"rad";case tl.kGradians:return"grad";case tl.kMilliseconds:return"ms";case tl.kSeconds:return"s";case tl.kTurns:return"turn";}return"";},ty=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"toString",value:function(){return this.buildCSSText(tc.kNo,td.kNo,"");}},{key:"isNumericValue",value:function(){return this.getType()>=th.kUnitType&&this.getType()<=th.kClampType;}}],[{key:"isAngle",value:function(e){return e===tl.kDegrees||e===tl.kRadians||e===tl.kGradians||e===tl.kTurns;}},{key:"isLength",value:function(e){return e>=tl.kEms&&e<tl.kDegrees;}},{key:"isRelativeUnit",value:function(e){return e===tl.kPercentage||e===tl.kEms||e===tl.kRems;}},{key:"isTime",value:function(e){return e===tl.kSeconds||e===tl.kMilliseconds;}}]),tb=function(e){function t(e){var n;return(0,N.default)(this,t),(n=(0,R.default)(this,t)).colorSpace=e,n;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"getType",value:function(){return th.kColorType;}},{key:"to",value:function(e){return this;}}]);}(ty),t_=((y={})[y.Constant=0]="Constant",y[y.LinearGradient=1]="LinearGradient",y[y.RadialGradient=2]="RadialGradient",y),tx=function(e){function t(e,n){var r;return(0,N.default)(this,t),(r=(0,R.default)(this,t)).type=e,r.value=n,r;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"clone",value:function(){return new t(this.type,this.value);}},{key:"buildCSSText",value:function(e,t,n){return n;}},{key:"getType",value:function(){return th.kColorType;}}]);}(ty),tw=function(e){function t(e){var n;return(0,N.default)(this,t),(n=(0,R.default)(this,t)).value=e,n;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"clone",value:function(){return new t(this.value);}},{key:"getType",value:function(){return th.kKeywordType;}},{key:"buildCSSText",value:function(e,t,n){return n+this.value;}}]);}(ty),tE=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(e)?"NaN":e>0?"infinity":"-infinity")+t;},tM=function(e){return tv(tp(e));},tT=function(e){function t(e){var n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tl.kNumber;return(0,N.default)(this,t),r=(0,R.default)(this,t),i="string"==typeof a?(n=a)?"number"===n?tl.kNumber:"percent"===n||"%"===n?tl.kPercentage:tf.find(function(e){return e.name===n;}).unit_type:tl.kUnknown:a,r.unit=i,r.value=e,r;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"clone",value:function(){return new t(this.value,this.unit);}},{key:"equals",value:function(e){return this.value===e.value&&this.unit===e.unit;}},{key:"getType",value:function(){return th.kUnitType;}},{key:"convertTo",value:function(e){if(this.unit===e)return new t(this.value,this.unit);var n=tM(this.unit);if(n!==tM(e)||n===tl.kUnknown)return null;var r=tg(this.unit)/tg(e);return new t(this.value*r,e);}},{key:"buildCSSText",value:function(e,t,n){var r;switch(this.unit){case tl.kUnknown:break;case tl.kInteger:r=Number(this.value).toFixed(0);break;case tl.kNumber:case tl.kPercentage:case tl.kEms:case tl.kRems:case tl.kPixels:case tl.kDegrees:case tl.kRadians:case tl.kGradians:case tl.kMilliseconds:case tl.kSeconds:case tl.kTurns:var i=this.value,a=tm(this.unit);if(i<-999999||i>999999){var o=tm(this.unit);r=!Number.isFinite(i)||Number.isNaN(i)?tE(i,o):i+(o||"");}else r="".concat(i).concat(a);}return n+r;}}]);}(ty),tS=new tT(0,"px");new tT(1,"px");var tk=new tT(0,"deg"),tC=function(e){function t(e,n,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(0,N.default)(this,t),(i=(0,R.default)(this,t,["rgb"])).r=e,i.g=n,i.b=r,i.alpha=a,i.isNone=o,i;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"clone",value:function(){return new t(this.r,this.g,this.b,this.alpha);}},{key:"buildCSSText",value:function(e,t,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")");}}]);}(tb),tA=new tw("unset"),tL={"":tA,unset:tA,initial:new tw("initial"),inherit:new tw("inherit")},tP=new tC(0,0,0,0,!0),tN=new tC(0,0,0,0),tO=ts(function(e,t,n,r){return new tC(e,t,n,r);},function(e,t,n,r){return"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(r,")");}),tI=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tl.kNumber;return new tT(e,t);};new tT(50,"%");var tR=function(){var e={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},t="";function n(e){throw Error("".concat(t,": ").concat(e));}function r(){return i("linear-gradient",e.linearGradient,o)||i("repeating-linear-gradient",e.repeatingLinearGradient,o)||i("radial-gradient",e.radialGradient,s)||i("repeating-radial-gradient",e.repeatingRadialGradient,s)||i("conic-gradient",e.conicGradient,s);}function i(t,r,i){return a(r,function(r){var a=i();return a&&!y(e.comma)&&n("Missing comma before color stops"),{type:t,orientation:a,colorStops:f(h)};});}function a(t,r){var i=y(t);if(i){y(e.startCall)||n("Missing (");var a=r(i);return y(e.endCall)||n("Missing )"),a;}}function o(){return m("directional",e.sideOrCorner,1)||m("angular",e.angleValue,1);}function s(){var n,r,i=l();return i&&((n=[]).push(i),r=t,y(e.comma)&&((i=l())?n.push(i):t=r)),n;}function l(){var e,t,n=((e=m("shape",/^(circle)/i,0))&&(e.style=g()||u()),e||((t=m("shape",/^(ellipse)/i,0))&&(t.style=v()||u()),t));if(n)n.at=c();else{var r=u();if(r){n=r;var i=c();i&&(n.at=i);}else{var a=d();a&&(n={type:"default-radial",at:a});}}return n;}function u(){return m("extent-keyword",e.extentKeywords,1);}function c(){if(m("position",/^at/,0)){var e=d();return e||n("Missing positioning value"),e;}}function d(){var e={x:v(),y:v()};if(e.x||e.y)return{type:"position",value:e};}function f(t){var r=t(),i=[];if(r)for(i.push(r);y(e.comma);)(r=t())?i.push(r):n("One extra comma");return i;}function h(){var t=m("hex",e.hexColor,1)||a(e.rgbaColor,function(){return{type:"rgba",value:f(p)};})||a(e.rgbColor,function(){return{type:"rgb",value:f(p)};})||m("literal",e.literalColor,0);return t||n("Expected color definition"),t.length=v(),t;}function p(){return y(e.number)[1];}function v(){return m("%",e.percentageValue,1)||m("position-keyword",e.positionKeywords,1)||g();}function g(){return m("px",e.pixelValue,1)||m("em",e.emValue,1);}function m(e,t,n){var r=y(t);if(r)return{type:e,value:r[n]};}function y(e){var n=/^[\n\r\t\s]+/.exec(t);n&&b(n[0].length);var r=e.exec(t);return r&&b(r[0].length),r;}function b(e){t=t.substring(e);}return function(e){var i;return t=e,i=f(r),t.length>0&&n("Invalid input not EOF"),i;};}();function tD(e,t,n,r){var i=r.value*eg,a=0+t/2,o=0+n/2,s=Math.abs(t*Math.cos(i))+Math.abs(n*Math.sin(i));return{x1:e[0]+a-Math.cos(i)*s/2,y1:e[1]+o-Math.sin(i)*s/2,x2:e[0]+a+Math.cos(i)*s/2,y2:e[1]+o+Math.sin(i)*s/2};}function tz(e,t,n,r,i,a){var o=r.value,s=i.value;r.unit===tl.kPercentage&&(o=r.value/100*t),i.unit===tl.kPercentage&&(s=i.value/100*n);var l=Math.max((0,F.distanceSquareRoot)([0,0],[o,s]),(0,F.distanceSquareRoot)([0,n],[o,s]),(0,F.distanceSquareRoot)([t,n],[o,s]),(0,F.distanceSquareRoot)([t,0],[o,s]));return a&&(a instanceof tT?l=a.value:a instanceof tw&&("closest-side"===a.value?l=Math.min(o,t-o,s,n-s):"farthest-side"===a.value?l=Math.max(o,t-o,s,n-s):"closest-corner"===a.value&&(l=Math.min((0,F.distanceSquareRoot)([0,0],[o,s]),(0,F.distanceSquareRoot)([0,n],[o,s]),(0,F.distanceSquareRoot)([t,n],[o,s]),(0,F.distanceSquareRoot)([t,0],[o,s]))))),{x:o+e[0],y:s+e[1],r:l};}var tB=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,tU=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,tF=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,tj=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,tV={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},tG=ts(function(e){return tI("angular"===e.type?Number(e.value):tV[e.value]||0,"deg");}),tH=ts(function(e){var t=50,n=50,r="%",i="%";if((null==e?void 0:e.type)==="position"){var a=e.value,o=a.x,s=a.y;(null==o?void 0:o.type)==="position-keyword"&&("left"===o.value?t=0:"center"===o.value?t=50:"right"===o.value?t=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),(null==s?void 0:s.type)==="position-keyword"&&("left"===s.value?t=0:"center"===s.value?n=50:"right"===s.value?t=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),((null==o?void 0:o.type)==="px"||(null==o?void 0:o.type)==="%"||(null==o?void 0:o.type)==="em")&&(r=null==o?void 0:o.type,t=Number(o.value)),((null==s?void 0:s.type)==="px"||(null==s?void 0:s.type)==="%"||(null==s?void 0:s.type)==="em")&&(i=null==s?void 0:s.type,n=Number(s.value));}return{cx:tI(t,r),cy:tI(n,i)};}),tW=ts(function(e){if(e.indexOf("linear")>-1||e.indexOf("radial")>-1)return tR(e).map(function(e){var t=e.type,n=e.orientation,r=e.colorStops;!function(e){var t=e.length;e[t-1].length=null!==(a=e[t-1].length)&&void 0!==a?a:{type:"%",value:"100"},t>1&&(e[0].length=null!==(o=e[0].length)&&void 0!==o?o:{type:"%",value:"0"});for(var n=0,r=Number(e[0].length.value),i=1;i<t;i++){var a,o,s,l=null===(s=e[i].length)||void 0===s?void 0:s.value;if(!(0,F.isNil)(l)&&!(0,F.isNil)(r)){for(var u=1;u<i-n;u++)e[n+u].length={type:"%",value:"".concat(r+(Number(l)-r)*u/(i-n))};n=i,r=Number(l);}}}(r);var i=r.map(function(e){var t,n;return{offset:tI(Number(e.length.value),"%"),color:(t=e.type,n=e.value,"hex"===t?"#".concat(n):"literal"===t?n:"rgb"===t?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")"))};});if("linear-gradient"===t)return new tx(t_.LinearGradient,{angle:n?tG(n):tk,steps:i});if("radial-gradient"===t&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var a,o=tH(n[0].at),s=o.cx,l=o.cy;if(n[0].style){var u=n[0].style,c=u.type,d=u.value;"extent-keyword"===c?(tL[d]||(tL[d]=new tw(d)),a=tL[d]):a=tI(d,c);}return new tx(t_.RadialGradient,{cx:s,cy:l,size:a,steps:i});}});var t=e[0];if("("===e[1]||"("===e[2]){if("l"===t){var n=tB.exec(e);if(n){var r,i=(null===(r=n[2].match(tj))||void 0===r?void 0:r.map(function(e){return e.split(":");}))||[];return[new tx(t_.LinearGradient,{angle:tI(parseFloat(n[1]),"deg"),steps:i.map(function(e){var t=(0,z.default)(e,2),n=t[0],r=t[1];return{offset:tI(100*Number(n),"%"),color:r};})})];}}else if("r"===t){var a=function(e){var t=tU.exec(e);if(t){var n,r=(null===(n=t[4].match(tj))||void 0===n?void 0:n.map(function(e){return e.split(":");}))||[];return{cx:tI(50,"%"),cy:tI(50,"%"),steps:r.map(function(e){var t=(0,z.default)(e,2),n=t[0],r=t[1];return{offset:tI(100*Number(n),"%"),color:r};})};}return null;}(e);if(a){if(!(0,F.isString)(a))return[new tx(t_.RadialGradient,a)];e=a;}}else if("p"===t)return function(e){var t=tF.exec(e);if(t){var n=t[1],r=t[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat";}return{image:r,repetition:n};}return null;}(e);}});function tZ(e){return e&&!!e.image;}function tq(e){return e&&!(0,F.isNil)(e.r)&&!(0,F.isNil)(e.g)&&!(0,F.isNil)(e.b);}var tY=ts(function(e){if(tZ(e))return(0,P.default)({repetition:"repeat"},e);if((0,F.isNil)(e)&&(e=""),"transparent"===e)return tN;if("currentColor"===e)e="black";else if("none"===e)return tP;var t=tW(e);if(t)return t;var n=e2(e),r=[0,0,0,0];return null!==n&&(r[0]=n.r||0,r[1]=n.g||0,r[2]=n.b||0,r[3]=n.opacity),tO.apply(void 0,r);});function tX(e,t){if(tq(e)&&tq(t))return[[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],function(e){var t=e.slice();if(t[3])for(var n=0;n<3;n++)t[n]=Math.round((0,F.clamp)(t[n],0,255));return t[3]=(0,F.clamp)(t[3],0,1),"rgba(".concat(t.join(","),")");}];}function t$(e,t){if((0,F.isNil)(t))return tI(0,"px");if(isFinite(Number(t="".concat(t).trim().toLowerCase()))){if("px".search(e)>=0)return tI(Number(t),"px");if("deg".search(e)>=0)return tI(Number(t),"deg");}var n=[];t=t.replace(e,function(e){return n.push(e),"U".concat(e);});var r="U(".concat(e.source,")");return n.map(function(e){return tI(Number(t.replace(RegExp("U".concat(e),"g"),"").replace(RegExp(r,"g"),"*0")),e);})[0];}var tK=function(e){return t$(/px/g,e);},tQ=ts(tK);ts(function(e){return t$(RegExp("%","g"),e);});var tJ=function(e){return(0,F.isNumber)(e)||isFinite(Number(e))?tI(Number(e)||0,"px"):t$(RegExp("px|%|em|rem","g"),e);},t0=ts(tJ),t1=function(e){return t$(RegExp("deg|rad|grad|turn","g"),e);},t2=ts(t1);function t3(e){var t=0;return e.unit===tl.kDegrees?t=e.value:e.unit===tl.kRadians?t=Number(e.value)*em:e.unit===tl.kTurns?t=360*Number(e.value):e.value&&(t=e.value),t;}function t5(e,t){var n;return(Array.isArray(e)?n=e.map(function(e){return Number(e);}):(0,F.isString)(e)?n=e.split(" ").map(function(e){return Number(e);}):(0,F.isNumber)(e)&&(n=[e]),2===t)?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===t?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===t&&n.length%2==1?[].concat((0,I.default)(n),(0,I.default)(n)):n;}function t4(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e.unit===tl.kPixels)return Number(e.value);if(e.unit===tl.kPercentage&&n){var i=n.nodeName===$.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[t]:0)+e.value/100*i.halfExtents[t]*2;}return 0;}var t7=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function t6(e){return e.toString();}var t8=function(e){return"number"==typeof e?tI(e):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(e)?tI(Number(e)):tI(0);},t9=ts(t8);function ne(e,t){return[e,t,t6];}function nt(e,t){return function(n,r){return[n,r,function(n){return t6((0,F.clamp)(n,e,t));}];};}function nn(e,t){if(e.length===t.length)return[e,t,function(e){return e;}];}function nr(e){return 0===e.parsedStyle.d.totalLength&&(e.parsedStyle.d.totalLength=(0,F.getTotalLength)(e.parsedStyle.d.absolutePath)),e.parsedStyle.d.totalLength;}function ni(e,t){return e[0]===t[0]&&e[1]===t[1];}function na(e,t){var n=e.prePoint,r=e.currentPoint,i=e.nextPoint,a=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.acos((a+o-(Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2)))/(2*Math.sqrt(a)*Math.sqrt(o)));if(!s||0===Math.sin(s)||(0,F.isNumberEqual)(s,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));return{xExtra:t/2*(1/Math.sin(s/2))*Math.cos(s/2-(l=l>Math.PI/2?Math.PI-l:l))-t/2||0,yExtra:t/2*(1/Math.sin(s/2))*Math.cos((u=u>Math.PI/2?Math.PI-u:u)-s/2)-t/2||0};}function no(e,t){return[t[0]+(t[0]-e[0]),t[1]+(t[1]-e[1])];}ts(function(e){return(0,F.isString)(e)?e.split(" ").map(t9):e.map(t9);});var ns=function(e,t){var n=e.x*t.x+e.y*t.y,r=Math.sqrt((Math.pow(e.x,2)+Math.pow(e.y,2))*(Math.pow(t.x,2)+Math.pow(t.y,2)));return(e.x*t.y-e.y*t.x<0?-1:1)*Math.acos(n/r);},nl=function(e,t,n,r,i,a,o,s){t=Math.abs(t),n=Math.abs(n);var l=(r=(0,F.mod)(r,360))*eg;if(e.x===o.x&&e.y===o.y)return{x:e.x,y:e.y,ellipticalArcAngle:0};if(0===t||0===n)return{x:0,y:0,ellipticalArcAngle:0};var u=(e.x-o.x)/2,c=(e.y-o.y)/2,d={x:Math.cos(l)*u+Math.sin(l)*c,y:-Math.sin(l)*u+Math.cos(l)*c},f=Math.pow(d.x,2)/Math.pow(t,2)+Math.pow(d.y,2)/Math.pow(n,2);f>1&&(t*=Math.sqrt(f),n*=Math.sqrt(f));var h=(Math.pow(t,2)*Math.pow(n,2)-Math.pow(t,2)*Math.pow(d.y,2)-Math.pow(n,2)*Math.pow(d.x,2))/(Math.pow(t,2)*Math.pow(d.y,2)+Math.pow(n,2)*Math.pow(d.x,2)),p=(i!==a?1:-1)*Math.sqrt(h=h<0?0:h),v={x:p*(t*d.y/n),y:p*(-(n*d.x)/t)},g={x:Math.cos(l)*v.x-Math.sin(l)*v.y+(e.x+o.x)/2,y:Math.sin(l)*v.x+Math.cos(l)*v.y+(e.y+o.y)/2},m={x:(d.x-v.x)/t,y:(d.y-v.y)/n},y=ns({x:1,y:0},m),b=ns(m,{x:(-d.x-v.x)/t,y:(-d.y-v.y)/n});!a&&b>0?b-=2*Math.PI:a&&b<0&&(b+=2*Math.PI);var _=y+(b%=2*Math.PI)*s,x=t*Math.cos(_),w=n*Math.sin(_);return{x:Math.cos(l)*x-Math.sin(l)*w+g.x,y:Math.sin(l)*x+Math.cos(l)*w+g.y,ellipticalArcStartAngle:y,ellipticalArcEndAngle:y+b,ellipticalArcAngle:_,ellipticalArcCenter:g,resultantRx:t,resultantRy:n};};function nu(e,t){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=e.arcParams,i=r.rx,a=void 0===i?0:i,o=r.ry,s=void 0===o?0:o,l=r.xRotation,u=r.arcFlag,c=r.sweepFlag,d=nl({x:e.prePoint[0],y:e.prePoint[1]},a,s,l,!!u,!!c,{x:e.currentPoint[0],y:e.currentPoint[1]},t),f=nl({x:e.prePoint[0],y:e.prePoint[1]},a,s,l,!!u,!!c,{x:e.currentPoint[0],y:e.currentPoint[1]},n?t+.005:t-.005),h=f.x-d.x,p=f.y-d.y,v=Math.sqrt(h*h+p*p);return{x:-h/v,y:-p/v};}function nc(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]);}function nd(e,t){return nc(e)*nc(t)?(e[0]*t[0]+e[1]*t[1])/(nc(e)*nc(t)):1;}function nf(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(nd(e,t));}var nh=function(e){if(""===e||Array.isArray(e)&&0===e.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};try{t=(0,F.normalizePath)(e);}catch(n){t=(0,F.normalizePath)(""),console.error("[g]: Invalid SVG Path definition: ".concat(e));}!function(e){for(var t=0;t<e.length;t++){var n=e[t-1],r=e[t];if("M"===r[0]&&n){var i=n[0],a=[r[1],r[2]],o=void 0;"L"===i||"M"===i?o=[n[1],n[2]]:("C"===i||"A"===i||"Q"===i)&&(o=[n[n.length-2],n[n.length-1]]),o&&ni(a,o)&&(e.splice(t,1),t--);}}}(t);var t,n=function(e){for(var t=!1,n=e.length,r=0;r<n;r++){var i=e[r][0];if("C"===i||"A"===i||"Q"===i){t=!0;break;}}return t;}(t),r=function(e){for(var t=[],n=[],r=[],i=0;i<e.length;i++){var a=e[i],o=a[0];"M"===o?(r.length&&(n.push(r),r=[]),r.push([a[1],a[2]])):"Z"===o?r.length&&(t.push(r),r=[]):r.push([a[1],a[2]]);}return r.length>0&&n.push(r),{polygons:t,polylines:n};}(t),i=r.polygons,a=r.polylines,o=function(e){for(var t=[],n=null,r=null,i=null,a=0,o=e.length,s=0;s<o;s++){var l=e[s];r=e[s+1];var u=l[0],c={command:u,prePoint:n,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":i=[l[1],l[2]],a=s;break;case"A":var d=function(e,t){var n=t[1],r=t[2],i=(0,F.mod)(t[3]*eg,2*Math.PI),a=t[4],o=t[5],s=e[0],l=e[1],u=t[6],c=t[7],d=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-c)/2,f=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-c)/2,h=d*d/(n*n)+f*f/(r*r);h>1&&(n*=Math.sqrt(h),r*=Math.sqrt(h));var p=n*n*(f*f)+r*r*(d*d),v=p?Math.sqrt((n*n*(r*r)-p)/p):1;a===o&&(v*=-1),isNaN(v)&&(v=0);var g=r?v*n*f/r:0,m=n?-(v*r)*d/n:0,y=(s+u)/2+Math.cos(i)*g-Math.sin(i)*m,b=(l+c)/2+Math.sin(i)*g+Math.cos(i)*m,_=[(d-g)/n,(f-m)/r],x=[(-1*d-g)/n,(-1*f-m)/r],w=nf([1,0],_),E=nf(_,x);return -1>=nd(_,x)&&(E=Math.PI),nd(_,x)>=1&&(E=0),0===o&&E>0&&(E-=2*Math.PI),1===o&&E<0&&(E+=2*Math.PI),{cx:y,cy:b,rx:ni(e,[u,c])?0:n,ry:ni(e,[u,c])?0:r,startAngle:w,endAngle:w+E,xRotation:i,arcFlag:a,sweepFlag:o};}(n,l);c.arcParams=d;}if("Z"===u)n=i,r=e[a+1];else{var f=l.length;n=[l[f-2],l[f-1]];}r&&"Z"===r[0]&&(r=e[a],t[a]&&(t[a].prePoint=n)),c.currentPoint=n,t[a]&&ni(n,t[a].currentPoint)&&(t[a].prePoint=c.prePoint);var h=r?[r[r.length-2],r[r.length-1]]:null;c.nextPoint=h;var p=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[p[0]-n[0],p[1]-n[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]];else if("Q"===u){var v=[l[1],l[2]];c.startTangent=[p[0]-v[0],p[1]-v[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]];}else if("T"===u){var g=t[s-1],m=no(g.currentPoint,p);"Q"===g.command?(c.command="Q",c.startTangent=[p[0]-m[0],p[1]-m[1]],c.endTangent=[n[0]-m[0],n[1]-m[1]]):(c.command="TL",c.startTangent=[p[0]-n[0],p[1]-n[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]]);}else if("C"===u){var y=[l[1],l[2]],b=[l[3],l[4]];c.startTangent=[p[0]-y[0],p[1]-y[1]],c.endTangent=[n[0]-b[0],n[1]-b[1]],0===c.startTangent[0]&&0===c.startTangent[1]&&(c.startTangent=[y[0]-b[0],y[1]-b[1]]),0===c.endTangent[0]&&0===c.endTangent[1]&&(c.endTangent=[b[0]-y[0],b[1]-y[1]]);}else if("S"===u){var _=t[s-1],x=no(_.currentPoint,p),w=[l[1],l[2]];"C"===_.command?(c.command="C",c.startTangent=[p[0]-x[0],p[1]-x[1]]):(c.command="SQ",c.startTangent=[p[0]-w[0],p[1]-w[1]]),c.endTangent=[n[0]-w[0],n[1]-w[1]];}else if("A"===u){var E=nu(c,0),M=E.x,S=E.y,k=nu(c,1,!1),C=k.x,A=k.y;c.startTangent=[M,S],c.endTangent=[C,A];}t.push(c);}return t;}(t),s=function(e,t){for(var n=[],r=[],i=[],a=0;a<e.length;a++){var o=e[a],s=o.currentPoint,l=o.params,u=o.prePoint,c=void 0;switch(o.command){case"Q":c=(0,G.quadBox)(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":c=(0,G.cubicBox)(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var d=o.arcParams;c=(0,G.arcBox)(d.cx,d.cy,d.rx,d.ry,d.xRotation,d.startAngle,d.endAngle);break;default:n.push(s[0]),r.push(s[1]);}c&&(o.box=c,n.push(c.x,c.x+c.width),r.push(c.y,c.y+c.height));}n=n.filter(function(e){return!Number.isNaN(e)&&e!==1/0&&e!==-1/0;}),r=r.filter(function(e){return!Number.isNaN(e)&&e!==1/0&&e!==-1/0;});var f=(0,F.min)(n),h=(0,F.min)(r),p=(0,F.max)(n),v=(0,F.max)(r);if(0===i.length)return{x:f,y:h,width:p-f,height:v-h};for(var g=0;g<i.length;g++){var m=i[g],y=m.currentPoint;y[0]===f?f-=na(m,0).xExtra:y[0]===p&&(p+=na(m,0).xExtra),y[1]===h?h-=na(m,t).yExtra:y[1]===v&&(v+=na(m,t).yExtra);}return{x:f,y:h,width:p-f,height:v-h};}(o,0),l=s.x,u=s.y,c=s.width,d=s.height;return{absolutePath:t,hasArc:n,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(c)?c:0,height:Number.isFinite(d)?d:0}};},np=ts(nh);function nv(e){return(0,F.isString)(e)?np(e):nh(e);}function ng(e,t,n){var r=e.curve,i=t.curve;r&&0!==r.length||(r=(0,F.path2Curve)(e.absolutePath,!1),e.curve=r),i&&0!==i.length||(i=(0,F.path2Curve)(t.absolutePath,!1),t.curve=i);var a=[r,i];r.length!==i.length&&(a=(0,F.equalizeSegments)(r,i));var o=(0,F.getDrawDirection)(a[0])!==(0,F.getDrawDirection)(a[1])?(0,F.reverseCurve)(a[0]):(0,F.clonePath)(a[0]);return[o,(0,F.getRotatedCurve)(a[1],o),function(e){return e;}];}function nm(e,t){return[e.points,t.points,function(e){return e;}];}var ny=/\s*(\w+)\(([^)]*)\)/g;function nb(e){return function(t){var n=0;return e.map(function(e){return null===e?t[n++]:e;});};}function n_(e){return e;}var nx={matrix:["NNNNNN",[null,null,0,0,null,null,0,0,0,0,1,0,null,null,0,1],n_],matrix3d:["NNNNNNNNNNNNNNNN",n_],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",nb([null,null,new tT(1)]),n_],scaleX:["N",nb([null,new tT(1),new tT(1)]),nb([null,new tT(1)])],scaleY:["N",nb([new tT(1),null,new tT(1)]),nb([new tT(1),null])],scaleZ:["N",nb([new tT(1),new tT(1),null])],scale3d:["NNN",n_],skew:["Aa",null,n_],skewX:["A",null,nb([null,tk])],skewY:["A",null,nb([tk,null])],translate:["Tt",nb([null,null,tS]),n_],translateX:["T",nb([null,tS,tS]),nb([null,tS])],translateY:["T",nb([tS,null,tS]),nb([tS,null])],translateZ:["L",nb([tS,tS,null])],translate3d:["TTL",n_]};function nw(e){for(var t=[],n=e.length,r=0;r<n;r++){var i=e[r],a=i[0],o=i.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!nx[a])return[];var s=o.map(function(e){return tI(e);});t.push({t:a,d:s});}return t;}function nE(e){if(Array.isArray(e))return nw(e);if("none"===(e=(e||"none").trim()))return[];var t,n=[],r=0;for(ny.lastIndex=0;(t=ny.exec(e))&&t.index===r;){r=t.index+t[0].length;var i=t[1],a=nx[i];if(!a)break;var o=t[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],d=s[u],f=void 0;if(void 0===(f=c?({A:function(e){return"0"===e.trim()?tk:t2(e);},N:t9,T:t0,L:tQ})[d.toUpperCase()](c):({a:tk,n:l[0],t:tS})[d]))return[];l.push(f);}if(n.push({t:i,d:l}),ny.lastIndex===e.length)return n;}return[];}function nM(e){if(Array.isArray(e))return nw(e);if("none"===(e=(e||"none").trim()))return[];var t,n=[],r=0;for(ny.lastIndex=0;(t=ny.exec(e))&&t.index===r;){r=t.index+t[0].length;var i=t[1],a=nx[i];if(!a)break;var o=t[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],d=s[u],f=void 0;if(void 0===(f=c?({A:function(e){return"0"===e.trim()?tk:t1(e);},N:t8,T:tJ,L:tK})[d.toUpperCase()](c):({a:tk,n:l[0],t:tS})[d]))return[];l.push(f);}if(n.push({t:i,d:l}),ny.lastIndex===e.length)return n;}return[];}function nT(e){switch(e.t){case"rotateX":return[1,0,0,0,0,Math.cos(i=t3(e.d[0])*eg),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return[Math.cos(i=t3(e.d[0])*eg),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return[Math.cos(i=t3(e.d[0])*eg),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":t=e.d[0].value,n=e.d[1].value,r=e.d[2].value,i=t3(e.d[3])*eg;var t,n,r,i,a=t*t+n*n+r*r;if(0===a)t=1,n=0,r=0;else if(1!==a){var o=Math.sqrt(a);t/=o,n/=o,r/=o;}var s=Math.sin(i/2),l=s*Math.cos(i/2),u=s*s;return[1-2*(n*n+r*r)*u,2*(t*n*u+r*l),2*(t*r*u-n*l),0,2*(t*n*u-r*l),1-2*(t*t+r*r)*u,2*(n*r*u+t*l),0,2*(t*r*u+n*l),2*(n*r*u-t*l),1-2*(t*t+n*n)*u,0,0,0,0,1];case"scale":return[e.d[0].value,0,0,0,0,e.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[e.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,e.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,e.d[0].value,0,0,0,0,1];case"scale3d":return[e.d[0].value,0,0,0,0,e.d[1].value,0,0,0,0,e.d[2].value,0,0,0,0,1];case"skew":var c=t3(e.d[0])*eg;return[1,Math.tan(t3(e.d[1])*eg),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return[1,0,0,0,Math.tan(i=t3(e.d[0])*eg),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return[1,Math.tan(i=t3(e.d[0])*eg),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,t=t4(e.d[0],0,null)||0,n=t4(e.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,t=t4(e.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=t4(e.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r=t4(e.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,t=t4(e.d[0],0,null)||0,n=t4(e.d[1],0,null)||0,r=t4(e.d[2],0,null)||0,1];case"perspective":var d=t4(e.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,d?-1/d:0,0,0,0,1];case"matrix":return[e.d[0].value,e.d[1].value,0,0,e.d[2].value,e.d[3].value,0,0,0,0,1,0,e.d[4].value,e.d[5].value,0,1];case"matrix3d":return e.d.map(function(e){return e.value;});}}function nS(e,t){return[e[0]*t[0]+e[4]*t[1]+e[8]*t[2]+e[12]*t[3],e[1]*t[0]+e[5]*t[1]+e[9]*t[2]+e[13]*t[3],e[2]*t[0]+e[6]*t[1]+e[10]*t[2]+e[14]*t[3],e[3]*t[0]+e[7]*t[1]+e[11]*t[2]+e[15]*t[3],e[0]*t[4]+e[4]*t[5]+e[8]*t[6]+e[12]*t[7],e[1]*t[4]+e[5]*t[5]+e[9]*t[6]+e[13]*t[7],e[2]*t[4]+e[6]*t[5]+e[10]*t[6]+e[14]*t[7],e[3]*t[4]+e[7]*t[5]+e[11]*t[6]+e[15]*t[7],e[0]*t[8]+e[4]*t[9]+e[8]*t[10]+e[12]*t[11],e[1]*t[8]+e[5]*t[9]+e[9]*t[10]+e[13]*t[11],e[2]*t[8]+e[6]*t[9]+e[10]*t[10]+e[14]*t[11],e[3]*t[8]+e[7]*t[9]+e[11]*t[10]+e[15]*t[11],e[0]*t[12]+e[4]*t[13]+e[8]*t[14]+e[12]*t[15],e[1]*t[12]+e[5]*t[13]+e[9]*t[14]+e[13]*t[15],e[2]*t[12]+e[6]*t[13]+e[10]*t[14]+e[14]*t[15],e[3]*t[12]+e[7]*t[13]+e[11]*t[14]+e[15]*t[15]];}function nk(e){var t=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return!function(e,t,n,r,i,a){if(!(!function(e,t){var n=t[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)e[i]=t[i]*r;return!0;}(ex,e)||(U.mat4.copy(ew,ex),ew[3]=0,ew[7]=0,ew[11]=0,ew[15]=1,1e-8>Math.abs(U.mat4.determinant(ew))))){var o=ex[3],s=ex[7],l=ex[11],u=ex[12],c=ex[13],d=ex[14],f=ex[15];if(0!==o||0!==s||0!==l){if(eE[0]=o,eE[1]=s,eE[2]=l,eE[3]=f,!U.mat4.invert(ew,ew))return;U.mat4.transpose(ew,ew),U.vec4.transformMat4(i,eE,ew);}else i[0]=i[1]=i[2]=0,i[3]=1;if(t[0]=u,t[1]=c,t[2]=d,eM[0][0]=ex[0],eM[0][1]=ex[1],eM[0][2]=ex[2],eM[1][0]=ex[4],eM[1][1]=ex[5],eM[1][2]=ex[6],eM[2][0]=ex[8],eM[2][1]=ex[9],eM[2][2]=ex[10],n[0]=U.vec3.length(eM[0]),U.vec3.normalize(eM[0],eM[0]),r[0]=U.vec3.dot(eM[0],eM[1]),eS(eM[1],eM[1],eM[0],1,-r[0]),n[1]=U.vec3.length(eM[1]),U.vec3.normalize(eM[1],eM[1]),r[0]/=n[1],r[1]=U.vec3.dot(eM[0],eM[2]),eS(eM[2],eM[2],eM[0],1,-r[1]),r[2]=U.vec3.dot(eM[1],eM[2]),eS(eM[2],eM[2],eM[1],1,-r[2]),n[2]=U.vec3.length(eM[2]),U.vec3.normalize(eM[2],eM[2]),r[1]/=n[2],r[2]/=n[2],U.vec3.cross(eT,eM[1],eM[2]),0>U.vec3.dot(eM[0],eT))for(var h=0;h<3;h++)n[h]*=-1,eM[h][0]*=-1,eM[h][1]*=-1,eM[h][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+eM[0][0]-eM[1][1]-eM[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-eM[0][0]+eM[1][1]-eM[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-eM[0][0]-eM[1][1]+eM[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+eM[0][0]+eM[1][1]+eM[2][2],0)),eM[2][1]>eM[1][2]&&(a[0]=-a[0]),eM[0][2]>eM[2][0]&&(a[1]=-a[1]),eM[1][0]>eM[0][1]&&(a[2]=-a[2]);}}(0===e.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:e.map(nT).reduce(nS),t,n,r,i,a),[[t,n,r,a,i]];}var nC=function(){function e(e,t){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var a=0;a<4;a++)n[r][i]+=t[r][a]*e[a][i];return n;}return function(t,n,r,i,a){for(var o,s=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=0;l<4;l++)s[l][3]=a[l];for(var u=0;u<3;u++)for(var c=0;c<3;c++)s[3][u]+=t[c]*s[c][u];var d=i[0],f=i[1],h=i[2],p=i[3],v=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];v[0][0]=1-2*(f*f+h*h),v[0][1]=2*(d*f-h*p),v[0][2]=2*(d*h+f*p),v[1][0]=2*(d*f+h*p),v[1][1]=1-2*(d*d+h*h),v[1][2]=2*(f*h-d*p),v[2][0]=2*(d*h-f*p),v[2][1]=2*(f*h+d*p),v[2][2]=1-2*(d*d+f*f),s=e(s,v);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];r[2]&&(g[2][1]=r[2],s=e(s,g)),r[1]&&(g[2][1]=0,g[2][0]=r[0],s=e(s,g)),r[0]&&(g[2][0]=0,g[1][0]=r[0],s=e(s,g));for(var m=0;m<3;m++)for(var y=0;y<3;y++)s[m][y]*=n[m];return 0===(o=s)[0][2]&&0===o[0][3]&&0===o[1][2]&&0===o[1][3]&&0===o[2][0]&&0===o[2][1]&&1===o[2][2]&&0===o[2][3]&&0===o[3][2]&&1===o[3][3]?[s[0][0],s[0][1],s[1][0],s[1][1],s[3][0],s[3][1]]:s[0].concat(s[1],s[2],s[3]);};}();function nA(e){return e.toFixed(6).replace(".000000","");}function nL(e,t){var n,r;return(e.decompositionPair!==t&&(e.decompositionPair=t,n=nk(e)),t.decompositionPair!==e&&(t.decompositionPair=e,r=nk(t)),null===n[0]||null===r[0])?[[!1],[!0],function(n){return n?t[0].d:e[0].d;}]:(n[0].push(0),r[0].push(1),[n,r,function(e){var t=function(e,t,n){var r=function(e,t){for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n;}(e,t);r=(0,F.clamp)(r,-1,1);var i=[];if(1===r)i=e;else for(var a=Math.acos(r),o=1*Math.sin(n*a)/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(e[s]*(Math.cos(n*a)-r*o)+t[s]*o);return i;}(n[0][3],r[0][3],e[5]);return nC(e[0],e[1],e[2],t,e[4]).map(nA).join(",");}]);}function nP(e){return e.replace(/[XY]/,"");}function nN(e){return e.replace(/(X|Y|Z|3d)?$/,"3d");}function nO(e,t,n){var r=!1;if(!e.length||!t.length){e.length||(r=!0,e=t,t=[]);for(var i=0;i<e.length;i++)!function(){var n=e[i],r=n.t,a=n.d,o="scale"===r.substring(0,5)?1:0;t.push({t:r,d:a.map(function(e){return"number"==typeof e?tI(o):tI(o,e.unit);})});}();}var a=[],o=[],s=[];if(e.length!==t.length){var l=nL(e,t);a=[l[0]],o=[l[1]],s=[["matrix",[l[2]]]];}else for(var u=0;u<e.length;u++){var c=e[u].t,d=t[u].t,f=e[u].d,h=t[u].d,p=nx[c],v=nx[d],g=void 0;if("perspective"===c&&"perspective"===d||("matrix"===c||"matrix3d"===c)&&("matrix"===d||"matrix3d"===d)){var m=nL([e[u]],[t[u]]);a.push(m[0]),o.push(m[1]),s.push(["matrix",[m[2]]]);continue;}if(c===d)g=c;else if(p[2]&&v[2]&&nP(c)===nP(d))g=nP(c),f=p[2](f),h=v[2](h);else if(p[1]&&v[1]&&nN(c)===nN(d))g=nN(c),f=p[1](f),h=v[1](h);else{var y=nL(e,t);a=[y[0]],o=[y[1]],s=[["matrix",[y[2]]]];break;}for(var b=[],_=[],x=[],w=0;w<f.length;w++){var E=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=e.value||0,s=t.value||0,l=tM(e.unit),u=e.convertTo(l),c=t.convertTo(l);return u&&c?(o=u.value,s=c.value,a=tm(e.unit)):(tT.isLength(e.unit)||tT.isLength(t.unit))&&(o=t4(e,i,n),s=t4(t,i,n),a="px"),[o,s,function(e){return r&&(e=Math.max(e,0)),e+a;}];}(f[w],h[w],n,!1,w);b[w]=E[0],_[w]=E[1],x.push(E[2]);}a.push(b),o.push(_),s.push([g,x]);}if(r){var M=a;a=o,o=M;}return[a,o,function(e){return e.map(function(e,t){var n=e.map(function(e,n){return s[t][1][n](e);}).join(",");return"matrix"===s[t][0]&&16===n.split(",").length&&(s[t][0]="matrix3d"),"matrix3d"===s[t][0]&&6===n.split(",").length&&(s[t][0]="matrix"),"".concat(s[t][0],"(").concat(n,")");}).join(" ");}];}var nI=ts(function(e){if((0,F.isString)(e)){if("text-anchor"===e)return[tI(0,"px"),tI(0,"px")];var t=e.split(" ");return(1===t.length&&("top"===t[0]||"bottom"===t[0]?(t[1]=t[0],t[0]="center"):t[1]="center"),2!==t.length)?null:[t0(nR(t[0])),t0(nR(t[1]))];}return[tI(e[0]||0,"px"),tI(e[1]||0,"px")];});function nR(e){return"center"===e?"50%":"left"===e||"top"===e?"0%":"right"===e||"bottom"===e?"100%":e;}var nD=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:eU.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:eU.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:eU.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:eU.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:eU.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:eU.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:eU.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:eU.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:eU.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:eU.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:eU.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:eU.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:eU.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:eU.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:eU.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:eU.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:eU.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:eU.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:eU.FILTER},{n:"clipPath",syntax:eU.DEFINED_PATH},{n:"textPath",syntax:eU.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:eU.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:eU.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:eU.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:eU.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:eU.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:eU.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:eU.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:eU.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:eU.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:eU.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:eU.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:eU.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:eU.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:eU.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:eU.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:eU.COORDINATE},{n:"y1",int:!0,l:!0,syntax:eU.COORDINATE},{n:"z1",int:!0,l:!0,syntax:eU.COORDINATE},{n:"x2",int:!0,l:!0,syntax:eU.COORDINATE},{n:"y2",int:!0,l:!0,syntax:eU.COORDINATE},{n:"z2",int:!0,l:!0,syntax:eU.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:eU.PATH,p:50},{n:"points",int:!0,l:!0,syntax:eU.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:eU.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:eU.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:eU.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:eU.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:eU.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:eU.NUMBER,d:function(e){return e===$.PATH||e===$.POLYGON||e===$.POLYLINE?"4":"10";}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:eU.MARKER},{n:"markerEnd",syntax:eU.MARKER},{n:"markerMid",syntax:eU.MARKER},{n:"markerStartOffset",syntax:eU.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:eU.LENGTH,l:!0,int:!0,d:"0"}],nz=new Set(nD.filter(function(e){return!!e.l;}).map(function(e){return e.n;})),nB={},nU=(0,O.default)(function e(t){var n=this;(0,N.default)(this,e),this.runtime=t,nD.forEach(function(e){n.registerMetadata(e);});},[{key:"registerMetadata",value:function(e){[e.n].concat((0,I.default)(e.a||[])).forEach(function(t){nB[t]=e;});}},{key:"getPropertySyntax",value:function(e){return this.runtime.CSSPropertySyntaxFactory[e];}},{key:"processProperties",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(e.attributes,t);var i=e.parsedStyle.clipPath,a=e.parsedStyle.offsetPath;!function(e,t){var n=nF(e);for(var r in t)n.has(r)&&(e.parsedStyle[r]=t[r]);}(e,t);var o=!!r.forceUpdateGeometry;if(!o){for(var s in t)if(nz.has(s)){o=!0;break;}}var l=nF(e);l.has("fill")&&t.fill&&(e.parsedStyle.fill=tY(t.fill)),l.has("stroke")&&t.stroke&&(e.parsedStyle.stroke=tY(t.stroke)),l.has("shadowColor")&&t.shadowColor&&(e.parsedStyle.shadowColor=tY(t.shadowColor)),l.has("filter")&&t.filter&&(e.parsedStyle.filter=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(t=t.toLowerCase().trim()))return[];for(var n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;(e=n.exec(t))&&e.index===i;)if(i=e.index+e[0].length,t7.indexOf(e[1])>-1&&r.push({name:e[1],params:e[2].split(" ").map(function(e){return t$(/deg|rad|grad|turn|px|%/g,e)||tY(e);})}),n.lastIndex===t.length)return r;return[];}(t.filter)),l.has("radius")&&!(0,F.isNil)(t.radius)&&(e.parsedStyle.radius=t5(t.radius,4)),l.has("lineDash")&&!(0,F.isNil)(t.lineDash)&&(e.parsedStyle.lineDash=t5(t.lineDash,"even")),l.has("points")&&t.points&&(e.parsedStyle.points=(n=t.points,{points:(0,F.isString)(n)?n.split(" ").map(function(e){var t=e.split(","),n=(0,z.default)(t,2),r=n[0],i=n[1];return[Number(r),Number(i)];}):n,totalLength:0,segments:[]})),l.has("d")&&""===t.d&&(e.parsedStyle.d=(0,P.default)({},eB)),l.has("d")&&t.d&&(e.parsedStyle.d=nv(t.d)),l.has("textTransform")&&t.textTransform&&this.runtime.CSSPropertySyntaxFactory[eU.TEXT_TRANSFORM].calculator(null,null,{value:t.textTransform},e,null),l.has("clipPath")&&!(0,F.isUndefined)(t.clipPath)&&this.runtime.CSSPropertySyntaxFactory[eU.DEFINED_PATH].calculator("clipPath",i,t.clipPath,e,this.runtime),l.has("offsetPath")&&t.offsetPath&&this.runtime.CSSPropertySyntaxFactory[eU.DEFINED_PATH].calculator("offsetPath",a,t.offsetPath,e,this.runtime),l.has("transform")&&t.transform&&(e.parsedStyle.transform=nE(t.transform)),l.has("transformOrigin")&&t.transformOrigin&&(e.parsedStyle.transformOrigin=nI(t.transformOrigin)),l.has("markerStart")&&t.markerStart&&(e.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[eU.MARKER].calculator(null,t.markerStart,t.markerStart,null,null)),l.has("markerEnd")&&t.markerEnd&&(e.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[eU.MARKER].calculator(null,t.markerEnd,t.markerEnd,null,null)),l.has("markerMid")&&t.markerMid&&(e.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[eU.MARKER].calculator("",t.markerMid,t.markerMid,null,null)),l.has("zIndex")&&!(0,F.isNil)(t.zIndex)&&this.runtime.CSSPropertySyntaxFactory[eU.Z_INDEX].postProcessor(e),l.has("offsetDistance")&&!(0,F.isNil)(t.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[eU.OFFSET_DISTANCE].postProcessor(e),l.has("transform")&&t.transform&&this.runtime.CSSPropertySyntaxFactory[eU.TRANSFORM].postProcessor(e),l.has("transformOrigin")&&t.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[eU.TRANSFORM_ORIGIN].postProcessor(e),o&&(e.geometry.dirty=!0,e.dirty(!0,!0),r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(e));}},{key:"updateGeometry",value:function(e){var t=e.nodeName,n=this.runtime.geometryUpdaterFactory[t];if(n){var r=e.geometry;r.contentBounds||(r.contentBounds=new eo),r.renderBounds||(r.renderBounds=new eo);var i=e.parsedStyle,a=n.update(i,e),o=a.cx,s=a.cy,l=a.cz,u=a.hwidth,c=void 0===u?0:u,d=a.hheight,f=void 0===d?0:d,h=a.hdepth,p=[Math.abs(c),Math.abs(f),void 0===h?0:h],v=i.stroke,g=i.lineWidth,m=i.increasedLineWidthForHitTesting,y=i.shadowType,b=void 0===y?"outer":y,_=i.shadowColor,x=i.filter,w=i.transformOrigin,E=[void 0===o?0:o,void 0===s?0:s,void 0===l?0:l];r.contentBounds.update(E,p);var M=t===$.POLYLINE||t===$.POLYGON||t===$.PATH?Math.SQRT2:.5;if(v&&!v.isNone){var S=(((void 0===g?1:g)||0)+((void 0===m?0:m)||0))*M;p[0]+=S,p[1]+=S;}if(r.renderBounds.update(E,p),_&&b&&"inner"!==b){var k=r.renderBounds,C=k.min,A=k.max,L=i.shadowBlur,P=i.shadowOffsetX,N=i.shadowOffsetY,O=L||0,I=P||0,R=N||0,D=C[0]-O+I,z=A[0]+O+I,B=C[1]-O+R,F=A[1]+O+R;C[0]=Math.min(C[0],D),A[0]=Math.max(A[0],z),C[1]=Math.min(C[1],B),A[1]=Math.max(A[1],F),r.renderBounds.setMinMax(C,A);}(void 0===x?[]:x).forEach(function(e){var t=e.name,n=e.params;if("blur"===t){var i=n[0].value;r.renderBounds.update(r.renderBounds.center,U.vec3.add(r.renderBounds.halfExtents,r.renderBounds.halfExtents,[i,i,0]));}else if("drop-shadow"===t){var a=n[0].value,o=n[1].value,s=n[2].value,l=r.renderBounds,u=l.min,c=l.max,d=u[0]-s+a,f=c[0]+s+a,h=u[1]-s+o,p=c[1]+s+o;u[0]=Math.min(u[0],d),c[0]=Math.max(c[0],f),u[1]=Math.min(u[1],h),c[1]=Math.max(c[1],p),r.renderBounds.setMinMax(u,c);}}),e.geometry.dirty=!1;var j=f<0,V=(c<0?-1:1)*(w?t4(w[0],0,e,!0):0),G=(j?-1:1)*(w?t4(w[1],1,e,!0):0);(V||G)&&e.setOrigin(V,G);}}},{key:"updateSizeAttenuation",value:function(e,t){e.style.isSizeAttenuation?(e.style.rawLineWidth||(e.style.rawLineWidth=e.style.lineWidth),e.style.lineWidth=(e.style.rawLineWidth||1)/t,e.nodeName===$.CIRCLE&&(e.style.rawR||(e.style.rawR=e.style.r),e.style.r=(e.style.rawR||1)/t)):(e.style.rawLineWidth&&(e.style.lineWidth=e.style.rawLineWidth,delete e.style.rawLineWidth),e.nodeName===$.CIRCLE&&e.style.rawR&&(e.style.r=e.style.rawR,delete e.style.rawR));}}]);function nF(e){return e.constructor.PARSED_STYLE_LIST;}var nj=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=ne;},[{key:"calculator",value:function(e,t,n,r){return t3(n);}}]),nV=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"calculator",value:function(e,t,n,r,i){return n instanceof tw&&(n=null),i.sceneGraphService.updateDisplayObjectDependency(e,t,n,r),"clipPath"===e&&r.forEach(function(e){0===e.childNodes.length&&i.sceneGraphService.dirtyToRoot(e);}),n;}}]),nG=(0,O.default)(function e(){(0,N.default)(this,e),this.parser=tY,this.mixer=tX;},[{key:"calculator",value:function(e,t,n,r){return n instanceof tw?"none"===n.value?tP:tN:n;}}]),nH=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"calculator",value:function(e,t,n){return n instanceof tw?[]:n;}}]);function nW(e){var t=e.parsedStyle.fontSize;return(0,F.isNil)(t)?null:t;}var nZ=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=ne;},[{key:"calculator",value:function(e,t,n,r,i){if((0,F.isNumber)(n))return n;if(!tT.isRelativeUnit(n.unit))return n.value;if(n.unit===tl.kPercentage)return 0;if(n.unit===tl.kEms){if(r.parentNode){var a,o=nW(r.parentNode);if(o)return o*n.value;}return 0;}if(n.unit===tl.kRems){if(null!=r&&null!==(a=r.ownerDocument)&&void 0!==a&&a.documentElement){var s=nW(r.ownerDocument.documentElement);if(s)return s*n.value;}return 0;}}}]),nq=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=nn;},[{key:"calculator",value:function(e,t,n){return n.map(function(e){return e.value;});}}]),nY=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=nn;},[{key:"calculator",value:function(e,t,n){return n.map(function(e){return e.value;});}}]),nX=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"calculator",value:function(e,t,n,r){n instanceof tw&&(n=null);var i,a=null===(i=n)||void 0===i?void 0:i.cloneNode(!0);return a&&(a.style.isMarker=!0),a;}}]),n$=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=ne;},[{key:"calculator",value:function(e,t,n){return n.value;}}]),nK=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=nt(0,1);},[{key:"calculator",value:function(e,t,n){return n.value;}},{key:"postProcessor",value:function(e){var t=e.parsedStyle,n=t.offsetPath,r=t.offsetDistance;if(n){var i=n.nodeName;if(i===$.LINE||i===$.PATH||i===$.POLYLINE){var a=n.getPoint(r);a&&e.setLocalPosition(a.x,a.y);}}}}]),nQ=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=nt(0,1);},[{key:"calculator",value:function(e,t,n){return n.value;}}]),nJ=(0,O.default)(function e(){(0,N.default)(this,e),this.parser=nv,this.mixer=ng;},[{key:"calculator",value:function(e,t,n){return n instanceof tw&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new ed(0,0,0,0)}:n;}}]),n0=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=nm;}),n1=function(e){function t(){var e;(0,N.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,R.default)(this,t,[].concat(r))).mixer=nt(0,1/0),e;}return(0,D.default)(t,e),(0,O.default)(t);}(nZ),n2=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"calculator",value:function(e,t,n,r){return n instanceof tw?"unset"===n.value?"":n.value:"".concat(n);}},{key:"postProcessor",value:function(e){e.nodeValue="".concat(e.parsedStyle.text)||"";}}]),n3=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"calculator",value:function(e,t,n,r){var i=r.getAttribute("text");if(i){var a=i;"capitalize"===n.value?a=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===n.value?a=i.toLowerCase():"uppercase"===n.value&&(a=i.toUpperCase()),r.parsedStyle.text=a;}return n.value;}}]),n5=(new WeakMap,"undefined"!=typeof window&&void 0!==window.document);function n4(e,t){var n=Number(e.parsedStyle.zIndex||0),r=Number(t.parsedStyle.zIndex||0);if(n===r){var i=e.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(e)-a.indexOf(t);}}return n-r;}function n7(e){var t,n=e;do{if(null===(t=n.parsedStyle)||void 0===t?void 0:t.clipPath)return n;n=n.parentElement;}while(null!==n)return null;}function n6(e,t,n){n5&&e.style&&(e.style.width=t+"px",e.style.height=n+"px");}var n8={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},n9="object"==typeof performance&&performance.now?performance:Date;function re(e){return e.nodeName===$.FRAGMENT||e.getRootNode().nodeName===$.FRAGMENT;}function rt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=!1,i=!1,a=!!t&&!t.isNone,o=!!n&&!n.isNone;return"visiblepainted"===e||"painted"===e||"auto"===e?(r=a,i=o):"visiblefill"===e||"fill"===e?r=!0:"visiblestroke"===e||"stroke"===e?i=!0:("visible"===e||"all"===e)&&(r=!0,i=!0),[r,i];}var rn=1,rr="object"==typeof self&&self.self===self?self:"object"==typeof Y&&Y.global===Y?Y:{},ri=Date.now(),ra={},ro=Date.now(),rs=function(e){if("function"!=typeof e)throw TypeError("".concat(e," is not a function"));var t=Date.now(),n=t-ro,r=rn++;return ra[r]=e,Object.keys(ra).length>1||setTimeout(function(){ro=t;var e=ra;ra={},Object.keys(e).forEach(function(t){return e[t](rr.performance&&"function"==typeof rr.performance.now?rr.performance.now():Date.now()-ri);});},n>16?0:16-n),r;},rl=function(e){return"string"!=typeof e?rs:""===e?rr.requestAnimationFrame:rr["".concat(e,"RequestAnimationFrame")];},ru=function(e,t){for(var n=0;void 0!==e[n];){if(t(e[n]))return e[n];n+=1;}}(["","webkit","moz","ms","o"],function(e){return!!rl(e);}),rc=rl(ru),rd="string"!=typeof ru?function(e){delete ra[e];}:""===ru?rr.cancelAnimationFrame:rr["".concat(ru,"CancelAnimationFrame")]||rr["".concat(ru,"CancelRequestAnimationFrame")];rr.requestAnimationFrame=rc,rr.cancelAnimationFrame=rd;var rf=(0,O.default)(function e(){(0,N.default)(this,e),this.callbacks=[];},[{key:"getCallbacksNum",value:function(){return this.callbacks.length;}},{key:"tapPromise",value:function(e,t){this.callbacks.push(t);}},{key:"promise",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.all(this.callbacks.map(function(e){return e.apply(void 0,t);}));}}]),rh=(0,O.default)(function e(){(0,N.default)(this,e),this.callbacks=[];},[{key:"tapPromise",value:function(e,t){this.callbacks.push(t);}},{key:"promise",value:(b=(0,W.default)((0,H.default)().mark(function e(){var t,n,r,i,a=arguments;return(0,H.default)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.callbacks.length){e.next=6;break;}return e.next=1,(t=this.callbacks)[0].apply(t,a);case 1:n=e.sent,r=0;case 2:if(!(r<this.callbacks.length-1)){e.next=5;break;}return i=this.callbacks[r],e.next=3,i(n);case 3:n=e.sent;case 4:r++,e.next=2;break;case 5:return e.abrupt("return",n);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop();}},e,this);})),function(){return b.apply(this,arguments);})}]),rp=(0,O.default)(function e(){(0,N.default)(this,e),this.callbacks=[];},[{key:"tap",value:function(e,t){this.callbacks.push(t);}},{key:"call",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=arguments;this.callbacks.forEach(function(e){e.apply(void 0,r);});}}]),rv=(0,O.default)(function e(){(0,N.default)(this,e),this.callbacks=[];},[{key:"tap",value:function(e,t){this.callbacks.push(t);}},{key:"call",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this.callbacks.length){for(var r=arguments,i=this.callbacks[0].apply(void 0,r),a=0;a<this.callbacks.length-1;a++)i=(0,this.callbacks[a])(i);return i;}return null;}}]),rg=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],rm=/([\"\'])[^\'\"]+\1/;function ry(e){var t=e.fontSize,n=e.fontFamily,r=e.fontStyle,i=e.fontVariant,a=e.fontWeight;return{fontSize:void 0===t?16:t,fontFamily:void 0===n?"sans-serif":n,fontStyle:void 0===r?"normal":r,fontVariant:void 0===i?"normal":i,fontWeight:void 0===a?"normal":a};}var rb=ts(function(e){for(var t=ry(e),n=t.fontSize,r=t.fontFamily,i=t.fontStyle,a=t.fontVariant,o=t.fontWeight,s=(0,F.isNumber)(n)&&"".concat(n,"px")||"16px",l=r.split(","),u=l.length-1;u>=0;u--){var c=l[u].trim();!rm.test(c)&&0>rg.indexOf(c)&&(c='"'.concat(c,'"')),l[u]=c;}return"".concat(i," ").concat(a," ").concat(o," ").concat(s," ").concat(l.join(","));},function(e){var t=ry(e),n=t.fontSize,r=t.fontFamily,i=t.fontStyle,a=t.fontVariant,o=t.fontWeight;return"".concat(i,"_").concat(a,"_").concat(o,"_").concat(n,"_").concat(r);}),r_=function(e){return Math.max(e,1e-6);};function rx(e,t,n){return U.mat4.identity(e),e[4]=Math.tan(t),e[1]=Math.tan(n),e;}var rw=U.mat4.create(),rE=U.mat4.create(),rM={scale:function(e){U.mat4.fromScaling(rw,[e[0].value,e[1].value,1].map(function(e){return r_(e);}));},scaleX:function(e){U.mat4.fromScaling(rw,[e[0].value,1,1].map(function(e){return r_(e);}));},scaleY:function(e){U.mat4.fromScaling(rw,[1,e[0].value,1].map(function(e){return r_(e);}));},scaleZ:function(e){U.mat4.fromScaling(rw,[1,1,e[0].value].map(function(e){return r_(e);}));},scale3d:function(e){U.mat4.fromScaling(rw,[e[0].value,e[1].value,e[2].value].map(function(e){return r_(e);}));},translate:function(e){U.mat4.fromTranslation(rw,[e[0].value,e[1].value,0]);},translateX:function(e){U.mat4.fromTranslation(rw,[e[0].value,0,0]);},translateY:function(e){U.mat4.fromTranslation(rw,[0,e[0].value,0]);},translateZ:function(e){U.mat4.fromTranslation(rw,[0,0,e[0].value]);},translate3d:function(e){U.mat4.fromTranslation(rw,[e[0].value,e[1].value,e[2].value]);},rotate:function(e){U.mat4.fromZRotation(rw,t3(e[0])*eg);},rotateX:function(e){U.mat4.fromXRotation(rw,t3(e[0])*eg);},rotateY:function(e){U.mat4.fromYRotation(rw,t3(e[0])*eg);},rotateZ:function(e){U.mat4.fromZRotation(rw,t3(e[0])*eg);},rotate3d:function(e){U.mat4.fromRotation(rw,t3(e[3])*eg,[e[0].value,e[1].value,e[2].value]);},skew:function(e){rx(rw,e[0].value*eg,e[1].value*eg);},skewX:function(e){rx(rw,e[0].value*eg,0);},skewY:function(e){rx(rw,0,e[0].value*eg);},matrix:function(e){U.mat4.set(rw,e[0].value,e[1].value,0,0,e[2].value,e[3].value,0,0,0,0,1,0,e[4].value,e[5].value,0,1);},matrix3d:function(e){U.mat4.set.apply(U.mat4,[rw].concat((0,I.default)(e.map(function(e){return e.value;}))));}},rT=U.vec3.fromValues(1,1,1),rS=U.vec3.create(),rk={translate:function(e,t){im.sceneGraphService.setLocalScale(e,rT,!1),im.sceneGraphService.setLocalEulerAngles(e,rS,void 0,void 0,!1),im.sceneGraphService.setLocalPosition(e,[t[0].value,t[1].value,0],!1),im.sceneGraphService.dirtyLocalTransform(e,e.transformable);}};function rC(e,t){if(e.length){if(1===e.length&&rk[e[0].t]){rk[e[0].t](t,e[0].d);return;}for(var n=U.mat4.identity(rE),r=0;r<e.length;r++){var i=e[r],a=i.t,o=i.d,s=rM[a];s&&(s(o),U.mat4.mul(n,n,rw));}t.setLocalTransform(n);}else t.resetLocalTransform();return t.getLocalTransform();}var rA=(0,O.default)(function e(){(0,N.default)(this,e),this.parser=nM,this.mixer=nO;},[{key:"calculator",value:function(e,t,n,r){return n instanceof tw?[]:n;}},{key:"postProcessor",value:function(e){rC(e.parsedStyle.transform,e);}}]),rL=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"postProcessor",value:function(e){var t=e.parsedStyle.transformOrigin;t[0].unit===tl.kPixels&&t[1].unit===tl.kPixels?e.setOrigin(t[0].value,t[1].value):e.getGeometryBounds();}}]),rP=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"calculator",value:function(e,t,n,r){return n.value;}},{key:"postProcessor",value:function(e){if(e.parentNode){var t=e.parentNode,n=t.renderable,r=t.sortable;n&&t.dirty(),r&&(r.dirty=!0,r.dirtyReason=eO.Z_INDEX_CHANGED);}}}]),rN=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e,t){var n=e.cx,r=e.cy,i=e.r,a=void 0===i?0:i;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:a,hheight:a};}}]),rO=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e,t){var n=e.cx,r=e.cy,i=e.rx,a=e.ry;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:void 0===i?0:i,hheight:void 0===a?0:a};}}]),rI=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e){var t=e.x1,n=e.y1,r=e.x2,i=e.y2,a=Math.min(t,r),o=Math.min(n,i),s=(Math.max(t,r)-a)/2,l=(Math.max(n,i)-o)/2;return{cx:a+s,cy:o+l,hwidth:s,hheight:l};}}]),rR=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e){var t=e.d.rect,n=t.x,r=t.y,i=t.width,a=t.height,o=i/2,s=a/2;return{cx:n+o,cy:r+s,hwidth:o,hheight:s};}}]),rD=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e){if(e.points&&(0,F.isArray)(e.points.points)){var t=e.points.points,n=Math.min.apply(Math,(0,I.default)(t.map(function(e){return e[0];}))),r=Math.max.apply(Math,(0,I.default)(t.map(function(e){return e[0];}))),i=Math.min.apply(Math,(0,I.default)(t.map(function(e){return e[1];}))),a=Math.max.apply(Math,(0,I.default)(t.map(function(e){return e[1];}))),o=(r-n)/2,s=(a-i)/2;return{cx:n+o,cy:i+s,hwidth:o,hheight:s};}return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rz=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e,t){var n=e.x,r=e.y,i=e.src,a=e.width,o=e.height,s=void 0===a?0:a,l=void 0===o?0:o;return!i||(0,F.isString)(i)||(s||(s=i.width,e.width=s),l||(l=i.height,e.height=l)),{cx:(void 0===n?0:n)+s/2,cy:(void 0===r?0:r)+l/2,hwidth:s/2,hheight:l/2};}}]),rB=(0,O.default)(function e(t){(0,N.default)(this,e),this.globalRuntime=t;},[{key:"isReadyToMeasure",value:function(e,t){return e.text;}},{key:"update",value:function(e,t){var n,r=e.text,i=e.textAlign,a=void 0===i?"start":i,o=e.lineWidth,s=void 0===o?1:o,l=e.textBaseline,u=void 0===l?"alphabetic":l,c=e.dx,d=void 0===c?0:c,f=e.dy,h=void 0===f?0:f,p=e.x,v=e.y;if(!this.isReadyToMeasure(e,t))return e.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var g=((null==t||null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,m=this.globalRuntime.textService.measureText(r,e,g);e.metrics=m;var y=m.width,b=m.height,_=y/2,x=b/2,w=(void 0===p?0:p)+_;"center"===a||"middle"===a?w+=s/2-_:("right"===a||"end"===a)&&(w+=s-2*_);var E=(void 0===v?0:v)-x;return"middle"===u?E+=x:"top"===u||"hanging"===u?E+=2*x:"alphabetic"===u||("bottom"===u||"ideographic"===u)&&(E+=0),d&&(w+=d),h&&(E+=h),{cx:w,cy:E,hwidth:_,hheight:x};}}]),rU=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e,t){return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rF=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e,t){var n=e.x,r=e.y,i=e.width,a=void 0===i?0:i,o=e.height,s=void 0===o?0:o;return{cx:(void 0===n?0:n)+a/2,cy:(void 0===r?0:r)+s/2,hwidth:a/2,hheight:s/2};}}]),rj=(0,O.default)(function e(t){(0,N.default)(this,e),this.eventPhase=e.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ec,this.page=new ec,this.canvas=new ec,this.viewport=new ec,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t;},[{key:"name",get:function(){return this.type;}},{key:"layerX",get:function(){return this.layer.x;}},{key:"layerY",get:function(){return this.layer.y;}},{key:"pageX",get:function(){return this.page.x;}},{key:"pageY",get:function(){return this.page.y;}},{key:"x",get:function(){return this.canvas.x;}},{key:"y",get:function(){return this.canvas.y;}},{key:"canvasX",get:function(){return this.canvas.x;}},{key:"canvasY",get:function(){return this.canvas.y;}},{key:"viewportX",get:function(){return this.viewport.x;}},{key:"viewportY",get:function(){return this.viewport.y;}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path;}},{key:"propagationPath",get:function(){return this.composedPath();}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0;}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0;}},{key:"stopPropagation",value:function(){this.propagationStopped=!0;}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw Error(ef);}}]),rV=function(e){function t(){var e;(0,N.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,R.default)(this,t,[].concat(r))).client=new ec,e.movement=new ec,e.offset=new ec,e.global=new ec,e.screen=new ec,e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"clientX",get:function(){return this.client.x;}},{key:"clientY",get:function(){return this.client.y;}},{key:"movementX",get:function(){return this.movement.x;}},{key:"movementY",get:function(){return this.movement.y;}},{key:"offsetX",get:function(){return this.offset.x;}},{key:"offsetY",get:function(){return this.offset.y;}},{key:"globalX",get:function(){return this.global.x;}},{key:"globalY",get:function(){return this.global.y;}},{key:"screenX",get:function(){return this.screen.x;}},{key:"screenY",get:function(){return this.screen.y;}},{key:"getModifierState",value:function(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e);}},{key:"initMouseEvent",value:function(){throw Error(ef);}}]);}(rj),rG=function(e){function t(){var e;(0,N.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,R.default)(this,t,[].concat(r))).width=0,e.height=0,e.isPrimary=!1,e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[];}},{key:"getPredictedEvents",value:function(){throw Error("getPredictedEvents is not supported!");}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this);}}]);}(rV),rH=function(e){function t(){return(0,N.default)(this,t),(0,R.default)(this,t,arguments);}return(0,D.default)(t,e),(0,O.default)(t,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this);}}]);}(rV),rW=function(e){function t(e,n){var r;return(0,N.default)(this,t),(r=(0,R.default)(this,t,[null])).type=e,r.detail=n,Object.assign(r,n),r;}return(0,D.default)(t,e),(0,O.default)(t);}(rj),rZ=function(e){function t(){var e;(0,N.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,R.default)(this,t,[].concat(r))).shadow=!1,e.ownerDocument=null,e.isConnected=!1,e.baseURI="",e.childNodes=[],e.nodeType=0,e.nodeName="",e.nodeValue=null,e.parentNode=null,e.destroyed=!1,e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"textContent",get:function(){var e="";this.nodeName===$.TEXT&&(e+=this.style.text);var t,n=(0,Z.default)(this.childNodes);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.nodeName===$.TEXT?e+=r.nodeValue:e+=r.textContent;}}catch(e){n.e(e);}finally{n.f();}return e;},set:function(e){var t=this;this.childNodes.slice().forEach(function(e){t.removeChild(e);}),this.nodeName===$.TEXT&&(this.style.text="".concat(e));}},{key:"getRootNode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(e):e.composed&&this.host?this.host.getRootNode(e):this;}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0;}},{key:"isDefaultNamespace",value:function(e){throw Error(ef);}},{key:"lookupNamespaceURI",value:function(e){throw Error(ef);}},{key:"lookupPrefix",value:function(e){throw Error(ef);}},{key:"normalize",value:function(){throw Error(ef);}},{key:"isEqualNode",value:function(e){return this===e;}},{key:"isSameNode",value:function(e){return this.isEqualNode(e);}},{key:"parent",get:function(){return this.parentNode;}},{key:"parentElement",get:function(){return null;}},{key:"nextSibling",get:function(){return null;}},{key:"previousSibling",get:function(){return null;}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null;}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null;}},{key:"compareDocumentPosition",value:function(e){if(e===this)return 0;for(var n,r=e,i=this,a=[r],o=[i];null!==(n=r.parentNode)&&void 0!==n?n:i.parentNode;)r=r.parentNode?(a.push(r.parentNode),r.parentNode):r,i=i.parentNode?(o.push(i.parentNode),i.parentNode):i;if(r!==i)return t.DOCUMENT_POSITION_DISCONNECTED|t.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|t.DOCUMENT_POSITION_PRECEDING;var s=a.length>o.length?a:o,l=s===a?o:a;if(s[s.length-l.length]===l[0])return s===a?t.DOCUMENT_POSITION_CONTAINED_BY|t.DOCUMENT_POSITION_FOLLOWING:t.DOCUMENT_POSITION_CONTAINS|t.DOCUMENT_POSITION_PRECEDING;for(var u=s.length-l.length,c=l.length-1;c>=0;c--){var d=l[c],f=s[u+c];if(f!==d){var h=d.parentNode.childNodes;if(h.indexOf(d)<h.indexOf(f)){if(l===a)return t.DOCUMENT_POSITION_PRECEDING;return t.DOCUMENT_POSITION_FOLLOWING;}if(s===a)return t.DOCUMENT_POSITION_PRECEDING;break;}}return t.DOCUMENT_POSITION_FOLLOWING;}},{key:"contain",value:function(e){return this.contains(e);}},{key:"contains",value:function(e){for(var t=e;t&&this!==t;)t=t.parentNode;return!!t;}},{key:"getAncestor",value:function(e){for(var t=this;e>0&&t;)t=t.parentNode,e--;return t;}},{key:"forEach",value:function(e){for(var t=[this];t.length>0;){var n=t.pop();if(!1===e(n))break;for(var r=n.childNodes.length-1;r>=0;r--)t.push(n.childNodes[r]);}}}],[{key:"isNode",value:function(e){return!!e.childNodes;}}]);}((0,O.default)(function e(){(0,N.default)(this,e),this.emitter=new B.default;},[{key:"on",value:function(e,t,n){return this.addEventListener(e,t,n),this;}},{key:"addEventListener",value:function(e,t,n){var r=!1,i=!1;if((0,F.isBoolean)(n))r=n;else if(n){var a=n.capture;r=void 0!==a&&a;var o=n.once;i=void 0!==o&&o;}r&&(e+="capture"),t=(0,F.isFunction)(t)?t:t.handleEvent;var s=(0,F.isFunction)(t)?void 0:t;return i?this.emitter.once(e,t,s):this.emitter.on(e,t,s),this;}},{key:"off",value:function(e,t,n){return e?this.removeEventListener(e,t,n):this.removeAllEventListeners(),this;}},{key:"removeAllEventListeners",value:function(){var e;null===(e=this.emitter)||void 0===e||e.removeAllListeners();}},{key:"removeEventListener",value:function(e,t,n){if(!this.emitter)return this;((0,F.isBoolean)(n)?n:null==n?void 0:n.capture)&&(e+="capture"),t=(0,F.isFunction)(t)?t:null===(r=t)||void 0===r?void 0:r.handleEvent;var r,i=(0,F.isFunction)(t)?void 0:t;return this.emitter.off(e,t,i),this;}},{key:"emit",value:function(e,t){this.dispatchEvent(new rW(e,t));}},{key:"dispatchEventToSelf",value:function(e){e.target||(e.target=this),e.currentTarget=this,this.emitter.emit(e.type,e);}},{key:"dispatchEvent",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;if(i)return this.dispatchEventToSelf(e),!0;if(t=this.document?this:this.defaultView?this.defaultView:null===(n=this.ownerDocument)||void 0===n?void 0:n.defaultView){if(e.manager=t.getEventService(),!e.manager)return!1;e.defaultPrevented=!1,e.path?e.path.length=0:e.page=[],r||(e.target=this),e.manager.dispatchEvent(e,e.type,r);}else this.dispatchEventToSelf(e);return!e.defaultPrevented;}}]));rZ.DOCUMENT_POSITION_DISCONNECTED=1,rZ.DOCUMENT_POSITION_PRECEDING=2,rZ.DOCUMENT_POSITION_FOLLOWING=4,rZ.DOCUMENT_POSITION_CONTAINS=8,rZ.DOCUMENT_POSITION_CONTAINED_BY=16,rZ.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,(0,O.default)(function e(t,n){var r=this;(0,N.default)(this,e),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=U.mat4.create(),this.tmpVec3=U.vec3.create(),this.onPointerDown=function(e){var t=r.createPointerEvent(e);if(r.dispatchEvent(t,"pointerdown"),"touch"===t.pointerType)r.dispatchEvent(t,"touchstart");else if("mouse"===t.pointerType||"pen"===t.pointerType){var n=2===t.button;r.dispatchEvent(t,n?"rightdown":"mousedown");}r.trackingData(e.pointerId).pressTargetsByButton[e.button]=t.composedPath(),r.freeEvent(t);},this.onPointerUp=function(e){var t=n9.now(),n=r.createPointerEvent(e,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)r.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var i=2===n.button;r.dispatchEvent(n,i?"rightup":"mouseup");}var a=r.trackingData(e.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[e.button]),s=o;if(o&&!n.composedPath().includes(o)){for(var l=o;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,r.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)r.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var u=2===n.button;r.notifyTarget(n,u?"rightupoutside":"mouseupoutside");}rZ.isNode(l)&&(l=l.parentNode);}delete a.pressTargetsByButton[e.button],s=l;}if(s){var c,d=r.clonePointerEvent(n,"click");d.target=s,d.path=[],a.clicksByButton[e.button]||(a.clicksByButton[e.button]={clickCount:0,target:d.target,timeStamp:t});var f=r.context.renderingContext.root.ownerDocument.defaultView,h=a.clicksByButton[e.button];h.target===d.target&&t-h.timeStamp<f.getConfig().dblClickSpeed?++h.clickCount:h.clickCount=1,h.target=d.target,h.timeStamp=t,d.detail=h.clickCount,null!==(c=n.detail)&&void 0!==c&&c.preventClick||(r.context.config.useNativeClickEvent||"mouse"!==d.pointerType&&"touch"!==d.pointerType||r.dispatchEvent(d,"click"),r.dispatchEvent(d,"pointertap")),r.freeEvent(d);}r.freeEvent(n);},this.onPointerMove=function(e){var t=r.createPointerEvent(e,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),n="mouse"===t.pointerType||"pen"===t.pointerType,i=r.trackingData(e.pointerId),a=r.findMountedTarget(i.overTargets);if(i.overTargets&&a!==t.target){var o="mousemove"===e.type?"mouseout":"pointerout",s=r.createPointerEvent(e,o,a||void 0);if(r.dispatchEvent(s,"pointerout"),n&&r.dispatchEvent(s,"mouseout"),!t.composedPath().includes(a)){var l=r.createPointerEvent(e,"pointerleave",a||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&!t.composedPath().includes(l.target);)l.currentTarget=l.target,r.notifyTarget(l),n&&r.notifyTarget(l,"mouseleave"),rZ.isNode(l.target)&&(l.target=l.target.parentNode);r.freeEvent(l);}r.freeEvent(s);}if(a!==t.target){var u="mousemove"===e.type?"mouseover":"pointerover",c=r.clonePointerEvent(t,u);r.dispatchEvent(c,"pointerover"),n&&r.dispatchEvent(c,"mouseover");for(var d=a&&rZ.isNode(a)&&a.parentNode;d&&d!==(rZ.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&d!==t.target;)d=d.parentNode;if(!d||d===(rZ.isNode(r.rootTarget)&&r.rootTarget.parentNode)){var f=r.clonePointerEvent(t,"pointerenter");for(f.eventPhase=f.AT_TARGET;f.target&&f.target!==a&&f.target!==(rZ.isNode(r.rootTarget)&&r.rootTarget.parentNode);)f.currentTarget=f.target,r.notifyTarget(f),n&&r.notifyTarget(f,"mouseenter"),rZ.isNode(f.target)&&(f.target=f.target.parentNode);r.freeEvent(f);}r.freeEvent(c);}r.dispatchEvent(t,"pointermove"),"touch"===t.pointerType&&r.dispatchEvent(t,"touchmove"),n&&(r.dispatchEvent(t,"mousemove"),r.cursor=r.getCursor(t.target)),i.overTargets=t.composedPath(),r.freeEvent(t);},this.onPointerOut=function(e){var t=r.trackingData(e.pointerId);if(t.overTargets){var n="mouse"===e.pointerType||"pen"===e.pointerType,i=r.findMountedTarget(t.overTargets),a=r.createPointerEvent(e,"pointerout",i||void 0);r.dispatchEvent(a),n&&r.dispatchEvent(a,"mouseout");var o=r.createPointerEvent(e,"pointerleave",i||void 0);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(rZ.isNode(r.rootTarget)&&r.rootTarget.parentNode);)o.currentTarget=o.target,r.notifyTarget(o),n&&r.notifyTarget(o,"mouseleave"),rZ.isNode(o.target)&&(o.target=o.target.parentNode);t.overTargets=null,r.freeEvent(a),r.freeEvent(o);}r.cursor=null;},this.onPointerOver=function(e){var t=r.trackingData(e.pointerId),n=r.createPointerEvent(e),i="mouse"===n.pointerType||"pen"===n.pointerType;r.dispatchEvent(n,"pointerover"),i&&r.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(r.cursor=r.getCursor(n.target));var a=r.clonePointerEvent(n,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==(rZ.isNode(r.rootTarget)&&r.rootTarget.parentNode);)a.currentTarget=a.target,r.notifyTarget(a),i&&r.notifyTarget(a,"mouseenter"),rZ.isNode(a.target)&&(a.target=a.target.parentNode);t.overTargets=n.composedPath(),r.freeEvent(n),r.freeEvent(a);},this.onPointerUpOutside=function(e){var t=r.trackingData(e.pointerId),n=r.findMountedTarget(t.pressTargetsByButton[e.button]),i=r.createPointerEvent(e);if(n){for(var a=n;a;)i.currentTarget=a,r.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType||("mouse"===i.pointerType||"pen"===i.pointerType)&&r.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),rZ.isNode(a)&&(a=a.parentNode);delete t.pressTargetsByButton[e.button];}r.freeEvent(i);},this.onWheel=function(e){var t=r.createWheelEvent(e);r.dispatchEvent(t),r.freeEvent(t);},this.onClick=function(e){if(r.context.config.useNativeClickEvent){var t=r.createPointerEvent(e);r.dispatchEvent(t),r.freeEvent(t);}},this.onPointerCancel=function(e){var t=r.createPointerEvent(e,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(t),r.freeEvent(t);},this.globalRuntime=t,this.context=n;},[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick);}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear();}},{key:"getScale",value:function(){var e=this.context.contextService.getBoundingClientRect(),t=1,n=1,r=this.context.contextService.getDomElement();if(r&&e){var i=r.offsetWidth,a=r.offsetHeight;i&&a&&(t=e.width/i,n=e.height/a);}return{scaleX:t,scaleY:n,bbox:e};}},{key:"client2Viewport",value:function(e){var t=this.getScale(),n=t.scaleX,r=t.scaleY,i=t.bbox;return new ec((e.x-((null==i?void 0:i.left)||0))/n,(e.y-((null==i?void 0:i.top)||0))/r);}},{key:"viewport2Client",value:function(e){var t=this.getScale(),n=t.scaleX,r=t.scaleY,i=t.bbox;return new ec((e.x+((null==i?void 0:i.left)||0))*n,(e.y+((null==i?void 0:i.top)||0))*r);}},{key:"viewport2Canvas",value:function(e){var t=e.x,n=e.y,r=this.rootTarget.defaultView.getCamera(),i=this.context.config,a=i.width,o=i.height,s=r.getPerspectiveInverse(),l=r.getWorldTransform(),u=U.mat4.multiply(this.tmpMatrix,l,s),c=U.vec3.set(this.tmpVec3,t/a*2-1,(1-n/o)*2-1,0);return U.vec3.transformMat4(c,c,u),new ec(c[0],c[1]);}},{key:"canvas2Viewport",value:function(e){var t=this.rootTarget.defaultView.getCamera(),n=t.getPerspective(),r=t.getViewTransform(),i=U.mat4.multiply(this.tmpMatrix,n,r),a=U.vec3.set(this.tmpVec3,e.x,e.y,0);U.vec3.transformMat4(this.tmpVec3,this.tmpVec3,i);var o=this.context.config,s=o.width,l=o.height;return new ec((a[0]+1)/2*s,(1-(a[1]+1)/2)*l);}},{key:"setPickHandler",value:function(e){this.pickHandler=e;}},{key:"addEventMapping",value:function(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort(function(e,t){return e.priority-t.priority;});}},{key:"mapEvent",value:function(e){if(this.rootTarget){var t=this.mappingTable[e.type];if(t)for(var n=0,r=t.length;n<r;n++)t[n].fn(e);else console.warn("[EventService]: Event mapping not defined for ".concat(e.type));}}},{key:"dispatchEvent",value:function(e,t,n){if(n){e.eventPhase=e.AT_TARGET;var r=this.rootTarget.defaultView||null;e.currentTarget=r,this.notifyListeners(e,t);}else e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t);}},{key:"propagate",value:function(e,t){if(e.target){var n=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(e.currentTarget=n[r],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!e.propagationStopped&&!e.propagationImmediatelyStopped){var i=n.indexOf(e.currentTarget);e.eventPhase=e.BUBBLING_PHASE;for(var a=i+1;a<n.length;a++)if(e.currentTarget=n[a],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;}}}},{key:"propagationPath",value:function(e){var t=[e],n=this.rootTarget.defaultView||null;if(n&&n===e)return t.unshift(n.document),t;for(var r=0;r<2048&&e!==this.rootTarget;r++)rZ.isNode(e)&&e.parentNode&&(t.push(e.parentNode),e=e.parentNode);return n&&t.push(n),t;}},{key:"hitTest",value:function(e){var t=e.viewportX,n=e.viewportY,r=this.context.config,i=r.width,a=r.height,o=r.disableHitTesting;return t<0||n<0||t>i||n>a?null:!o&&this.pickHandler(e)||this.rootTarget||null;}},{key:"isNativeEventFromCanvas",value:function(e,t){var n,r=null==t?void 0:t.target;if(null!==(n=r)&&void 0!==n&&n.shadowRoot&&(r=t.composedPath()[0]),r){if(r===e)return!0;if(e&&e.contains)return e.contains(r);}return null!=t&&!!t.composedPath&&t.composedPath().indexOf(e)>-1;}},{key:"getExistedHTML",value:function(e){if(e.nativeEvent.composedPath)for(var t=0,n=e.nativeEvent.composedPath();t<n.length;t++){var r=n[t],i=this.nativeHTMLMap.get(r);if(i)return i;}return null;}},{key:"pickTarget",value:function(e){return this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY});}},{key:"createPointerEvent",value:function(e,t,n,r){var i=this.allocateEvent(rG);this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e;var a=this.getExistedHTML(i),o=this.context.contextService.getDomElement();return i.target=null!=n?n:a||this.isNativeEventFromCanvas(o,i.nativeEvent)&&this.pickTarget(i)||r,"string"==typeof t&&(i.type=t),i;}},{key:"createWheelEvent",value:function(e){var t=this.allocateEvent(rH);this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e;var n=this.getExistedHTML(t),r=this.context.contextService.getDomElement();return t.target=n||this.isNativeEventFromCanvas(r,t.nativeEvent)&&this.pickTarget(t),t;}},{key:"trackingData",value:function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e];}},{key:"cloneWheelEvent",value:function(e){var t=this.allocateEvent(rH);return t.nativeEvent=e.nativeEvent,t.originalEvent=e.originalEvent,this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.target=e.target,t.path=e.composedPath().slice(),t.type=e.type,t;}},{key:"clonePointerEvent",value:function(e,t){var n=this.allocateEvent(rG);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=null!=t?t:n.type,n;}},{key:"copyPointerData",value:function(e,t){t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist;}},{key:"copyMouseData",value:function(e,t){t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.client.copyFrom(e.client),t.movement.copyFrom(e.movement),t.canvas.copyFrom(e.canvas),t.screen.copyFrom(e.screen),t.global.copyFrom(e.global),t.offset.copyFrom(e.offset);}},{key:"copyWheelData",value:function(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ;}},{key:"copyData",value:function(e,t){t.isTrusted=e.isTrusted,t.timeStamp=n9.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.page.copyFrom(e.page),t.viewport.copyFrom(e.viewport);}},{key:"allocateEvent",value:function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=[],t.target=null,t;}},{key:"freeEvent",value:function(e){if(e.manager!==this)throw Error("It is illegal to free an event not managed by this EventBoundary!");var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e);}},{key:"notifyTarget",value:function(e,t){t=null!=t?t:e.type;var n=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(t,"capture"):t;this.notifyListeners(e,n),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t);}},{key:"notifyListeners",value:function(e,t){var n=e.currentTarget.emitter,r=n._events[t];if(r){if("fn"in r)r.once&&n.removeListener(t,r.fn,void 0,!0),r.fn.call(e.currentTarget||r.context,e);else for(var i=0;i<r.length&&!e.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(t,r[i].fn,void 0,!0),r[i].fn.call(e.currentTarget||r[i].context,e);}}},{key:"findMountedTarget",value:function(e){if(!e)return null;for(var t=e[e.length-1],n=e.length-2;n>=0;n--){var r=e[n];if(r===this.rootTarget||rZ.isNode(r)&&r.parentNode===t)t=e[n];else break;}return t;}},{key:"getCursor",value:function(e){for(var t=e;t;){var n=!!t.getAttribute&&t.getAttribute("cursor");if(n)return n;t=rZ.isNode(t)&&t.parentNode;}}}]);var rq=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"getOrCreateCanvas",value:function(e,t){if(this.canvas)return this.canvas;if(e||im.offscreenCanvas)this.canvas=e||im.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,P.default)({willReadFrequently:!0},t));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,P.default)({willReadFrequently:!0},t)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"));}catch(e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,P.default)({willReadFrequently:!0},t));}return this.canvas.width=10,this.canvas.height=10,this.canvas;}},{key:"getOrCreateContext",value:function(e,t){return this.context||this.getOrCreateCanvas(e,t),this.context;}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0);}catch(e){}try{return document.createElement("canvas");}catch(e){}return null;}}]),rY=((_={})[_.CAMERA_CHANGED=0]="CAMERA_CHANGED",_[_.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",_[_.NONE=2]="NONE",_);(0,O.default)(function e(t,n){(0,N.default)(this,e),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new rp,initAsync:new rf,dirtycheck:new rv,cull:new rv,beginFrame:new rp,beforeRender:new rp,render:new rp,afterRender:new rp,endFrame:new rp,destroy:new rp,pick:new rh,pickSync:new rv,pointerDown:new rp,pointerUp:new rp,pointerMove:new rp,pointerOut:new rp,pointerOver:new rp,pointerWheel:new rp,pointerCancel:new rp,click:new rp},this.globalRuntime=t,this.context=n;},[{key:"init",value:function(e){var t=this,n=(0,P.default)((0,P.default)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(e){e.apply(n,t.globalRuntime);}),this.hooks.init.call(),0===this.hooks.initAsync.getCallbacksNum()?(this.inited=!0,e()):this.hooks.initAsync.promise().then(function(){t.inited=!0,e();}).catch(function(e){});}},{key:"getStats",value:function(){return this.stats;}},{key:"disableDirtyRectangleRendering",value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(rY.CAMERA_CHANGED);}},{key:"render",value:function(e,t,n){var r=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var i=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(i.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),i.renderReasons.size&&this.inited){i.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var a=1===i.renderReasons.size&&i.renderReasons.has(rY.CAMERA_CHANGED),o=!e.disableRenderHooks||!a;o&&this.renderDisplayObject(i.root,e,i),this.hooks.beginFrame.call(t),o&&i.renderListCurrentFrame.forEach(function(e){r.hooks.beforeRender.call(e),r.hooks.render.call(e),r.hooks.afterRender.call(e);}),this.hooks.endFrame.call(t),i.renderListCurrentFrame=[],i.renderReasons.clear(),n();}}},{key:"renderDisplayObject",value:function(e,t,n){for(var r=this,i=t.renderer.getConfig(),a=i.enableDirtyCheck,o=i.enableCulling,s=[e];s.length>0;){var l,u=s.pop();!function(e){var t=e.renderable,i=e.sortable,s=a?t.dirty||n.dirtyRectangleRenderingDisabled?e:null:e,l=null;s&&(l=o?r.hooks.cull.call(s,r.context.camera):s)&&(r.stats.rendered+=1,n.renderListCurrentFrame.push(l)),e.dirty(!1),i.renderOrder=r.zIndexCounter,r.zIndexCounter+=1,r.stats.total+=1,i.dirty&&(r.sort(e,i),i.dirty=!1,i.dirtyChildren=[],i.dirtyReason=void 0);}(u);for(var c=(null===(l=u.sortable)||void 0===l||null===(l=l.sorted)||void 0===l?void 0:l.length)>0?u.sortable.sorted:u.childNodes,d=c.length-1;d>=0;d--)s.push(c[d]);}}},{key:"sort",value:function(e,t){var n,r;(null==t||null===(n=t.sorted)||void 0===n?void 0:n.length)>0&&t.dirtyReason!==eO.Z_INDEX_CHANGED?t.dirtyChildren.forEach(function(n){var r=t.sorted.indexOf(n);if(r>-1&&t.sorted.splice(r,1),e.childNodes.indexOf(n)>-1){if(0===t.sorted.length)t.sorted.push(n);else{var i=function(e,t){for(var n=0,r=e.length;n<r;){var i=n+r>>>1;0>n4(e[i],t)?n=i+1:r=i;}return n;}(t.sorted,n);t.sorted.splice(i,0,n);}}}):t.sorted=e.childNodes.slice().sort(n4),(null===(r=t.sorted)||void 0===r?void 0:r.length)>0&&0===e.childNodes.filter(function(e){return e.parsedStyle.zIndex;}).length&&(t.sorted=[]);}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents();}},{key:"dirtify",value:function(){this.context.renderingContext.renderReasons.add(rY.DISPLAY_OBJECT_CHANGED);}}]);var rX=/\[\s*(.*)=(.*)\s*\]/,r$=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"selectOne",value:function(e,t){var n=this;if(e.startsWith("."))return t.find(function(t){return((null==t?void 0:t.classList)||[]).indexOf(n.getIdOrClassname(e))>-1;});if(e.startsWith("#"))return t.find(function(t){return t.id===n.getIdOrClassname(e);});if(e.startsWith("[")){var r=this.getAttribute(e),i=r.name,a=r.value;return i?t.find(function(e){return t!==e&&("name"===i?e.name===a:n.attributeToString(e,i)===a);}):null;}return t.find(function(n){return t!==n&&n.nodeName===e;});}},{key:"selectAll",value:function(e,t){var n=this;if(e.startsWith("."))return t.findAll(function(r){return t!==r&&((null==r?void 0:r.classList)||[]).indexOf(n.getIdOrClassname(e))>-1;});if(e.startsWith("#"))return t.findAll(function(r){return t!==r&&r.id===n.getIdOrClassname(e);});if(e.startsWith("[")){var r=this.getAttribute(e),i=r.name,a=r.value;return i?t.findAll(function(e){return t!==e&&("name"===i?e.name===a:n.attributeToString(e,i)===a);}):[];}return t.findAll(function(n){return t!==n&&n.nodeName===e;});}},{key:"is",value:function(e,t){if(e.startsWith("."))return t.className===this.getIdOrClassname(e);if(e.startsWith("#"))return t.id===this.getIdOrClassname(e);if(e.startsWith("[")){var n=this.getAttribute(e),r=n.name,i=n.value;return"name"===r?t.name===i:this.attributeToString(t,r)===i;}return t.nodeName===e;}},{key:"getIdOrClassname",value:function(e){return e.substring(1);}},{key:"getAttribute",value:function(e){var t=e.match(rX),n="",r="";return t&&t.length>2&&(n=t[1].replace(/"/g,""),r=t[2].replace(/"/g,"")),{name:n,value:r};}},{key:"attributeToString",value:function(e,t){if(!e.getAttribute)return"";var n=e.getAttribute(t);return(0,F.isNil)(n)?"":n.toString?n.toString():"";}}]),rK=((x={}).ATTR_MODIFIED="DOMAttrModified",x.INSERTED="DOMNodeInserted",x.MOUNTED="DOMNodeInsertedIntoDocument",x.REMOVED="removed",x.UNMOUNTED="DOMNodeRemovedFromDocument",x.REPARENT="reparent",x.DESTROY="destroy",x.BOUNDS_CHANGED="bounds-changed",x.CULLED="culled",x),rQ=function(e){function t(e,n,r,i,a,o,s,l){var u;return(0,N.default)(this,t),(u=(0,R.default)(this,t,[null])).relatedNode=n,u.prevValue=r,u.newValue=i,u.attrName=a,u.attrChange=o,u.prevParsedValue=s,u.newParsedValue=l,u.type=e,u;}return(0,D.default)(t,e),(0,O.default)(t);}(rj);rQ.ADDITION=2,rQ.MODIFICATION=1,rQ.REMOVAL=3;var rJ=new rQ(rK.REPARENT,null,"","","",0,"",""),r0=U.vec2.create(),r1=U.vec3.create(),r2=U.vec3.fromValues(1,1,1),r3=U.mat4.create(),r5=U.vec2.create(),r4=U.vec3.create(),r7=U.mat4.create(),r6=U.quat.create(),r8=U.vec3.create(),r9=U.quat.create(),ie=U.vec3.create(),it=U.vec3.create(),ir=U.vec3.create(),ii=U.mat4.create(),ia=U.quat.create(),io=U.quat.create(),is=U.quat.create(),il={affectChildren:!0},iu=(0,O.default)(function e(t){(0,N.default)(this,e),this.pendingEvents=new Map,this.boundsChangedEvent=new rW(rK.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=t;},[{key:"matches",value:function(e,t){return this.runtime.sceneGraphSelector.is(e,t);}},{key:"querySelector",value:function(e,t){return this.runtime.sceneGraphSelector.selectOne(e,t);}},{key:"querySelectorAll",value:function(e,t){return this.runtime.sceneGraphSelector.selectAll(e,t);}},{key:"attach",value:function(e,t,n){var r=!1;e.parentNode&&(r=e.parentNode!==t,this.detach(e));var i=e.nodeName===$.FRAGMENT,a=re(t);e.parentNode=t;var o=i?e.childNodes:[e];(0,F.isNumber)(n)?o.forEach(function(e){t.childNodes.splice(n,0,e),e.parentNode=t;}):o.forEach(function(e){t.childNodes.push(e),e.parentNode=t;});var s=t.sortable;if((null!=s&&null!==(u=s.sorted)&&void 0!==u&&u.length||s.dirty||e.parsedStyle.zIndex)&&(-1===s.dirtyChildren.indexOf(e)&&s.dirtyChildren.push(e),s.dirty=!0,s.dirtyReason=eO.ADDED),!a){if(i)this.dirtifyFragment(e);else{var l=e.transformable;l&&this.dirtyWorldTransform(e,l);}if(r){var u,c,d=(null===(c=t.ownerDocument)||void 0===c||null===(c=c.defaultView)||void 0===c||null===(c=c.getConfig())||void 0===c||null===(c=c.future)||void 0===c?void 0:c.experimentalCancelEventPropagation)===!0;e.dispatchEvent(rJ,d,d);}}}},{key:"detach",value:function(e){if(e.parentNode){var t,n,r=e.transformable,i=e.parentNode.sortable;(null!=i&&null!==(t=i.sorted)&&void 0!==t&&t.length||null!==(n=e.style)&&void 0!==n&&n.zIndex)&&(-1===i.dirtyChildren.indexOf(e)&&i.dirtyChildren.push(e),i.dirty=!0,i.dirtyReason=eO.REMOVED);var a=e.parentNode.childNodes.indexOf(e);a>-1&&e.parentNode.childNodes.splice(a,1),r&&this.dirtyWorldTransform(e,r),e.parentNode=null;}}},{key:"getLocalPosition",value:function(e){return e.transformable.localPosition;}},{key:"getLocalRotation",value:function(e){return e.transformable.localRotation;}},{key:"getLocalScale",value:function(e){return e.transformable.localScale;}},{key:"getLocalSkew",value:function(e){return e.transformable.localSkew;}},{key:"getLocalTransform",value:function(e){var t=e.transformable;return ez(t),t.localTransform;}},{key:"setLocalPosition",value:function(e,t){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=e.transformable;it[0]=t[0],it[1]=t[1],it[2]=null!==(n=t[2])&&void 0!==n?n:0,!U.vec3.equals(i.localPosition,it)&&(U.vec3.copy(i.localPosition,it),r&&this.dirtyLocalTransform(e,i));}},{key:"translateLocal",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof t&&(t=U.vec3.fromValues(t,n,r));var i=e.transformable;U.vec3.equals(t,r1)||(U.vec3.transformQuat(t,t,i.localRotation),U.vec3.add(i.localPosition,i.localPosition,t),this.dirtyLocalTransform(e,i));}},{key:"setLocalRotation",value:function(e,t,n,r,i){var a=!(arguments.length>5)||void 0===arguments[5]||arguments[5];"number"==typeof t&&(t=U.quat.set(r6,t,n,r,i));var o=e.transformable;U.quat.copy(o.localRotation,t),a&&this.dirtyLocalTransform(e,o);}},{key:"rotateLocal",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof t&&(t=U.vec3.fromValues(t,n,r));var i=e.transformable;U.quat.fromEuler(io,t[0],t[1],t[2]),U.quat.mul(i.localRotation,i.localRotation,io),this.dirtyLocalTransform(e,i);}},{key:"setLocalScale",value:function(e,t){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=e.transformable;U.vec3.set(r4,t[0],t[1],null!==(n=t[2])&&void 0!==n?n:i.localScale[2]),!U.vec3.equals(r4,i.localScale)&&(U.vec3.copy(i.localScale,r4),r&&this.dirtyLocalTransform(e,i));}},{key:"scaleLocal",value:function(e,t){var n,r=e.transformable;U.vec3.multiply(r.localScale,r.localScale,U.vec3.set(r4,t[0],t[1],null!==(n=t[2])&&void 0!==n?n:1)),this.dirtyLocalTransform(e,r);}},{key:"setLocalSkew",value:function(e,t,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];"number"==typeof t&&(t=U.vec2.set(r5,t,n));var i=e.transformable;U.vec2.copy(i.localSkew,t),r&&this.dirtyLocalTransform(e,i);}},{key:"setLocalEulerAngles",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4];"number"==typeof t&&(t=U.vec3.fromValues(t,n,r));var a=e.transformable;U.quat.fromEuler(a.localRotation,t[0],t[1],t[2]),i&&this.dirtyLocalTransform(e,a);}},{key:"setLocalTransform",value:function(e,t){var n=U.mat4.getTranslation(r8,t),r=U.mat4.getRotation(r9,t),i=U.mat4.getScaling(ie,t);this.setLocalScale(e,i,!1),this.setLocalPosition(e,n,!1),this.setLocalRotation(e,r,void 0,void 0,void 0,!1),this.dirtyLocalTransform(e,e.transformable);}},{key:"resetLocalTransform",value:function(e){this.setLocalScale(e,r2,!1),this.setLocalPosition(e,r1,!1),this.setLocalEulerAngles(e,r1,void 0,void 0,!1),this.setLocalSkew(e,r0,void 0,!1),this.dirtyLocalTransform(e,e.transformable);}},{key:"getPosition",value:function(e){var t=e.transformable;return U.mat4.getTranslation(t.position,this.getWorldTransform(e,t));}},{key:"getRotation",value:function(e){var t=e.transformable;return U.mat4.getRotation(t.rotation,this.getWorldTransform(e,t));}},{key:"getScale",value:function(e){var t=e.transformable;return U.mat4.getScaling(t.scaling,this.getWorldTransform(e,t));}},{key:"getOrigin",value:function(e){return e.getGeometryBounds(),e.transformable.origin;}},{key:"getWorldTransform",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transformable;return(t.localDirtyFlag||t.dirtyFlag)&&(e.parentNode&&e.parentNode.transformable&&this.getWorldTransform(e.parentNode),this.internalUpdateTransform(e)),t.worldTransform;}},{key:"setPosition",value:function(e,t){var n,r=e.transformable;if(ir[0]=t[0],ir[1]=t[1],ir[2]=null!==(n=t[2])&&void 0!==n?n:0,!U.vec3.equals(this.getPosition(e),ir)){if(U.vec3.copy(r.position,ir),null!==e.parentNode&&e.parentNode.transformable){var i=e.parentNode.transformable;U.mat4.copy(ii,i.worldTransform),U.mat4.invert(ii,ii),U.vec3.transformMat4(r.localPosition,ir,ii);}else U.vec3.copy(r.localPosition,ir);this.dirtyLocalTransform(e,r);}}},{key:"translate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof t&&(t=U.vec3.set(r4,t,n,r)),U.vec3.equals(t,r1)||(U.vec3.add(r4,this.getPosition(e),t),this.setPosition(e,r4));}},{key:"setRotation",value:function(e,t,n,r,i){var a=e.transformable;if("number"==typeof t&&(t=U.quat.fromValues(t,n,r,i)),null!==e.parentNode&&e.parentNode.transformable){var o=this.getRotation(e.parentNode);U.quat.copy(r6,o),U.quat.invert(r6,r6),U.quat.multiply(a.localRotation,r6,t),U.quat.normalize(a.localRotation,a.localRotation),this.dirtyLocalTransform(e,a);}else this.setLocalRotation(e,t);}},{key:"rotate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof t&&(t=U.vec3.fromValues(t,n,r));var i=e.transformable;if(null!==e.parentNode&&e.parentNode.transformable){U.quat.fromEuler(r6,t[0],t[1],t[2]);var a=this.getRotation(e),o=this.getRotation(e.parentNode);U.quat.copy(is,o),U.quat.invert(is,is),U.quat.multiply(r6,is,r6),U.quat.multiply(i.localRotation,r6,a),U.quat.normalize(i.localRotation,i.localRotation),this.dirtyLocalTransform(e,i);}else this.rotateLocal(e,t);}},{key:"setOrigin",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof t&&(t=[t,n,r]);var i=e.transformable;if(t[0]!==i.origin[0]||t[1]!==i.origin[1]||t[2]!==i.origin[2]){var a=i.origin;a[0]=t[0],a[1]=t[1],a[2]=t[2]||0,this.dirtyLocalTransform(e,i);}}},{key:"setEulerAngles",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof t&&(t=U.vec3.fromValues(t,n,r));var i=e.transformable;if(null!==e.parentNode&&e.parentNode.transformable){U.quat.fromEuler(i.localRotation,t[0],t[1],t[2]);var a=this.getRotation(e.parentNode);U.quat.copy(ia,U.quat.invert(r6,a)),U.quat.mul(i.localRotation,i.localRotation,ia),this.dirtyLocalTransform(e,i);}else this.setLocalEulerAngles(e,t);}},{key:"getTransformedGeometryBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.getGeometryBounds(e,t);if(!eo.isEmpty(r)){var i=n||new eo;return i.setFromTransformedAABB(r,this.getWorldTransform(e)),i;}return null;}},{key:"getGeometryBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.geometry;return n.dirty&&im.styleValueRegistry.updateGeometry(e),(t?n.renderBounds:n.contentBounds||null)||new eo;}},{key:"getBounds",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.renderable;if(!r.boundsDirty&&!n&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&n&&r.renderBounds)return r.renderBounds;var i=n?r.renderBounds:r.bounds,a=this.getTransformedGeometryBounds(e,n,i);if(e.childNodes.forEach(function(e){var r=t.getBounds(e,n);r&&(a?a.add(r):(a=i||new eo).update(r.center,r.halfExtents));}),a||(a=new eo),n){var o=n7(e);if(o){var s=o.parsedStyle.clipPath.getBounds(n);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents);}}return n?(r.renderBounds=a,r.renderBoundsDirty=!1):(r.bounds=a,r.boundsDirty=!1),a;}},{key:"getLocalBounds",value:function(e){if(e.parentNode){var t=r3;e.parentNode.transformable&&(t=U.mat4.invert(r7,this.getWorldTransform(e.parentNode)));var n=this.getBounds(e);if(!eo.isEmpty(n)){var r=new eo;return r.setFromTransformedAABB(n,t),r;}}return this.getBounds(e);}},{key:"getBoundingClientRect",value:function(e){var t,n,r=this.getGeometryBounds(e);eo.isEmpty(r)||(n=new eo).setFromTransformedAABB(r,this.getWorldTransform(e));var i=null===(t=e.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t?void 0:t.getContextService().getBoundingClientRect();if(n){var a=n.getMin(),o=(0,z.default)(a,2),s=o[0],l=o[1],u=n.getMax(),c=(0,z.default)(u,2),d=c[0],f=c[1];return new ed(s+((null==i?void 0:i.left)||0),l+((null==i?void 0:i.top)||0),d-s,f-l);}return new ed((null==i?void 0:i.left)||0,(null==i?void 0:i.top)||0,0,0);}},{key:"internalUpdateTransform",value:function(e){var t,n,r=null===(n=e.parentNode)||void 0===n?void 0:n.transformable;ez(e.transformable),(t=e.transformable).dirtyFlag&&(r?U.mat4.multiply(t.worldTransform,r.worldTransform,t.localTransform):U.mat4.copy(t.worldTransform,t.localTransform),t.dirtyFlag=!1);}},{key:"internalUpdateElement",value:function(e,t){var n=(null===(s=e.ownerDocument)||void 0===s||null===(s=s.defaultView)||void 0===s||null===(s=s.getConfig())||void 0===s||null===(s=s.future)||void 0===s?void 0:s.experimentalAttributeUpdateOptimization)===!0,r=t[t.length-1],i=(null==r?void 0:r.transformDirty)||(null===(l=e.transformable)||void 0===l?void 0:l.localDirtyFlag);e.transformable&&((d=e.transformable).dirtyFlag||(d.dirtyFlag=i)),this.internalUpdateTransform(e),i&&(null===(f=e.dirty)||void 0===f||f.call(e,!0,!0));var a=(null===(u=e.renderable)||void 0===u?void 0:u.boundsDirty)||(null===(c=e.renderable)||void 0===c?void 0:c.renderBoundsDirty);if((i||a)&&(null==r?void 0:r.shapeUpdated)===!1&&n)for(var o=t.length-1;o>=0;){var s,l,u,c,d,f,h,p,v=t[o];if(v.shapeUpdated)break;null===(h=(p=v.node).dirty)||void 0===h||h.call(p,!0,!0),v.shapeUpdated=!0,o-=1;}return i;}},{key:"syncHierarchy",value:function(e){for(var t,n,r=[e],i=e.parentNode?[{node:e.parentNode,transformDirty:(null===(t=e.parentNode.transformable)||void 0===t?void 0:t.localDirtyFlag)||(null===(n=e.parentNode.transformable)||void 0===n?void 0:n.dirtyFlag),shapeUpdated:!1}]:[];r.length>0;){for(var a=r.pop(),o=i[i.length-1];i.length>0&&a.parentNode!==o.node;)o=i.pop();var s=this.internalUpdateElement(a,i);if(a.childNodes.length>0){for(var l=a.childNodes.length-1;l>=0;l--)r.push(a.childNodes[l]);i.push({node:a,transformDirty:s,shapeUpdated:!1});}}}},{key:"dirtyLocalTransform",value:function(e,t){re(e)||t.localDirtyFlag||(t.localDirtyFlag=!0,t.dirtyFlag||this.dirtyWorldTransform(e,t));}},{key:"dirtyWorldTransform",value:function(e,t){this.dirtifyWorldInternal(e,t),this.dirtyToRoot(e,!0);}},{key:"dirtifyWorldInternal",value:function(e,t){var n,r=this,i=(null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization)===!0;t.dirtyFlag||(t.dirtyFlag=!0,e.dirty(!0,!0),i||e.childNodes.forEach(function(e){var t=e.transformable;r.dirtifyWorldInternal(e,t);}));}},{key:"dirtyToRoot",value:function(e){for(var t,n,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e,o=(null===(t=e.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig())||void 0===t||null===(t=t.future)||void 0===t?void 0:t.experimentalAttributeUpdateOptimization)===!0;a&&(null===(n=(r=a).dirty)||void 0===n||n.call(r,!0,!0),!o);)a=a.parentNode;i&&e.forEach(function(e){var t;null===(t=e.dirty)||void 0===t||t.call(e,!0,!0);}),this.informDependentDisplayObjects(e),this.pendingEvents.set(e,i);}},{key:"dirtifyFragment",value:function(e){var t,n=e.transformable;n&&(n.dirtyFlag=!0,n.localDirtyFlag=!0),null===(t=e.dirty)||void 0===t||t.call(e,!0,!0);for(var r=e.childNodes.length,i=0;i<r;i++)this.dirtifyFragment(e.childNodes[i]);e.nodeName===$.FRAGMENT&&this.pendingEvents.set(e,!1);}},{key:"triggerPendingEvents",value:function(){var e,t,n=this,r=new Set,i=function(t,i){if(!(!t.isConnected||r.has(t))&&t.nodeName!==$.FRAGMENT){if(n.boundsChangedEvent.detail=i,n.boundsChangedEvent.target=t,t.isMutationObserved)t.dispatchEvent(n.boundsChangedEvent);else{if(void 0===e){var a;e=(null===(a=t.ownerDocument.defaultView)||void 0===a||null===(a=a.getConfig())||void 0===a||null===(a=a.future)||void 0===a?void 0:a.experimentalCancelEventPropagation)===!0;}t.ownerDocument.defaultView.dispatchEvent(n.boundsChangedEvent,!0,e);}r.add(t);}};this.pendingEvents.forEach(function(e,n){if(n.nodeName!==$.FRAGMENT){if(void 0===t){var r;t=(null===(r=n.ownerDocument)||void 0===r||null===(r=r.defaultView)||void 0===r||null===(r=r.getConfig())||void 0===r||null===(r=r.future)||void 0===r?void 0:r.experimentalAttributeUpdateOptimization)===!0;}il.affectChildren=e,t?i(n,il):e?n.forEach(function(e){i(e,il);}):i(n,il);}}),r.clear(),this.clearPendingEvents();}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear();}},{key:"updateDisplayObjectDependency",value:function(e,t,n,r){if(t&&t!==n){var i=this.displayObjectDependencyMap.get(t);if(i&&i[e]){var a=i[e].indexOf(r);i[e].splice(a,1);}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[e]||(o[e]=[]),o[e].push(r);}}},{key:"informDependentDisplayObjects",value:function(e){var t,n=this,r=this.displayObjectDependencyMap.get(e);if(r){var i=null===(t=e.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig())||void 0===t||null===(t=t.future)||void 0===t?void 0:t.experimentalCancelEventPropagation;Object.keys(r).forEach(function(e){r[e].forEach(function(t){n.dirtyToRoot(t,!0),t.dispatchEvent(new rQ(rK.ATTR_MODIFIED,t,n,n,e,rQ.MODIFICATION,n,n),i,i),t.isCustomElement&&t.isConnected&&t.attributeChangedCallback&&t.attributeChangedCallback(e,n,n);});});}}}]),ic=(0,O.default)(function e(t){if((0,N.default)(this,e),t<=0)throw Error("LRU capacity must be a positive number.");this.capacity=t,this.cache=new Map;},[{key:"get",value:function(e){if(this.cache.has(e)){var t=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,t),t;}}},{key:"put",value:function(e,t){if(this.cache.has(e)&&this.cache.delete(e),this.cache.set(e,t),this.cache.size>this.capacity){var n=this.cache.keys().next().value;this.cache.delete(n);}}},{key:"len",value:function(){return this.cache.size;}},{key:"clear",value:function(){this.cache.clear();}}]),id={MetricsString:"|\xc9q\xc5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},ih=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,ip=new RegExp("".concat(/[!%),.:;?\]}¢°·'""†‡›℃∶、。〃〆〕〗〞﹚﹜！＂％＇），．：；？！］｝～]/.source,"|").concat(/[!),.:;?\]}¢·–—'"•"、。〆〞〕〉》」︰︱︲︳﹐﹑﹒﹓﹔﹕﹖﹘﹚﹜！），．：；？︶︸︺︼︾﹀﹂﹗］｜｝､]/.source,"|").concat(/[)\]｝〕〉》」』】〙〗〟'"｠»ヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻‐゠–〜?!‼⁇⁈⁉・、:;,。.]/.source,"|").concat(/[!%),.:;?\]}¢°'"†‡℃〆〈《「『〕！％），．：；？］｝]/.source)),iv=new RegExp("".concat(/[$(£¥·'"〈《「『【〔〖〝﹙﹛＄（．［｛￡￥]/.source,"|").concat(/[([{£¥'"‵〈《「『〔〝︴﹙﹛（｛︵︷︹︻︽︿﹁﹃﹏]/.source,"|").concat(/[([｛〔〈《「『【〘〖〝'"｟«—...‥〳〴〵]/.source,"|").concat(/[$([{£¥'"々〇〉》」〔＄（［｛｠￥￦#]/.source)),ig=(0,O.default)(function e(t){var n=this;(0,N.default)(this,e),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(e,t){return!n.isBreakingSpace(t)&&!!(e&&(iv.exec(t)||ip.exec(e)));},this.trimByKinsokuShorui=function(e){var t=(0,I.default)(e),n=t[t.length-2];if(!n)return e;var r=n[n.length-1];return t[t.length-2]=n.slice(0,-1),t[t.length-1]=r+t[t.length-1],t;},this.runtime=t,this.charWidthCache=new ic(100);},[{key:"measureFont",value:function(e,t){if(this.fontMetricsCache[e])return this.fontMetricsCache[e];var n={ascent:0,descent:0,fontSize:0},r=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(t),i=this.runtime.offscreenCanvasCreator.getOrCreateContext(t,{willReadFrequently:!0});i.font=e;var a=id.MetricsString+id.BaselineSymbol,o=Math.ceil(i.measureText(a).width),s=Math.ceil(i.measureText(id.BaselineSymbol).width),l=id.HeightMultiplier*s;s=s*id.BaselineMultiplier|0,r.width=o,r.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(a,0,s);var u=i.getImageData(0,0,o||1,l||1).data,c=u.length,d=4*o,f=0,h=0,p=!1;for(f=0;f<s;++f){for(var v=0;v<d;v+=4)if(255!==u[h+v]){p=!0;break;}if(p)break;h+=d;}for(n.ascent=s-f,h=c-d,p=!1,f=l;f>s;--f){for(var g=0;g<d;g+=4)if(255!==u[h+g]){p=!0;break;}if(p)break;h-=d;}return n.descent=f-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[e]=n,n;}},{key:"measureText",value:function(e,t,n){var r=t.fontSize,i=void 0===r?16:r,a=t.wordWrap,o=t.lineHeight,s=t.lineWidth,l=void 0===s?1:s,u=t.textBaseline,c=void 0===u?"alphabetic":u,d=t.textAlign,f=void 0===d?"start":d,h=t.letterSpacing,p=void 0===h?0:h,v=t.textPath;t.textPathSide,t.textPathStartOffset;var g=t.leading,m=void 0===g?0:g,y=rb(t),b=this.measureFont(y,n);0===b.fontSize&&(b.fontSize=i,b.ascent=i);var _=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);_.font=y,t.isOverflowing=!1;var x=(void 0!==a&&a?this.wordWrap(e,t,n):e).split(/(?:\r\n|\r|\n)/),w=Array(x.length),E=0;if(v){v.getTotalLength();for(var M=0;M<x.length;M++)_.measureText(x[M]).width,x[M].length;}else{for(var S=0;S<x.length;S++){var k=_.measureText(x[S]).width+(x[S].length-1)*p;w[S]=k,E=Math.max(E,k);}var C=E+l,A=o||b.fontSize+l,L=Math.max(A,b.fontSize+l)+(x.length-1)*(A+m);A+=m;var P=0;return"middle"===c?P=-L/2:"bottom"===c||"alphabetic"===c||"ideographic"===c?P=-L:("top"===c||"hanging"===c)&&(P=0),{font:y,width:C,height:L,lines:x,lineWidths:w,lineHeight:A,maxLineWidth:E,fontProperties:b,lineMetrics:w.map(function(e,t){var n=0;return"center"===f||"middle"===f?n-=e/2:("right"===f||"end"===f)&&(n-=e),new ed(n-l/2,P+t*A,e+l,A);})};}}},{key:"wordWrap",value:function(e,t,n){var r=this,i=Array.from(e);if(0===i.length)return"";var a=this,o=t.wordWrapWidth,s=t.letterSpacing,l=void 0===s?0:s,u=t.maxLines,c=void 0===u?1/0:u,d=t.textOverflow,f=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),h=(void 0===o?0:o)+l,p="";"ellipsis"===d?p="...":d&&"clip"!==d&&(p=d);var v=[""],g=0,m=0,y=-1,b=rb(t),_=this.charWidthCache.get(b);_||(_=new ic(500),this.charWidthCache.put(b,_));var x=function(e){return r.getFromCache(e,l,_,f);},w=x(p);function E(e,t,n,r){for(;x(e)<r&&t<i.length-1&&!a.isNewline(i[t+1]);)t+=1,e+=i[t];for(;x(e)>r&&t>=n;)t-=1,e=e.slice(0,-1);return{lineTxt:e,txtLastCharIndex:t};}function M(e,t){if(!(w<=0)&&!(w>h)){if(!v[e]){v[e]=p;return;}var n=E(v[e],t,y+1,h-w);v[e]=n.lineTxt+p;}}for(var S=0;S<i.length;S++){var k=i[S],C=i[S-1],A=i[S+1],L=x(k);if(this.isNewline(k)){if(g+1>=c){S<i.length-1&&M(g,S-1),t.isOverflowing=!0;break;}y=S-1,m=0,v[g+=1]="";continue;}if(L>h){M(g,S-1),t.isOverflowing=!0;break;}if(m>0&&m+L>h){var P=E(v[g],S-1,y+1,h);if(P.txtLastCharIndex!==S-1){if(v[g]=P.lineTxt,P.txtLastCharIndex===i.length-1)break;k=i[S=P.txtLastCharIndex+1],C=i[S-1],A=i[S+1],L=x(k);}if(g+1>=c){M(g,S-1),t.isOverflowing=!0;break;}if(y=S-1,m=0,v[g+=1]="",this.isBreakingSpace(k))continue;this.canBreakInLastChar(k)||(v=this.trimToBreakable(v),m=this.sumTextWidthByCache(v[g]||"",x)),this.shouldBreakByKinsokuShorui(k,A)&&(v=this.trimByKinsokuShorui(v),m+=x(C||""));}m+=L,v[g]+=k;}return v.join("\n");}},{key:"isBreakingSpace",value:function(e){return"string"==typeof e&&id.BreakingSpaces.indexOf(e.charCodeAt(0))>=0;}},{key:"isNewline",value:function(e){return"string"==typeof e&&id.Newlines.indexOf(e.charCodeAt(0))>=0;}},{key:"trimToBreakable",value:function(e){var t=(0,I.default)(e),n=t[t.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return t;var i=n.slice(r,r+1),a=this.isBreakingSpace(i);return t[t.length-1]+=n.slice(r+1,n.length),t[t.length-2]=n.slice(0,r+(a?0:1)),t;}},{key:"canBreakInLastChar",value:function(e){return!(e&&ih.test(e));}},{key:"sumTextWidthByCache",value:function(e,t){return e.split("").reduce(function(e,n){return e+t(n);},0);}},{key:"findBreakableIndex",value:function(e){for(var t=e.length-1;t>=0;t--)if(!ih.test(e[t]))return t;return -1;}},{key:"getFromCache",value:function(e,t,n,r){var i=n.get(e);if("number"!=typeof i){var a=e.length*t;i=r.measureText(e).width+a,n.put(e,i);}return i;}},{key:"clearCache",value:function(){this.fontMetricsCache={},this.charWidthCache.clear();}}]),im={},iy=(E=new rz,M=new rD,w={},(0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)(w,$.FRAGMENT,null),$.CIRCLE,new rN),$.ELLIPSE,new rO),$.RECT,E),$.IMAGE,E),$.GROUP,new rU),$.LINE,new rI),$.TEXT,new rB(im)),$.POLYLINE,M),$.POLYGON,M),(0,j.default)((0,j.default)((0,j.default)(w,$.PATH,new rR),$.HTML,new rF),$.MESH,null)),ib=(k=new nG,C=new nZ,S={},(0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)(S,eU.PERCENTAGE,null),eU.NUMBER,new n$),eU.ANGLE,new nj),eU.DEFINED_PATH,new nV),eU.PAINT,k),eU.COLOR,k),eU.FILTER,new nH),eU.LENGTH,C),eU.LENGTH_PERCENTAGE,C),eU.LENGTH_PERCENTAGE_12,new nq),(0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)(S,eU.LENGTH_PERCENTAGE_14,new nY),eU.COORDINATE,new nZ),eU.OFFSET_DISTANCE,new nK),eU.OPACITY_VALUE,new nQ),eU.PATH,new nJ),eU.LIST_OF_POINTS,new n0),eU.SHADOW_BLUR,new n1),eU.TEXT,new n2),eU.TEXT_TRANSFORM,new n3),eU.TRANSFORM,new rA),(0,j.default)((0,j.default)((0,j.default)(S,eU.TRANSFORM_ORIGIN,new rL),eU.Z_INDEX,new rP),eU.MARKER,new nX));im.CameraContribution=eP,im.AnimationTimeline=null,im.EasingFunction=null,im.offscreenCanvasCreator=new rq,im.sceneGraphSelector=new r$,im.sceneGraphService=new iu(im),im.textService=new ig(im),im.geometryUpdaterFactory=iy,im.CSSPropertySyntaxFactory=ib,im.styleValueRegistry=new nU(im),im.layoutRegistry=null,im.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==Y?Y:{},im.enableStyleSyntax=!0,im.enableSizeAttenuation=!1;var i_=0,ix=new rQ(rK.INSERTED,null,"","","",0,"",""),iw=new rQ(rK.REMOVED,null,"","","",0,"",""),iE=new rW(rK.DESTROY),iM=function(e){function t(){var e;(0,N.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,R.default)(this,t,[].concat(r))).entity=i_++,e.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},e.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},e.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},e.cullable={strategy:eN.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},e.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},e.rBushNode={aabb:void 0},e.namespaceURI="g",e.scrollLeft=0,e.scrollTop=0,e.clientTop=0,e.clientLeft=0,e.style={},e.computedStyle={},e.parsedStyle={},e.attributes={},e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"dirty",value:function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.renderable.dirty=e,t&&(this.renderable.boundsDirty=e,this.renderable.renderBoundsDirty=e);}},{key:"className",get:function(){return this.getAttribute("class")||"";},set:function(e){this.setAttribute("class",e);}},{key:"classList",get:function(){return this.className.split(" ").filter(function(e){return""!==e;});}},{key:"tagName",get:function(){return this.nodeName;}},{key:"children",get:function(){return this.childNodes;}},{key:"childElementCount",get:function(){return this.childNodes.length;}},{key:"firstElementChild",get:function(){return this.firstChild;}},{key:"lastElementChild",get:function(){return this.lastChild;}},{key:"parentElement",get:function(){return this.parentNode;}},{key:"nextSibling",get:function(){if(this.parentNode){var e=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[e+1]||null;}return null;}},{key:"previousSibling",get:function(){if(this.parentNode){var e=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[e-1]||null;}return null;}},{key:"cloneNode",value:function(e){throw Error(ef);}},{key:"appendChild",value:function(e,t){var n;if(e.destroyed)throw Error("Cannot append a destroyed element.");return im.sceneGraphService.attach(e,this,t),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(re(this)||e.nodeName!==$.FRAGMENT?this.ownerDocument.defaultView.mountChildren(e):this.ownerDocument.defaultView.mountFragment(e)),this.isMutationObserved&&(ix.relatedNode=this,e.dispatchEvent(ix)),e;}},{key:"insertBefore",value:function(e,t){if(t){e.parentElement&&e.parentElement.removeChild(e);var n=this.childNodes.indexOf(t);-1===n?this.appendChild(e):this.appendChild(e,n);}else this.appendChild(e);return e;}},{key:"replaceChild",value:function(e,t){var n=this.childNodes.indexOf(t);return this.removeChild(t),this.appendChild(e,n),t;}},{key:"removeChild",value:function(e){var t,n,r=(null===(t=this.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation)===!0;return iw.relatedNode=this,e.dispatchEvent(iw,r,r),null!==(n=e.ownerDocument)&&void 0!==n&&n.defaultView&&e.ownerDocument.defaultView.unmountChildren(e),im.sceneGraphService.detach(e),e;}},{key:"removeChildren",value:function(){for(var e=this.childNodes.length-1;e>=0;e--){var t=this.childNodes[e];this.removeChild(t);}}},{key:"destroyChildren",value:function(){for(var e=this.childNodes.length-1;e>=0;e--){var t=this.childNodes[e];t.childNodes.length>0&&t.destroyChildren(),t.destroy();}}},{key:"matches",value:function(e){return im.sceneGraphService.matches(e,this);}},{key:"getElementById",value:function(e){return im.sceneGraphService.querySelector("#".concat(e),this);}},{key:"getElementsByName",value:function(e){return im.sceneGraphService.querySelectorAll('[name="'.concat(e,'"]'),this);}},{key:"getElementsByClassName",value:function(e){return im.sceneGraphService.querySelectorAll(".".concat(e),this);}},{key:"getElementsByTagName",value:function(e){return im.sceneGraphService.querySelectorAll(e,this);}},{key:"querySelector",value:function(e){return im.sceneGraphService.querySelector(e,this);}},{key:"querySelectorAll",value:function(e){return im.sceneGraphService.querySelectorAll(e,this);}},{key:"closest",value:function(e){var t=this;do{if(im.sceneGraphService.matches(e,t))return t;t=t.parentElement;}while(null!==t)return null;}},{key:"find",value:function(e){var t=this,n=null;return this.forEach(function(r){return!(r!==t&&e(r))||(n=r,!1);}),n;}},{key:"findAll",value:function(e){var t=this,n=[];return this.forEach(function(r){r!==t&&e(r)&&n.push(r);}),n;}},{key:"after",value:function(){var e=this;if(this.parentNode){for(var t=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(n,r){var i;return null===(i=e.parentNode)||void 0===i?void 0:i.appendChild(n,t+r+1);});}}},{key:"before",value:function(){if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n[0],a=n.slice(1);this.parentNode.appendChild(i,e),i.after.apply(i,(0,I.default)(a));}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove();}},{key:"append",value:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach(function(t){return e.appendChild(t);});}},{key:"prepend",value:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach(function(t,n){return e.appendChild(t,n);});}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments);}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this;}},{key:"destroy",value:function(){var e,t=(null===(e=this.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;this.destroyChildren(),this.dispatchEvent(iE,t,t),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0;}},{key:"getGeometryBounds",value:function(){return im.sceneGraphService.getGeometryBounds(this);}},{key:"getRenderBounds",value:function(){return im.sceneGraphService.getBounds(this,!0);}},{key:"getBounds",value:function(){return im.sceneGraphService.getBounds(this);}},{key:"getLocalBounds",value:function(){return im.sceneGraphService.getLocalBounds(this);}},{key:"getBoundingClientRect",value:function(){return im.sceneGraphService.getBoundingClientRect(this);}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle));}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes);}},{key:"getAttribute",value:function(e){if("symbol"!=typeof e)return this.attributes[e];}},{key:"hasAttribute",value:function(e){return this.getAttributeNames().includes(e);}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length;}},{key:"removeAttribute",value:function(e){this.setAttribute(e,null),delete this.attributes[e];}},{key:"setAttribute",value:function(e,t,n,r){this.attributes[e]=t;}},{key:"getAttributeNS",value:function(e,t){throw Error(ef);}},{key:"getAttributeNode",value:function(e){throw Error(ef);}},{key:"getAttributeNodeNS",value:function(e,t){throw Error(ef);}},{key:"hasAttributeNS",value:function(e,t){throw Error(ef);}},{key:"removeAttributeNS",value:function(e,t){throw Error(ef);}},{key:"removeAttributeNode",value:function(e){throw Error(ef);}},{key:"setAttributeNS",value:function(e,t,n){throw Error(ef);}},{key:"setAttributeNode",value:function(e){throw Error(ef);}},{key:"setAttributeNodeNS",value:function(e){throw Error(ef);}},{key:"toggleAttribute",value:function(e,t){throw Error(ef);}}]);}(rZ);function iT(e){return!!(null!=e&&e.nodeName);}var iS=im.globalThis.Proxy?im.globalThis.Proxy:function(){},ik=new rQ(rK.ATTR_MODIFIED,null,null,null,null,rQ.MODIFICATION,null,null),iC=U.vec3.create(),iA=U.quat.create(),iL=function(e){function t(e){var n;return(0,N.default)(this,t),(n=(0,R.default)(this,t)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=e,n.id=e.id||"",n.name=e.name||"",(e.className||e.class)&&(n.className=e.className||e.class),n.nodeName=e.type||$.GROUP,e.initialParsedStyle&&Object.assign(n.parsedStyle,e.initialParsedStyle),n.initAttributes(e.style),im.enableStyleSyntax&&(n.style=new iS({setProperty:function(e,t){n.setAttribute(e,t);},getPropertyValue:function(e){return n.getAttribute(e);},removeProperty:function(e){n.removeAttribute(e);},item:function(){return"";}},{get:function(e,t){return void 0!==e[t]?e[t]:n.getAttribute(t);},set:function(e,t,r){return n.setAttribute(t,r),!0;}})),n;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"destroy",value:function(){(0,V.default)(t,"destroy",this,3)([]),this.getAnimations().forEach(function(e){e.cancel();});}},{key:"cloneNode",value:function(e,t){var n=(0,P.default)({},this.attributes);for(var r in n){var i=n[r];iT(i)&&"clipPath"!==r&&"offsetPath"!==r&&"textPath"!==r&&(n[r]=i.cloneNode(e)),t&&(n[r]=t(r,i));}var a=new this.constructor((0,P.default)((0,P.default)({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),e&&this.children.forEach(function(t){if(!t.style.isMarker){var n=t.cloneNode(e);a.appendChild(n);}}),a;}},{key:"initAttributes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};im.styleValueRegistry.processProperties(this,e,{forceUpdateGeometry:!0}),this.dirty();}},{key:"setAttribute",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];!(0,F.isUndefined)(n)&&(r||n!==this.attributes[e])&&(this.internalSetAttribute(e,n,{memoize:i}),(0,V.default)(t,"setAttribute",this,3)([e,n]));}},{key:"internalSetAttribute",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.attributes[e],a=this.parsedStyle[e];im.styleValueRegistry.processProperties(this,(0,j.default)({},e,t),r),this.dirty();var o=this.parsedStyle[e];if(this.isConnected){if(ik.relatedNode=this,ik.prevValue=i,ik.newValue=t,ik.attrName=e,ik.prevParsedValue=a,ik.newParsedValue=o,this.isMutationObserved)this.dispatchEvent(ik);else{var s,l=(null===(s=this.ownerDocument.defaultView.getConfig().future)||void 0===s?void 0:s.experimentalCancelEventPropagation)===!0;ik.target=this,this.ownerDocument.defaultView.dispatchEvent(ik,!0,l);}}(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(n=this.attributeChangedCallback)||void 0===n||n.call(this,e,i,t,a,o));}},{key:"getBBox",value:function(){var e=this.getBounds(),t=e.getMin(),n=(0,z.default)(t,2),r=n[0],i=n[1],a=e.getMax(),o=(0,z.default)(a,2);return new ed(r,i,o[0]-r,o[1]-i);}},{key:"setOrigin",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return im.sceneGraphService.setOrigin(this,ev(e,t,n,!1)),this;}},{key:"getOrigin",value:function(){return im.sceneGraphService.getOrigin(this);}},{key:"setPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return im.sceneGraphService.setPosition(this,ev(e,t,n,!1)),this;}},{key:"setLocalPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return im.sceneGraphService.setLocalPosition(this,ev(e,t,n,!1)),this;}},{key:"translate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return im.sceneGraphService.translate(this,ev(e,t,n,!1)),this;}},{key:"translateLocal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return im.sceneGraphService.translateLocal(this,ev(e,t,n,!1)),this;}},{key:"getPosition",value:function(){return im.sceneGraphService.getPosition(this);}},{key:"getLocalPosition",value:function(){return im.sceneGraphService.getLocalPosition(this);}},{key:"scale",value:function(e,t,n){return this.scaleLocal(e,t,n);}},{key:"scaleLocal",value:function(e,t,n){return"number"==typeof e&&(t=t||e,n=n||e,e=ev(e,t,n,!1)),im.sceneGraphService.scaleLocal(this,e),this;}},{key:"setLocalScale",value:function(e,t,n){return"number"==typeof e&&(t=t||e,n=n||e,e=ev(e,t,n,!1)),im.sceneGraphService.setLocalScale(this,e),this;}},{key:"getLocalScale",value:function(){return im.sceneGraphService.getLocalScale(this);}},{key:"getScale",value:function(){return im.sceneGraphService.getScale(this);}},{key:"getEulerAngles",value:function(){var e=eb(iC,im.sceneGraphService.getWorldTransform(this));return(0,z.default)(e,3)[2]*em;}},{key:"getLocalEulerAngles",value:function(){var e=eb(iC,im.sceneGraphService.getLocalRotation(this));return(0,z.default)(e,3)[2]*em;}},{key:"setEulerAngles",value:function(e){return im.sceneGraphService.setEulerAngles(this,0,0,e),this;}},{key:"setLocalEulerAngles",value:function(e){return im.sceneGraphService.setLocalEulerAngles(this,0,0,e),this;}},{key:"rotateLocal",value:function(e,t,n){return(0,F.isNil)(t)&&(0,F.isNil)(n)?im.sceneGraphService.rotateLocal(this,0,0,e):im.sceneGraphService.rotateLocal(this,e,t,n),this;}},{key:"rotate",value:function(e,t,n){return(0,F.isNil)(t)&&(0,F.isNil)(n)?im.sceneGraphService.rotate(this,0,0,e):im.sceneGraphService.rotate(this,e,t,n),this;}},{key:"setRotation",value:function(e,t,n,r){return im.sceneGraphService.setRotation(this,e,t,n,r),this;}},{key:"setLocalRotation",value:function(e,t,n,r){return im.sceneGraphService.setLocalRotation(this,e,t,n,r),this;}},{key:"setLocalSkew",value:function(e,t){return im.sceneGraphService.setLocalSkew(this,e,t),this;}},{key:"getRotation",value:function(){return im.sceneGraphService.getRotation(this);}},{key:"getLocalRotation",value:function(){return im.sceneGraphService.getLocalRotation(this);}},{key:"getLocalSkew",value:function(){return im.sceneGraphService.getLocalSkew(this);}},{key:"getLocalTransform",value:function(){return im.sceneGraphService.getLocalTransform(this);}},{key:"getWorldTransform",value:function(){return im.sceneGraphService.getWorldTransform(this);}},{key:"setLocalTransform",value:function(e){return im.sceneGraphService.setLocalTransform(this,e),this;}},{key:"resetLocalTransform",value:function(){im.sceneGraphService.resetLocalTransform(this);}},{key:"getAnimations",value:function(){return this.activeAnimations;}},{key:"animate",value:function(e,t){var n,r=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return r?r.play(this,e,t):null;}},{key:"isVisible",value:function(){var e;return(null===(e=this.parsedStyle)||void 0===e?void 0:e.visibility)!=="hidden";}},{key:"interactive",get:function(){return this.isInteractive();},set:function(e){this.style.pointerEvents=e?"auto":"none";}},{key:"isInteractive",value:function(){var e;return(null===(e=this.parsedStyle)||void 0===e?void 0:e.pointerEvents)!=="none";}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible);}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,I.default)(this.parentNode.children.map(function(e){return Number(e.style.zIndex);})))+1),this;}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,I.default)(this.parentNode.children.map(function(e){return Number(e.style.zIndex);})))-1),this;}},{key:"getConfig",value:function(){return this.config;}},{key:"attr",value:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n[0],a=n[1];return i?(0,F.isObject)(i)?(Object.keys(i).forEach(function(t){e.setAttribute(t,i[t]);}),this):2===n.length?(this.setAttribute(i,a),this):this.attributes[i]:this.attributes;}},{key:"getMatrix",value:function(e){var t,n,r,i=e||this.getWorldTransform(),a=U.mat4.getTranslation(iC,i),o=(0,z.default)(a,2),s=o[0],l=o[1],u=U.mat4.getScaling(iC,i),c=(0,z.default)(u,2),d=c[0],f=c[1],h=eb(iC,U.mat4.getRotation(iA,i)),p=(0,z.default)(h,3),v=p[0],g=p[2];return n=Math.cos(t=v||g),r=Math.sin(t),U.mat3.fromValues(d*n,f*r,0,-d*r,f*n,0,s,l,1);}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform());}},{key:"setMatrix",value:function(e){var t=e_(e),n=(0,z.default)(t,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setEulerAngles(s).setPosition(r,i).setLocalScale(a,o);}},{key:"setLocalMatrix",value:function(e){var t=e_(e),n=(0,z.default)(t,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setLocalEulerAngles(s).setLocalPosition(r,i).setLocalScale(a,o);}},{key:"show",value:function(){this.forEach(function(e){e.style.visibility="visible";});}},{key:"hide",value:function(){this.forEach(function(e){e.style.visibility="hidden";});}},{key:"getCount",value:function(){return this.childElementCount;}},{key:"getParent",value:function(){return this.parentElement;}},{key:"getChildren",value:function(){return this.children;}},{key:"getFirst",value:function(){return this.firstElementChild;}},{key:"getLast",value:function(){return this.lastElementChild;}},{key:"getChildByIndex",value:function(e){return this.children[e]||null;}},{key:"add",value:function(e,t){return this.appendChild(e,t);}},{key:"set",value:function(e,t){this.config[e]=t;}},{key:"get",value:function(e){return this.config[e];}},{key:"moveTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(e,t,n),this;}},{key:"move",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(e,t,n),this;}},{key:"setZIndex",value:function(e){return this.style.zIndex=e,this;}}]);}(iM);iL.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var iP=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:$.CIRCLE},e)]);}return(0,D.default)(t,e),(0,O.default)(t);}(iL);iP.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(iL.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var iN=["style"];(function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iN);return(0,N.default)(this,t),(e=(0,R.default)(this,t,[(0,P.default)({style:r},i)])).isCustomElement=!0,e;}return(0,D.default)(t,e),(0,O.default)(t);})(iL).PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iO=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:$.ELLIPSE},e)]);}return(0,D.default)(t,e),(0,O.default)(t);}(iL);iO.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(iL.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),function(e){function t(){return(0,N.default)(this,t),(0,R.default)(this,t,[{type:$.FRAGMENT}]);}return(0,D.default)(t,e),(0,O.default)(t);}(iL).PARSED_STYLE_LIST=new Set(["class","className"]);var iI=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:$.GROUP},e)]);}return(0,D.default)(t,e),(0,O.default)(t);}(iL);iI.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iR=["style"],iD=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iR);return(0,N.default)(this,t),(e=(0,R.default)(this,t,[(0,P.default)({type:$.HTML,style:r},i)])).cullable.enable=!1,e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"getDomElement",value:function(){return this.parsedStyle.$el;}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"getLocalBounds",value:function(){if(this.parentNode){var e=U.mat4.invert(U.mat4.create(),this.parentNode.getWorldTransform()),t=this.getBounds();if(!eo.isEmpty(t)){var n=new eo;return n.setFromTransformedAABB(t,e),n;}}return this.getBounds();}}]);}(iL);iD.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(iL.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var iz=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:$.IMAGE},e)]);}return(0,D.default)(t,e),(0,O.default)(t);}(iL);iz.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(iL.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var iB=["style"],iU=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iB);(0,N.default)(this,t),(e=(0,R.default)(this,t,[(0,P.default)({type:$.LINE,style:(0,P.default)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},r)},i)])).markerStartAngle=0,e.markerEndAngle=0;var a=e.parsedStyle,o=a.markerStart,s=a.markerEnd;return o&&iT(o)&&(e.markerStartAngle=o.getLocalEulerAngles(),e.appendChild(o)),s&&iT(s)&&(e.markerEndAngle=s.getLocalEulerAngles(),e.appendChild(s)),e.transformMarker(!0),e.transformMarker(!1),e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"attributeChangedCallback",value:function(e,t,n,r,i){"x1"===e||"y1"===e||"x2"===e||"y2"===e||"markerStartOffset"===e||"markerEndOffset"===e?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===e?(r&&iT(r)&&(this.markerStartAngle=0,r.remove()),i&&iT(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===e&&(r&&iT(r)&&(this.markerEndAngle=0,r.remove()),i&&iT(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)));}},{key:"transformMarker",value:function(e){var t,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,d=s.markerEndOffset,f=s.x1,h=s.x2,p=s.y1,v=s.y2,g=e?l:u;if(g&&iT(g)){var m=0;e?(r=f,i=p,t=h-f,n=v-p,a=c||0,o=this.markerStartAngle):(r=h,i=v,t=f-h,n=p-v,a=d||0,o=this.markerEndAngle),m=Math.atan2(n,t),g.setLocalEulerAngles(180*m/Math.PI+o),g.setLocalPosition(r+Math.cos(m)*a,i+Math.sin(m)*a);}}},{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,r=n.x1,i=n.y1,a=n.x2,o=n.y2,s=(0,G.linePointAt)(r,i,a,o,e),l=s.x,u=s.y,c=U.vec3.transformMat4(U.vec3.create(),U.vec3.fromValues(l,u,0),t?this.getWorldTransform():this.getLocalTransform());return new ec(c[0],c[1]);}},{key:"getPointAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(e/this.getTotalLength(),t);}},{key:"getTotalLength",value:function(){var e=this.parsedStyle,t=e.x1,n=e.y1,r=e.x2,i=e.y2;return(0,G.lineLength)(t,n,r,i);}}]);}(iL);iU.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(iL.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var iF=["style"],ij=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iF);(0,N.default)(this,t),(e=(0,R.default)(this,t,[(0,P.default)({type:$.PATH,style:r,initialParsedStyle:{miterLimit:4,d:(0,P.default)({},eB)}},i)])).markerStartAngle=0,e.markerEndAngle=0,e.markerMidList=[];var a=e.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&iT(o)&&(e.markerStartAngle=o.getLocalEulerAngles(),e.appendChild(o)),l&&iT(l)&&e.placeMarkerMid(l),s&&iT(s)&&(e.markerEndAngle=s.getLocalEulerAngles(),e.appendChild(s)),e.transformMarker(!0),e.transformMarker(!1),e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"attributeChangedCallback",value:function(e,t,n,r,i){"d"===e?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===e||"markerEndOffset"===e?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===e?(r&&iT(r)&&(this.markerStartAngle=0,r.remove()),i&&iT(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===e?(r&&iT(r)&&(this.markerEndAngle=0,r.remove()),i&&iT(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===e&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(e){var t,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,d=s.markerEndOffset,f=e?l:u;if(f&&iT(f)){var h=0;if(e){var p=this.getStartTangent(),v=(0,z.default)(p,2),g=v[0],m=v[1];r=m[0],i=m[1],t=g[0]-m[0],n=g[1]-m[1],a=c||0,o=this.markerStartAngle;}else{var y=this.getEndTangent(),b=(0,z.default)(y,2),_=b[0],x=b[1];r=x[0],i=x[1],t=_[0]-x[0],n=_[1]-x[1],a=d||0,o=this.markerEndAngle;}h=Math.atan2(n,t),f.setLocalEulerAngles(180*h/Math.PI+o),f.setLocalPosition(r+Math.cos(h)*a,i+Math.sin(h)*a);}}},{key:"placeMarkerMid",value:function(e){var t=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(e){e.remove();}),e&&iT(e))for(var n=1;n<t.length-1;n++){var r=(0,z.default)(t[n].currentPoint,2),i=r[0],a=r[1],o=1===n?e:e.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(i,a);}}},{key:"getTotalLength",value:function(){return nr(this);}},{key:"getPointAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.d.absolutePath,r=(0,F.getPointAtLength)(n,e),i=r.x,a=r.y,o=U.vec3.transformMat4(U.vec3.create(),U.vec3.fromValues(i,a,0),t?this.getWorldTransform():this.getLocalTransform());return new ec(o[0],o[1]);}},{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(e*nr(this),t);}},{key:"getStartTangent",value:function(){var e=this.parsedStyle.d.segments,t=[];if(e.length>1){var n=e[0].currentPoint,r=e[1].currentPoint,i=e[1].startTangent;t=[],i?t.push([n[0]-i[0],n[1]-i[1]]):t.push([r[0],r[1]]),t.push([n[0],n[1]]);}return t;}},{key:"getEndTangent",value:function(){var e=this.parsedStyle.d.segments,t=e.length,n=[];if(t>1){var r=e[t-2].currentPoint,i=e[t-1].currentPoint,a=e[t-1].endTangent;n=[],a?n.push([i[0]-a[0],i[1]-a[1]]):n.push([r[0],r[1]]),n.push([i[0],i[1]]);}return n;}}]);}(iL);ij.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(iL.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var iV=["style"],iG=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iV);(0,N.default)(this,t),(e=(0,R.default)(this,t,[(0,P.default)({type:$.POLYGON,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},i)])).markerStartAngle=0,e.markerEndAngle=0,e.markerMidList=[];var a=e.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&iT(o)&&(e.markerStartAngle=o.getLocalEulerAngles(),e.appendChild(o)),l&&iT(l)&&e.placeMarkerMid(l),s&&iT(s)&&(e.markerEndAngle=s.getLocalEulerAngles(),e.appendChild(s)),e.transformMarker(!0),e.transformMarker(!1),e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"attributeChangedCallback",value:function(e,t,n,r,i){"points"===e?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===e||"markerEndOffset"===e?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===e?(r&&iT(r)&&(this.markerStartAngle=0,r.remove()),i&&iT(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===e?(r&&iT(r)&&(this.markerEndAngle=0,r.remove()),i&&iT(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===e&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(e){var t,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,d=s.markerEndOffset,f=(s.points||{}).points,h=e?l:u;if(h&&iT(h)&&f){var p=0;if(r=f[0][0],i=f[0][1],e)t=f[1][0]-f[0][0],n=f[1][1]-f[0][1],a=c||0,o=this.markerStartAngle;else{var v=f.length;this.parsedStyle.isClosed?(t=f[v-1][0]-f[0][0],n=f[v-1][1]-f[0][1]):(r=f[v-1][0],i=f[v-1][1],t=f[v-2][0]-f[v-1][0],n=f[v-2][1]-f[v-1][1]),a=d||0,o=this.markerEndAngle;}p=Math.atan2(n,t),h.setLocalEulerAngles(180*p/Math.PI+o),h.setLocalPosition(r+Math.cos(p)*a,i+Math.sin(p)*a);}}},{key:"placeMarkerMid",value:function(e){var t=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach(function(e){e.remove();}),this.markerMidList=[],e&&iT(e)&&t)for(var n=1;n<(this.parsedStyle.isClosed?t.length:t.length-1);n++){var r=t[n][0],i=t[n][1],a=1===n?e:e.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(r,i);}}}]);}(iL);iG.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(iL.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var iH=["style"],iW=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.style,r=(0,q.default)(e,iH);return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:$.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},r)]);}return(0,D.default)(t,e),(0,O.default)(t,[{key:"getTotalLength",value:function(){return 0===this.parsedStyle.points.totalLength&&(this.parsedStyle.points.totalLength=(0,G.polylineLength)(this.parsedStyle.points.points)),this.parsedStyle.points.totalLength;}},{key:"getPointAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(e/this.getTotalLength(),t);}},{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var r,i,a=[],o=0,s=this.getTotalLength();n.forEach(function(e,t){n[t+1]&&((r=[0,0])[0]=o/s,i=(0,G.lineLength)(e[0],e[1],n[t+1][0],n[t+1][1]),o+=i,r[1]=o/s,a.push(r));}),this.parsedStyle.points.segments=a;}var l=0,u=0;this.parsedStyle.points.segments.forEach(function(t,n){e>=t[0]&&e<=t[1]&&(l=(e-t[0])/(t[1]-t[0]),u=n);});var c=(0,G.linePointAt)(n[u][0],n[u][1],n[u+1][0],n[u+1][1],l),d=c.x,f=c.y,h=U.vec3.transformMat4(U.vec3.create(),U.vec3.fromValues(d,f,0),t?this.getWorldTransform():this.getLocalTransform());return new ec(h[0],h[1]);}},{key:"getStartTangent",value:function(){var e=this.parsedStyle.points.points,t=[];return t.push([e[1][0],e[1][1]]),t.push([e[0][0],e[0][1]]),t;}},{key:"getEndTangent",value:function(){var e=this.parsedStyle.points.points,t=e.length-1,n=[];return n.push([e[t-1][0],e[t-1][1]]),n.push([e[t][0],e[t][1]]),n;}}]);}(iG);iW.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(iG.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var iZ=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:$.RECT},e)]);}return(0,D.default)(t,e),(0,O.default)(t);}(iL);iZ.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(iL.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var iq=["style"],iY=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.style,r=(0,q.default)(e,iq);return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:$.TEXT,style:(0,P.default)({fill:"black"},n)},r)]);}return(0,D.default)(t,e),(0,O.default)(t,[{key:"getComputedTextLength",value:function(){var e;return this.getGeometryBounds(),(null===(e=this.parsedStyle.metrics)||void 0===e?void 0:e.maxLineWidth)||0;}},{key:"getLineBoundingRects",value:function(){var e;return this.getGeometryBounds(),(null===(e=this.parsedStyle.metrics)||void 0===e?void 0:e.lineMetrics)||[];}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing;}}]);}(iL);iY.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(iL.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textPathSide","textPathStartOffset","metrics","dx","dy"])),(0,O.default)(function e(){(0,N.default)(this,e),this.registry={},this.define($.CIRCLE,iP),this.define($.ELLIPSE,iO),this.define($.RECT,iZ),this.define($.IMAGE,iz),this.define($.LINE,iU),this.define($.GROUP,iI),this.define($.PATH,ij),this.define($.POLYGON,iG),this.define($.POLYLINE,iW),this.define($.TEXT,iY),this.define($.HTML,iD);},[{key:"define",value:function(e,t){this.registry[e]=t;}},{key:"get",value:function(e){return this.registry[e];}}]),function(){function e(t){(0,N.default)(this,e),this.strategies=t;}return(0,O.default)(e,[{key:"apply",value:function(t){var n=t.config,r=t.camera,i=t.renderingService,a=t.renderingContext,o=this.strategies;i.hooks.cull.tap(e.tag,function(e){if(e){var t,i=e.cullable;if(0===o.length?i.visible=a.unculledEntities.indexOf(e.entity)>-1:i.visible=o.every(function(t){return t.isVisible(r,e);}),!e.isCulled()&&e.isVisible())return e;var s=(null===(t=n.future)||void 0===t?void 0:t.experimentalCancelEventPropagation)===!0;return e.dispatchEvent(new rW(rK.CULLED),s,s),null;}return e;}),i.hooks.afterRender.tap(e.tag,function(e){e.cullable.visibilityPlaneMask=-1;});}}]);}().tag="Culling",function(){function e(){var t=this;(0,N.default)(this,e),this.autoPreventDefault=!1,this.rootPointerEvent=new rG(null),this.rootWheelEvent=new rH(null),this.onPointerMove=function(e){var n=null===(r=t.context.renderingContext.root)||void 0===r||null===(r=r.ownerDocument)||void 0===r?void 0:r.defaultView;if(!n.supportsTouchEvents||"touch"!==e.pointerType){var r,i,a=t.normalizeToPointerEvent(e,n),o=(0,Z.default)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=t.bootstrapEvent(t.rootPointerEvent,s,n,e);t.context.eventService.mapEvent(l);}}catch(e){o.e(e);}finally{o.f();}t.setCursor(t.context.eventService.cursor);}},this.onClick=function(e){var n,r,i=null===(n=t.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,a=t.normalizeToPointerEvent(e,i),o=(0,Z.default)(a);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=t.bootstrapEvent(t.rootPointerEvent,s,i,e);t.context.eventService.mapEvent(l);}}catch(e){o.e(e);}finally{o.f();}t.setCursor(t.context.eventService.cursor);};}return(0,O.default)(e,[{key:"apply",value:function(t){var n=this;this.context=t;var r=t.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(e){return n.context.renderingService.hooks.pickSync.call({position:e,picked:[],topmost:!0}).picked[0]||null;}),r.hooks.pointerWheel.tap(e.tag,function(e){var t=n.normalizeWheelEvent(e);n.context.eventService.mapEvent(t);}),r.hooks.pointerDown.tap(e.tag,function(e){if(!i.supportsTouchEvents||"touch"!==e.pointerType){var t=n.normalizeToPointerEvent(e,i);n.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();var r,a=(0,Z.default)(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,e);n.context.eventService.mapEvent(s);}}catch(e){a.e(e);}finally{a.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerUp.tap(e.tag,function(e){if(!i.supportsTouchEvents||"touch"!==e.pointerType){var t,r=n.context.contextService.getDomElement(),a=n.context.eventService.isNativeEventFromCanvas(r,e)?"":"outside",o=n.normalizeToPointerEvent(e,i),s=(0,Z.default)(o);try{for(s.s();!(t=s.n()).done;){var l=t.value,u=n.bootstrapEvent(n.rootPointerEvent,l,i,e);u.type+=a,n.context.eventService.mapEvent(u);}}catch(e){s.e(e);}finally{s.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerMove.tap(e.tag,this.onPointerMove),r.hooks.pointerOver.tap(e.tag,this.onPointerMove),r.hooks.pointerOut.tap(e.tag,this.onPointerMove),r.hooks.click.tap(e.tag,this.onClick),r.hooks.pointerCancel.tap(e.tag,function(e){var t,r=n.normalizeToPointerEvent(e,i),a=(0,Z.default)(r);try{for(a.s();!(t=a.n()).done;){var o=t.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,e);n.context.eventService.mapEvent(s);}}catch(e){a.e(e);}finally{a.f();}n.setCursor(n.context.eventService.cursor);});}},{key:"bootstrapEvent",value:function(e,t,n,r){e.view=n,e.originalEvent=null,e.nativeEvent=r,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t);var i=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),a=i.x,o=i.y;e.viewport.x=a,e.viewport.y=o;var s=this.context.eventService.viewport2Canvas(e.viewport),l=s.x,u=s.y;return e.canvas.x=l,e.canvas.y=u,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=r.isTrusted,"pointerleave"===e.type&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=n8[e.type]||e.type),e;}},{key:"normalizeWheelEvent",value:function(e){var t=this.rootWheelEvent;this.transferMouseData(t,e),t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ;var n=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),r=n.x,i=n.y;t.viewport.x=r,t.viewport.y=i;var a=this.context.eventService.viewport2Canvas(t.viewport),o=a.x,s=a.y;return t.canvas.x=o,t.canvas.y=s,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.nativeEvent=e,t.type=e.type,t;}},{key:"transferMouseData",value:function(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=n9.now(),e.type=t.type,e.altKey=t.altKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.screen.x=t.screenX,e.screen.y=t.screenY,e.relatedTarget=null;}},{key:"setCursor",value:function(e){this.context.contextService.applyCursorStyle(e||this.context.config.cursor||"default");}},{key:"normalizeToPointerEvent",value:function(e,t){var n=[];if(t.isTouchEvent(e))for(var r=0;r<e.changedTouches.length;r++){var i=e.changedTouches[r];(0,F.isUndefined)(i.button)&&(i.button=0),(0,F.isUndefined)(i.buttons)&&(i.buttons=1),(0,F.isUndefined)(i.isPrimary)&&(i.isPrimary=1===e.touches.length&&"touchstart"===e.type),(0,F.isUndefined)(i.width)&&(i.width=i.radiusX||1),(0,F.isUndefined)(i.height)&&(i.height=i.radiusY||1),(0,F.isUndefined)(i.tiltX)&&(i.tiltX=0),(0,F.isUndefined)(i.tiltY)&&(i.tiltY=0),(0,F.isUndefined)(i.pointerType)&&(i.pointerType="touch"),(0,F.isUndefined)(i.pointerId)&&(i.pointerId=i.identifier||0),(0,F.isUndefined)(i.pressure)&&(i.pressure=i.force||.5),(0,F.isUndefined)(i.twist)&&(i.twist=0),(0,F.isUndefined)(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=e.type,n.push(i);}else t.isMouseEvent(e)&&((0,F.isUndefined)(e.isPrimary)&&(e.isPrimary=!0),(0,F.isUndefined)(e.width)&&(e.width=1),(0,F.isUndefined)(e.height)&&(e.height=1),(0,F.isUndefined)(e.tiltX)&&(e.tiltX=0),(0,F.isUndefined)(e.tiltY)&&(e.tiltY=0),(0,F.isUndefined)(e.pointerType)&&(e.pointerType="mouse"),(0,F.isUndefined)(e.pointerId)&&(e.pointerId=1),(0,F.isUndefined)(e.pressure)&&(e.pressure=.5),(0,F.isUndefined)(e.twist)&&(e.twist=0),(0,F.isUndefined)(e.tangentialPressure)&&(e.tangentialPressure=0),e.isNormalized=!0),n.push(e);return n;}}]);}().tag="Event";var iX=[$.CIRCLE,$.ELLIPSE,$.IMAGE,$.RECT,$.LINE,$.POLYLINE,$.POLYGON,$.TEXT,$.PATH,$.HTML];(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"isVisible",value:function(e,t){var n,r=t.cullable;if(!r.enable)return!0;var i=t.getRenderBounds();if(eo.isEmpty(i))return!1;var a=e.getFrustum(),o=null===(n=t.parentNode)||void 0===n||null===(n=n.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(t,i,o||el.INDETERMINATE,a.planes),r.visible=r.visibilityPlaneMask!==el.OUTSIDE,r.visible;}},{key:"computeVisibilityWithPlaneMask",value:function(e,t,n,r){if(n===el.OUTSIDE||n===el.INSIDE)return n;for(var i=el.INSIDE,a=iX.indexOf(e.nodeName)>-1,o=0,s=r.length;o<s;++o){var l=1<<o;if((n&l)!=0&&(!a||4!==o&&5!==o)){var u=r[o],c=u.normal,d=u.distance;if(U.vec3.dot(c,t.getPositiveFarPoint(r[o]))+d<0)return el.OUTSIDE;U.vec3.dot(c,t.getNegativeFarPoint(r[o]))+d<0&&(i|=l);}}return i;}}]),function(){function e(){(0,N.default)(this,e),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1;}return(0,O.default)(e,[{key:"apply",value:function(t){var n,r,i=this,a=t.config,o=t.renderingService,s=t.renderingContext,l=t.rBushRoot,u=s.root.ownerDocument.defaultView;this.rBush=l;var c=function(e){o.dirtify();},d=function(e){i.syncTasks.set(e.target,e.detail.affectChildren),o.dirtify();},f=function(e){var t=e.target;im.enableSizeAttenuation&&im.styleValueRegistry.updateSizeAttenuation(t,u.getCamera().getZoom());},h=function(e){var t=e.target,n=t.rBushNode;null!=n&&n.aabb&&i.rBush.remove(n.aabb),i.syncTasks.delete(t),im.sceneGraphService.dirtyToRoot(t),o.dirtify();};o.hooks.init.tap(e.tag,function(){u.addEventListener(rK.MOUNTED,f),u.addEventListener(rK.UNMOUNTED,h),u.addEventListener(rK.ATTR_MODIFIED,c),u.addEventListener(rK.BOUNDS_CHANGED,d);}),o.hooks.destroy.tap(e.tag,function(){u.removeEventListener(rK.MOUNTED,f),u.removeEventListener(rK.UNMOUNTED,h),u.removeEventListener(rK.ATTR_MODIFIED,c),u.removeEventListener(rK.BOUNDS_CHANGED,d),i.syncTasks.clear();});var p=null!==(n=im.globalThis.requestIdleCallback)&&void 0!==n?n:rc.bind(im.globalThis),v=(null===(r=a.future)||void 0===r?void 0:r.experimentalRICSyncRTree)===!0;o.hooks.endFrame.tap(e.tag,function(){i.isFirstTimeRendering?(i.isFirstTimeRendering=!1,i.syncing=!0,p(function(){i.syncRTree(!0),i.isFirstTimeRenderingFinished=!0;})):v&&im.globalThis.requestIdleCallback&&im.globalThis.cancelIdleCallback?(im.globalThis.cancelIdleCallback(i.ricSyncRTreeId),i.ricSyncRTreeId=im.globalThis.requestIdleCallback(function(){return i.syncRTree();})):i.syncRTree();});}},{key:"syncNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.isConnected){var n=e.rBushNode;n.aabb&&this.rBush.remove(n.aabb);var r=e.getRenderBounds();if(r){var i=e.renderable;t&&(i.dirtyRenderBounds||(i.dirtyRenderBounds=new eo),i.dirtyRenderBounds.update(r.center,r.halfExtents));var a=r.getMin(),o=(0,z.default)(a,2),s=o[0],l=o[1],u=r.getMax(),c=(0,z.default)(u,2),d=c[0],f=c[1];n.aabb||(n.aabb={}),n.aabb.displayObject=e,n.aabb.minX=s,n.aabb.minY=l,n.aabb.maxX=d,n.aabb.maxY=f;}if(n.aabb&&!isNaN(n.aabb.maxX)&&!isNaN(n.aabb.maxX)&&!isNaN(n.aabb.minX)&&!isNaN(n.aabb.minY))return n.aabb;}}},{key:"syncRTree",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t||!this.syncing&&0!==this.syncTasks.size){this.syncing=!0;var n=[],r=new Set,i=function(i){if(!r.has(i)&&i.renderable){var a=e.syncNode(i,t);a&&(n.push(a),r.add(i));}};this.syncTasks.forEach(function(e,t){e&&t.forEach(i);for(var n=t;n;)i(n),n=n.parentElement;}),this.rBush.load(n),n.length=0,this.syncing=!1;}}}]);}().tag="Prepare";var i$=((A={}).READY="ready",A.BEFORE_RENDER="beforerender",A.RERENDER="rerender",A.AFTER_RENDER="afterrender",A.BEFORE_DESTROY="beforedestroy",A.AFTER_DESTROY="afterdestroy",A.RESIZE="resize",A.DIRTY_RECTANGLE="dirtyrectangle",A.RENDERER_CHANGED="rendererchanged",A);new rW(rK.MOUNTED),new rW(rK.UNMOUNTED),new rW(i$.BEFORE_RENDER),new rW(i$.RERENDER),new rW(i$.AFTER_RENDER);},"59935ee7":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("4d809c36"));function i(e,t){var n,i,a,o,s,l=this._x0,u=this._x1,c=[],d=this._root;for(d&&c.push(new r.default(d,l,u)),null==t?t=1/0:(l=e-t,u=e+t);o=c.pop();)if((d=o.node)&&!((i=o.x0)>u)&&!((a=o.x1)<l)){if(d.length){var f=(i+a)/2;c.push(new r.default(d[1],f,a),new r.default(d[0],i,f)),(s=+(e>=f))&&(o=c[c.length-1],c[c.length-1]=c[c.length-1-s],c[c.length-1-s]=o);}else{var h=Math.abs(e-+this._x.call(null,d.data));h<t&&(t=h,l=e-h,u=e+h,n=d.data);}}return n;}},"59975c13":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("71f18948")),a=r._(n("a12bb5bb")),o=r._(n("b0c50986")),s=function(e,t,n){if(!(0,a.default)(e)&&!(0,o.default)(e))return e;var r=n;return(0,i.default)(e,function(e,n){r=t(r,e,n);}),r;};},"59ba2d7e":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"LarkMap",{enumerable:!0,get:function(){return i.LarkMap;}});var r=n("d1751d7c"),i=n("ae6890f9");r._(n("bea685b2"),t),r._(n("c9696724"),t);},"5a08cc31":function(e,t,n){var r=n("a2a19376"),i=n("689596c4"),a=n("bab17bc9"),o=a&&a.isMap,s=o?i(o):r;e.exports=s;},"5aa23130":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"BoxZoomHandler",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe")._(n("d812e418")),i=n("e31a659c"),a=n("b448a57d"),o=n("42fc1d72");class s{constructor(e,t){(0,r.default)(this,"_map",void 0),(0,r.default)(this,"_tr",void 0),(0,r.default)(this,"_el",void 0),(0,r.default)(this,"_container",void 0),(0,r.default)(this,"_enabled",void 0),(0,r.default)(this,"_active",void 0),(0,r.default)(this,"_startPos",void 0),(0,r.default)(this,"_lastPos",void 0),(0,r.default)(this,"_box",void 0),(0,r.default)(this,"_clickTolerance",void 0),this._map=e,this._tr=new o.TransformProvider(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1;}isEnabled(){return!!this._enabled;}isActive(){return!!this._active;}enable(){this.isEnabled()||(this._enabled=!0);}disable(){this.isEnabled()&&(this._enabled=!1);}mousedown(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(i.DOM.disableDrag(),this._startPos=this._lastPos=t,this._active=!0);}mousemoveWindow(e,t){if(!this._active||this._lastPos.equals(t)||!this._box&&t.dist(this._startPos)<this._clickTolerance)return;let n=this._startPos;this._lastPos=t,this._box||(this._box=i.DOM.create("div","l7-boxzoom",this._container),this._container.classList.add("l7-crosshair"),this._fireEvent("boxzoomstart",e));let r=Math.min(n.x,t.x),a=Math.max(n.x,t.x),o=Math.min(n.y,t.y),s=Math.max(n.y,t.y);i.DOM.setTransform(this._box,`translate(${r}px,${o}px)`),this._box.style.width=`${a-r}px`,this._box.style.height=`${s-o}px`;}mouseupWindow(e,t){if(!this._active||0!==e.button)return;let n=this._startPos;if(this.reset(),i.DOM.suppressClick(),n.x!==t.x||n.y!==t.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:e})),{cameraAnimation:e=>e.fitScreenCoordinates(n,t,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e);}keydown(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e));}reset(){this._active=!1,this._container.classList.remove("l7-crosshair"),this._box&&(i.DOM.remove(this._box),this._box=null),i.DOM.enableDrag(),delete this._startPos,delete this._lastPos;}_fireEvent(e,t){return this._map.fire(new a.Event(e,{originalEvent:t}));}}},"5b973812":function(e,t,n){"use strict";function r(e){switch(32|e){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1;}}n.d(t,"__esModule",{value:!0}),n.d(t,"isPathCommand",{enumerable:!0,get:function(){return r;}});},"5bf0d2ef":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{computeMiter:function(){return c;},computeNormal:function(){return d;},default:function(){return p;},direction:function(){return f;}});var r=n("777fffbe")._(n("d812e418")),i=n("fb1ec05a"),a=n("71293cfd");let o=a.vec2.create();a.vec2.create();let s=a.vec2.create(),l=a.vec2.create(),u=a.vec2.create();function c(e,t,n,r,i){a.vec2.add(e,n,r),a.vec2.normalize(e,e),t=a.vec2.fromValues(-e[1],e[0]);let o=a.vec2.fromValues(-n[1],n[0]);return[i/a.vec2.dot(t,o),t];}function d(e,t){return a.vec2.set(e,-t[1],t[0]);}function f(e,t,n){return a.vec2.sub(e,t,n),a.vec2.normalize(e,e),e;}function h(e,t){return e[0]===t[0]&&e[1]===t[1];}class p{constructor(e={}){(0,r.default)(this,"complex",void 0),(0,r.default)(this,"join",void 0),(0,r.default)(this,"cap",void 0),(0,r.default)(this,"miterLimit",void 0),(0,r.default)(this,"thickness",void 0),(0,r.default)(this,"normal",void 0),(0,r.default)(this,"lastFlip",-1),(0,r.default)(this,"miter",a.vec2.fromValues(0,0)),(0,r.default)(this,"started",!1),(0,r.default)(this,"dash",!1),(0,r.default)(this,"totalDistance",0),(0,r.default)(this,"currentIndex",0),this.join=e.join||"miter",this.cap=e.cap||"butt",this.miterLimit=e.miterLimit||10,this.thickness=e.thickness||1,this.dash=e.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]};}simpleExtrude(e){let t=this.complex;if(e.length<=1)return t;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;let n=e.length,r=t.startIndex;for(let i=1;i<n;i++){let n=e[i-1],a=e[i],o=i<e.length-1?e[i+1]:null,s=this.simpleSegment(t,r,n,a,o);r+=s;}if(this.dash)for(let e=0;e<t.positions.length/6;e++)t.positions[6*e+5]=this.totalDistance;return t.startIndex=t.positions.length/6,t;}extrude(e){let t=this.complex;if(e.length<=1)return t;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;let n=e.length,r=t.startIndex;for(let i=1;i<n;i++){let n=e[i-1],a=e[i],o=i<e.length-1?e[i+1]:null,s=this.segment(t,r,n,a,o);r+=s;}if(this.dash)for(let e=0;e<t.positions.length/6;e++)t.positions[6*e+5]=this.totalDistance;return t.startIndex=t.positions.length/6,t;}simpleSegment(e,t,n,r,o){let p=0,v=e.indices,g=e.positions,m=e.normals,y=(0,i.aProjectFlat)([r[0],r[1]]),b=(0,i.aProjectFlat)([n[0],n[1]]);f(s,y,b);let _=0;if(this.dash&&(_=this.lineSegmentDistance(y,b),this.totalDistance+=_),this.normal||(this.normal=a.vec2.create(),d(this.normal,s)),this.started||(this.started=!0,this.extrusions(g,m,n,this.normal,this.thickness,this.totalDistance-_)),v.push(t+0,t+1,t+2),o){let e=(0,i.aProjectFlat)([o[0],o[1]]);h(y,e)&&a.vec2.add(e,y,a.vec2.normalize(e,a.vec2.subtract(e,y,b))),f(l,e,y);let[n,d]=c(u,a.vec2.create(),s,l,this.thickness),_=0>a.vec2.dot(u,this.normal)?-1:1;this.extrusions(g,m,r,d,n,this.totalDistance),v.push(...1===this.lastFlip?[t,t+2,t+3]:[t+2,t+1,t+3]),_=-1,a.vec2.copy(this.normal,d),p+=2,this.lastFlip=_;}else d(this.normal,s),this.extrusions(g,m,r,this.normal,this.thickness,this.totalDistance),v.push(...1===this.lastFlip?[t,t+2,t+3]:[t+2,t+1,t+3]),p+=2;return p;}segment(e,t,n,r,p){let v=0,g=e.indices,m=e.positions,y=e.normals,b="square"===this.cap,_="bevel"===this.join,x=(0,i.aProjectFlat)([r[0],r[1]]),w=(0,i.aProjectFlat)([n[0],n[1]]);f(s,x,w);let E=0;if(this.dash&&(E=this.lineSegmentDistance(x,w),this.totalDistance+=E),this.normal||(this.normal=a.vec2.create(),d(this.normal,s)),!this.started){if(this.started=!0,b){let e=a.vec2.create(),t=a.vec2.create();a.vec2.add(e,this.normal,s),a.vec2.add(t,this.normal,s),y.push(t[0],t[1],0),y.push(e[0],e[1],0),m.push(n[0],n[1],0|n[2],this.totalDistance-E,-this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),m.push(n[0],n[1],0|n[2],this.totalDistance-E,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++;}else this.extrusions(m,y,n,this.normal,this.thickness,this.totalDistance-E);}if(g.push(t+0,t+1,t+2),p){let e=(0,i.aProjectFlat)([p[0],p[1]]);h(x,e)&&a.vec2.add(e,x,a.vec2.normalize(e,a.vec2.subtract(e,x,w))),f(l,e,x);let[n,b]=c(u,a.vec2.create(),s,l,this.thickness),E=0>a.vec2.dot(u,this.normal)?-1:1,M=_;!M&&"miter"===this.join&&n>this.miterLimit&&(M=!0),M?(y.push(this.normal[0],this.normal[1],0),y.push(b[0],b[1],0),m.push(r[0],r[1],0|r[2],this.totalDistance,-this.thickness*E,0|r[2]),this.complex.indexes.push(this.currentIndex),m.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness*E,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,g.push(...this.lastFlip!==-E?[t,t+2,t+3]:[t+2,t+1,t+3]),g.push(t+2,t+3,t+4),d(o,l),a.vec2.copy(this.normal,o),y.push(this.normal[0],this.normal[1],0),m.push(r[0],r[1],0|r[2],this.totalDistance,-this.thickness*E,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,v+=3):(this.extrusions(m,y,r,b,n,this.totalDistance),g.push(...1===this.lastFlip?[t,t+2,t+3]:[t+2,t+1,t+3]),E=-1,a.vec2.copy(this.normal,b),v+=2),this.lastFlip=E;}else{if(d(this.normal,s),b){let e=a.vec2.create(),t=a.vec2.create();a.vec2.sub(t,s,this.normal),a.vec2.add(e,s,this.normal),y.push(t[0],t[1],0),y.push(e[0],e[1],0),m.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),m.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++;}else this.extrusions(m,y,r,this.normal,this.thickness,this.totalDistance);g.push(...1===this.lastFlip?[t,t+2,t+3]:[t+2,t+1,t+3]),v+=2;}return v;}extrusions(e,t,n,r,i,a){t.push(r[0],r[1],0),t.push(r[0],r[1],0),e.push(n[0],n[1],0|n[2],a,-i,0|n[2]),this.complex.indexes.push(this.currentIndex),e.push(n[0],n[1],0|n[2],a,i,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++;}lineSegmentDistance(e,t){let n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r);}}},"5bf20808":function(e,t,n){var r;if("function"==typeof n)try{r=n("e625a2d1");}catch(e){}r||(r=window.graphlib),e.exports=r;},"5c29df5b":function(e,t,n){var r=n("a985b25e"),i=n("d57bce82");e.exports=function(e,t){return r(e,i(e),t);};},"5c93f055":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{LngLat:function(){return o;},earthRadius:function(){return a;}});var r=n("777fffbe")._(n("d812e418")),i=n("f9562c3c");let a=6371008.8;class o{constructor(e,t){if((0,r.default)(this,"lng",void 0),(0,r.default)(this,"lat",void 0),isNaN(e)||isNaN(t))throw Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw Error("Invalid LngLat latitude value: must be between -90 and 90");}wrap(){return new o((0,i.wrap)(this.lng,-180,180),this.lat);}toArray(){return[this.lng,this.lat];}toString(){return`LngLat(${this.lng}, ${this.lat})`;}distanceTo(e){let t=Math.PI/180,n=this.lat*t,r=e.lat*t;return a*Math.acos(Math.min(Math.sin(n)*Math.sin(r)+Math.cos(n)*Math.cos(r)*Math.cos((e.lng-this.lng)*t),1));}static convert(e){if(e instanceof o)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new o(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new o(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]");}}},"5c9f5160":function(e,t,n){var r=n("1ac6edf9"),i=n("d1945137")(function(e,t){return null==e?{}:r(e,t);});e.exports=i;},"5ca30fb9":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("dd837acc")),i=Object.prototype.hasOwnProperty,a=function(e,t,n,a,o,s){var l=1&n,u=(0,r.default)(e),c=u.length;if(c!=(0,r.default)(t).length&&!l)return!1;for(var d=c;d--;){var f=u[d];if(!(l?f in t:i.call(t,f)))return!1;}var h=s.get(e),p=s.get(t);if(h&&p)return h==t&&p==e;var v=!0;s.set(e,t),s.set(t,e);for(var g=l;++d<c;){var m=e[f=u[d]],y=t[f];if(a)var b=l?a(y,m,f,t,e,s):a(m,y,f,e,t,s);if(!(void 0===b?m===y||o(m,y,n,a,s):b)){v=!1;break;}g||(g="constructor"==f);}if(v&&!g){var _=e.constructor,x=t.constructor;_!=x&&"constructor"in e&&"constructor"in t&&!("function"==typeof _&&_ instanceof _&&"function"==typeof x&&x instanceof x)&&(v=!1);}return s.delete(e),s.delete(t),v;};},"5cac9775":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return v;}});var r=n("777fffbe"),i=r._(n("9c676843")),a=r._(n("6ddc54e8")),o=r._(n("9f6f6314")),s=r._(n("9c6e7c32")),l=r._(n("871ff507")),u=r._(n("e3f531bc")),c=r._(n("8f7ff84b")),d=r._(n("a5ba8ec1")),f=r._(n("cb688f1d")),h=r._(n("f0dd048d")),p=r._(n("eb793955")),v={fill:f.default,line:i.default,extrude:c.default,text:u.default,point_fill:o.default,point_image:s.default,point_normal:l.default,point_extrude:a.default,water:p.default,ocean:h.default,extrusion:d.default};},"5d61e09d":function(e,t,n){"use strict";function r(){return this._root;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"5dc7140d":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("318fb8cd")),a=r._(n("ccff5790")),o=function(e,t){if(e){if((0,i.default)(e))for(var n=0,r=e.length;n<r&&!1!==t(e[n],n);n++);else if((0,a.default)(e)){for(var o in e)if(e.hasOwnProperty(o)&&!1===t(e[o],o))break;}}};},"5e450230":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return f;}});var r=n("777fffbe"),i=n("852bbaa9"),a=r._(n("82f98358")),o=r._(n("1316cf9d")),s=r._(n("3d495adb")),l=n("6801e0b3"),u=n("c37c383f"),c=i._(n("ef68bcfd")),d=(0,l.createMat4)(),f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.width,r=t.height,i=t.viewMatrix,a=void 0===i?d:i,s=t.projectionMatrix,u=void 0===s?d:s;(0,o.default)(this,e),this.width=n||1,this.height=r||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=a,this.projectionMatrix=u;var f=(0,l.createMat4)();c.multiply(f,f,this.projectionMatrix),c.multiply(f,f,this.viewMatrix),this.viewProjectionMatrix=f;var h=(0,l.createMat4)();c.scale(h,h,[this.width/2,-this.height/2,1]),c.translate(h,h,[1,-1,0]),c.multiply(h,h,this.viewProjectionMatrix);var p=c.invert((0,l.createMat4)(),h);if(!p)throw Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=h,this.pixelUnprojectionMatrix=p,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this);}return(0,s.default)(e,[{key:"equals",value:function(t){return t instanceof e&&t.width===this.width&&t.height===this.height&&c.equals(t.projectionMatrix,this.projectionMatrix)&&c.equals(t.viewMatrix,this.viewMatrix);}},{key:"project",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.topLeft,r=this.projectPosition(e),i=(0,u.worldToPixels)(r,this.pixelProjectionMatrix),o=(0,a.default)(i,2),s=o[0],l=o[1],c=void 0===n||n?l:this.height-l;return 2===e.length?[s,c]:[s,c,i[2]];}},{key:"unproject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.topLeft,r=t.targetZ,i=(0,a.default)(e,3),o=i[0],s=i[1],l=i[2],c=void 0===n||n?s:this.height-s,d=r&&r*this.pixelsPerMeter,f=(0,u.pixelsToWorld)([o,c,l],this.pixelUnprojectionMatrix,d),h=this.unprojectPosition(f),p=(0,a.default)(h,3),v=p[0],g=p[1],m=p[2];return Number.isFinite(l)?[v,g,m]:Number.isFinite(r)?[v,g,r]:[v,g];}},{key:"projectPosition",value:function(e){var t=this.projectFlat(e),n=(0,a.default)(t,2);return[n[0],n[1],(e[2]||0)*this.pixelsPerMeter];}},{key:"unprojectPosition",value:function(e){var t=this.unprojectFlat(e),n=(0,a.default)(t,2);return[n[0],n[1],(e[2]||0)/this.pixelsPerMeter];}},{key:"projectFlat",value:function(e){return arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale,e;}},{key:"unprojectFlat",value:function(e){return arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale,e;}}]),e;}();},"5e61b478":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"normalizePath",{enumerable:!0,get:function(){return l;}});var r=n("b594a703"),i=n("ba9d7bc5"),a=n("fad5290a"),o=n("ad9c2b8c"),s=n("d6947c32");function l(e){if((0,i.isNormalizedArray)(e))return[].concat(e);for(var t=(0,o.path2Absolute)(e),n=(0,r.__assign)({},a.paramsParser),l=0;l<t.length;l+=1){t[l]=(0,s.normalizeSegment)(t[l],n);var u=t[l],c=u.length;n.x1=+u[c-2],n.y1=+u[c-1],n.x2=+u[c-4]||n.x1,n.y2=+u[c-3]||n.y1;}return t;}},"5e762d8e":function(e,t,n){"use strict";function r(e){if(isNaN(a=+this._x.call(null,e))||isNaN(o=+this._y.call(null,e))||isNaN(s=+this._z.call(null,e)))return this;var t,n,r,i,a,o,s,l,u,c,d,f,h,p,v,g=this._root,m=this._x0,y=this._y0,b=this._z0,_=this._x1,x=this._y1,w=this._z1;if(!g)return this;if(g.length)for(;;){if((d=a>=(l=(m+_)/2))?m=l:_=l,(f=o>=(u=(y+x)/2))?y=u:x=u,(h=s>=(c=(b+w)/2))?b=c:w=c,t=g,!(g=g[p=h<<2|f<<1|d]))return this;if(!g.length)break;(t[p+1&7]||t[p+2&7]||t[p+3&7]||t[p+4&7]||t[p+5&7]||t[p+6&7]||t[p+7&7])&&(n=t,v=p);}for(;g.data!==e;)if(r=g,!(g=g.next))return this;return((i=g.next)&&delete g.next,r)?i?r.next=i:delete r.next:t?(i?t[p]=i:delete t[p],(g=t[0]||t[1]||t[2]||t[3]||t[4]||t[5]||t[6]||t[7])&&g===(t[7]||t[6]||t[5]||t[4]||t[3]||t[2]||t[1]||t[0])&&!g.length&&(n?n[v]=g:this._root=g)):this._root=i,this;}function i(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this;}n.d(t,"__esModule",{value:!0}),n.e(t,{default:function(){return r;},removeAll:function(){return i;}});},"5e913e76":function(e,t,n){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e;}),n;};},"5f17371e":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return p;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("f89fb776")),o=r._(n("d812e418")),s=n("d9b661b3"),l=n("fb1ec05a"),u=n("71293cfd"),c=r._(n("755bc4f8")),d=n("f717bab4"),f=n("aa587738");let{isEqual:h}=l.lodashUtil;class p extends c.default{constructor(...e){super(...e),(0,o.default)(this,"texture",void 0),(0,o.default)(this,"colorTexture",void 0),(0,o.default)(this,"heatmapFramerBuffer",void 0),(0,o.default)(this,"heatmapTexture",void 0),(0,o.default)(this,"intensityModel",void 0),(0,o.default)(this,"colorModel",void 0),(0,o.default)(this,"shapeType",void 0),(0,o.default)(this,"preRampColors",void 0),(0,o.default)(this,"colorModelUniformBuffer",[]),(0,o.default)(this,"heat3DModelUniformBuffer",[]);}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,UV:10,DIR:11});}prerender(){let{clear:e,useFramebuffer:t}=this.rendererService;t(this.heatmapFramerBuffer,()=>{e({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.heatmapFramerBuffer}),this.drawIntensityMode();});}render(e){let{rampColors:t}=this.layer.getLayerConfig();h(this.preRampColors,t)||this.updateColorTexture(),"heatmap"===this.shapeType?this.drawHeatMap(e):this.draw3DHeatMap(e);}getUninforms(){throw Error("Method not implemented.");}initModels(){var e=this;return(0,a.default)(function*(){var t;let{createFramebuffer:n,getViewportSize:r,createTexture2D:i}=e.rendererService,a=e.styleAttributeService.getLayerStyleAttribute("shape"),o=(null==a||null===(t=a.scale)||void 0===t?void 0:t.field)||"heatmap";e.shapeType=o,e.intensityModel=yield e.buildHeatMapIntensity(),e.colorModel="heatmap"===o?e.buildHeatmap():e.build3dHeatMap();let{width:l,height:u}=r();return e.heatmapTexture=i({width:Math.floor(l/4),height:Math.floor(u/4),wrapS:s.gl.CLAMP_TO_EDGE,wrapT:s.gl.CLAMP_TO_EDGE,min:s.gl.LINEAR,mag:s.gl.LINEAR,usage:s.TextureUsage.RENDER_TARGET}),e.heatmapFramerBuffer=n({color:e.heatmapTexture,depth:!0,width:Math.floor(l/4),height:Math.floor(u/4)}),e.updateColorTexture(),[e.intensityModel,e.colorModel];})();}buildModels(){var e=this;return(0,a.default)(function*(){return e.initModels();})();}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:s.AttributeType.Attribute,descriptor:{name:"a_Dir",shaderLocation:this.attributeLocation.DIR,buffer:{usage:s.gl.DYNAMIC_DRAW,data:[],type:s.gl.FLOAT},size:2,update:(e,t,n)=>[n[3],n[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:s.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:s.gl.DYNAMIC_DRAW,data:[],type:s.gl.FLOAT},size:1,update:e=>{let{size:t=1}=e;return[t];}}});}buildHeatMapIntensity(){var e=this;return(0,a.default)(function*(){return e.uniformBuffers=[e.rendererService.createBuffer({data:new Float32Array(4).fill(0),isUBO:!0})],e.layer.triangulation=d.HeatmapTriangulation,yield e.layer.buildLayerModel({moduleName:"heatmapIntensity",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_DIR) in vec2 a_Dir;\n\nlayout(std140) uniform commonUniforms {\n  float u_radius;\n  float u_intensity;\n  float u_common_uniforms_padding1;\n  float u_common_uniforms_padding2;\n};\n\nout vec2 v_extrude;\nout float v_weight;\n\n#define GAUSS_COEF (0.3989422804014327)\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  vec3 picking_color_placeholder = u_PickingColor;\n\n  v_weight = a_Size;\n  float ZERO = 1.0 / 255.0 / 16.0;\n  float extrude_x = a_Dir.x * 2.0 - 1.0;\n  float extrude_y = a_Dir.y * 2.0 - 1.0;\n  vec2 extrude_dir = normalize(vec2(extrude_x, extrude_y));\n  float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 2.5;\n  v_extrude = extrude_dir * S;\n\n  vec2 offset = project_pixel(v_extrude * u_radius);\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));\n\n}\n',fragmentShader:"layout(std140) uniform commonUniforms {\n  float u_radius;\n  float u_intensity;\n  float u_common_uniforms_padding1;\n  float u_common_uniforms_padding2;\n};\n\nin vec2 v_extrude;\nin float v_weight;\nout vec4 outputColor;\n#define GAUSS_COEF  0.3989422804014327\n\nvoid main(){\n    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);\n    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);\n    outputColor = vec4(val, 1., 1., 1.);\n}\n",triangulation:d.HeatmapTriangulation,defines:e.getDefines(),depth:{enable:!1},cull:{enable:!0,face:s.gl.FRONT}});})();}buildHeatmap(){this.shaderModuleService.registerModule("heatmapColor",{vs:'layout(location = 0) in vec3 a_Position;\nlayout(location = 10) in vec2 a_Uv;\n\nlayout(std140) uniform commonUniforms {\n  float u_opacity;\n  float u_common_uniforms_padding1;\n  float u_common_uniforms_padding2;\n  float u_common_uniforms_padding3;\n};\n\n#pragma include "scene_uniforms"\n\nout vec2 v_texCoord;\nvoid main() {\n  v_texCoord = a_Uv;\n  #ifdef VIEWPORT_ORIGIN_TL\n  v_texCoord.y = 1.0 - v_texCoord.y;\n  #endif\n\n  gl_Position = vec4(a_Position.xy, 0, 1.0);\n}\n',fs:'uniform sampler2D u_texture;        // \u70ED\u529B\u5F3A\u5EA6\u56FE\nuniform sampler2D u_colorTexture;   // \u6839\u636E\u5F3A\u5EA6\u5206\u5E03\u7684\u8272\u5E26\n\nlayout(std140) uniform commonUniforms {\n  float u_opacity;\n  float u_common_uniforms_padding1;\n  float u_common_uniforms_padding2;\n  float u_common_uniforms_padding3;\n};\nin vec2 v_texCoord;\nout vec4 outputColor;\n\n#pragma include "scene_uniforms"\n\nfloat getBlurIndusty() {\n    float vW = 2.0/ u_ViewportSize.x;\n    float vH = 2.0/ u_ViewportSize.y;\n    vec2 vUv = v_texCoord;\n    float i11 = texture(SAMPLER_2D(u_texture), vec2( vUv.x - 1.0 * vW, vUv.y + 1.0 * vH) ).r;\n    float i12 = texture(SAMPLER_2D(u_texture), vec2( vUv.x - 0.0 * vW, vUv.y + 1.0 * vH) ).r;\n    float i13 = texture(SAMPLER_2D(u_texture), vec2( vUv.x + 1.0 * vW, vUv.y + 1.0 * vH) ).r;\n\n    float i21 = texture(SAMPLER_2D(u_texture), vec2( vUv.x - 1.0 * vW, vUv.y) ).r;\n    float i22 = texture(SAMPLER_2D(u_texture), vec2( vUv.x , vUv.y) ).r;\n    float i23 = texture(SAMPLER_2D(u_texture), vec2( vUv.x + 1.0 * vW, vUv.y) ).r;\n\n    float i31 = texture(SAMPLER_2D(u_texture), vec2( vUv.x - 1.0 * vW, vUv.y-1.0*vH) ).r;\n    float i32 = texture(SAMPLER_2D(u_texture), vec2( vUv.x - 0.0 * vW, vUv.y-1.0*vH) ).r;\n    float i33 = texture(SAMPLER_2D(u_texture), vec2( vUv.x + 1.0 * vW, vUv.y-1.0*vH) ).r;\n\n    return(\n        i11 + \n        i12 + \n        i13 + \n        i21 + \n        i21 + \n        i22 + \n        i23 + \n        i31 + \n        i32 + \n        i33\n        )/9.0;\n}\n\n\nvoid main(){\n    // float intensity = texture(u_texture, v_texCoord).r;\n    float intensity = getBlurIndusty();\n    vec4 color = texture(SAMPLER_2D(u_colorTexture), vec2(intensity, 0.0));\n    outputColor = color;\n    outputColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;\n}\n'}),this.colorModelUniformBuffer=[this.rendererService.createBuffer({data:new Float32Array(4).fill(0),isUBO:!0})];let{vs:e,fs:t,uniforms:n}=this.shaderModuleService.getModule("heatmapColor"),{createAttribute:r,createElements:a,createBuffer:o,createModel:l}=this.rendererService;return l({vs:e,fs:t,uniformBuffers:[...this.colorModelUniformBuffer,...this.rendererService.uniformBuffers],attributes:{a_Position:r({shaderLocation:this.attributeLocation.POSITION,buffer:o({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:s.gl.FLOAT}),size:3}),a_Uv:r({shaderLocation:this.attributeLocation.UV,buffer:o({data:[0,1,1,1,0,0,1,0],type:s.gl.FLOAT}),size:2})},uniforms:(0,i.default)({},n),depth:{enable:!1},elements:a({data:[0,2,1,2,3,1],type:s.gl.UNSIGNED_INT,count:6})});}build3dHeatMap(){let{getViewportSize:e}=this.rendererService,{width:t,height:n}=e(),r=(0,f.heatMap3DTriangulation)(t/4,n/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:'layout(location = 0) in vec3 a_Position;\nlayout(location = 10) in vec2 a_Uv;\n\nlayout(std140) uniform commonUniforms {\n  mat4 u_ViewProjectionMatrixUncentered;\n  mat4 u_InverseViewProjectionMatrix;\n  float u_opacity;\n  float u_common_uniforms_padding1;\n  float u_common_uniforms_padding2;\n  float u_common_uniforms_padding3;\n};\n\nuniform sampler2D u_texture;\nuniform sampler2D u_colorTexture;\n\nout vec2 v_texCoord;\nout float v_intensity;\n\nvec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {\n  float t2 = t * t;\n  float one_minus_t = 1.0 - t;\n  float one_minus_t2 = one_minus_t * one_minus_t;\n  return P0 * one_minus_t2 * one_minus_t +\n  P1 * 3.0 * t * one_minus_t2 +\n  P2 * 3.0 * t2 * one_minus_t +\n  P3 * t2 * t;\n}\nvec2 toBezier(float t, vec4 p) {\n  return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));\n}\n\n#pragma include "projection"\n#pragma include "project"\n\nvoid main() {\n  v_texCoord = a_Uv;\n\n  vec2 pos = a_Uv * vec2(2.0) - vec2(1.0); // \u5C06\u539F\u672C 0 -> 1 \u7684 uv \u8F6C\u6362\u4E3A -1 -> 1 \u7684\u6807\u51C6\u5750\u6807\u7A7A\u95F4\uFF08NDC\uFF09\n\n  vec4 p1 = vec4(pos, 0.0, 1.0); // x/y \u5E73\u9762\u4E0A\u7684\u70B9\uFF08z == 0\uFF09\u53EF\u4EE5\u8BA4\u4E3A\u662F\u4E09\u7EF4\u4E0A\u7684\u70B9\u88AB\u6295\u5F71\u5230\u5E73\u9762\u540E\u7684\u70B9\n  vec4 p2 = vec4(pos, 1.0, 1.0); // \u5E73\u884C\u4E8Ex/y\u5E73\u9762\u3001z==1 \u7684\u5E73\u9762\u4E0A\u7684\u70B9\n\n  vec4 inverseP1 = u_InverseViewProjectionMatrix * p1; // \u6839\u636E\u89C6\u56FE\u6295\u5F71\u77E9\u9635\u7684\u9006\u77E9\u9635\u5E73\u9762\u4E0A\u7684\u53CD\u7B97\u51FA\u4E09\u7EF4\u7A7A\u95F4\u4E2D\u7684\u70B9\uFF08p1\u5E73\u9762\u4E0A\u7684\u70B9\uFF09\n  vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;\n\n  inverseP1 = inverseP1 / inverseP1.w; // \u5F52\u4E00\u5316\u64CD\u4F5C\uFF08\u5F52\u4E00\u5316\u540E\u4E3A\u4E16\u754C\u5750\u6807\uFF09\n  inverseP2 = inverseP2 / inverseP2.w;\n\n  float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z); // ??\n  vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);\n\n  vec4 b = vec4(0.5, 0.0, 1.0, 0.5);\n  float fh;\n\n  v_intensity = texture(SAMPLER_2D(u_texture), v_texCoord).r;\n  fh = toBezier(v_intensity, b).y;\n  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.0), 1.0);\n\n}\n',fs:"layout(std140) uniform commonUniforms {\n  mat4 u_ViewProjectionMatrixUncentered;\n  mat4 u_InverseViewProjectionMatrix;\n  float u_opacity;\n  float u_common_uniforms_padding1;\n  float u_common_uniforms_padding2;\n  float u_common_uniforms_padding3;\n};\n\nuniform sampler2D u_texture;\nuniform sampler2D u_colorTexture;\n\nin vec2 v_texCoord;\nin float v_intensity;\nout vec4 outputColor;\n\nvoid main(){\n   \n    float intensity = texture(SAMPLER_2D(u_texture), v_texCoord).r;\n    vec4 color = texture(SAMPLER_2D(u_colorTexture),vec2(intensity, 0));\n    outputColor = color;\n    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;\n   outputColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;\n}\n"}),this.heat3DModelUniformBuffer=[this.rendererService.createBuffer({data:new Float32Array(36).fill(0),isUBO:!0})];let{vs:a,fs:o,uniforms:l}=this.shaderModuleService.getModule("heatmap3dColor"),{createAttribute:u,createElements:c,createBuffer:d,createModel:h}=this.rendererService;return h({vs:a,fs:o,attributes:{a_Position:u({shaderLocation:this.attributeLocation.POSITION,buffer:d({data:r.vertices,type:s.gl.FLOAT}),size:3}),a_Uv:u({shaderLocation:this.attributeLocation.UV,buffer:d({data:r.uvs,type:s.gl.FLOAT}),size:2})},primitive:s.gl.TRIANGLES,uniformBuffers:[...this.heat3DModelUniformBuffer,...this.rendererService.uniformBuffers],uniforms:(0,i.default)({},l),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:s.gl.SRC_ALPHA,srcAlpha:1,dstRGB:s.gl.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:c({data:r.indices,type:s.gl.UNSIGNED_INT,count:r.indices.length})});}drawIntensityMode(){var e;let{intensity:t=10,radius:n=5}=this.layer.getLayerConfig();this.uniformBuffers[0].subData({offset:0,data:[n,t]}),this.layerService.beforeRenderData(this.layer),this.layer.hooks.beforeRender.call(),null===(e=this.intensityModel)||void 0===e||e.draw({uniforms:{u_radius:n,u_intensity:t},blend:{enable:!0,func:{srcRGB:s.gl.ONE,srcAlpha:1,dstRGB:s.gl.ONE,dstAlpha:1}},stencil:{enable:!1,mask:255,func:{cmp:514,ref:1,mask:255}}}),this.layer.hooks.afterRender.call();}drawHeatMap(e){var t;let{opacity:n=1}=this.layer.getLayerConfig(),r={u_opacity:n,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer},i=[this.heatmapTexture,this.colorTexture];this.colorModelUniformBuffer[0].subData({offset:0,data:[n]}),null===(t=this.colorModel)||void 0===t||t.draw({uniforms:r,textures:i,blend:this.getBlend(),stencil:this.getStencil(e)});}draw3DHeatMap(e){var t;let{opacity:n=1}=this.layer.getLayerConfig(),r=u.mat4.create();u.mat4.invert(r,this.cameraService.getViewProjectionMatrixUncentered());let i={u_opacity:n,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:[...r]};this.heat3DModelUniformBuffer[0].subData({offset:0,data:[...i.u_ViewProjectionMatrixUncentered,...i.u_InverseViewProjectionMatrix,n]});let a=[this.heatmapTexture,this.colorTexture];null===(t=this.colorModel)||void 0===t||t.draw({uniforms:i,textures:a,blend:{enable:!0,func:{srcRGB:s.gl.SRC_ALPHA,srcAlpha:1,dstRGB:s.gl.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},stencil:this.getStencil(e)});}updateColorTexture(){let{createTexture2D:e}=this.rendererService;this.texture&&this.texture.destroy();let{rampColors:t}=this.layer.getLayerConfig(),n=(0,l.generateColorRamp)(t);this.colorTexture=e({data:n.data,usage:s.TextureUsage.SAMPLED,width:n.width,height:n.height,wrapS:s.gl.CLAMP_TO_EDGE,wrapT:s.gl.CLAMP_TO_EDGE,min:s.gl.NEAREST,mag:s.gl.NEAREST,flipY:!1,unorm:!0}),this.preRampColors=t;}}},"5f230a3e":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0});var r=n("777fffbe"),i=n("81e755b2"),a=r._(n("1316cf9d")),o=r._(n("3d495adb")),s=r._(n("66a06515")),l=r._(n("20defe2a")),u=n("0d884ee9"),c=n("71293cfd"),d=function(e){function t(){var e;(0,a.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,s.default)(this,t,[].concat(r))).landmarks=[],e;}return(0,l.default)(t,e),(0,o.default)(t,[{key:"rotate",value:function(e,t,n){if(this.relElevation=(0,i.getAngle)(t),this.relAzimuth=(0,i.getAngle)(e),this.relRoll=(0,i.getAngle)(n),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===i.CameraType.EXPLORING){var r=c.quat.setAxisAngle(c.quat.create(),[1,0,0],(0,i.deg2rad)((this.rotateWorld?1:-1)*this.relElevation)),a=c.quat.setAxisAngle(c.quat.create(),[0,1,0],(0,i.deg2rad)((this.rotateWorld?1:-1)*this.relAzimuth)),o=c.quat.setAxisAngle(c.quat.create(),[0,0,1],(0,i.deg2rad)(this.relRoll)),s=c.quat.multiply(c.quat.create(),a,r);s=c.quat.multiply(c.quat.create(),s,o);var l=c.mat4.fromQuat(c.mat4.create(),s);c.mat4.translate(this.matrix,this.matrix,[0,0,-this.distance]),c.mat4.multiply(this.matrix,this.matrix,l),c.mat4.translate(this.matrix,this.matrix,[0,0,this.distance]);}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix();}return this._getAxes(),this.type===i.CameraType.ORBITING||this.type===i.CameraType.EXPLORING?this._getPosition():this.type===i.CameraType.TRACKING&&this._getFocalPoint(),this._update(),this;}},{key:"pan",value:function(e,t){var n=(0,i.createVec3)(e,t,0),r=c.vec3.clone(this.position);return c.vec3.add(r,r,c.vec3.scale(c.vec3.create(),this.right,n[0])),c.vec3.add(r,r,c.vec3.scale(c.vec3.create(),this.up,n[1])),this._setPosition(r),this.triggerUpdate(),this;}},{key:"dolly",value:function(e){var t=this.forward,n=c.vec3.clone(this.position),r=e*this.dollyingStep;return r=Math.max(Math.min(this.distance+e*this.dollyingStep,this.maxDistance),this.minDistance)-this.distance,n[0]+=r*t[0],n[1]+=r*t[1],n[2]+=r*t[2],this._setPosition(n),this.type===i.CameraType.ORBITING||this.type===i.CameraType.EXPLORING?this._getDistance():this.type===i.CameraType.TRACKING&&c.vec3.add(this.focalPoint,n,this.distanceVector),this.triggerUpdate(),this;}},{key:"cancelLandmarkAnimation",value:function(){void 0!==this.landmarkAnimationID&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID);}},{key:"createLandmark",value:function(e){var t,n,r,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=o.position,l=void 0===s?this.position:s,u=o.focalPoint,d=void 0===u?this.focalPoint:u,f=o.roll,h=o.zoom,p=new i.runtime.CameraContribution;p.setType(this.type,void 0),p.setPosition(l[0],null!==(t=l[1])&&void 0!==t?t:this.position[1],null!==(n=l[2])&&void 0!==n?n:this.position[2]),p.setFocalPoint(d[0],null!==(r=d[1])&&void 0!==r?r:this.focalPoint[1],null!==(a=d[2])&&void 0!==a?a:this.focalPoint[2]),p.setRoll(null!=f?f:this.roll),p.setZoom(null!=h?h:this.zoom);var v={name:e,matrix:c.mat4.clone(p.getWorldTransform()),right:c.vec3.clone(p.right),up:c.vec3.clone(p.up),forward:c.vec3.clone(p.forward),position:c.vec3.clone(p.getPosition()),focalPoint:c.vec3.clone(p.getFocalPoint()),distanceVector:c.vec3.clone(p.getDistanceVector()),distance:p.getDistance(),dollyingStep:p.getDollyingStep(),azimuth:p.getAzimuth(),elevation:p.getElevation(),roll:p.getRoll(),relAzimuth:p.relAzimuth,relElevation:p.relElevation,relRoll:p.relRoll,zoom:p.getZoom()};return this.landmarks.push(v),v;}},{key:"gotoLandmark",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,u.isString)(e)?this.landmarks.find(function(t){return t.name===e;}):e;if(r){var a,o=(0,u.isNumber)(n)?{duration:n}:n,s=o.easing,l=o.duration,d=void 0===l?100:l,f=o.easingFunction,h=o.onfinish,p=void 0===h?void 0:h,v=o.onframe,g=void 0===v?void 0:v;this.cancelLandmarkAnimation();var m=r.position,y=r.focalPoint,b=r.zoom,_=r.roll,x=(void 0===f?void 0:f)||i.runtime.EasingFunction(void 0===s?"linear":s),w=function(){t.setFocalPoint(y),t.setPosition(m),t.setRoll(_),t.setZoom(b),t.computeMatrix(),t.triggerUpdate(),null==p||p();};if(0===d)return w();var E=function(e){void 0===a&&(a=e);var n=e-a;if(n>=d){w();return;}var r=x(n/d),i=c.vec3.create(),o=c.vec3.create(),s=1,l=0;if(c.vec3.lerp(i,t.focalPoint,y,r),c.vec3.lerp(o,t.position,m,r),l=t.roll*(1-r)+_*r,s=t.zoom*(1-r)+b*r,t.setFocalPoint(i),t.setPosition(o),t.setRoll(l),t.setZoom(s),c.vec3.dist(i,y)+c.vec3.dist(o,m)<=.01&&void 0===b&&void 0===_)return w();t.computeMatrix(),t.triggerUpdate(),n<d&&(null==g||g(r),t.landmarkAnimationID=t.canvas.requestAnimationFrame(E));};this.canvas.requestAnimationFrame(E);}}}]);}(i.Camera);i.runtime.CameraContribution=d;},"5f5b66d7":function(e,t,n){var r=n("8d15a3f4");e.exports=function(){this.__data__=r?r(null):{},this.size=0;};},"5f6e51a9":function(e,t,n){"use strict";function r(e,t){if(!({}).hasOwnProperty.call(e,t))throw TypeError("attempted to use private field on non-instance");return e;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"5fe55d01":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return d;}});var r=n("777fffbe"),i=r._(n("4f760119")),a=r._(n("58bc00e8")),o=r._(n("4dbf85f4")),s=r._(n("19f20421")),l=r._(n("9c676843")),u=r._(n("a665ba30")),c=r._(n("f2e70cc2")),d={arc:i.default,arc3d:a.default,greatcircle:s.default,wall:c.default,line:l.default,simple:u.default,flowline:o.default,earthArc3d:a.default};},"612663f6":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{GeoLocate:function(){return u;},default:function(){return u;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("f89fb776")),o=r._(n("d812e418")),s=n("631fd3ae"),l=r._(n("3198c185"));class u extends l.default{constructor(e){var t;super(e),t=this,(0,o.default)(this,"getGeoLocation",()=>new Promise((e,t)=>{window.navigator.geolocation.getCurrentPosition(({coords:n})=>{let{longitude:r,latitude:i}=null!=n?n:{};isNaN(r)||isNaN(i)?t():e([r,i]);},e=>{t(e);});})),(0,o.default)(this,"onClick",(0,a.default)(function*(){if(!window.navigator.geolocation)return;let{transform:e}=t.controlOption,n=yield t.getGeoLocation(),r=t.mapsService.getZoom();t.mapsService.setZoomAndCenter(r>15?r:15,e?yield e(n):n);})),window.navigator.geolocation||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u83B7\u53D6\u5730\u7406\u5B9A\u4F4D");}getDefault(e){return(0,i.default)((0,i.default)({},super.getDefault(e)),{},{title:"\u5B9A\u4F4D",btnIcon:(0,s.createL7Icon)("l7-icon-reposition")});}onAdd(){let e=super.onAdd();return e.addEventListener("click",this.onClick),e;}}},"617c7249":function(e,t,n){e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e;};},"61ae7b88":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("4d809c36"));function i(e){var t,n=[],i=[];for(this._root&&n.push(new r.default(this._root,this._x0,this._x1));t=n.pop();){var a=t.node;if(a.length){var o,s=t.x0,l=t.x1,u=(s+l)/2;(o=a[0])&&n.push(new r.default(o,s,u)),(o=a[1])&&n.push(new r.default(o,u,l));}i.push(t);}for(;t=i.pop();)e(t.node,t.x0,t.x1);return this;}},"61b1131d":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{arcToCubic:function(){return s.arcToCubic;},clonePath:function(){return i.clonePath;},distanceSquareRoot:function(){return f.distanceSquareRoot;},equalizeSegments:function(){return h.equalizeSegments;},getDrawDirection:function(){return c.getDrawDirection;},getPointAtLength:function(){return d.getPointAtLength;},getRotatedCurve:function(){return u.getRotatedCurve;},getTotalLength:function(){return l.getTotalLength;},normalizePath:function(){return a.normalizePath;},path2Curve:function(){return r.path2Curve;},reverseCurve:function(){return o.reverseCurve;}});var r=n("6bbcbda8"),i=n("c1ba9e59"),a=n("5e61b478"),o=n("24aea557"),s=n("2abedd64"),l=n("f6062608"),u=n("8c9f46f3"),c=n("d283da89"),d=n("17ed734c"),f=n("d1adb660"),h=n("df63ef95");},"61e223d5":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"load",{enumerable:!0,get:function(){return r;}});let r=e=>{let{tk:t}=e;return new Promise(e=>{let n=document.createElement("script");n.type="text/javascript",n.src=`https://api.tianditu.gov.cn/api?v=4.0&tk=${t}`,n.onload=function(){console.log("TianDiTu API script loaded."),e(!0);},n.onerror=function(){console.error("Failed to load TianDiTu API script."),e(!1);},document.head.appendChild(n);});};},"61e63793":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("daaa1548")),o=r._(n("d812e418")),s=n("d9b661b3"),l=r._(n("755bc4f8"));class u extends l.default{constructor(...e){super(...e),(0,o.default)(this,"texture",void 0),(0,o.default)(this,"terrainImage",void 0),(0,o.default)(this,"terrainImageLoaded",!1),(0,o.default)(this,"mapTexture",void 0),(0,o.default)(this,"planeGeometryTriangulation",()=>{let{width:e=1,height:t=1,widthSegments:n=1,heightSegments:r=1,center:i=[120,30],terrainTexture:a,rgb2height:o=(e,t,n)=>e+t+n}=this.layer.getLayerConfig(),{indices:s,positions:l}=this.initPlane(e,t,n,r,...i);return a?this.translateVertex(l,s,this.terrainImage,n,r,o):{vertices:l,indices:s,size:5};});}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:10});}initPlane(e=1,t=1,n=1,r=1,i=120,a=30){let o=e/2,s=t/2,l=Math.floor(n),u=Math.floor(r),c=l+1,d=u+1,f=e/l,h=t/u,p=[],v=[];for(let e=0;e<d;e++){let t=e*h-s;for(let n=0;n<c;n++){let r=n*f-o;v.push(r+i,-t+a,0),v.push(n/l),v.push(1-e/u);}}for(let e=0;e<u;e++)for(let t=0;t<l;t++){let n=t+c*e,r=t+c*(e+1),i=t+1+c*(e+1),a=t+1+c*e;p.push(n,r,a),p.push(r,i,a);}return{indices:p,positions:v};}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,a.default)((0,a.default)({},e.uniformsOption),t.uniformsOption);}getCommonUniformsInfo(){let{opacity:e,mapTexture:t,terrainClipHeight:n=0,terrainTexture:r}=this.layer.getLayerConfig();if(this.mapTexture!==t){var i;this.mapTexture=t,null===(i=this.texture)||void 0===i||i.destroy(),this.updateTexture(t);}let a={u_opacity:e||1,u_mapFlag:t?1:0,u_terrainClipHeight:r?n:-1,u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(a);}clearModels(){var e;this.terrainImage=null,null===(e=this.texture)||void 0===e||e.destroy(),this.textures=[];}initModels(){var e=this;return(0,i.default)(function*(){let{mapTexture:t,terrainTexture:n}=e.layer.getLayerConfig();e.mapTexture=t;let{createTexture2D:r}=e.rendererService;return e.texture=r({height:0,width:0}),e.updateTexture(t),e.initUniformsBuffer(),n&&(e.terrainImage=yield e.loadTerrainImage(n)),[(yield e.layer.buildLayerModel({moduleName:"geometryPlane",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec3 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\nlayout(std140) uniform commonUniforms {\n  float u_opacity;\n  float u_mapFlag;\n  float u_terrainClipHeight;\n};\n\nout vec3 v_Color;\nout vec2 v_uv;\nout float v_clip;\n\n#pragma include "projection"\n#pragma include "picking"\nvoid main() {\n  v_Color = a_Color;\n  v_uv = a_Uv;\n\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n\n  v_clip = 1.0;\n  if (a_Position.z < u_terrainClipHeight) {\n    v_clip = 0.0;\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, a_Position.z, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'uniform sampler2D u_texture;\nlayout(std140) uniform commonUniforms {\n  float u_opacity;\n  float u_mapFlag;\n  float u_terrainClipHeight;\n};\n\nin vec3 v_Color;\nin vec2 v_uv;\nin float v_clip;\nout vec4 outputColor;\n\n#pragma include "picking"\nvoid main() {\n  if (u_mapFlag > 0.0) {\n    outputColor = texture(SAMPLER_2D(u_texture), vec2(v_uv.x, 1.0 - v_uv.y));\n    outputColor.a *= u_opacity;\n  } else {\n    outputColor = vec4(v_Color, u_opacity);\n  }\n  outputColor.a *= v_clip;\n  outputColor = filterColor(outputColor);\n}\n',triangulation:e.planeGeometryTriangulation,defines:e.getDefines(),inject:e.getInject(),primitive:s.gl.TRIANGLES,depth:{enable:!0},cull:{enable:!0,face:s.gl.BACK}}))];})();}buildModels(){var e=this;return(0,i.default)(function*(){return e.initModels();})();}createModelData(e){if(e){let{widthSegments:t,heightSegments:n,width:r,height:i}=this.layer.getLayerConfig(),{widthSegments:a,heightSegments:o,width:s,height:l}=e;this.layer.style({widthSegments:void 0!==a?a:t,heightSegments:void 0!==o?o:n,width:void 0!==s?s:r,height:void 0!==l?l:i});}let t=this.layer.getEncodedData();return this.styleAttributeService.createAttributesAndIndices(t,this.planeGeometryTriangulation);}updateTexture(e){let{createTexture2D:t}=this.rendererService;if(e){let n=new Image;n.crossOrigin="anonymous",n.onload=()=>{this.texture=t({data:n,width:n.width,height:n.height,wrapS:s.gl.CLAMP_TO_EDGE,wrapT:s.gl.CLAMP_TO_EDGE}),this.layerService.reRender();},n.src=e;}else this.texture=t({width:0,height:0});}getImageData(e){let t=document.createElement("canvas"),n=t.getContext("2d"),{width:r,height:i}=e;return t.width=r,t.height=i,n.drawImage(e,0,0,r,i),n.getImageData(0,0,r,i);}translateVertex(e,t,n,r,i,a){let o=n.width,s=n.height,l=this.getImageData(n).data,u=Math.floor(r),c=Math.floor(i),d=u+1,f=c+1,h=o/u,p=s/c;for(let t=0;t<f;t++){let n=Math.floor(t*p)*o;for(let r=0;r<d;r++){let i=(n+Math.floor(r*h))*4,o=l[i],s=l[i+1],u=l[i+2];e[(t*d+r)*5+2]=a(o,s,u);}}return{vertices:e,indices:t,size:5};}loadTerrainImage(e){var t=this;return(0,i.default)(function*(){if(t.terrainImage)return t.terrainImageLoaded?t.terrainImage:new Promise(e=>{t.terrainImage.onload=()=>{e(t.terrainImage);};});{let n=new Image;return n.crossOrigin="anonymous",new Promise(r=>{n.onload=()=>{t.terrainImageLoaded=!0,r(n),setTimeout(()=>t.layer.emit("terrainImageLoaded",null));},n.src=e;});}})();}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:s.AttributeType.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:s.gl.DYNAMIC_DRAW,data:[],type:s.gl.FLOAT},size:2,update:(e,t,n)=>[n[3],n[4]]}});}}},"62396a98":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("89dc7153")),i=function(e,t){return(0,r.default)(e,function(e,n,r){return t.includes(r)||(e[r]=n),e;},{});};},"629a34cc":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("ebc8c370")),a=r._(n("3a988df8")),o=function(e){return(0,a.default)(e)&&"[object Set]"==(0,i.default)(e);};},"62b16a10":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{Graph:function(){return c;},VACANT_EDGE_ID:function(){return r;},VACANT_EDGE_LABEL:function(){return a;},VACANT_GRAPH_ID:function(){return s;},VACANT_NODE_ID:function(){return i;},VACANT_NODE_LABEL:function(){return o;}});var r=-1,i=-1,a="-1",o="-1",s=-1,l=function(e,t,n,o){void 0===e&&(e=r),void 0===t&&(t=i),void 0===n&&(n=i),void 0===o&&(o=a),this.id=e,this.from=t,this.to=n,this.label=o;},u=function(){function e(e,t){void 0===e&&(e=i),void 0===t&&(t=o),this.id=e,this.label=t,this.edges=[],this.edgeMap={};}return e.prototype.addEdge=function(e){this.edges.push(e),this.edgeMap[e.id]=e;},e;}(),c=function(){function e(e,t,n){void 0===e&&(e=i),void 0===t&&(t=!0),void 0===n&&(n=!1),this.id=e,this.edgeIdAutoIncrease=t,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=n;}return e.prototype.getNodeNum=function(){return this.nodes.length;},e.prototype.addNode=function(e,t){if(!this.nodeMap[e]){var n=new u(e,t);this.nodes.push(n),this.nodeMap[e]=n,this.nodeLabelMap[t]||(this.nodeLabelMap[t]=[]),this.nodeLabelMap[t].push(e);}},e.prototype.addEdge=function(e,t,n,r){if((this.edgeIdAutoIncrease||void 0===e)&&(e=this.counter++),!this.nodeMap[t]||!this.nodeMap[n]||!this.nodeMap[n].edgeMap[e]){var i=new l(e,t,n,r);if(this.edges.push(i),this.edgeMap[e]=i,this.nodeMap[t].addEdge(i),this.edgeLabelMap[r]||(this.edgeLabelMap[r]=[]),this.edgeLabelMap[r].push(i),!this.directed){var a=new l(e,n,t,r);this.nodeMap[n].addEdge(a),this.edgeLabelMap[r].push(a);}}},e;}();},"631fd3ae":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"createL7Icon",{enumerable:!0,get:function(){return r;}});let r=e=>{let t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.classList.add("l7-iconfont"),t.setAttribute("aria-hidden","true");let n=document.createElementNS("http://www.w3.org/2000/svg","use");return n.setAttributeNS("http://www.w3.org/1999/xlink","href",`#${e}`),t.appendChild(n),t;};},"633ca35c":function(e,t,n){var r=n("ce906886"),i=n("b192169f"),a=n("5bf20808").Graph;e.exports={debugOrdering:function(e){var t=i.buildLayerMatrix(e),n=new a({compound:!0,multigraph:!0}).setGraph({});return r.forEach(e.nodes(),function(t){n.setNode(t,{label:t}),n.setParent(t,"layer"+e.node(t).rank);}),r.forEach(e.edges(),function(e){n.setEdge(e.v,e.w,{},e.name);}),r.forEach(t,function(e,t){n.setNode("layer"+t,{rank:"same"}),r.reduce(e,function(e,t){return n.setEdge(e,t,{style:"invis"}),t;});}),n;}};},"636528d5":function(e,t,n){var r=Date.now;e.exports=function(e){var t=0,n=0;return function(){var i=r(),a=16-(i-n);if(n=i,a>0){if(++t>=800)return arguments[0];}else t=0;return e.apply(void 0,arguments);};};},"638df17c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"scanParam",{enumerable:!0,get:function(){return i;}});var r=n("af11c929");function i(e){var t,n=e.max,i=e.pathValue,a=e.index,o=a,s=!1,l=!1,u=!1,c=!1;if(o>=n){e.err="[path-util]: Invalid path value at index ".concat(o,', "pathValue" is missing param');return;}if((43===(t=i.charCodeAt(o))||45===t)&&(o+=1,t=i.charCodeAt(o)),!(0,r.isDigit)(t)&&46!==t){e.err="[path-util]: Invalid path value at index ".concat(o,', "').concat(i[o],'" is not a number');return;}if(46!==t){if(s=48===t,o+=1,t=i.charCodeAt(o),s&&o<n&&t&&(0,r.isDigit)(t)){e.err="[path-util]: Invalid path value at index ".concat(a,', "').concat(i[a],'" illegal number');return;}for(;o<n&&(0,r.isDigit)(i.charCodeAt(o));)o+=1,l=!0;t=i.charCodeAt(o);}if(46===t){for(c=!0,o+=1;(0,r.isDigit)(i.charCodeAt(o));)o+=1,u=!0;t=i.charCodeAt(o);}if(101===t||69===t){if(c&&!l&&!u){e.err="[path-util]: Invalid path value at index ".concat(o,', "').concat(i[o],'" invalid float exponent');return;}if(o+=1,(43===(t=i.charCodeAt(o))||45===t)&&(o+=1),o<n&&(0,r.isDigit)(i.charCodeAt(o)))for(;o<n&&(0,r.isDigit)(i.charCodeAt(o));)o+=1;else{e.err="[path-util]: Invalid path value at index ".concat(o,', "').concat(i[o],'" invalid integer exponent');return;}}e.index=o,e.param=+e.pathValue.slice(a,o);}},"63aee470":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("a8be75a3")),a=r._(n("731b2a36")),o=(0,i.default)(a.default,"Promise");},"63bbd163":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("d2dabb01");function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,r.isAnyArray)(e))throw TypeError("input must be an array");if(0===e.length)throw TypeError("input must not be empty");var n=t.fromIndex,i=void 0===n?0:n,a=t.toIndex,o=void 0===a?e.length:a;if(i<0||i>=e.length||!Number.isInteger(i))throw Error("fromIndex must be a positive integer smaller than length");if(o<=i||o>e.length||!Number.isInteger(o))throw Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=e[i],l=i+1;l<o;l++)e[l]<s&&(s=e[l]);return s;}},"63bd4b56":function(e,t,n){var r=n("062e2d5f"),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,o=r(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(i,function(e,n,r,i){t.push(r?i.replace(a,"$1"):n||e);}),t;});e.exports=o;},"644ac1e2":function(e,t,n){var r=n("ab7074ef"),i=n("fa026405"),a=n("49612516"),o=RegExp("['\u2019]","g");e.exports=function(e){return function(t){return r(a(i(t).replace(o,"")),e,"");};};},"644d7f2e":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{findShortestPath:function(){return i.findShortestPath;},pageRank:function(){return a.default;}});var r=n("777fffbe");n("aabd5101"),n("71ba123c");var i=n("1955a375");n("fc59e6b8"),n("4b5ee90c"),n("e95afa28"),n("a56c16a1"),n("44a4680f"),n("3dfdf06f"),n("402ce633");var a=r._(n("7c4281a7"));n("dc6ae360"),n("a6000239");},"6495e7c6":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"octree",{enumerable:!0,get:function(){return r.default;}});var r=n("777fffbe")._(n("d0ab0443"));},"64b9b79c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=Object.prototype,i=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r);};},"655dca65":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"binarytree",{enumerable:!0,get:function(){return r.default;}});var r=n("777fffbe")._(n("950ddc7d"));},65974307:function(e,t,n){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o);}return a;};},"65f3d028":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"segmentCubicFactory",{enumerable:!0,get:function(){return i;}});var r=n("d1adb660");function i(e,t,n,i,a,o,s,l,u,c){var d,f=c.bbox,h=void 0===f||f,p=c.length,v=void 0===p||p,g=c.sampleSize,m=void 0===g?10:g,y="number"==typeof u,b=e,_=t,x=0,w=[b,_,0],E=[b,_],M={x:0,y:0},S=[{x:b,y:_}];y&&u<=0&&(M={x:b,y:_});for(var k=0;k<=m;k+=1){if(b=(d=function(e,t,n,r,i,a,o,s,l){var u=1-l;return{x:Math.pow(u,3)*e+3*Math.pow(u,2)*l*n+3*u*Math.pow(l,2)*i+Math.pow(l,3)*o,y:Math.pow(u,3)*t+3*Math.pow(u,2)*l*r+3*u*Math.pow(l,2)*a+Math.pow(l,3)*s};}(e,t,n,i,a,o,s,l,k/m)).x,_=d.y,h&&S.push({x:b,y:_}),v&&(x+=(0,r.distanceSquareRoot)(E,[b,_])),E=[b,_],y&&x>=u&&u>w[2]){var C=(x-u)/(x-w[2]);M={x:E[0]*(1-C)+w[0]*C,y:E[1]*(1-C)+w[1]*C};}w=[b,_,x];}return y&&u>=x&&(M={x:s,y:l}),{length:x,point:M,min:{x:Math.min.apply(null,S.map(function(e){return e.x;})),y:Math.min.apply(null,S.map(function(e){return e.y;}))},max:{x:Math.max.apply(null,S.map(function(e){return e.x;})),y:Math.max.apply(null,S.map(function(e){return e.y;}))}};}},"666963cd":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("73ff5a90")),i=Object.prototype.hasOwnProperty,a=function(e){var t=this.__data__;if(r.default){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n;}return i.call(t,e)?t[e]:void 0;};},"666a0e6f":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"getTileFactory",{enumerable:!0,get:function(){return f;}});var r=n("777fffbe"),i=n("d9b661b3"),a=r._(n("d23dbaca")),o=r._(n("7172b896")),s=r._(n("58b94788")),l=r._(n("2f0d6cbf")),u=r._(n("5474b795")),c=r._(n("85f42f11")),d=r._(n("a2fd0fbe"));function f(e){switch(e.type){case"PolygonLayer":case"LineLayer":case"PointLayer":return d.default;case"TileDebugLayer":return a.default;case"MaskLayer":return s.default;case"RasterLayer":let{dataType:t}=e.getSource().parser;switch(t){case i.RasterTileType.RGB:case i.RasterTileType.CUSTOMRGB:return l.default;case i.RasterTileType.ARRAYBUFFER:case i.RasterTileType.CUSTOMARRAYBUFFER:return c.default;case i.RasterTileType.TERRAINRGB:case i.RasterTileType.CUSTOMTERRAINRGB:return u.default;default:return o.default;}default:return d.default;}}},"66ee10cd":function(e,t,n){var r=n("7988eeca"),i=n("ef51a61d"),a=n("481b6514"),o=n("2a3589a9"),s=n("46cf8fa6");e.exports=function(e){if(null==e)return 0;if(a(e))return o(e)?s(e):e.length;var t=i(e);return"[object Map]"==t||"[object Set]"==t?e.size:r(e).length;};},"673e833b":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("6ebbe753")),a=r._(n("96ab26b2")),o=r._(n("2546cc51")),s=function(e,t){var n=this.__data__;if(n instanceof i.default){var r=n.__data__;if(!a.default||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new o.default(r);}return n.set(e,t),this.size=n.size,this;};},"6751161d":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return h;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=r._(n("80dad29a")),s=n("d9b661b3"),l=n("3aa02964"),u=r._(n("4f2bad25")),c=n("61e223d5");let d=0,f={zoomchange:["Ge"]};class h extends o.default{constructor(...e){super(...e),(0,a.default)(this,"viewport",null),(0,a.default)(this,"evtCbProxyMap",new Map),(0,a.default)(this,"sceneContainer",void 0),(0,a.default)(this,"handleCameraChanged",()=>{this.emit("mapchange");let e=this.map,{lng:t,lat:n}=this.map.getCenter(),r={center:[t,n],viewportHeight:e.getContainer().clientHeight,viewportWidth:e.getContainer().clientWidth,bearing:360,pitch:0,zoom:e.getZoom()-1};this.viewport&&(this.viewport.syncWithMapCamera(r),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport));});}addMarkerContainer(){let e=this.map.getContainer(),t=this.markerContainer=document.createElement("div");e.appendChild(t),t.setAttribute("tabindex","-1"),t.id="tdt-L7-marker",t.style.position="absolute",t.style.left="",t.style.top="",t.style.zIndex="600",t.style.width="0px",t.style.height="0px",t.style.overflow="visible";}getMarkerContainer(){return this.markerContainer;}onCameraChanged(e){this.cameraChangedCallback=e;}resize(e){this.sceneContainer.style.width=e.newSize.x+"px",this.sceneContainer.style.height=e.newSize.y+"px";}update(){let e=this.map.getBounds(),{x:t,y:n}=this.map.lngLatToLayerPoint({lng:e.getSouthWest().lng,lat:e.getNorthEast().lat});this.sceneContainer.style.transition="",this.sceneContainer.style.transformOrigin="center",this.sceneContainer.style.transform=`translate3d(${t}px, ${n}px, 0px) scale(1)`,this.markerContainer.style.transition="",this.markerContainer.style.transformOrigin="center",this.markerContainer.style.transform=`translate3d(${-t}px, ${-n}px, 0px) scale(1)`,this.sceneContainer._tdt_pos=new T.Point(t,n),this.handleCameraChanged();}getZoomScale(e,t){let n=this.map.options.IW;return t=void 0===t?this.map.getZoom():t,n.scale(e)/n.scale(t);}zoomStartUpdate(e){let t=e.center,n=e.zoom,r=this.getZoomScale(n,this.map.getZoom()),i=T._Q.getPosition(this.sceneContainer),a=this.map.getSize().GQ(.5),o=this.map.options.IW.qW(this.map.getCenter(),n),s=this.map.options.IW.qW(t,n).DQ(o),l=new T.Point(a.x,a.y).GQ(-r);l.aQ(i),l.aQ(a),l.DQ(s),this.sceneContainer.style.transform=`translate3d(${l.x}px,${l.y}px,0px) scale(${r})`,this.sceneContainer.style.transformOrigin="0 0",this.sceneContainer.style.transition="transform 0.25s cubic-bezier(0,0,0.25,1)",this.handleCameraChanged();}getOverlayContainer(){var e;let t=null===(e=this.map.getPanes())||void 0===e?void 0:e.overlayPane,n=document.createElement("div");t.parentElement.appendChild(n),n.id="tdt-L7";let r=this.map.getSize();return n.style.zIndex="200",n.style.width=`${r.x}px`,n.style.height=`${r.y}px`,this.sceneContainer=n,n;}init(){var e=this;return(0,i.default)(function*(){e.viewport=new u.default;let{id:t,mapInstance:n,center:r=[121.30654632240122,31.25744185633306],token:i="b15e548080c79819617367d3f6095c69",minZoom:a=1,maxZoom:o=18,zoom:s=3}=e.config;if(window.T||(yield(0,c.load)({tk:i})),n){e.map=n,e.map.centerAndZoom(new window.T.LngLat(r[0],r[1]),s),e.$mapContainer=e.map.getContainer();let t=new window.T.LngLat(r[0],r[1]);e.map.centerAndZoom(t,s),e.setMinZoom(a),e.setMaxZoom(o);}else{if(!t)throw Error("No container id specified");e.$mapContainer=e.creatMapContainer(t);let n=new T.Map(e.$mapContainer,{center:window.T.LngLat(r[0],r[1]),minZoom:a,maxZoom:o,zoom:s,projection:"EPSG:900913"});e.map=n;let i=new window.T.Control.Zoom;n.addControl(i);}e.map.getContainer().querySelector(".tdt-pane").style.zIndex=1,e.handleCameraChanged(),e.map.on("move",e.update,e),e.map.on("Ge",e.zoomStartUpdate,e),e.map.on("resize",e.resize,e);})();}destroy(){}on(e,t){if(-1!==s.MapServiceEvent.indexOf(e))this.eventEmitter.on(e,t);else{let n=e=>{let n=this.evtCbProxyMap.get(e);if(n||this.evtCbProxyMap.set(e,n=new Map),n.get(t))return;let r=(...e)=>{!e[0]||"object"!=typeof e[0]||e[0].lngLat||e[0].lnglat||(e[0].lngLat=e[0].latlng||e[0].latLng,e[0].map=this.map),t(...e);};n.set(t,r),this.map.on(e,r);};Array.isArray(f[e])?f[e].forEach(t=>{n(t||e);}):n(f[e]||e);}}off(e,t){if(-1!==s.MapServiceEvent.indexOf(e)){this.eventEmitter.off(e,t);return;}let n=n=>{var r,i;let a=null===(r=this.evtCbProxyMap.get(e))||void 0===r?void 0:r.get(t);a&&(null===(i=this.evtCbProxyMap.get(n))||void 0===i||i.delete(t),this.map.off(n,a));};Array.isArray(f[e])?f[e].forEach(t=>{n(t||e);}):n(f[e]||e);}once(e,t){throw Error("Method not implemented.");}getMapContainer(){return this.map.getContainer();}getType(){return"tdtmap";}getMapCanvasContainer(){var e;return null===(e=this.map.getContainer())||void 0===e?void 0:e.getElementsByClassName("tdt-container")[0];}getSize(){let e=this.map.getSize();return[e.x,e.y];}getZoom(){return this.map.getZoom();}setZoom(e){return this.map.setZoom(e);}getCenter(){return this.map.getCenter();}setCenter(e){let t=window.T.LngLat(e[0],e[1]);this.map.centerAndZoom(t,this.map.getZoom());}setZoomAndCenter(e,t){let n=window.T.LngLat(t[0],t[1]);this.map.centerAndZoom(n,e);}getPitch(){return 0;}getRotation(){return 0;}setRotation(e){this.map.setBearing(e);}zoomIn(e,t){this.map.zoomIn(e,t);}zoomOut(e,t){this.map.zoomOut(e,t);}panTo(e){this.map.panTo(e);}panBy(e=0,t=0){this.map.panBy([e,t]);}fitBounds(e){let[t,n]=e;this.map.setViewport([new window.T.LngLat(t[0],t[1]),new window.T.LngLat(n[0],n[1])]);}setMaxZoom(e){this.map.setMaxZoom(e);}setMinZoom(e){this.map.setMinZoom(e);}setMapStatus(e){!0===e.doubleClickZoom&&this.map.enableDoubleClickZoom(),!1===e.doubleClickZoom&&this.map.disableDoubleClickZoom(),!1===e.dragEnable&&this.map.disableDrag(),!0===e.dragEnable&&this.map.enableDrag(),!1===e.keyboardEnable&&this.map.disableKeyboard(),!0===e.keyboardEnable&&this.map.enableKeyboard(),!1===e.zoomEnable&&this.map.disableScrollWheelZoom(),!0===e.zoomEnable&&this.map.enableScrollWheelZoom();}getModelMatrix(){throw Error("Method not implemented.");}pixelToLngLat([e,t]){let n=this.map.layerPointToLngLat({x:e,y:t});return{lng:n.lng,lat:n.lat};}lngLatToPixel([e,t]){let n=this.map.lngLatToLayerPoint({lng:e,lat:t});return{x:n.x,y:n.y};}containerToLngLat([e,t]){let n=this.map.containerPointToLngLat({x:e,y:t});return{lng:n.lng,lat:n.lat};}lngLatToContainer([e,t]){let n=this.map.lngLatToContainerPoint({lat:t,lng:e});return{x:n.x,y:n.y};}lngLatToCoord([e,t]){let n=this.lngLatToPixel([e,t]);return[n.x,n.y];}lngLatToCoords(e){return e.map(e=>Array.isArray(e[0])?this.lngLatToCoords(e):this.lngLatToCoord(e));}getBounds(){let e=this.map.getBounds(),t=e.getSouthWest(),n=e.getNorthEast();return[[t.lng,t.lat],[n.lng,n.lat]];}lngLatToMercator(e,t){let{x:n=0,y:r=0,z:i=0}=l.MercatorCoordinate.fromLngLat(e,t);return{x:n,y:r,z:i};}getCustomCoordCenter(){throw Error("Method not implemented.");}creatMapContainer(e){let t=e;"string"==typeof e&&(t=document.getElementById(e));let n=document.createElement("div");return n.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,n.id="l7_tdt_div"+d++,t.appendChild(n),n;}}},"6801e0b3":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{createMat4:function(){return i;},transformVector:function(){return a;}});var r=n("852bbaa9")._(n("20eaf7f4"));function i(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];}function a(e,t){var n=r.transformMat4([],t,e);return r.scale(n,n,1/n[3]),n;}},"684a09cf":function(e,t,n){var r=n("d438c68f"),i=n("10e0f52e");e.exports=function(e,t){return null!=e&&i(e,t,r);};},"6855ca3a":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("4a8d04f1"));function i(e){var t,n,i,a=(0,r.default)(.1);function o(e){for(var r,a=0,o=t.length;a<o;++a)r=t[a],r.vz+=(i[a]-r.z)*n[a]*e;}function s(){if(t){var r,o=t.length;for(r=0,n=Array(o),i=Array(o);r<o;++r)n[r]=isNaN(i[r]=+e(t[r],r,t))?0:+a(t[r],r,t);}}return"function"!=typeof e&&(e=(0,r.default)(null==e?0:+e)),o.initialize=function(e){t=e,s();},o.strength=function(e){return arguments.length?(a="function"==typeof e?e:(0,r.default)(+e),s(),o):a;},o.z=function(t){return arguments.length?(e="function"==typeof t?t:(0,r.default)(+t),s(),o):e;},o;}},"68726a22":function(e,t,n){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r;};},"6891a51d":function(e,t,n){var r=n("ce906886"),i=n("b192169f");function a(e,t,n){for(var i;t.length&&(i=r.last(t)).i<=n;)t.pop(),e.push(i.vs),n++;return n;}e.exports=function(e,t){var n,o=i.partition(e,function(e){return r.has(e,"barycenter");}),s=o.lhs,l=r.sortBy(o.rhs,function(e){return-e.i;}),u=[],c=0,d=0,f=0;s.sort((n=!!t,function(e,t){return e.barycenter<t.barycenter?-1:e.barycenter>t.barycenter?1:n?t.i-e.i:e.i-t.i;})),f=a(u,l,f),r.forEach(s,function(e){f+=e.vs.length,u.push(e.vs),c+=e.barycenter*e.weight,d+=e.weight,f=a(u,l,f);});var h={vs:r.flatten(u,!0)};return d&&(h.barycenter=c/d,h.weight=d),h;};},"689596c4":function(e,t,n){e.exports=function(e){return function(t){return e(t);};};},"68c0b55c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("dbd10968")),a=r._(n("9677a0f2"));!function(e,t){var n="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,r="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram);if(!n&&!r&&(t||(t=document),t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i);}var o=t.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o);}}(`.mapboxgl-ctrl-logo {
  display: none !important;
}
`);class o extends i.default{getServiceConstructor(){return a.default;}}},"6960d5ca":function(e,t,n){"use strict";var r=n("ce906886");function i(e){r.forEach(e.nodes(),function(t){a(e.node(t));}),r.forEach(e.edges(),function(t){a(e.edge(t));});}function a(e){var t=e.width;e.width=e.height,e.height=t;}function o(e){e.y=-e.y;}function s(e){var t=e.x;e.x=e.y,e.y=t;}e.exports={adjust:function(e){var t=e.graph().rankdir.toLowerCase();("lr"===t||"rl"===t)&&i(e);},undo:function(e){var t=e.graph().rankdir.toLowerCase();("bt"===t||"rl"===t)&&(r.forEach(e.nodes(),function(t){o(e.node(t));}),r.forEach(e.edges(),function(t){var n=e.edge(t);r.forEach(n.points,o),r.has(n,"y")&&o(n);})),("lr"===t||"rl"===t)&&(r.forEach(e.nodes(),function(t){s(e.node(t));}),r.forEach(e.edges(),function(t){var n=e.edge(t);r.forEach(n.points,s),r.has(n,"x")&&s(n);}),i(e));}};},"6986dfc1":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("99ff515c")),i=function(e,t){return!!(0,r.default)(e)&&e.indexOf(t)>-1;};},"69a50a3d":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{DefaultUniformStyleType:function(){return i;},DefaultUniformStyleValue:function(){return r;}});let r={opacity:1,stroke:[1,0,0,1],offsets:[0,0],rotation:0,extrusionBase:0,strokeOpacity:1,thetaOffset:.314},i={opacity:"float",stroke:"vec4",offsets:"vec2",textOffset:"vec2",rotation:"float",extrusionBase:"float",strokeOpacity:"float",thetaOffset:"float"};},"69f7008f":function(e,t,n){var r=n("68726a22"),i=n("2e6bd01b"),a=n("c0051812"),o=n("85163435"),s=n("05d6656f"),l=n("c31b66bd"),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=a(e),c=!n&&i(e),d=!n&&!c&&o(e),f=!n&&!c&&!d&&l(e),h=n||c||d||f,p=h?r(e.length,String):[],v=p.length;for(var g in e)(t||u.call(e,g))&&!(h&&("length"==g||d&&("offset"==g||"parent"==g)||f&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,v)))&&p.push(g);return p;};},"6ab6b06e":function(e,t,n){var r=n("80d2cf98"),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,a,o,s){var l=1&n,u=r(e),c=u.length;if(c!=r(t).length&&!l)return!1;for(var d=c;d--;){var f=u[d];if(!(l?f in t:i.call(t,f)))return!1;}var h=s.get(e),p=s.get(t);if(h&&p)return h==t&&p==e;var v=!0;s.set(e,t),s.set(t,e);for(var g=l;++d<c;){var m=e[f=u[d]],y=t[f];if(a)var b=l?a(y,m,f,t,e,s):a(m,y,f,e,t,s);if(!(void 0===b?m===y||o(m,y,n,a,s):b)){v=!1;break;}g||(g="constructor"==f);}if(v&&!g){var _=e.constructor,x=t.constructor;_!=x&&"constructor"in e&&"constructor"in t&&!("function"==typeof _&&_ instanceof _&&"function"==typeof x&&x instanceof x)&&(v=!1);}return s.delete(e),s.delete(t),v;};},"6ae941e3":function(e,t,n){e.exports=n("325a7ff6");},"6b042c5e":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e,t,n){var r,i,a,o,s=0;n||(n={});var l=function(){s=!1===n.leading?0:Date.now(),r=null,o=e.apply(i,a),r||(i=a=null);},u=function(){var u=Date.now();s||!1!==n.leading||(s=u);var c=t-(u-s);return i=this,a=arguments,c<=0||c>t?(r&&(clearTimeout(r),r=null),s=u,o=e.apply(i,a),r||(i=a=null)):r||!1===n.trailing||(r=setTimeout(l,c)),o;};return u.cancel=function(){clearTimeout(r),s=0,r=i=a=null;},u;};},"6b3683f9":function(e,t,n){var r=n("478fb4e7");e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n;};},"6b4089d5":function(e,t,n){e.exports=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1;};},"6b41e0ef":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return f;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=n("d9b661b3"),s=n("fb1ec05a"),l=r._(n("755bc4f8")),u=n("f717bab4"),c=n("a0845b89");let d={0:"#3288bd",.1:"#66c2a5",.2:"#abdda4",.3:"#e6f598",.4:"#fee08b",.5:"#fdae61",.6:"#f46d43",1:"#d53e4f"};class f extends l.default{constructor(...e){super(...e),(0,a.default)(this,"texture",void 0),(0,a.default)(this,"colorModel",void 0),(0,a.default)(this,"wind",void 0),(0,a.default)(this,"imageCoords",void 0),(0,a.default)(this,"sizeScale",.5),(0,a.default)(this,"frequency",new s.FrequencyController(7.2)),(0,a.default)(this,"cacheZoom",void 0);}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9});}render(e){this.drawColorMode(e),this.frequency.run(()=>{this.drawWind();});}getUninforms(){throw Error("Method not implemented.");}initModels(){var e=this;return(0,i.default)(function*(){var t,n;let{uMin:r=-21.32,uMax:i=26.8,vMin:a=-21.57,vMax:s=21.42,fadeOpacity:l=.996,speedFactor:f=.25,dropRate:h=.003,dropRateBump:p=.01,rampColors:v=d,sizeScale:g=.5}=e.layer.getLayerConfig(),{createTexture2D:m}=e.rendererService,y=e.layer.getSource();e.texture=m({height:0,width:0}),e.cacheZoom=Math.floor(e.mapService.getZoom());let b=e.rendererService.getGLContext();e.imageCoords=null===(t=y.data)||void 0===t?void 0:t.dataArray[0].coordinates,null===(n=y.data)||void 0===n||null===(n=n.images)||void 0===n||n.then(t=>{var n;e.sizeScale=g*e.getZoomScale();let{imageWidth:o,imageHeight:u}=e.getWindSize();e.wind=new c.Wind({glContext:b,imageWidth:o,imageHeight:u,fadeOpacity:l,speedFactor:f,dropRate:h,dropRateBump:p,rampColors:v}),e.wind.setWind({uMin:r,uMax:i,vMin:a,vMax:s,image:t[0]}),null===(n=e.texture)||void 0===n||n.destroy(),e.texture=m({width:o,height:u}),e.layerService.reRender();});let _=yield e.layer.buildLayerModel({moduleName:"wind",vertexShader:'precision highp float;\nuniform mat4 u_ModelMatrix;\n\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\nvarying vec2 v_texCoord;\n#pragma include "projection"\nvoid main() {\n  v_texCoord = a_Uv;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));\n}\n',fragmentShader:"precision mediump float;\nuniform float u_opacity: 1.0;\nuniform sampler2D u_texture;\nvarying vec2 v_texCoord;\nvoid main() {\n  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));\n  gl_FragColor = color;\n  gl_FragColor.a *= u_opacity;\n}\n",defines:e.getDefines(),triangulation:u.RasterImageTriangulation,primitive:o.gl.TRIANGLES,depth:{enable:!1}});return e.colorModel=_,[_];})();}getWindSize(){let e=this.mapService.lngLatToPixel(this.imageCoords[0]),t=this.mapService.lngLatToPixel(this.imageCoords[1]);return{imageWidth:Math.min(Math.floor((t.x-e.x)*this.sizeScale),2048),imageHeight:Math.min(Math.floor((e.y-t.y)*this.sizeScale),2048)};}buildModels(){var e=this;return(0,i.default)(function*(){return e.initModels();})();}clearModels(){var e,t;null===(e=this.texture)||void 0===e||e.destroy(),null===(t=this.wind)||void 0===t||t.destroy();}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:o.AttributeType.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:2,update:(e,t,n)=>[n[3],n[4]]}});}getZoomScale(){return Math.min((this.cacheZoom+4)/30*2,2);}drawWind(){if(this.wind){let{uMin:e=-21.32,uMax:t=26.8,vMin:n=-21.57,vMax:r=21.42,numParticles:i=65535,fadeOpacity:a=.996,speedFactor:o=.25,dropRate:s=.003,dropRateBump:l=.01,rampColors:u=d,sizeScale:c=.5}=this.layer.getLayerConfig(),f=i,h=Math.floor(this.mapService.getZoom());if("number"==typeof c&&c!==this.sizeScale||h!==this.cacheZoom){let e=this.getZoomScale();this.sizeScale=c,f*=e;let{imageWidth:t,imageHeight:n}=this.getWindSize();this.wind.reSize(t,n),this.cacheZoom=h;}this.wind.updateWindDir(e,t,n,r),this.wind.updateParticelNum(f),this.wind.updateColorRampTexture(u),this.wind.fadeOpacity=a,this.wind.speedFactor=o,this.wind.dropRate=s,this.wind.dropRateBump=l;let{d:p,w:v,h:g}=this.wind.draw();this.rendererService.setBaseState(),this.texture.update({data:p,width:v,height:g});}}drawColorMode(e={}){var t;let{opacity:n}=this.layer.getLayerConfig();this.layerService.beforeRenderData(this.layer),this.layer.hooks.beforeRender.call(),this.layerService.renderMask(this.layer.masks),null===(t=this.colorModel)||void 0===t||t.draw({uniforms:{u_opacity:n||1,u_texture:this.texture},blend:this.getBlend(),stencil:this.getStencil(e)}),this.layer.hooks.afterRender.call();}}},"6bbcbda8":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"path2Curve",{enumerable:!0,get:function(){return u;}});var r=n("b594a703"),i=n("fad5290a"),a=n("80a551a4"),o=n("5e61b478"),s=n("39fbb7f2"),l=n("9f6ac7d7");function u(e,t){if(void 0===t&&(t=!1),(0,s.isCurveArray)(e)){var n,u,c=[].concat(e);return t?[c,[]]:c;}for(var d=(0,o.normalizePath)(e),f=(0,r.__assign)({},i.paramsParser),h=[],p="",v=d.length,g=[],m=0;m<v;m+=1){d[m]&&(p=d[m][0]),h[m]=p;var y=(0,l.segmentToCubic)(d[m],f);d[m]=y,(0,a.fixArc)(d,h,m),v=d.length,"Z"===p&&g.push(m),u=(n=d[m]).length,f.x1=+n[u-2],f.y1=+n[u-1],f.x2=+n[u-4]||f.x1,f.y2=+n[u-3]||f.y1;}return t?[d,g]:d;}},"6bec070f":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("d812e418")),o=n("d9b661b3");class s{constructor(){(0,a.default)(this,"cameraService",void 0),(0,a.default)(this,"coordinateSystemService",void 0),(0,a.default)(this,"rendererService",void 0),(0,a.default)(this,"mapService",void 0),(0,a.default)(this,"layerService",void 0);}apply(e,{rendererService:t,mapService:n,layerService:r,coordinateSystemService:a,cameraService:o}){let s;this.rendererService=t,this.mapService=n,this.layerService=r,this.coordinateSystemService=a,this.cameraService=o,this.rendererService.uniformBuffers[0]||(s=this.rendererService.createBuffer({data:new Float32Array(96),isUBO:!0,label:"renderUniformBuffer"}),this.rendererService.uniformBuffers[0]=s),e.hooks.beforeRender.tap("ShaderUniformPlugin",()=>{let t=e.getRelativeOrigin&&e.getRelativeOrigin()||[0,0];this.coordinateSystemService.refresh(),t&&(Math.abs(t[0])>1e-4||Math.abs(t[1])>1e-4)&&2===this.coordinateSystemService.getCoordinateSystem()&&this.coordinateSystemService.setViewportCenter(t);let{width:n,height:r}=this.rendererService.getViewportSize(),{data:a,uniforms:o}=this.generateUBO(n,r,t);this.layerService.alreadyInRendering&&this.rendererService.uniformBuffers[0]&&this.rendererService.uniformBuffers[0].subData({offset:0,data:a}),"WebGL1"===this.rendererService.queryVerdorInfo()&&e.models.forEach(t=>{t.addUniforms((0,i.default)((0,i.default)({},o),{},{u_PickingBuffer:e.getLayerConfig().pickingBuffer||0,u_shaderPick:Number(e.getShaderPickStat())}));});});}generateUBO(e,t,n){let r=this.cameraService.getProjectionMatrix(),i=this.cameraService.getViewMatrix(),a=this.cameraService.getViewProjectionMatrix(),s=this.cameraService.getModelMatrix(),l=this.coordinateSystemService.getViewportCenterProjection(),u=this.coordinateSystemService.getPixelsPerDegree(),c=this.cameraService.getZoom(),d=this.coordinateSystemService.getPixelsPerDegree2(),f=this.cameraService.getZoomScale(),h=this.coordinateSystemService.getPixelsPerMeter(),p=this.coordinateSystemService.getCoordinateSystem(),v=this.cameraService.getCameraPosition(),g=window.devicePixelRatio,m=this.coordinateSystemService.getViewportCenter(),y=[e,t],b=this.cameraService.getFocalDistance(),_=n&&n.length>=2?[n[0],n[1]]:[0,0];return{data:[...i,...r,...a,...s,...l,...u,c,...d,f,...h,p,...v,g,...m,...y,b,..._,0],uniforms:{[o.CameraUniform.ProjectionMatrix]:r,[o.CameraUniform.ViewMatrix]:i,[o.CameraUniform.ViewProjectionMatrix]:a,[o.CameraUniform.Zoom]:c,[o.CameraUniform.ZoomScale]:f,[o.CameraUniform.FocalDistance]:b,[o.CameraUniform.CameraPosition]:v,[o.CoordinateUniform.CoordinateSystem]:p,[o.CoordinateUniform.ViewportCenter]:m,[o.CoordinateUniform.ViewportCenterProjection]:l,[o.CoordinateUniform.PixelsPerDegree]:u,[o.CoordinateUniform.PixelsPerDegree2]:d,[o.CoordinateUniform.PixelsPerMeter]:h,u_ViewportSize:y,u_ModelMatrix:s,u_DevicePixelRatio:g,u_RelativeOrigin:_}};}}},"6c08fa2c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("494da66d")),i=function(e){return(0,r.default)(this.__data__,e)>-1;};},"6c166e16":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("a684d625")),a=r._(n("d781f976")),o=r._(n("323ab2ac")),s=function(e){return(0,i.default)(e,o.default,a.default);};},"6c357209":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{EARTH_RADIUS:function(){return i;},EARTH_RADIUS_OUTER:function(){return o;},EARTH_SEGMENTS:function(){return a;},lglt2xyz:function(){return l;},primitiveSphere:function(){return u;}});var r=n("71293cfd");let i=100,a=36,o=40;function s(e){return e/180*Math.acos(-1);}function l(e){let t=s(e[0])+Math.PI/2,n=s(e[1]),r=i+.4*Math.random(),a=r*Math.cos(n)*Math.cos(t);return[r*Math.cos(n)*Math.sin(t),r*Math.sin(n),a];}function u(e,t){let n=r.mat4.create(),i=r.mat4.create(),a=r.vec3.fromValues(0,1,0),o=r.vec3.fromValues(0,0,0);e=void 0!==e?e:1;let s=2+(void 0!==(t=t||{}).segments?t.segments:32),l=2*s,u=[],c=[],d=[],f=[],h=[],p=[];for(let t=0;t<=s;t++){let v=t/s,g=v*Math.PI;for(let t=0;t<=l;t++){let s=t/l,u=s*Math.PI*2;r.mat4.identity(i),r.mat4.rotateZ(i,i,-g),r.mat4.identity(n),r.mat4.rotateY(n,n,u),r.vec3.transformMat4(o,a,i),r.vec3.transformMat4(o,o,n),r.vec3.scale(o,o,-e),d.push(o.slice()),f.push(...o.slice()),r.vec3.normalize(o,o),h.push(...o.slice()),p.push([s,1-v]),f.push(s,1-v);}if(t>0){let e=d.length,t=e-2*(l+1);for(;t+l+2<e;t++)u.push([t,t+1,t+l+1]),c.push(t,t+1,t+l+1),u.push([t+l+1,t+1,t+l+2]),c.push(t+l+1,t+1,t+l+2);}}return{cells:u,positions:d,uvs:p,positionsArr:f,indicesArr:c,normalArr:h};}},"6c35bac1":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("afa4dabd")),a=r._(n("b6081162")),o=function(e){if(!(0,i.default)(e)||!(0,a.default)(e,"Object"))return!1;if(null===Object.getPrototypeOf(e))return!0;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t;};},"6c5ed4b1":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"Plugin",{enumerable:!0,get:function(){return S;}});var r,i,a=n("777fffbe"),o=a._(n("1316cf9d")),s=a._(n("3d495adb")),l=a._(n("66a06515")),u=a._(n("20defe2a")),c=n("597eee67"),d=a._(n("83128d43")),f=a._(n("daaa1548")),h=a._(n("82f98358")),p=a._(n("f89fb776")),v=n("0d884ee9"),g=n("71293cfd"),m=(0,s.default)(function e(){(0,o.default)(this,e),this.cacheStore=new Map;},[{key:"onRefAdded",value:function(e){}},{key:"has",value:function(e){return this.cacheStore.has(e);}},{key:"put",value:function(e,t,n){return!this.cacheStore.has(e)&&(this.cacheStore.set(e,{value:t,counter:new Set([n.entity])}),this.onRefAdded(n),!0);}},{key:"get",value:function(e,t){var n=this.cacheStore.get(e);return n?(n.counter.has(t.entity)||(n.counter.add(t.entity),this.onRefAdded(t)),n.value):null;}},{key:"update",value:function(e,t,n){var r=this.cacheStore.get(e);return!!r&&(r.value=(0,f.default)((0,f.default)({},r.value),t),r.counter.has(n.entity)||(r.counter.add(n.entity),this.onRefAdded(n)),!0);}},{key:"release",value:function(e,t){var n=this.cacheStore.get(e);return!!n&&(n.counter.delete(t.entity),n.counter.size<=0&&this.cacheStore.delete(e),!0);}},{key:"releaseRef",value:function(e){var t=this;Array.from(this.cacheStore.keys()).forEach(function(n){t.release(n,e);});}},{key:"getSize",value:function(){return this.cacheStore.size;}},{key:"clear",value:function(){this.cacheStore.clear();}}]),y=[],b=[],_=function(){function e(){(0,o.default)(this,e);}return(0,s.default)(e,null,[{key:"stop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.api;e.rafId&&(t.cancelAnimationFrame(e.rafId),e.rafId=null);}},{key:"executeTask",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.api;y.length<=0&&b.length<=0||(b.forEach(function(e){return e();}),b=y.splice(0,e.TASK_NUM_PER_FRAME),e.rafId=t.requestAnimationFrame(function(){e.executeTask(t);}));}},{key:"sliceImage",value:function(t,n,r,i){for(var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e.api,s=t.naturalWidth||t.width,l=t.naturalHeight||t.height,u=n-a,c=r-a,d=Math.ceil(s/u),f=Math.ceil(l/c),h={tileSize:[n,r],gridSize:[f,d],tiles:Array(f).fill(null).map(function(){return Array(d).fill(null);})},p=function(e){for(var a=function(a){y.push(function(){var d=a*u,f=e*c,p=[Math.min(n,s-d),Math.min(r,l-f)],v=p[0],g=p[1],m=o.createCanvas();m.width=n,m.height=r,m.getContext("2d").drawImage(t,d,f,v,g,0,0,v,g),h.tiles[e][a]={x:d,y:f,tileX:a,tileY:e,data:m},i();});},f=0;f<d;f++)a(f);},v=0;v<f;v++)p(v);return e.stop(),e.executeTask(),h;}}]);}();_.TASK_NUM_PER_FRAME=10;var x=new m;x.onRefAdded=function(e){var t=this;e.addEventListener(c.ElementEvent.DESTROY,function(){t.releaseRef(e);},{once:!0});};var w=(0,s.default)(function e(t,n){(0,o.default)(this,e),this.gradientCache={},this.patternCache={},this.context=t,this.runtime=n;},[{key:"getImageSync",value:function(e,t,n){var r=(0,v.isString)(e)?e:e.src;if(x.has(r)){var i=x.get(r,t);if(i.img.complete)return null==n||n(i),i;}return this.getOrCreateImage(e,t).then(function(e){null==n||n(e);}).catch(function(e){console.error(e);}),null;}},{key:"getOrCreateImage",value:function(e,t){var n=this,r=(0,v.isString)(e)?e:e.src;if(!(0,v.isString)(e)&&!x.has(r)){var i={img:e,size:[e.naturalWidth||e.width,e.naturalHeight||e.height],tileSize:E(e)};x.put(r,i,t);}if(x.has(r)){var a=x.get(r,t);return a.img.complete?Promise.resolve(a):new Promise(function(e,t){a.img.addEventListener("load",function(){a.size=[a.img.naturalWidth||a.img.width,a.img.naturalHeight||a.img.height],a.tileSize=E(a.img),e(a);}),a.img.addEventListener("error",function(e){t(e);});});}return new Promise(function(e,i){var a=n.context.config.createImage();if(a){var o={img:a,size:[0,0],tileSize:E(a)};x.put(r,o,t),a.onload=function(){o.size=[a.naturalWidth||a.width,a.naturalHeight||a.height],o.tileSize=E(o.img),e(o);},a.onerror=function(e){i(e);},a.crossOrigin="Anonymous",a.src=r;}});}},{key:"createDownSampledImage",value:(r=(0,p.default)((0,d.default)().mark(function e(t,n){var r,i,a,o,s,l,u,c,p,v,g,m,y,b;return(0,d.default)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,this.getOrCreateImage(t,n);case 1:if(!(void 0!==(r=e.sent).downSamplingRate)){e.next=2;break;}return e.abrupt("return",r);case 2:if(s=void 0===(o=(a="boolean"==typeof(i=this.context.config.enableLargeImageOptimization)?{}:i).maxDownSampledImageSize)?2048:o,u=void 0===(l=a.downSamplingRateThreshold)?.5:l,c=this.runtime.globalThis.createImageBitmap,v=(p=(0,h.default)(r.size,2))[0],g=p[1],m=r.img,y=Math.min((s+s)/(v+g),Math.max(.01,Math.min(u,.5))),b=(0,f.default)((0,f.default)({},r),{},{downSamplingRate:y}),x.update(r.img.src,b,n),!c){e.next=7;break;}return e.prev=3,e.next=4,c(r.img,{resizeWidth:v*y,resizeHeight:g*y});case 4:m=e.sent,e.next=6;break;case 5:e.prev=5,e.catch(3),y=1;case 6:e.next=8;break;case 7:y=1;case 8:return b=(0,f.default)((0,f.default)({},this.getImageSync(t,n)),{},{downSampled:m,downSamplingRate:y}),x.update(r.img.src,b,n),e.abrupt("return",b);case 9:case"end":return e.stop();}},e,this,[[3,5]]);})),function(e,t){return r.apply(this,arguments);})},{key:"createImageTiles",value:(i=(0,p.default)((0,d.default)().mark(function e(t,n,r,i){var a,o,s,l,u;return(0,d.default)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,this.getOrCreateImage(t,i);case 1:return a=e.sent,s=(o=i.ownerDocument.defaultView).requestAnimationFrame,l=o.cancelAnimationFrame,_.api={requestAnimationFrame:s,cancelAnimationFrame:l,createCanvas:function(){return c.OffscreenCanvasCreator.createCanvas();}},u=(0,f.default)((0,f.default)({},a),_.sliceImage(a.img,a.tileSize[0],a.tileSize[0],r)),x.update(a.img.src,u,i),e.abrupt("return",u);case 2:case"end":return e.stop();}},e,this);})),function(e,t,n,r){return i.apply(this,arguments);})},{key:"releaseImage",value:function(e,t){x.release((0,v.isString)(e)?e:e.src,t);}},{key:"releaseImageRef",value:function(e){x.releaseRef(e);}},{key:"getOrCreatePatternSync",value:function(e,t,n,r,i,a,o){var s,l,u=this.generatePatternKey(t);if(u&&this.patternCache[u])return this.patternCache[u];var d=t.image,f=t.repetition,h=t.transform,p=!1;if((0,v.isString)(d)){var m=this.getImageSync(d,e,o);s=null==m?void 0:m.img;}else r?(s=r,p=!0):s=d;var y=s&&n.createPattern(s,f);return y&&(l=h?(0,c.parsedTransformToMat4)((0,c.parseTransform)(h),new c.DisplayObject({})):g.mat4.identity(g.mat4.create()),p&&g.mat4.scale(l,l,[1/i,1/i,1]),y.setTransform({a:l[0],b:l[1],c:l[4],d:l[5],e:l[12]+a[0],f:l[13]+a[1]})),u&&y&&(this.patternCache[u]=y),y;}},{key:"getOrCreateGradient",value:function(e,t){var n=this.generateGradientKey(e),r=e.type,i=e.steps,a=e.min,o=e.width,s=e.height,l=e.angle,u=e.cx,d=e.cy,f=e.size;if(this.gradientCache[n])return this.gradientCache[n];var h=null;if(r===c.GradientType.LinearGradient){var p=(0,c.computeLinearGradient)(a,o,s,l),v=p.x1,g=p.y1,m=p.x2,y=p.y2;h=t.createLinearGradient(v,g,m,y);}else if(r===c.GradientType.RadialGradient){var b=(0,c.computeRadialGradient)(a,o,s,u,d,f),_=b.x,x=b.y,w=b.r;h=t.createRadialGradient(_,x,0,_,x,w);}return h&&(i.forEach(function(e){var t,n=e.offset,r=e.color;n.unit===c.UnitType.kPercentage&&(null===(t=h)||void 0===t||t.addColorStop(n.value/100,r.toString()));}),this.gradientCache[n]=h),this.gradientCache[n];}},{key:"generateGradientKey",value:function(e){var t=e.type,n=e.min,r=e.width,i=e.height,a=e.steps,o=e.angle,s=e.cx,l=e.cy,u=e.size;return"gradient-".concat(t,"-").concat((null==o?void 0:o.toString())||0,"-").concat((null==s?void 0:s.toString())||0,"-").concat((null==l?void 0:l.toString())||0,"-").concat((null==u?void 0:u.toString())||0,"-").concat(n[0],"-").concat(n[1],"-").concat(r,"-").concat(i,"-").concat(a.map(function(e){var t=e.offset,n=e.color;return"".concat(t).concat(n);}).join("-"));}},{key:"generatePatternKey",value:function(e){var t=e.image,n=e.repetition;return(0,v.isString)(t)?"pattern-".concat(t,"-").concat(n):"rect"===t.nodeName?"pattern-".concat(t.entity,"-").concat(n):void 0;}}]);function E(e){if(!e.complete)return[0,0];var t=e.naturalWidth||e.width,n=e.naturalHeight||e.height,r=256;return[256,512].forEach(function(e){Math.ceil(n/e)*Math.ceil(t/e)<1e3&&(r=e);}),[r,r];}w.isSupportTile=!!c.OffscreenCanvasCreator.createCanvas();var M=function(){function e(){(0,o.default)(this,e);}return(0,s.default)(e,[{key:"apply",value:function(t){var n=t.renderingService,r=t.renderingContext,i=t.imagePool,a=r.root.ownerDocument.defaultView,o=function(e,t,n){var r=e.parsedStyle,i=r.width,a=r.height;i&&!a?e.setAttribute("height",n/t*i):!i&&a&&e.setAttribute("width",t/n*a);},s=function(e){var t=e.target,r=t.nodeName,a=t.attributes;if(r===c.Shape.IMAGE){var s=a.src,l=a.keepAspectRatio;i.getImageSync(s,t,function(e){var r=e.img,i=r.width,a=r.height;l&&o(t,i,a),t.renderable.dirty=!0,n.dirtify();});}},l=function(e){var t=e.target,r=e.attrName,a=e.prevValue,s=e.newValue;t.nodeName===c.Shape.IMAGE&&"src"===r&&(a!==s&&i.releaseImage(a,t),(0,v.isString)(s)&&i.getOrCreateImage(s,t).then(function(e){var r=e.img,i=r.width,a=r.height;t.attributes.keepAspectRatio&&o(t,i,a),t.renderable.dirty=!0,n.dirtify();}).catch(function(){}));};n.hooks.init.tap(e.tag,function(){a.addEventListener(c.ElementEvent.MOUNTED,s),a.addEventListener(c.ElementEvent.ATTR_MODIFIED,l);}),n.hooks.destroy.tap(e.tag,function(){a.removeEventListener(c.ElementEvent.MOUNTED,s),a.removeEventListener(c.ElementEvent.ATTR_MODIFIED,l);});}}]);}();M.tag="LoadImage";var S=function(e){function t(){var e;(0,o.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,l.default)(this,t,[].concat(r))).name="image-loader",e;}return(0,u.default)(t,e),(0,s.default)(t,[{key:"init",value:function(e){this.context.imagePool=new w(this.context,e),this.addRenderingPlugin(new M);}},{key:"destroy",value:function(){this.removeAllRenderingPlugins();}}]);}(c.AbstractRendererPlugin);},"6c69325d":function(e,t,n){"use strict";var r,i;n.d(t,"__esModule",{value:!0}),n.e(t,{ShapeType2D:function(){return o;},ShapeType3D:function(){return a;},circle:function(){return l;},geometryShape:function(){return h;},hexagon:function(){return d;},pentagon:function(){return f;},polygonPath:function(){return s;},square:function(){return u;},triangle:function(){return c;}});let a=((r={}).CYLINDER="cylinder",r.SQUARECOLUMN="squareColumn",r.TRIANGLECOLUMN="triangleColumn",r.HEXAGONCOLUMN="hexagonColumn",r.PENTAGONCOLUMN="pentagonColumn",r),o=((i={}).CIRCLE="circle",i.SQUARE="square",i.TRIANGLE="triangle",i.HEXAGON="hexagon",i.PENTAGON="pentagon",i);function s(e,t=0){let n=2*Math.PI/e,r=[];for(let i=0;i<e;i++)r.push(n*i+t*Math.PI/12);return r.map(e=>[Math.sin(e+Math.PI/4),Math.cos(e+Math.PI/4),0]);}function l(){return s(30);}function u(){return s(4);}function c(){return s(3);}function d(){return s(6,1);}function f(){return s(5);}let h={[o.CIRCLE]:l,[o.HEXAGON]:d,[o.TRIANGLE]:c,[o.SQUARE]:u,[o.PENTAGON]:f,[a.CYLINDER]:l,[a.HEXAGONCOLUMN]:d,[a.TRIANGLECOLUMN]:c,[a.SQUARECOLUMN]:u,[a.PENTAGONCOLUMN]:f};},"6ca3854b":function(e,t,n){"use strict";function r(e){return null==e;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"6cd126a9":function(e,t,n){"use strict";function r(e){return"string"==typeof e;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"6ce1af71":function(e,t,n){var r=n("7c1db5f7"),i=n("e5791bbd"),a=n("81e8f94e"),o=Math.max,s=Math.min;e.exports=function(e,t,n){var l,u,c,d,f,h,p=0,v=!1,g=!1,m=!0;if("function"!=typeof e)throw TypeError("Expected a function");function y(t){var n=l,r=u;return l=u=void 0,p=t,d=e.apply(r,n);}function b(e){var n=e-h,r=e-p;return void 0===h||n>=t||n<0||g&&r>=c;}function _(){var e,n,r,a=i();if(b(a))return x(a);f=setTimeout(_,(e=a-h,n=a-p,r=t-e,g?s(r,c-n):r));}function x(e){return(f=void 0,m&&l)?y(e):(l=u=void 0,d);}function w(){var e,n=i(),r=b(n);if(l=arguments,u=this,h=n,r){if(void 0===f)return p=e=h,f=setTimeout(_,t),v?y(e):d;if(g)return clearTimeout(f),f=setTimeout(_,t),y(h);}return void 0===f&&(f=setTimeout(_,t)),d;}return t=a(t)||0,r(n)&&(v=!!n.leading,c=(g="maxWait"in n)?o(a(n.maxWait)||0,t):c,m="trailing"in n?!!n.trailing:m),w.cancel=function(){void 0!==f&&clearTimeout(f),p=0,l=h=u=f=void 0;},w.flush=function(){return void 0===f?d:x(i());},w;};},"6cfccf4b":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});let r=n("7b266b54");var i="object"==typeof r&&r&&r.Object===Object&&r;},"6dca7af8":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{SceneEventList:function(){return i;},SceneEventMap:function(){return r;}});var r={onLoaded:"loaded",onDestroy:"destroy",onResize:"resize",onMapMove:"mapmove",onMoveStart:"movestart",onMoveEnd:"moveend",onZoomChange:"zoomchange",onZoomStart:"zoomstart",onZoomEnd:"zoomend",onClick:"click",onDblclick:"dblclick",onContextMenu:"contextmenu",onMouseMove:"mousemove",onMouseWheel:"mousewheel",onMouseDown:"mousedown",onMouseOver:"mouseover",onMouseOut:"mouseout",onMouseUp:"mouseup",onDragStart:"dragstart",onDragging:"dragging",onDragEnd:"dragend"},i=Object.keys(r);},"6ddc54e8":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=n("d9b661b3"),s=n("fb1ec05a"),l=r._(n("755bc4f8")),u=n("f717bab4");class c extends l.default{constructor(...e){super(...e),(0,a.default)(this,"raiseCount",0),(0,a.default)(this,"raiseRepeat",0);}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,NORMAL:11});}getCommonUniformsInfo(){let{animateOption:e={enable:!1,speed:.01,repeat:!1},sourceColor:t,targetColor:n,pickLight:r=!1,heightfixed:i=!1,opacityLinear:a={enable:!1,dir:"up"},lightEnable:o=!0}=this.layer.getLayerConfig(),l=0,u=[0,0,0,0],c=[0,0,0,0];if(t&&n&&(u=(0,s.rgb2arr)(t),c=(0,s.rgb2arr)(n),l=1),this.raiseCount<1&&this.raiseRepeat>0&&e.enable){let{speed:t=.01}=e;this.raiseCount+=t,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1);}let d={u_pickLight:Number(r),u_heightfixed:Number(i),u_r:e.enable&&this.raiseRepeat>0?this.raiseCount:1,u_linearColor:l,u_sourceColor:u,u_targetColor:c,u_opacitylinear:Number(a.enable),u_opacitylinear_dir:"up"===a.dir?1:0,u_lightEnable:Number(o)};return this.getUniformsBufferInfo(d);}initModels(){var e=this;return(0,i.default)(function*(){return e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){let{depth:t=!0,animateOption:{repeat:n=1}}=e.layer.getLayerConfig();return e.raiseRepeat=n,e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:'#define pi (3.1415926535)\n\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;\nlayout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec4 a_Extrude;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\n\nlayout(std140) uniform commonUniforms {\n  float u_pickLight;\n  float u_heightfixed;\n  float u_r;\n  float u_linearColor;\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_opacitylinear;\n  float u_opacitylinear_dir;\n  float u_lightEnable;\n};\nout vec4 v_color;\nout float v_lightWeight;\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nfloat getYRadian(float x, float z) {\n  if (x > 0.0 && z > 0.0) {\n    return atan(x / z);\n  } else if (x > 0.0 && z <= 0.0) {\n    return atan(-z / x) + pi / 2.0;\n  } else if (x <= 0.0 && z <= 0.0) {\n    return pi + atan(x / z); //atan(x/z) +\n  } else {\n    return atan(z / -x) + pi * 3.0 / 2.0;\n  }\n}\n\nfloat getXRadian(float y, float r) {\n  return atan(y / r);\n}\n\nvoid main() {\n  vec3 size = a_Size * a_Position;\n\n  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB\n\n  if (u_heightfixed < 1.0) {\n    // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6\n  } else {\n    // \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09\n    if (\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n    ) {\n      offset *= 4.0 / pow(2.0, 21.0 - u_Zoom);\n    }\n  }\n\n  vec2 positions = a_Extrude.xy;\n  vec2 positions64Low = a_Extrude.zw;\n  vec4 project_pos = project_position(vec4(positions, 0.0, 1.0), positions64Low);\n\n  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F\n  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);\n\n  // // \u5706\u67F1\u5149\u7167\u6548\u679C\n  float lightWeight = 1.0;\n\n  if (u_lightEnable > 0.0) {\n    // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027\n    lightWeight = calc_lighting(pos);\n  }\n\n  v_lightWeight = lightWeight;\n\n  v_color = a_Color;\n\n  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272\n  if (u_linearColor == 1.0) {\n    // \u4F7F\u7528\u6E10\u53D8\u989C\u8272\n    v_color = mix(u_sourceColor, u_targetColor, a_Position.z);\n    v_color.a = v_color.a * opacity;\n  } else {\n    v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);\n  }\n\n  if (u_opacitylinear > 0.0) {\n    v_color.a *= u_opacitylinear_dir > 0.0 ? 1.0 - a_Position.z : a_Position.z;\n  }\n\n  gl_Position = project_common_position_to_clipspace(pos);\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'\nin vec4 v_color;\nin float v_lightWeight;\nout vec4 outputColor;\n\nlayout(std140) uniform commonUniforms {\n  float u_pickLight;\n  float u_heightfixed;\n  float u_r;\n  float u_linearColor;\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_opacitylinear;\n  float u_opacitylinear_dir;\n  float u_lightEnable;\n};\n\n#pragma include "scene_uniforms"\n#pragma include "picking"\n\nvoid main() {\n\n  outputColor = v_color;\n  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8\n  // picking\n  if(u_pickLight > 0.0) {\n    outputColor = filterColorAlpha(outputColor, v_lightWeight);\n  } else {\n    outputColor = filterColor(outputColor);\n  }\n}\n',triangulation:u.PointExtrudeTriangulation,defines:e.getDefines(),inject:e.getInject(),cull:{enable:!0,face:o.gl.FRONT},depth:{enable:t}}))];})();}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:o.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:3,update:e=>{let{size:t}=e;if(!t)return[2,2,2];{let e=[];return Array.isArray(t)&&(e=2===t.length?[t[0],t[0],t[1]]:t),Array.isArray(t)||(e=[t,t,t]),e;}}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:o.AttributeType.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:o.gl.STATIC_DRAW,data:[],type:o.gl.FLOAT},size:3,update:(e,t,n,r,i)=>i}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:o.AttributeType.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:4,update:e=>{let t=(0,s.calculateCentroid)(e.coordinates);return[t[0],t[1],(0,s.fp64LowPart)(t[0]),(0,s.fp64LowPart)(t[1])];}}});}}},"6deff457":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"CoreLayer",{enumerable:!0,get:function(){return d;}});var r=n("777fffbe"),i=n("c9dce8f9"),a=r._(n("6e60059a")),o=n("c1f97feb"),s=n("a24d4a8c"),l=n("fd2cf6a2"),u=n("e8a85aaa"),c=n("16235f10");class d extends a.default{get inited(){return this.layer.inited;}get source(){return this.layer.getSource();}constructor(e){super(),this.isComposite=!1;let{id:t,name:n,source:r,interaction:i=!1}=e;this.id=t||(0,s.uniqueId)("core-layer"),this.name=n||this.id,this.interaction=i,this.options=(0,u.deepMergeLayerOptions)(this.getDefaultOptions(),e),this.lastOptions=this.options,this.layer=this.createLayer(),this.adaptorLayerAttr(!1),this.setSource(r),this.emit(c.CoreLayerEvent.CREATED,this);}getDefaultOptions(){return d.DefaultOptions;}getLayerConfig(){return(0,s.omit)(this.options,["source","shape","color","size","scale","texture","style","animate","state"]);}adaptorAttrOptions(e){return e;}adaptorLayerAttr(e=!0){let t=["shape","color","size","scale","texture","filter","style","animate","state"],n=this.adaptorAttrOptions(this.options),r=this.adaptorAttrOptions(this.lastOptions);for(let i=0;i<t.length;i++){let a=t[i],o=n[a],u=r[a];(0,s.isUndefined)(o)||e&&(0,s.isEqual)(o,u)||l.MappingAttribute[a](this.layer,o);}}setSource(e){if(e instanceof o.Source)this.layer.setSource(e);else{let{data:t}=e,n=(0,i.__rest)(e,["data"]);this.layer.getSource()?this.layer.setData(t,n):this.layer.source(t,n);}}getSource(){return this.source;}addTo(e){this.scene=e,this.layer.once(c.CoreLayerEvent.INITED,()=>{this.emit(c.CoreLayerEvent.INITED,this);}),this.layer.once(c.CoreLayerEvent.ADD,()=>{this.emit(c.CoreLayerEvent.ADD,this);}),e.addLayer(this.layer);}remove(){this.scene&&(this.scene.removeLayer(this.layer),this.emit(c.CoreLayerEvent.REMOVE));}update(e,t=!0){var n,r;this.updateOption(e),this.updateConfig(e),t&&(null===(n=this.scene)||void 0===n||n.setEnableRender(!1)),((0,s.isUndefined)(this.options.visible)||this.options.visible)&&this.adaptorLayerAttr(),e.source&&(0,u.isSourceChanged)(e.source,this.lastOptions.source)&&this.changeData(e.source),t&&(null===(r=this.scene)||void 0===r||r.setEnableRender(!0),this.render());}updateOption(e){this.lastOptions=this.options,this.options=(0,u.deepMergeLayerOptions)(this.options,e);}updateConfig(e){(0,s.isUndefined)(e.zIndex)||(0,s.isEqual)(this.lastOptions.zIndex,this.options.zIndex)||this.setIndex(e.zIndex),(0,s.isUndefined)(e.blend)||(0,s.isEqual)(this.lastOptions.blend,this.options.blend)||this.setBlend(e.blend),(0,s.isUndefined)(e.minZoom)||(0,s.isEqual)(this.lastOptions.minZoom,this.options.minZoom)||this.setMinZoom(e.minZoom),(0,s.isUndefined)(e.maxZoom)||(0,s.isEqual)(this.lastOptions.maxZoom,this.options.maxZoom)||this.setMaxZoom(e.maxZoom),(0,s.isUndefined)(e.visible)||(0,s.isEqual)(this.lastOptions.visible,this.options.visible)||(e.visible?this.show():this.hide());}render(){this.scene&&this.scene.render();}changeData(e){this.setSource(e);}setIndex(e){this.layer.setIndex(e);}setBlend(e){this.layer.setBlend(e);}setMinZoom(e){this.layer.setMinZoom(e);}setMaxZoom(e){this.layer.setMaxZoom(e);}show(){this.layer.inited&&this.layer.show();}hide(){this.layer.inited&&this.layer.hide();}toggleVisible(){this.isVisible()?this.hide():this.show();}isVisible(){return this.layer.inited?this.layer.isVisible():!!(0,s.isUndefined)(this.options.visible)||this.options.visible;}boxSelect(e,t){this.layer.boxSelect(e,t);}fitBounds(e){this.layer.fitBounds(e);}getLegend(e){return this.layer.getLegend(e);}getLegendItems(e){return this.layer.getLegendItems(e);}on(e,t,n){return -1!==c.OriginLayerEventList.indexOf(e)?this.layer.on(e,t):super.on(e,t,n),this;}once(e,t){return -1!==c.OriginLayerEventList.indexOf(e)?this.layer.once(e,t):super.once(e,t),this;}off(e,t){return -1!==c.OriginLayerEventList.indexOf(e)?this.layer.off(e,t):super.off(e,t),this;}destroy(){this.layer.destroy();}}d.DefaultOptions={};},"6e3a9823":function(e,t,n){var r=n("cc74f26d"),i=n("5180c603"),a=n("296f3d59"),o=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?i(e):a(e);};},"6e5d3338":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("d9b661b3"),i=n("02737fa5"),a=n("1d52ce54");class o{apply(e,{styleAttributeService:t}){e.hooks.init.tapPromise("RegisterStyleAttributePlugin",()=>{(0,a.isTileGroup)(e)||this.registerBuiltinAttributes(t,e);});}registerBuiltinAttributes(e,t){if("MaskLayer"===t.type){this.registerPositionAttribute(e);return;}this.registerPositionAttribute(e),this.registerColorAttribute(e);}registerPositionAttribute(e){e.registerStyleAttribute({name:"position",type:r.AttributeType.Attribute,descriptor:{name:"a_Position",shaderLocation:i.COMMON_ATTRIBUTE_LOCATION.POSITION,buffer:{data:[],type:r.gl.FLOAT},size:3,update:(e,t,n)=>2===n.length?[n[0],n[1],0]:[n[0],n[1],n[2]]}});}registerColorAttribute(e){e.registerStyleAttribute({name:"color",type:r.AttributeType.Attribute,descriptor:{name:"a_Color",shaderLocation:i.COMMON_ATTRIBUTE_LOCATION.COLOR,buffer:{usage:r.gl.DYNAMIC_DRAW,data:[],type:r.gl.FLOAT},size:4,update:e=>{let{color:t}=e;return t&&t.length?t:[1,1,1,1];}}});}}},"6ea58a25":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r={value:()=>{}};function i(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw Error("illegal type: "+e);r[e]=[];}return new a(r);}function a(e){this._=e;}function o(e,t,n){for(var i=0,a=e.length;i<a;++i)if(e[i].name===t){e[i]=r,e=e.slice(0,i).concat(e.slice(i+1));break;}return null!=n&&e.push({name:t,value:n}),e;}a.prototype=i.prototype={constructor:a,on:function(e,t){var n,r=this._,i=(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!r.hasOwnProperty(e))throw Error("unknown type: "+e);return{type:e,name:t};}),a=-1,s=i.length;if(arguments.length<2){for(;++a<s;)if((n=(e=i[a]).type)&&(n=function(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value;}(r[n],e.name)))return n;return;}if(null!=t&&"function"!=typeof t)throw Error("invalid callback: "+t);for(;++a<s;)if(n=(e=i[a]).type)r[n]=o(r[n],e.name,t);else if(null==t)for(n in r)r[n]=o(r[n],e.name,null);return this;},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new a(e);},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(e))throw Error("unknown type: "+e);for(r=this._[e],a=0,n=r.length;a<n;++a)r[a].value.apply(t,i);},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n);}};var s=i;},"6ea93842":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("dbd10968")),a=r._(n("d320934e"));class o extends i.default{getServiceConstructor(){return a.default;}}},"6ebbe753":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe"),i=r._(n("3173d47c")),a=r._(n("d29fda11")),o=r._(n("88a41c13")),s=r._(n("6c08fa2c")),l=r._(n("44a82fba"));function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1]);}}u.prototype.clear=i.default,u.prototype.delete=a.default,u.prototype.get=o.default,u.prototype.has=s.default,u.prototype.set=l.default;var c=u;},"6f10f19e":function(e,t,n){"use strict";var r,i;r=this,i=function(){function e(e){var t,o,s=[];return e.AMapUI&&s.push((t=e.AMapUI,new Promise(function(e,o){var s=[];if(t.plugins)for(var l=0;l<t.plugins.length;l+=1)-1==r.AMapUI.plugins.indexOf(t.plugins[l])&&s.push(t.plugins[l]);if(i.AMapUI===n.failed)o("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(i.AMapUI===n.notload){i.AMapUI=n.loading,r.AMapUI.version=t.version||r.AMapUI.version,l=r.AMapUI.version;var u=document.body||document.head,c=document.createElement("script");c.type="text/javascript",c.src="https://webapi.amap.com/ui/"+l+"/main.js",c.onerror=function(e){i.AMapUI=n.failed,o("\u8BF7\u6C42 AMapUI \u5931\u8D25");},c.onload=function(){if(i.AMapUI=n.loaded,s.length)window.AMapUI.loadUI(s,function(){for(var t=0,n=s.length;t<n;t++){var r=s[t].split("/").slice(-1)[0];window.AMapUI[r]=arguments[t];}for(e();a.AMapUI.length;)a.AMapUI.splice(0,1)[0]();});else for(e();a.AMapUI.length;)a.AMapUI.splice(0,1)[0]();},u.appendChild(c);}else i.AMapUI===n.loaded?t.version&&t.version!==r.AMapUI.version?o("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):s.length?window.AMapUI.loadUI(s,function(){for(var t=0,n=s.length;t<n;t++){var r=s[t].split("/").slice(-1)[0];window.AMapUI[r]=arguments[t];}e();}):e():t.version&&t.version!==r.AMapUI.version?o("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):a.AMapUI.push(function(t){t?o(t):s.length?window.AMapUI.loadUI(s,function(){for(var t=0,n=s.length;t<n;t++){var r=s[t].split("/").slice(-1)[0];window.AMapUI[r]=arguments[t];}e();}):e();});}))),e.Loca&&s.push((o=e.Loca,new Promise(function(e,t){if(i.Loca===n.failed)t("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(i.Loca===n.notload){i.Loca=n.loading,r.Loca.version=o.version||r.Loca.version;var s=r.Loca.version,l=r.AMap.version.startsWith("2"),u=s.startsWith("2");if(l&&!u||!l&&u)t("JSAPI \u4E0E Loca \u7248\u672C\u4E0D\u5BF9\u5E94\uFF01\uFF01");else{l=r.key,u=document.body||document.head;var c=document.createElement("script");c.type="text/javascript",c.src="https://webapi.amap.com/loca?v="+s+"&key="+l,c.onerror=function(e){i.Loca=n.failed,t("\u8BF7\u6C42 AMapUI \u5931\u8D25");},c.onload=function(){for(i.Loca=n.loaded,e();a.Loca.length;)a.Loca.splice(0,1)[0]();},u.appendChild(c);}}else i.Loca===n.loaded?o.version&&o.version!==r.Loca.version?t("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):e():o.version&&o.version!==r.Loca.version?t("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):a.Loca.push(function(e){e?t(e):t();});}))),Promise.all(s);}if(!window)throw Error("AMap JSAPI can only be used in Browser.");(t=n||(n={})).notload="notload",t.loading="loading",t.loaded="loaded",t.failed="failed";var t,n,r={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},i={AMap:n.notload,AMapUI:n.notload,Loca:n.notload},a={AMap:[],AMapUI:[],Loca:[]},o=[],s=function(e){"function"==typeof e&&(i.AMap===n.loaded?e(window.AMap):o.push(e));};return{load:function(t){return new Promise(function(a,l){if(i.AMap==n.failed)l("");else if(i.AMap==n.notload){var u=t.key,c=t.version,d=t.plugins;u?(window.AMap&&"lbs.amap.com"!==location.host&&l("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),r.key=u,r.AMap.version=c||r.AMap.version,r.AMap.plugins=d||r.AMap.plugins,i.AMap=n.loading,c=document.body||document.head,window.___onAPILoaded=function(r){if(delete window.___onAPILoaded,r)i.AMap=n.failed,l(r);else for(i.AMap=n.loaded,e(t).then(function(){a(window.AMap);}).catch(l);o.length;)o.splice(0,1)[0]();},(d=document.createElement("script")).type="text/javascript",d.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+r.AMap.version+"&key="+u+"&plugin="+r.AMap.plugins.join(","),d.onerror=function(e){i.AMap=n.failed,l(e);},c.appendChild(d)):l("\u8BF7\u586B\u5199key");}else if(i.AMap==n.loaded){if(t.key&&t.key!==r.key)l("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(t.version&&t.version!==r.AMap.version)l("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(u=[],t.plugins)for(c=0;c<t.plugins.length;c+=1)-1==r.AMap.plugins.indexOf(t.plugins[c])&&u.push(t.plugins[c]);u.length?window.AMap.plugin(u,function(){e(t).then(function(){a(window.AMap);}).catch(l);}):e(t).then(function(){a(window.AMap);}).catch(l);}}else if(t.key&&t.key!==r.key)l("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(t.version&&t.version!==r.AMap.version)l("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var f=[];if(t.plugins)for(c=0;c<t.plugins.length;c+=1)-1==r.AMap.plugins.indexOf(t.plugins[c])&&f.push(t.plugins[c]);s(function(){f.length?window.AMap.plugin(f,function(){e(t).then(function(){a(window.AMap);}).catch(l);}):e(t).then(function(){a(window.AMap);}).catch(l);});}});},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,r={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},i={AMap:n.notload,AMapUI:n.notload,Loca:n.notload},a={AMap:[],AMapUI:[],Loca:[]};}};},"object"==typeof t&&void 0!==e?e.exports=i():(r=r||self).AMapLoader=i();},"6f115330":function(e,t,n){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t;};},"6f26c977":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("0a498565")),a=r._(n("aa15234a")),o=Object.prototype.hasOwnProperty,s=function(e,t,n){var r=e[t];o.call(e,t)&&(0,a.default)(r,n)&&(void 0!==n||t in e)||(0,i.default)(e,t,n);};},"6fd2fa26":function(e,t,n){"use strict";var r=n("ce906886"),i=n("5bf20808").Graph,a=n("afa361e1").slack;e.exports=function(e){var t,n,o=new i({directed:!1}),s=e.nodes()[0],l=e.nodeCount();for(o.setNode(s,{});r.forEach(o.nodes(),function t(n){r.forEach(e.nodeEdges(n),function(r){var i=r.v,s=n===i?r.w:i;o.hasNode(s)||a(e,r)||(o.setNode(s,{}),o.setEdge(n,s,{}),t(s));});}),o.nodeCount()<l;)t=function(e,t){return r.minBy(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return a(t,n);});}(o,e),n=o.hasNode(t.v)?a(e,t):-a(e,t),function(e,t,n){r.forEach(e.nodes(),function(e){t.node(e).rank+=n;});}(o,e,n);return o;};},"701e250e":function(e,t,n){var r=n("32f27622"),i=n("481b6514"),a=n("16ec8ed6");e.exports=function(e){return function(t,n,o){var s=Object(t);if(!i(t)){var l=r(n,3);t=a(t),n=function(e){return l(s[e],e,s);};}var u=e(t,n,o);return u>-1?s[l?t[u]:u]:void 0;};};},"705631d2":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){return this.__data__.get(e);};},"70da4908":function(e,t,n){var r=n("d1473659"),i=n("16ec8ed6");e.exports=function(e){for(var t=i(e),n=t.length;n--;){var a=t[n],o=e[a];t[n]=[a,o,r(o)];}return t;};},"714a8a5a":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{MAX_DIST:function(){return l;},MAX_TAP_INTERVAL:function(){return s;},SingleTapRecognizer:function(){return u;},TapRecognizer:function(){return c;}});var r=n("777fffbe"),i=r._(n("d812e418")),a=r._(n("be334174")),o=n("c4fa2186");let s=500,l=30;class u{constructor(e){(0,i.default)(this,"numTouches",void 0),(0,i.default)(this,"centroid",void 0),(0,i.default)(this,"startTime",void 0),(0,i.default)(this,"aborted",void 0),(0,i.default)(this,"touches",void 0),this.reset(),this.numTouches=e.numTouches;}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1;}touchstart(e,t,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),n.length===this.numTouches&&(this.centroid=function(e){let t=new a.default(0,0);for(let n of e)t._add(n);return t.div(e.length);}(t),this.touches=(0,o.indexTouches)(n,t)));}touchmove(e,t,n){if(this.aborted||!this.centroid)return;let r=(0,o.indexTouches)(n,t);for(let e in this.touches){let t=this.touches[e],n=r[e];(!n||n.dist(t)>l)&&(this.aborted=!0);}}touchend(e,t,n){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){let e=!this.aborted&&this.centroid;if(this.reset(),e)return e;}}}class c{constructor(e){(0,i.default)(this,"singleTap",void 0),(0,i.default)(this,"numTaps",void 0),(0,i.default)(this,"lastTime",void 0),(0,i.default)(this,"lastTap",void 0),(0,i.default)(this,"count",void 0),this.singleTap=new u(e),this.numTaps=e.numTaps,this.reset();}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset();}touchstart(e,t,n){this.singleTap.touchstart(e,t,n);}touchmove(e,t,n){this.singleTap.touchmove(e,t,n);}touchend(e,t,n){let r=this.singleTap.touchend(e,t,n);if(r){let t=e.timeStamp-this.lastTime<s,n=!this.lastTap||this.lastTap.dist(r)<l;if(t&&n||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=r,this.count===this.numTaps)return this.reset(),r;}}}},"7172b896":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("f89fb776")),o=r._(n("fb04a60c")),s=r._(n("bec2d0e3"));class l extends s.default{initTileLayer(){var e=this;return(0,a.default)(function*(){let t=e.parent.getLayerAttributeConfig(),n=e.getLayerOptions(),r=e.getSourceOption(),a=new o.default((0,i.default)({},n)).source(r.data,r.options);t&&Object.keys(t).forEach(e=>{var n,r;a[e](null===(n=t[e])||void 0===n?void 0:n.field,null===(r=t[e])||void 0===r?void 0:r.values);}),yield e.addLayer(a),e.isLoaded=!0;})();}getSourceOption(){let e=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:e.transforms}};}}},"71a8d152":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=/\w*$/,i=function(e){var t=new e.constructor(e.source,r.exec(e));return t.lastIndex=e.lastIndex,t;};},"71ba123c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("b594a703"),i=n("a24d4a8c"),a=n("9999b369"),o=function(e,t,n){for(var r,i=1/0,a=0;a<t.length;a++){var o=t[a].id;!n[o]&&e[o]<=i&&(i=e[o],r=t[a]);}return r;},s=function(e,t,n,s){var l=e.nodes,u=void 0===l?[]:l,c=e.edges,d=void 0===c?[]:c,f=[],h={},p={},v={};u.forEach(function(e,n){var r=e.id;f.push(r),p[r]=1/0,r===t&&(p[r]=0);});for(var g=u.length,m=0;m<g;m++)!function(e){var t=o(p,u,h),r=t.id;h[r]=!0,p[r]!==1/0&&(n?(0,a.getOutEdgesNodeId)(r,d):(0,a.getEdgesByNodeId)(r,d)).forEach(function(e){var n=e.target,i=e.source,a=n===r?i:n,o=s&&e[s]?e[s]:1;p[a]>p[t.id]+o?(p[a]=p[t.id]+o,v[a]=[t.id]):p[a]===p[t.id]+o&&v[a].push(t.id);});}(0);v[t]=[t];var y={};for(var b in p)p[b]!==1/0&&function e(t,n,a,o){if(t===n)return[t];if(o[n])return o[n];for(var s=[],l=0,u=a[n];l<u.length;l++){var c=e(t,u[l],a,o);if(!c)return;for(var d=0;d<c.length;d++){var f=c[d];(0,i.isArray)(f)?s.push((0,r.__spreadArray)((0,r.__spreadArray)([],f,!0),[n],!1)):s.push([f,n]);}}return o[n]=s,o[n];}(t,b,v,y);var _={};for(var b in y)_[b]=y[b][0];return{length:p,path:_,allPath:y};};},"71f18948":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("a12bb5bb")),a=r._(n("a483b73f")),o=function(e,t){if(e){if((0,i.default)(e))for(var n=0,r=e.length;n<r&&!1!==t(e[n],n);n++);else if((0,a.default)(e)){for(var o in e)if(e.hasOwnProperty(o)&&!1===t(e[o],o))break;}}};},"7242d666":function(e,t,n){"use strict";var r=n("ce906886"),i=n("b192169f");e.exports={run:function(e){e.graph().dummyChains=[],r.forEach(e.edges(),function(t){(function(e,t){var n,r,a,o=t.v,s=e.node(o).rank,l=t.w,u=e.node(l).rank,c=t.name,d=e.edge(t),f=d.labelRank;if(u!==s+1){for(e.removeEdge(t),a=0,++s;s<u;++a,++s)d.points=[],r={width:0,height:0,edgeLabel:d,edgeObj:t,rank:s},n=i.addDummyNode(e,"edge",r,"_d"),s===f&&(r.width=d.width,r.height=d.height,r.dummy="edge-label",r.labelpos=d.labelpos),e.setEdge(o,n,{weight:d.weight},c),0===a&&e.graph().dummyChains.push(n),o=n;e.setEdge(o,l,{weight:d.weight},c);}})(e,t);});},undo:function(e){r.forEach(e.graph().dummyChains,function(t){var n,r=e.node(t),i=r.edgeLabel;for(e.setEdge(r.edgeObj,i);r.dummy;)n=e.successors(t)[0],e.removeNode(t),i.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),t=n,r=e.node(t);});}};},"72b9f8f3":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("daaa1548")),o=n("d9b661b3"),s=r._(n("755bc4f8")),l=n("f717bab4");class u extends s.default{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,POS:9});}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,a.default)((0,a.default)({},e.uniformsOption),t.uniformsOption);}getCommonUniformsInfo(){let{opacity:e,coverage:t,angle:n}=this.layer.getLayerConfig(),r={u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset],u_opacity:e||1,u_coverage:t||.9,u_angle:n||0};return this.getUniformsBufferInfo(r);}initModels(){var e=this;return(0,i.default)(function*(){return e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"heatmapGrid",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location =  ATTRIBUTE_LOCATION_POS) in vec3 a_Pos;\n\nlayout(std140) uniform commonUniforms {\n    vec2 u_radius;\n    float u_opacity;\n    float u_coverage;\n    float u_angle;\n};\n\nout vec4 v_color;\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nvoid main() {\n  v_color = a_Color;\n  v_color.a *= u_opacity;\n\n  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\n  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage;\n\n  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\n  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\n  gl_Position = project_common_position_to_clipspace(project_pos);\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'in vec4 v_color;\n\n#pragma include "scene_uniforms"\n#pragma include "picking"\nout vec4 outputColor;\nvoid main() {\n  outputColor = v_color;\n  outputColor = filterColor(outputColor);\n}\n',defines:e.getDefines(),triangulation:l.HeatmapGridTriangulation,primitive:o.gl.TRIANGLES,depth:{enable:!1}}))];})();}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:o.AttributeType.Attribute,descriptor:{shaderLocation:this.attributeLocation.POS,name:"a_Pos",buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:3,update:e=>{let t=e.coordinates;return[t[0],t[1],0];}}});}}},"72c06be7":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});class r{apply(e,{styleAttributeService:t}){e.hooks.init.tapPromise("UpdateStyleAttributePlugin",()=>{this.initStyleAttribute(e,{styleAttributeService:t});}),e.hooks.beforeRender.tap("UpdateStyleAttributePlugin",()=>{!e.layerModelNeedUpdate&&e.inited&&this.updateStyleAttribute(e,{styleAttributeService:t});});}updateStyleAttribute(e,{styleAttributeService:t}){let n=t.getLayerStyleAttributes()||[],r=t.getLayerStyleAttribute("filter");if(r&&r.needRegenerateVertices){e.layerModelNeedUpdate=!0,n.forEach(e=>e.needRegenerateVertices=!1);return;}n.filter(e=>e.needRegenerateVertices).forEach(n=>{t.updateAttributeByFeatureRange(n.name,e.getEncodedData(),n.featureRange.startIndex,n.featureRange.endIndex,e),n.needRegenerateVertices=!1;});}initStyleAttribute(e,{styleAttributeService:t}){(t.getLayerStyleAttributes()||[]).filter(e=>e.needRegenerateVertices).forEach(n=>{t.updateAttributeByFeatureRange(n.name,e.getEncodedData(),n.featureRange.startIndex,n.featureRange.endIndex),n.needRegenerateVertices=!1;});}}},"72f55a8e":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1;};},"731b2a36":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("6cfccf4b")),i="object"==typeof self&&self&&self.Object===Object&&self,a=r.default||i||Function("return this")();},"734d0cc9":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=0;function i(e){return"__private_"+r+++"_"+e;}},"7372f057":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("a9c461d6")),i=function(e){var t=(0,r.default)(this,e).delete(e);return this.size-=t?1:0,t;};},"73c8c35c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{generateMousePanHandler:function(){return s;},generateMousePitchHandler:function(){return u;},generateMouseRotationHandler:function(){return l;}});var r=n("e31a659c"),i=n("c91fd173"),a=n("3bd3be8f");let o=e=>{e.mousedown=e.dragStart,e.mousemoveWindow=e.dragMove,e.mouseup=e.dragEnd,e.contextmenu=e=>{e.preventDefault();};},s=({enable:e,clickTolerance:t})=>{let n=new a.MouseMoveStateManager({checkCorrectEvent:e=>0===r.DOM.mouseButton(e)&&!e.ctrlKey});return new i.DragHandler({clickTolerance:t,move:(e,t)=>({around:t,panDelta:t.sub(e)}),activateOnStart:!0,moveStateManager:n,enable:e,assignEvents:o});},l=({enable:e,clickTolerance:t,bearingDegreesPerPixelMoved:n=.8})=>{let s=new a.MouseMoveStateManager({checkCorrectEvent:e=>0===r.DOM.mouseButton(e)&&e.ctrlKey||2===r.DOM.mouseButton(e)});return new i.DragHandler({clickTolerance:t,move:(e,t)=>({bearingDelta:(t.x-e.x)*n}),moveStateManager:s,enable:e,assignEvents:o});},u=({enable:e,clickTolerance:t,pitchDegreesPerPixelMoved:n=-.5})=>{let s=new a.MouseMoveStateManager({checkCorrectEvent:e=>0===r.DOM.mouseButton(e)&&e.ctrlKey||2===r.DOM.mouseButton(e)});return new i.DragHandler({clickTolerance:t,move:(e,t)=>({pitchDelta:(t.y-e.y)*n}),moveStateManager:s,enable:e,assignEvents:o});};},"73ff5a90":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=(0,n("777fffbe")._(n("a8be75a3")).default)(Object,"create");},"755bc4f8":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return v;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("daaa1548")),o=r._(n("d812e418")),s=n("d9b661b3"),l=n("fb1ec05a"),u=n("20a478c1"),c=n("4fcbbee8"),d=n("02737fa5"),f=n("69a50a3d"),h=n("36c59252");let p="ATTRIBUTE_LOCATION_";class v{get attributeLocation(){return(0,a.default)({},d.COMMON_ATTRIBUTE_LOCATION);}constructor(e){(0,o.default)(this,"triangulation",void 0),(0,o.default)(this,"uniformBuffers",[]),(0,o.default)(this,"textures",[]),(0,o.default)(this,"createTexture2D",void 0),(0,o.default)(this,"preStyleAttribute",{}),(0,o.default)(this,"encodeStyleAttribute",{}),(0,o.default)(this,"layer",void 0),(0,o.default)(this,"dataTexture",void 0),(0,o.default)(this,"DATA_TEXTURE_WIDTH",void 0),(0,o.default)(this,"dataTextureTest",void 0),(0,o.default)(this,"configService",void 0),(0,o.default)(this,"shaderModuleService",void 0),(0,o.default)(this,"rendererService",void 0),(0,o.default)(this,"iconService",void 0),(0,o.default)(this,"fontService",void 0),(0,o.default)(this,"styleAttributeService",void 0),(0,o.default)(this,"mapService",void 0),(0,o.default)(this,"cameraService",void 0),(0,o.default)(this,"layerService",void 0),(0,o.default)(this,"pickingService",void 0),(0,o.default)(this,"attributeUnifoms",void 0),(0,o.default)(this,"commonUnifoms",void 0),this.layer=e,this.configService=e.getContainer().globalConfigService,this.rendererService=e.getContainer().rendererService,this.pickingService=e.getContainer().pickingService,this.shaderModuleService=e.getContainer().shaderModuleService,this.styleAttributeService=e.getContainer().styleAttributeService,this.mapService=e.getContainer().mapService,this.iconService=e.getContainer().iconService,this.fontService=e.getContainer().fontService,this.cameraService=e.getContainer().cameraService,this.layerService=e.getContainer().layerService,this.registerStyleAttribute(),this.registerBuiltinAttributes(),this.startModelAnimate();let{createTexture2D:t}=this.rendererService;this.createTexture2D=t;}getBlend(){let{blend:e="normal"}=this.layer.getLayerConfig();return u.BlendTypes[s.BlendType[e]];}getStencil(e){let{mask:t=!1,maskInside:n=!0,enableMask:r,maskOperation:i=s.MaskOperation.AND}=this.layer.getLayerConfig();if("MaskLayer"===this.layer.type)return(0,c.getStencilMask)({isStencil:!0,stencilType:s.StencilType.SINGLE});if(e.isStencil)return(0,c.getStencilMask)((0,a.default)((0,a.default)({},e),{},{maskOperation:i}));let o=t||r&&0!==this.layer.masks.length||void 0!==this.layer.tileMask;return(0,c.getStencil)(o,n);}getDefaultStyle(){return{};}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());this.updateStyleUnifoms();let n=(0,a.default)((0,a.default)({},t.uniformsOption),e.uniformsOption);return Object.keys(n).forEach(e=>{"boolean"==typeof n[e]&&(n[e]=n[e]?1:0);}),!this.rendererService.hasOwnProperty("device")&&this.textures&&1===this.textures.length&&(n.u_texture=this.textures[0]),n;}getAnimateUniforms(){return{};}needUpdate(){return(0,i.default)(function*(){return!1;})();}buildModels(){return(0,i.default)(function*(){throw Error("Method not implemented.");})();}initModels(){return(0,i.default)(function*(){throw Error("Method not implemented.");})();}clearModels(e=!0){}getAttribute(){throw Error("Method not implemented.");}prerender(){}render(e){throw Error("Method not implemented.");}registerBuiltinAttributes(){throw Error("Method not implemented.");}animateOption2Array(e){return[e.enable?0:1,e.duration||4,e.interval||.2,e.trailLength||.1];}startModelAnimate(){let{animateOption:e}=this.layer.getLayerConfig();e.enable&&this.layer.setAnimateStartTime();}getInject(){return function(e,t){let n=[],r="";e.forEach(e=>{let i=e.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase();t[e]?r+=`#define USE_ATTRIBUTE_${i} 0.0 
`:n.push(`  ${f.DefaultUniformStyleType[e]} u_${e};`),r+=`
#ifdef USE_ATTRIBUTE_${i}
layout(location = ${p+i}) in ${f.DefaultUniformStyleType[e]} a_${e.charAt(0).toUpperCase()+e.slice(1)};
#endif 
`;});let i=n.length?`
layout(std140) uniform AttributeUniforms {
  ${n.join("\n")}
};
`:"";r+=i;let a="";return e.forEach(e=>{let t=e.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase();a+=`
  #ifdef USE_ATTRIBUTE_${t}
    ${f.DefaultUniformStyleType[e]} ${e} = a_${e.charAt(0).toUpperCase()+e.slice(1)};
  #else
    ${f.DefaultUniformStyleType[e]} ${e} = u_${e};
  #endif
  `;}),{"vs:#decl":r,"fs:#decl":i,"vs:#main-start":a};}(this.layer.enableShaderEncodeStyles,this.layer.encodeStyleAttribute);}getDefines(){let e=Object.keys(this.attributeLocation).reduce((e,t)=>(e[p+t]=this.attributeLocation[t],e),{});return(0,a.default)({},e);}getStyleAttribute(){let e={};return this.layer.enableShaderEncodeStyles.forEach(t=>{if(!this.layer.encodeStyleAttribute[t]){let n=this.layer.getLayerConfig()[t],r=void 0===n?f.DefaultUniformStyleValue[t]:n;"stroke"===t&&(r=(0,l.rgb2arr)(r)),e["u_"+t]=r;}}),e;}registerStyleAttribute(){Object.keys(this.layer.encodeStyleAttribute).forEach(e=>{let t=(0,d.getCommonStyleAttributeOptions)(e);t&&this.styleAttributeService.registerStyleAttribute(t);});}registerPosition64LowAttribute(e=!0){this.styleAttributeService.registerStyleAttribute({name:"position64Low",type:s.AttributeType.Attribute,descriptor:{name:"a_Position64Low",shaderLocation:this.attributeLocation.POSITION_64LOW,buffer:{data:[],type:s.gl.FLOAT},size:2,update:(t,n,r)=>e?[(0,l.fp64LowPart)(r[0]),(0,l.fp64LowPart)(r[1])]:[0,0]}});}updateEncodeAttribute(e,t){this.encodeStyleAttribute[e]=t;}initUniformsBuffer(){let e=this.getUniformsBufferInfo(this.getStyleAttribute()),t=this.getCommonUniformsInfo();0!==e.uniformsLength&&(this.attributeUnifoms=this.rendererService.createBuffer({data:new Float32Array((0,h.MultipleOfFourNumber)(e.uniformsLength)).fill(0),isUBO:!0,label:"layerModelAttributeUnifoms"}),this.uniformBuffers.push(this.attributeUnifoms)),0!==t.uniformsLength&&(this.commonUnifoms=this.rendererService.createBuffer({data:new Float32Array((0,h.MultipleOfFourNumber)(t.uniformsLength)).fill(0),isUBO:!0,label:"layerModelCommonUnifoms"}),this.uniformBuffers.push(this.commonUnifoms));}getUniformsBufferInfo(e){let t=0,n=[];return Object.values(e).forEach(e=>{Array.isArray(e)?(n.push(...e),t+=e.length):"number"==typeof e?(n.push(e),t+=1):"boolean"==typeof e&&(n.push(Number(e)),t+=1);}),{uniformsOption:e,uniformsLength:t,uniformsArray:n};}getCommonUniformsInfo(){return{uniformsLength:0,uniformsArray:[],uniformsOption:{}};}updateStyleUnifoms(){var e,t;let{uniformsArray:n}=this.getUniformsBufferInfo(this.getStyleAttribute()),{uniformsArray:r}=this.getCommonUniformsInfo();null===(e=this.attributeUnifoms)||void 0===e||e.subData({offset:0,data:new Uint8Array(new Float32Array(n).buffer)}),null===(t=this.commonUnifoms)||void 0===t||t.subData({offset:0,data:new Uint8Array(new Float32Array(r).buffer)});}}},75794060:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{expose:function(){return c;},releaseProxy:function(){return a;},wrap:function(){return f;}});let r=Symbol("Comlink.proxy"),i=Symbol("Comlink.endpoint"),a=Symbol("Comlink.releaseProxy"),o=Symbol("Comlink.finalizer"),s=Symbol("Comlink.thrown"),l=e=>"object"==typeof e&&null!==e||"function"==typeof e,u=new Map([["proxy",{canHandle:e=>l(e)&&e[r],serialize(e){let{port1:t,port2:n}=new MessageChannel;return c(e,t),[n,[n]];},deserialize:e=>(e.start(),f(e))}],["throw",{canHandle:e=>l(e)&&s in e,serialize:({value:e})=>[e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[]],deserialize(e){if(e.isError)throw Object.assign(Error(e.value.message),e.value);throw e.value;}}]]);function c(e,t=globalThis,n=["*"]){t.addEventListener("message",function i(a){let l;if(!a||!a.data)return;if(!function(e,t){for(let n of e)if(t===n||"*"===n||n instanceof RegExp&&n.test(t))return!0;return!1;}(n,a.origin)){console.warn(`Invalid origin '${a.origin}' for comlink proxy`);return;}let{id:u,type:f,path:h}=Object.assign({path:[]},a.data),p=(a.data.argumentList||[]).map(_);try{var v,g;let t=h.slice(0,-1).reduce((e,t)=>e[t],e),n=h.reduce((e,t)=>e[t],e);switch(f){case"GET":l=n;break;case"SET":t[h.slice(-1)[0]]=_(a.data.value),l=!0;break;case"APPLY":l=n.apply(t,p);break;case"CONSTRUCT":v=new n(...p),l=Object.assign(v,{[r]:!0});break;case"ENDPOINT":{let{port1:t,port2:n}=new MessageChannel;c(e,n),g=[t],y.set(t,g),l=t;}break;case"RELEASE":l=void 0;break;default:return;}}catch(e){l={value:e,[s]:0};}Promise.resolve(l).catch(e=>({value:e,[s]:0})).then(n=>{let[r,a]=b(n);t.postMessage(Object.assign(Object.assign({},r),{id:u}),a),"RELEASE"===f&&(t.removeEventListener("message",i),d(t),o in e&&"function"==typeof e[o]&&e[o]());}).catch(e=>{let[n,r]=b({value:TypeError("Unserializable return value"),[s]:0});t.postMessage(Object.assign(Object.assign({},n),{id:u}),r);});}),t.start&&t.start();}function d(e){"MessagePort"===e.constructor.name&&e.close();}function f(e,t){let n=new Map;return e.addEventListener("message",function(e){let{data:t}=e;if(!t||!t.id)return;let r=n.get(t.id);if(r)try{r(t);}finally{n.delete(t.id);}}),function e(t,n,r=[],o=function(){}){let s=!1,l=new Proxy(o,{get(i,o){if(h(s),o===a)return()=>{g&&g.unregister(l),p(t),n.clear(),s=!0;};if("then"===o){if(0===r.length)return{then:()=>l};let e=x(t,n,{type:"GET",path:r.map(e=>e.toString())}).then(_);return e.then.bind(e);}return e(t,n,[...r,o]);},set(e,i,a){h(s);let[o,l]=b(a);return x(t,n,{type:"SET",path:[...r,i].map(e=>e.toString()),value:o},l).then(_);},apply(a,o,l){h(s);let u=r[r.length-1];if(u===i)return x(t,n,{type:"ENDPOINT"}).then(_);if("bind"===u)return e(t,n,r.slice(0,-1));let[c,d]=m(l);return x(t,n,{type:"APPLY",path:r.map(e=>e.toString()),argumentList:c},d).then(_);},construct(e,i){h(s);let[a,o]=m(i);return x(t,n,{type:"CONSTRUCT",path:r.map(e=>e.toString()),argumentList:a},o).then(_);}});return function(e,t){let n=(v.get(t)||0)+1;v.set(t,n),g&&g.register(e,t,e);}(l,t),l;}(e,n,[],t);}function h(e){if(e)throw Error("Proxy has been released and is not useable");}function p(e){return x(e,new Map,{type:"RELEASE"}).then(()=>{d(e);});}let v=new WeakMap,g="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{let t=(v.get(e)||0)-1;v.set(e,t),0===t&&p(e);});function m(e){var t;let n=e.map(b);return[n.map(e=>e[0]),(t=n.map(e=>e[1]),Array.prototype.concat.apply([],t))];}let y=new WeakMap;function b(e){for(let[t,n]of u)if(n.canHandle(e)){let[r,i]=n.serialize(e);return[{type:"HANDLER",name:t,value:r},i];}return[{type:"RAW",value:e},y.get(e)||[]];}function _(e){switch(e.type){case"HANDLER":return u.get(e.name).deserialize(e.value);case"RAW":return e.value;}}function x(e,t,n,r){return new Promise(i=>{let a=[,,,,].fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");t.set(a,i),e.start&&e.start(),e.postMessage(Object.assign({id:a},n),r);});}},"759cce50":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"isPathArray",{enumerable:!0,get:function(){return i;}});var r=n("383ce26f");function i(e){return Array.isArray(e)&&e.every(function(e){var t=e[0].toLowerCase();return r.paramsCount[t]===e.length-1&&"achlmqstvz".includes(t);});}},"75a81265":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("19b4e351"));function i(e,t){for(;!({}).hasOwnProperty.call(e,t)&&null!==(e=(0,r.default)(e)););return e;}},"76cd0fdf":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("318fb8cd")),i=function(e){if("object"!=typeof e||null===e)return e;if((0,r.default)(e)){t=[];for(var t,n=0,a=e.length;n<a;n++)"object"==typeof e[n]&&null!=e[n]?t[n]=i(e[n]):t[n]=e[n];}else for(var o in t={},e)"object"==typeof e[o]&&null!=e[o]?t[o]=i(e[o]):t[o]=e[o];return t;},a=i;},"76d49047":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("4086b076")),a=r._(n("3a988df8")),o=function(e){return"number"==typeof e||(0,a.default)(e)&&"[object Number]"==(0,i.default)(e);};},"776af75c":function(e,t,n){"use strict";function r(e,t){void 0===t&&(t=new Map);var n=[];if(Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var a=e[r];t.has(a)||(n.push(a),t.set(a,!0));}return n;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"77ed14f2":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("c8a0b2e7")),a=r._(n("61e63793")),o=r._(n("93407ee1")),s={plane:a.default,sprite:o.default,billboard:i.default};},"7850ca64":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return v;}});var r=n("777fffbe"),i=n("852bbaa9"),a=r._(n("1316cf9d")),o=r._(n("3d495adb")),s=r._(n("51e3ba23")),l=r._(n("19b4e351")),u=r._(n("20defe2a")),c=r._(n("4ca04ccd")),d=r._(n("5e450230")),f=n("c37c383f"),h=r._(n("e367577c")),p=i._(n("d09e5fa2")),v=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.width,i=n.height,o=n.latitude,u=void 0===o?0:o,d=n.longitude,h=void 0===d?0:d,p=n.zoom,v=void 0===p?0:p,g=n.pitch,m=void 0===g?0:g,y=n.bearing,b=void 0===y?0:y,_=n.altitude,x=void 0===_?1.5:_,w=n.nearZMultiplier,E=n.farZMultiplier;(0,a.default)(this,t),r=r||1,i=i||1;var M=(0,f.zoomToScale)(v);x=Math.max(.75,x);var S=(0,f.lngLatToWorld)([h,u],M);S[2]=0;var k=(0,f.getProjectionMatrix)({width:r,height:i,pitch:m,bearing:b,altitude:x,nearZMultiplier:w||1/i,farZMultiplier:E||1.01}),C=(0,f.getViewMatrix)({height:i,center:S,pitch:m,bearing:b,altitude:x,flipY:!0});return(e=(0,s.default)(this,(0,l.default)(t).call(this,{width:r,height:i,viewMatrix:C,projectionMatrix:k}))).latitude=u,e.longitude=h,e.zoom=v,e.pitch=m,e.bearing=b,e.altitude=x,e.scale=M,e.center=S,e.pixelsPerMeter=(0,f.getDistanceScales)((0,c.default)((0,c.default)(e))).pixelsPerMeter[2],Object.freeze((0,c.default)((0,c.default)(e))),e;}return(0,u.default)(t,e),(0,o.default)(t,[{key:"projectFlat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return(0,f.lngLatToWorld)(e,t);}},{key:"unprojectFlat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return(0,f.worldToLngLat)(e,t);}},{key:"getMapCenterByLngLatPosition",value:function(e){var t=e.lngLat,n=e.pos,r=(0,f.pixelsToWorld)(n,this.pixelUnprojectionMatrix),i=(0,f.lngLatToWorld)(t,this.scale),a=p.add([],i,p.negate([],r)),o=p.add([],this.center,a);return(0,f.worldToLngLat)(o,this.scale);}},{key:"getLocationAtPoint",value:function(e){var t=e.lngLat,n=e.pos;return this.getMapCenterByLngLatPosition({lngLat:t,pos:n});}},{key:"fitBounds",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.width,i=this.height,a=(0,h.default)(Object.assign({width:r,height:i,bounds:e},n));return new t({width:r,height:i,longitude:a.longitude,latitude:a.latitude,zoom:a.zoom});}}]),t;}(d.default);},"790e60a9":function(e,t,n){"use strict";if(n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}}),!window)throw Error("Google Map JSAPI can only be used in Browser.");var r,i=((r=i||{}).notload="notload",r.loading="loading",r.loaded="loaded",r.failed="failed",r);let a={key:""},o={GMap:i.notload},s=[],l=e=>{if("function"==typeof e){if(o.GMap===i.loaded){e(window.google.maps.Map);return;}s.push(e);}};var u={load:e=>new Promise((t,n)=>{if(o.GMap===i.failed)n("");else if(o.GMap===i.notload){let{key:r}=e;if(!r){n("\u8BF7\u586B\u5199key");return;}a.key=r,o.GMap=i.loading,window.initMap=e=>{if(delete window.initMap,e)o.GMap=i.failed,n(e);else for(o.GMap=i.loaded;s.length;)s.splice(0,1)[0](window.google.maps.Map);};let u=document.createElement("script");u.type="text/javascript",u.async=!1,u.src=`https://maps.googleapis.com/maps/api/js?key=${a.key}&callback=initMap`,u.onerror=e=>{o.GMap=i.failed,n(e);},(document.body||document.head).appendChild(u),l(t);}else if(o.GMap===i.loaded){if(e.key&&e.key!==a.key){n("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");return;}l(t);}}),reset:()=>{delete window.google,o={GMap:i.notload};}};},"7988eeca":function(e,t,n){var r=n("3d3bd3f9"),i=n("2879839f"),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=[];for(var n in Object(e))a.call(e,n)&&"constructor"!=n&&t.push(n);return t;};},"799ce237":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return f;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=n("d9b661b3"),s=n("fb1ec05a"),l=r._(n("755bc4f8")),u=n("f717bab4"),c=n("6c357209");let{isNumber:d}=s.lodashUtil;class f extends l.default{constructor(...e){super(...e),(0,a.default)(this,"raiseCount",0),(0,a.default)(this,"raiseRepeat",0);}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,POS:10,NORMAL:11});}getCommonUniformsInfo(){let{animateOption:e={enable:!1,speed:.01,repeat:!1},opacity:t=1,sourceColor:n,targetColor:r,pickLight:i=!1,heightfixed:a=!0,opacityLinear:o={enable:!1,dir:"up"},lightEnable:l=!0}=this.layer.getLayerConfig(),u=0,c=[0,0,0,0],f=[0,0,0,0];if(n&&r&&(c=(0,s.rgb2arr)(n),f=(0,s.rgb2arr)(r),u=1),this.raiseCount<1&&this.raiseRepeat>0&&e.enable){let{speed:t=.01}=e;this.raiseCount+=t,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1);}let h={u_sourceColor:c,u_targetColor:f,u_linearColor:u,u_pickLight:Number(i),u_heightfixed:Number(a),u_r:e.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:d(t)?t:1,u_opacitylinear:Number(o.enable),u_opacitylinear_dir:"up"===o.dir?1:0,u_lightEnable:Number(l)};return this.getUniformsBufferInfo(h);}initModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){let{animateOption:{repeat:t=1}}=e.layer.getLayerConfig();return e.raiseRepeat=t,[(yield e.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:'precision highp float;\n\n#define pi 3.1415926535\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;\nlayout(location = ATTRIBUTE_LOCATION_POS) in vec3 a_Pos;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\n\nlayout(std140) uniform commonUniform {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_linearColor: 0;\n  float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A\n  float u_globel;\n  float u_r;\n  float u_pickLight: 0.0;\n  float u_opacitylinear: 0.0;\n  float u_opacitylinear_dir: 1.0;\n  float u_lightEnable: 1.0;\n};\n\nout vec4 v_color;\nout float v_lightWeight;\nout float v_barLinearZ;\n// \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143\n\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nfloat getYRadian(float x, float z) {\n  if(x > 0.0 && z > 0.0) {\n    return atan(x/z);\n  } else if(x > 0.0 && z <= 0.0){\n    return atan(-z/x) + pi/2.0;\n  } else if(x <= 0.0 && z <= 0.0) {\n    return  pi + atan(x/z); //atan(x/z) +\n  } else {\n    return atan(z/-x) + pi*3.0/2.0;\n  }\n}\n\nfloat getXRadian(float y, float r) {\n  return atan(y/r);\n}\n\nvoid main() {\n\n  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97\n  vec3 size = a_Size * a_Position;\n\n  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C\n  v_barLinearZ =  a_Position.z;\n\n  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB\n  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6\n    //\n  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);\n    }\n  }\n\n\n  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));\n\n  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F\n  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);\n\n  // \u5706\u67F1\u5149\u7167\u6548\u679C\n  float lightWeight = 1.0;\n  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027\n    lightWeight = calc_lighting(pos);\n  }\n  v_lightWeight = lightWeight;\n  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272\n  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272\n    v_color = mix(u_sourceColor, u_targetColor, v_barLinearZ);\n    v_color.rgb *= lightWeight;\n  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272\n     v_color = a_Color;\n  }\n  v_color.a *= u_opacity;\n\n\n  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6\n  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635\n  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);\n  float xRadian = getXRadian(a_Pos.y, r);\n  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C\n  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C\n  mat4 mx = mat4(\n    1,0,0,0,\n    0,xcos,-xsin,0,\n    0,xsin,xcos,0,\n    0,0,0,1);\n\n  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635\n  float yRadian = getYRadian(a_Pos.x, a_Pos.z);\n  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C\n  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C\n  mat4 my = mat4(\n    ycos,0,-ysin,0,\n    0,1,0,0,\n    ysin,0,ycos,0,\n    0,0,0,1);\n\n  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);\n\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'precision highp float;\nin vec4 v_color;\n\n#pragma include "picking"\n\nlayout(std140) uniform commonUniform {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_linearColor: 0;\n  float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A\n  float u_globel;\n  float u_r;\n  float u_pickLight: 0.0;\n  float u_opacitylinear: 0.0;\n  float u_opacitylinear_dir: 1.0;\n  float u_lightEnable: 1.0;\n};\nin float v_lightWeight;\nin float v_barLinearZ;\nout vec4 outputColor;\nvoid main() {\n\n   outputColor = v_color;\n\n  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8\n  if(u_opacitylinear > 0.0) {\n    outputColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_barLinearZ): v_barLinearZ;\n  }\n\n  // picking\n  if(u_pickLight > 0.0) {\n    outputColor = filterColorAlpha(outputColor, v_lightWeight);\n  } else {\n    outputColor = filterColor(outputColor);\n  }\n}\n',triangulation:u.PointExtrudeTriangulation,depth:{enable:!0},defines:e.getDefines(),inject:e.getInject(),cull:{enable:!0,face:o.gl.FRONT},blend:e.getBlend()}))];})();}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:o.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:3,update:e=>{let{size:t}=e;if(!t)return[2,2,2];{let e=[];return Array.isArray(t)&&(e=2===t.length?[t[0],t[0],t[1]]:t),Array.isArray(t)||(e=[t,t,t]),e;}}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:o.AttributeType.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:o.gl.STATIC_DRAW,data:[],type:o.gl.FLOAT},size:3,update:(e,t,n,r,i)=>i}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:o.AttributeType.Attribute,descriptor:{name:"a_Pos",shaderLocation:this.attributeLocation.POS,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:3,update:e=>{let t=(0,s.calculateCentroid)(e.coordinates);return(0,c.lglt2xyz)([t[0],t[1]]);}}});}}},"799da683":function(e,t,n){var r=n("1c52dcc2"),i=n("9bb80662"),a=n("49f9401f"),o=n("c4fc35e5");e.exports=function(e){return a(e)?r(o(e)):i(e);};},"7ad58a24":function(e,t,n){var r=Math.ceil,i=Math.max;e.exports=function(e,t,n,a){for(var o=-1,s=i(r((t-e)/(n||1)),0),l=Array(s);s--;)l[a?s:++o]=e,e+=n;return l;};},"7af463cb":function(e,t,n){var r=n("7c1db5f7"),i=Object.create,a=function(){function e(){}return function(t){if(!r(t))return{};if(i)return i(t);e.prototype=t;var n=new e;return e.prototype=void 0,n;};}();e.exports=a;},"7b7551ff":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){return null===e;};},"7bc08ef6":function(e,t,n){var r=n("81d598f3"),i=n("9fb0e475"),a=n("399c1f06");e.exports=function(e,t){return a(i(e,t,r),e+"");};},"7c1db5f7":function(e,t,n){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t);};},"7c424190":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("73ff5a90")),i=function(){this.__data__=r.default?(0,r.default)(null):{},this.size=0;};},"7c4281a7":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("b63470f3")),i=n("9999b369"),a=function(e,t,n){"number"!=typeof t&&(t=1e-6),"number"!=typeof n&&(n=.85);for(var a,o=1,s=0,l=1e3,u=e.nodes,c=void 0===u?[]:u,d=e.edges,f=void 0===d?[]:d,h=c.length,p={},v={},g=0;g<h;++g){var m=c[g],y=m.id;p[y]=1/h,v[y]=1/h;}for(var b=(0,r.default)(e);l>0&&o>t;){s=0;for(var g=0;g<h;++g){var m=c[g],y=m.id;if(a=0,0===b[m.id].inDegree)p[y]=0;else{for(var _=(0,i.getNeighbors)(y,f,"source"),x=0;x<_.length;++x){var w=_[x],E=b[w].outDegree;E>0&&(a+=v[w]/E);}p[y]=n*a,s+=p[y];}}s=(1-s)/h,o=0;for(var g=0;g<h;++g){var m=c[g],y=m.id;o+=Math.abs((a=p[y]+s)-v[y]),v[y]=a;}l-=1;}return v;};},"7c60386d":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe")._(n("d812e418")),i=n("d9b661b3"),a=n("fb1ec05a"),o=n("02737fa5");let{isNumber:s}=a.lodashUtil,l={ENCODE:1,HIGHLIGHT:2};class u{constructor(){(0,r.default)(this,"pickingUniformMap",void 0);}pickOption2Array(){let e=[];return this.pickingUniformMap.forEach(t=>{s(t)?e.push(t):e.push(...t);}),e;}updatePickOption(e,t){Object.keys(e).forEach(t=>{this.pickingUniformMap.set(t,e[t]);});let n=t.getLayerConfig().pickingBuffer||0,r=Number(t.getShaderPickStat());this.pickingUniformMap.set("u_PickingBuffer",n),this.pickingUniformMap.set("u_shaderPick",r),t.getPickingUniformBuffer().subData({offset:0,data:this.pickOption2Array()});}apply(e,{styleAttributeService:t}){this.pickingUniformMap=new Map([["u_HighlightColor",[1,0,0,1]],["u_SelectColor",[1,0,0,1]],["u_PickingColor",[0,0,0]],["u_PickingStage",0],["u_CurrentSelectedId",[0,0,0]],["u_PickingThreshold",10],["u_PickingBuffer",0],["u_shaderPick",0],["u_activeMix",0]]),e.hooks.init.tapPromise("PixelPickingPlugin",()=>{let{enablePicking:n}=e.getLayerConfig();t.registerStyleAttribute({name:"pickingColor",type:i.AttributeType.Attribute,descriptor:{name:"a_PickingColor",shaderLocation:o.COMMON_ATTRIBUTE_LOCATION.PICKING_COLOR,buffer:{data:[],type:i.gl.FLOAT},size:3,update:e=>{let{id:t}=e;return n?(0,a.encodePickingColor)(t):[0,0,0];}}});}),e.hooks.beforePickingEncode.tap("PixelPickingPlugin",()=>{let{enablePicking:t}=e.getLayerConfig();t&&e.isVisible()&&(this.updatePickOption({u_PickingStage:l.ENCODE},e),e.models.forEach(e=>e.addUniforms({u_PickingStage:l.ENCODE})));}),e.hooks.afterPickingEncode.tap("PixelPickingPlugin",()=>{let{enablePicking:t}=e.getLayerConfig();t&&e.isVisible()&&(this.updatePickOption({u_PickingStage:l.HIGHLIGHT},e),e.models.forEach(e=>e.addUniforms({u_PickingStage:l.HIGHLIGHT})));}),e.hooks.beforeHighlight.tap("PixelPickingPlugin",t=>{let{highlightColor:n,activeMix:r=0}=e.getLayerConfig(),i="string"==typeof n?(0,a.rgb2arr)(n):n||[1,0,0,1];e.updateLayerConfig({pickedFeatureID:(0,a.decodePickingColor)(new Uint8Array(t))});let o={u_PickingStage:l.HIGHLIGHT,u_PickingColor:t,u_HighlightColor:i.map(e=>255*e),u_activeMix:r};this.updatePickOption(o,e),e.models.forEach(e=>e.addUniforms(o));}),e.hooks.beforeSelect.tap("PixelPickingPlugin",t=>{let{selectColor:n,selectMix:r=0}=e.getLayerConfig(),i="string"==typeof n?(0,a.rgb2arr)(n):n||[1,0,0,1];e.updateLayerConfig({pickedFeatureID:(0,a.decodePickingColor)(new Uint8Array(t))});let o={u_PickingStage:l.HIGHLIGHT,u_PickingColor:t,u_HighlightColor:i.map(e=>255*e),u_activeMix:r,u_CurrentSelectedId:t,u_SelectColor:i.map(e=>255*e)};this.updatePickOption(o,e),e.models.forEach(e=>e.addUniforms(o));});}}},"7ca04eec":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"Plugin",{enumerable:!0,get:function(){return d;}});var r=n("777fffbe"),i=r._(n("1316cf9d")),a=r._(n("3d495adb")),o=r._(n("66a06515")),s=r._(n("20defe2a")),l=n("597eee67"),u=n("0d884ee9"),c=function(){function e(){(0,i.default)(this,e),this.displayObjectHTMLElementMap=new WeakMap;}return(0,a.default)(e,[{key:"joinTransformMatrix",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return"matrix(".concat([e[0],e[1],e[4],e[5],e[12]+t[0],e[13]+t[1]].join(","),")");}},{key:"apply",value:function(t,n){var r=this,i=t.camera,a=t.renderingContext,o=t.renderingService;this.context=t;var s=a.root.ownerDocument.defaultView,u=s.context.eventService.nativeHTMLMap,c=function(e,t){t.style.transform=r.joinTransformMatrix(e.getWorldTransform(),e.getOrigin());},d=function(e){var t=e.target;if(t.nodeName===l.Shape.HTML){r.$camera||(r.$camera=r.createCamera(i));var n=r.getOrCreateEl(t);r.$camera.appendChild(n),Object.keys(t.attributes).forEach(function(e){r.updateAttribute(e,t);}),c(t,n),u.set(n,t);}},f=function(e){var t=e.target;if(t.nodeName===l.Shape.HTML&&r.$camera){var n=r.getOrCreateEl(t);n&&(n.remove(),u.delete(n));}},h=function(e){var t=e.target;if(t.nodeName===l.Shape.HTML){var n=e.attrName;r.updateAttribute(n,t);}},p=function(e){var t=e.target;(t.nodeName===l.Shape.FRAGMENT?t.childNodes:[t]).forEach(function(e){if(e.nodeName===l.Shape.HTML){var t=r.getOrCreateEl(e);c(e,t);}});},v=function(){if(r.$camera){var e=r.context.config,t=e.width,n=e.height;r.$camera.parentElement.style.width="".concat(t||0,"px"),r.$camera.parentElement.style.height="".concat(n||0,"px");}};o.hooks.init.tap(e.tag,function(){s.addEventListener(l.CanvasEvent.RESIZE,v),s.addEventListener(l.ElementEvent.MOUNTED,d),s.addEventListener(l.ElementEvent.UNMOUNTED,f),s.addEventListener(l.ElementEvent.ATTR_MODIFIED,h),s.addEventListener(l.ElementEvent.BOUNDS_CHANGED,p);}),o.hooks.endFrame.tap(e.tag,function(){r.$camera&&a.renderReasons.has(l.RenderReason.CAMERA_CHANGED)&&(r.$camera.style.transform=r.joinTransformMatrix(i.getOrthoMatrix()));}),o.hooks.destroy.tap(e.tag,function(){r.$camera&&r.$camera.remove(),s.removeEventListener(l.CanvasEvent.RESIZE,v),s.removeEventListener(l.ElementEvent.MOUNTED,d),s.removeEventListener(l.ElementEvent.UNMOUNTED,f),s.removeEventListener(l.ElementEvent.ATTR_MODIFIED,h),s.removeEventListener(l.ElementEvent.BOUNDS_CHANGED,p);});}},{key:"createCamera",value:function(e){var t=this.context.config,n=t.document,r=t.width,i=t.height,a=this.context.contextService.getDomElement(),o=a.parentNode;if(o){var s="g-canvas-camera",l=o.querySelector("#".concat(s));if(!l){var u=(n||document).createElement("div");u.style.overflow="hidden",u.style.pointerEvents="none",u.style.position="absolute",u.style.left="0px",u.style.top="0px",u.style.width="".concat(r||0,"px"),u.style.height="".concat(i||0,"px");var c=(n||document).createElement("div");l=c,c.id=s,c.style.position="absolute",c.style.left="".concat(a.offsetLeft||0,"px"),c.style.top="".concat(a.offsetTop||0,"px"),c.style.transformOrigin="left top",c.style.transform=this.joinTransformMatrix(e.getOrthoMatrix()),c.style.pointerEvents="none",c.style.width="100%",c.style.height="100%",u.appendChild(c),o.appendChild(u);}return l;}return null;}},{key:"getOrCreateEl",value:function(e){var t=this.context.config.document,n=this.displayObjectHTMLElementMap.get(e);return n||(n=(t||document).createElement("div"),e.parsedStyle.$el=n,this.displayObjectHTMLElementMap.set(e,n),e.id&&(n.id=e.id),e.name&&n.setAttribute("name",e.name),e.className&&(n.className=e.className),n.style.position="absolute",n.style["will-change"]="transform",n.style.transform=this.joinTransformMatrix(e.getWorldTransform(),e.getOrigin())),n;}},{key:"updateAttribute",value:function(e,t){var n=this.getOrCreateEl(t);switch(e){case"innerHTML":var r=t.parsedStyle.innerHTML;(0,u.isString)(r)?n.innerHTML=r:(n.innerHTML="",n.appendChild(r));break;case"x":n.style.left="".concat(t.parsedStyle.x,"px");break;case"y":n.style.top="".concat(t.parsedStyle.y,"px");break;case"transformOrigin":var i=t.parsedStyle.transformOrigin;n.style["transform-origin"]="".concat(i[0].buildCSSText(null,null,"")," ").concat(i[1].buildCSSText(null,null,""));break;case"width":var a=t.parsedStyle.width;n.style.width=(0,u.isNumber)(a)?"".concat(a,"px"):a.toString();break;case"height":var o=t.parsedStyle.height;n.style.height=(0,u.isNumber)(o)?"".concat(o,"px"):o.toString();break;case"zIndex":var s=t.parsedStyle.zIndex;n.style["z-index"]="".concat(s);break;case"visibility":var c=t.parsedStyle.visibility;n.style.visibility=c;break;case"pointerEvents":var d=t.parsedStyle.pointerEvents;n.style.pointerEvents=void 0===d?"auto":d;break;case"opacity":var f=t.parsedStyle.opacity;n.style.opacity="".concat(f);break;case"fill":var h=t.parsedStyle.fill,p="";(0,l.isCSSRGB)(h)?p=h.isNone?"transparent":t.getAttribute("fill"):Array.isArray(h)?p=t.getAttribute("fill"):(0,l.isPattern)(h),n.style.background=p;break;case"stroke":var v=t.parsedStyle.stroke,g="";(0,l.isCSSRGB)(v)?g=v.isNone?"transparent":t.getAttribute("stroke"):Array.isArray(v)?g=t.getAttribute("stroke"):(0,l.isPattern)(v),n.style["border-color"]=g,n.style["border-style"]="solid";break;case"lineWidth":var m=t.parsedStyle.lineWidth;n.style["border-width"]="".concat(m||0,"px");break;case"lineDash":n.style["border-style"]="dashed";break;case"filter":var y=t.style.filter;n.style.filter=y;break;default:(0,u.isNil)(t.style[e])||""===t.style[e]||(n.style[e]=t.style[e]);}}}]);}();c.tag="HTMLRendering";var d=function(e){function t(){var e;(0,i.default)(this,t);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=(0,o.default)(this,t,[].concat(r))).name="html-renderer",e;}return(0,s.default)(t,e),(0,a.default)(t,[{key:"init",value:function(){this.addRenderingPlugin(new c);}},{key:"destroy",value:function(){this.removeAllRenderingPlugins();}}]);}(l.AbstractRendererPlugin);},"7cf183ea":function(e,t,n){var r=n("6e3a9823"),i=n("f28dfa76");e.exports=function(e){return"number"==typeof e||i(e)&&"[object Number]"==r(e);};},"7cf732b3":function(e,t,n){var r=/\w*$/;e.exports=function(e){var t=new e.constructor(e.source,r.exec(e));return t.lastIndex=e.lastIndex,t;};},"7d058635":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"useLayerEvent",{enumerable:!0,get:function(){return o;}});var r=n("af467690"),i=n("9d065c04"),a=n("fede9095"),o=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.LayerEventMap,o=(0,i.useMemo)(function(){return Object.keys(n);},[n]),s=function(r){o.forEach(function(i){var a=n[i],o=t[i];i&&o&&e[r](a,o);});},l=function(){return s("on");},u=function(){return s("off");},c=(0,i.useRef)(!0);c.current&&l(),(0,i.useEffect)(function(){return c.current?c.current=!1:l(),function(){u();};},o.map(function(e){return t[e];})),(0,r.useUnmount)(function(){u();});};},"7d20a5e6":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return p;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("b131ee44")),o=r._(n("f89fb776")),s=r._(n("d812e418")),l=n("d9b661b3"),u=n("3aa02964"),c=r._(n("80dad29a")),d=r._(n("a68aa674"));let f=["id","style","rotation"],h={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"};class p extends c.default{constructor(...e){super(...e),(0,s.default)(this,"version","GLOBEL"),(0,s.default)(this,"dragging",!1),(0,s.default)(this,"viewport",void 0),(0,s.default)(this,"handleCameraChanging",void 0),(0,s.default)(this,"handleCameraTimer",void 0),(0,s.default)(this,"handleCameraChanged",e=>{this.emit("mapchange"),this.handleCameraChanging=!0,this.handleCameraTimer&&clearTimeout(this.handleCameraTimer),this.handleCameraTimer=setTimeout(()=>{this.handleCameraChanging=!1;},2e3),e.type&&e.originalEvent&&("wheel"===e.originalEvent.type&&this.viewport.scaleZoom(-(.01*Math.sign(e.originalEvent.wheelDelta)*1)),Math.abs(e.originalEvent.movementX)>Math.abs(e.originalEvent.movementY)?e.originalEvent.movementX>0?this.viewport.rotateY(.02):e.originalEvent.movementX<0&&this.viewport.rotateY(-.02):e.originalEvent.movementY>0?this.viewport.rotateX(.02):e.originalEvent.movementY<0&&this.viewport.rotateX(-.02));let{offsetCoordinate:t=!0}=this.config;this.viewport.syncWithMapCamera({viewportHeight:this.map.transform.height,viewportWidth:this.map.transform.width}),this.viewport.getZoom()>12&&t?this.coordinateSystemService.setCoordinateSystem(l.CoordinateSystem.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(l.CoordinateSystem.LNGLAT),this.cameraChangedCallback(this.viewport);});}lngLatToMercator(e,t){throw Error("Method not implemented.");}getModelMatrix(e,t,n,r,i){throw Error("Method not implemented.");}on(e,t){-1!==l.MapServiceEvent.indexOf(e)?this.eventEmitter.on(e,t):this.map.on(h[e]||e,t);}off(e,t){this.map.off(h[e]||e,t),this.eventEmitter.off(e,t);}getMapCanvasContainer(){return this.map.getCanvasContainer();}getSize(){let e=this.map.transform;return[e.width,e.height];}getType(){return"earth";}init(){var e=this;return(0,o.default)(function*(){let t=e.config,{id:n="map",style:r="light",rotation:o=0}=t,s=(0,a.default)(t,f);e.viewport=new d.default,e.$mapContainer=e.creatMapContainer(n),e.map=new u.Map((0,i.default)({container:e.$mapContainer,bearing:o},s)),e.map.on("load",e.handleCameraChanged),e.map.on("move",e.handleCameraChanged),e.handleCameraChanged({});})();}destroy(){var e;null===(e=this.$mapContainer)||void 0===e||null===(e=e.parentNode)||void 0===e||e.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null);}emit(e,...t){this.eventEmitter.emit(e,...t);}once(e,...t){this.eventEmitter.once(e,...t);}getMapContainer(){return this.$mapContainer;}getCanvasOverlays(){}onCameraChanged(e){this.cameraChangedCallback=e;}rotateY(e){let{force:t=!1,reg:n=.01}=e||{};(!this.handleCameraChanging||t)&&this.viewport&&(this.viewport.rotateY(n),this.viewport.syncWithMapCamera({viewportHeight:this.map.transform.height,viewportWidth:this.map.transform.width}),this.cameraChangedCallback(this.viewport));}}},"7e78caeb":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=Object.prototype,i=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r);};},"7ea96697":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"Map",{enumerable:!0,get:function(){return b;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("d812e418")),o=r._(n("be334174")),s=n("39b8b27a"),l=n("5c93f055"),u=n("d092a378"),c=n("458dc274"),d=n("d50110f4"),f=n("262c4dce"),h=n("e31a659c"),p=n("b448a57d"),v=n("df79d367"),g=n("f9562c3c"),m=n("fb1ec05a");!function(e,t){var n="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,r="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram);if(!n&&!r&&(t||(t=document),t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i);}var o=t.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o);}}(`.l7-map {
  font:
    12px/20px 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgb(0 0 0 / 0%);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: grab;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  touch-action: none;
}

.l7-canvas-container.l7-touch-drag-pan.l7-cooperative-gestures,
.l7-canvas-container.l7-touch-drag-pan.l7-cooperative-gestures .l7-canvas {
  touch-action: pan-x pan-y;
}

.l7-cooperative-gesture-screen {
  background: rgba(0 0 0 / 40%);
  position: absolute;
  inset: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  color: white;
  padding: 1rem;
  font-size: 1.4em;
  line-height: 1.2;
  opacity: 0;
  pointer-events: none;
  transition: opacity 1s ease 1s;
  z-index: 99999;
}

.l7-cooperative-gesture-screen.l7-show {
  opacity: 1;
  transition: opacity 0.05s;
}

.l7-cooperative-gesture-screen .l7-mobile-message {
  display: none;
}

@media (hover: none), (width <= 480px) {
  .l7-cooperative-gesture-screen .l7-desktop-message {
    display: none;
  }

  .l7-cooperative-gesture-screen .l7-mobile-message {
    display: block;
  }
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right {
  position: absolute;
  pointer-events: none;
  z-index: 2;
}

.l7-ctrl-top-left {
  top: 0;
  left: 0;
}

.l7-ctrl-top-right {
  top: 0;
  right: 0;
}

.l7-ctrl-bottom-left {
  bottom: 0;
  left: 0;
}

.l7-ctrl-bottom-right {
  right: 0;
  bottom: 0;
}

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}

.l7-ctrl-top-left .l7-ctrl {
  margin: 10px 0 0 10px;
  float: left;
}

.l7-ctrl-top-right .l7-ctrl {
  margin: 10px 10px 0 0;
  float: right;
}

.l7-ctrl-bottom-left .l7-ctrl {
  margin: 0 0 10px 10px;
  float: left;
}

.l7-ctrl-bottom-right .l7-ctrl {
  margin: 0 10px 10px 0;
  float: right;
}

.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
  cursor: crosshair;
}

.l7-boxzoom {
  position: absolute;
  top: 0;
  left: 0;
  width: 0;
  height: 0;
  background: #fff;
  border: 2px dotted #202020;
  opacity: 0.5;
  z-index: 10;
}
`);let y={interactive:!0,bearingSnap:7,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,fadeDuration:300,clickTolerance:3,pitchWithRotate:!0};class b extends s.Camera{constructor(e){let t=(0,i.default)((0,i.default)({},y),e);if(null!=t.minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<0)throw Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&t.maxPitch>85)throw Error("maxPitch must be less than or equal to 85");if(super(new c.Transform(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),{bearingSnap:t.bearingSnap}),(0,a.default)(this,"_container",void 0),(0,a.default)(this,"_canvasContainer",void 0),(0,a.default)(this,"_interactive",void 0),(0,a.default)(this,"_frameRequest",void 0),(0,a.default)(this,"_loaded",void 0),(0,a.default)(this,"_idleTriggered",!1),(0,a.default)(this,"_fullyLoaded",void 0),(0,a.default)(this,"_trackResize",void 0),(0,a.default)(this,"_resizeObserver",void 0),(0,a.default)(this,"_preserveDrawingBuffer",void 0),(0,a.default)(this,"_failIfMajorPerformanceCaveat",void 0),(0,a.default)(this,"_fadeDuration",void 0),(0,a.default)(this,"_crossSourceCollisions",void 0),(0,a.default)(this,"_crossFadingFactor",1),(0,a.default)(this,"_collectResourceTiming",void 0),(0,a.default)(this,"_renderTaskQueue",new v.TaskQueue),(0,a.default)(this,"_mapId",(0,g.uniqueId)()),(0,a.default)(this,"_removed",void 0),(0,a.default)(this,"_clickTolerance",void 0),(0,a.default)(this,"version",void 0),(0,a.default)(this,"mapSize",void 0),(0,a.default)(this,"scrollZoom",void 0),(0,a.default)(this,"boxZoom",void 0),(0,a.default)(this,"dragRotate",void 0),(0,a.default)(this,"dragPan",void 0),(0,a.default)(this,"keyboard",void 0),(0,a.default)(this,"doubleClickZoom",void 0),(0,a.default)(this,"touchZoomRotate",void 0),(0,a.default)(this,"touchPitch",void 0),(0,a.default)(this,"cooperativeGestures",void 0),(0,a.default)(this,"_onMapScroll",e=>{if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1;}),this._interactive=t.interactive,this._trackResize=!0===t.trackResize,this._bearingSnap=t.bearingSnap,this._fadeDuration=t.fadeDuration,this._clickTolerance=t.clickTolerance,this.version=e.version,this.mapSize=e.mapSize,"string"==typeof t.container){if(this._container=document.getElementById(t.container),!this._container)throw Error(`Container '${t.container}' not found.`);}else if(t.container instanceof HTMLElement)this._container=t.container;else throw Error("Invalid type: 'container' must be a String or HTMLElement.");if(t.maxBounds&&this.setMaxBounds(t.maxBounds),this._setupContainer(),this.on("move",()=>this._update()).on("moveend",()=>this._update()).on("zoom",()=>this._update()).once("idle",()=>{this._idleTriggered=!0;}),"undefined"!=typeof window){let e=!1,t=m.lodashUtil.throttle(e=>{this._trackResize&&!this._removed&&this.resize(e)._update();},50);this._resizeObserver=new ResizeObserver(n=>{if(!e){e=!0;return;}t(n);}),this._resizeObserver.observe(this._container);}this.handlers=new d.HandlerManager(this,t),this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,(0,g.extend)({},t.fitBoundsOptions,{duration:0}))),this.resize();}_getMapId(){return this._mapId;}calculateCameraOptionsFromTo(e,t,n,r){return super.calculateCameraOptionsFromTo(e,t,n,r);}resize(e){var t;let n=this._containerDimensions(),r=n[0],i=n[1];this.transform.resize(r,i),null===(t=this._requestedCameraState)||void 0===t||t.resize(r,i);let a=!this._moving;return a&&(this.stop(),this.fire(new p.Event("movestart",e)).fire(new p.Event("move",e))),this.fire(new p.Event("resize",e)),a&&this.fire(new p.Event("moveend",e)),this;}getBounds(){return this.transform.getBounds();}getMaxBounds(){return this.transform.getMaxBounds();}setMaxBounds(e){return this.transform.setMaxBounds(e&&u.LngLatBounds.convert(e)),this._update();}setMinZoom(e){if((e=null==e?-2:e)>=-2&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw Error("minZoom must be between -2 and the current maxZoom, inclusive");}getMinZoom(){return this.transform.minZoom;}setMaxZoom(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this.getZoom()>e&&this.setZoom(e),this;throw Error("maxZoom must be greater than the current minZoom");}getMaxZoom(){return this.transform.maxZoom;}setMinPitch(e){if((e=null==e?0:e)<0)throw Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this.getPitch()<e&&this.setPitch(e),this;throw Error("minPitch must be between 0 and the current maxPitch, inclusive");}getMinPitch(){return this.transform.minPitch;}setMaxPitch(e){if((e=null==e?60:e)>85)throw Error("maxPitch must be less than or equal to 85");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this.getPitch()>e&&this.setPitch(e),this;throw Error("maxPitch must be greater than the current minPitch");}getMaxPitch(){return this.transform.maxPitch;}getRenderWorldCopies(){return this.transform.renderWorldCopies;}setRenderWorldCopies(e){this.transform.renderWorldCopies=e;}project(e){return this.transform.locationPoint(l.LngLat.convert(e));}unproject(e){return this.transform.pointLocation(o.default.convert(e));}isMoving(){var e;return this._moving||(null===(e=this.handlers)||void 0===e?void 0:e.isMoving());}isZooming(){var e;return this._zooming||(null===(e=this.handlers)||void 0===e?void 0:e.isZooming());}isRotating(){var e;return this._rotating||(null===(e=this.handlers)||void 0===e?void 0:e.isRotating());}on(e,t){return super.on(e,t);}once(e,t){return super.once(e,t);}off(e,t){return super.off(e,t);}getContainer(){return this._container;}getCanvasContainer(){return this._canvasContainer;}_containerDimensions(){let e=0,t=0;return this._container&&(e=this._container.clientWidth||400,t=this._container.clientHeight||300),[e,t];}_setupContainer(){let e=this._container;e.classList.add("l7-map");let t=this._canvasContainer=h.DOM.create("div","l7-canvas-container",e);this._interactive&&t.classList.add("l7-interactive"),this._container.addEventListener("scroll",this._onMapScroll,!1);}_update(){return this.triggerRepaint(),this;}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e);}_cancelRenderFrame(e){this._renderTaskQueue.remove(e);}_render(e){if(this._renderTaskQueue.run(e),!this._removed)return this.fire(new p.Event("render")),this.isMoving()||this.fire(new p.Event("idle")),this;}remove(){var e;this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.handlers.destroy(),delete this.handlers,null===(e=this._resizeObserver)||void 0===e||e.disconnect(),h.DOM.remove(this._canvasContainer),this._container.classList.remove("l7-map"),this._removed=!0,this.fire(new p.Event("remove"));}triggerRepaint(){this._frameRequest||(this._frameRequest=new AbortController,f.browser.frameAsync(this._frameRequest).then(e=>{this._frameRequest=null,this._render(e);}).catch(()=>{}));}getCameraTargetElevation(){return this.transform.elevation;}}},"80a551a4":function(e,t,n){"use strict";function r(e,t,n){if(e[n].length>7){e[n].shift();for(var r=e[n],i=n;r.length;)t[n]="A",e.splice(i+=1,0,["C"].concat(r.splice(0,6)));e.splice(n,1);}}n.d(t,"__esModule",{value:!0}),n.d(t,"fixArc",{enumerable:!0,get:function(){return r;}});},"80c793c2":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("dbd10968")),a=r._(n("7d20a5e6"));class o extends i.default{getServiceConstructor(){return a.default;}}},"80c79fc1":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"createUpdateEffect",{enumerable:!0,get:function(){return i;}});var r=n("9d065c04"),i=function(e){return function(t,n){var i=(0,r.useRef)(!1);e(function(){return function(){i.current=!1;};},[]),e(function(){if(i.current)return t();i.current=!0;},n);};};},"80d2cf98":function(e,t,n){var r=n("8ab1b7bd"),i=n("d57bce82"),a=n("16ec8ed6");e.exports=function(e){return r(e,a,i);};},"80dad29a":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe")._(n("d812e418")),i=n("d9b661b3"),a=n("fb1ec05a"),o=n("f86d399e"),s=n("570a7fd1"),l=n("cc20131e");let u={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"};class c{constructor(e){(0,r.default)(this,"version","DEFAUlTMAP"),(0,r.default)(this,"map",void 0),(0,r.default)(this,"simpleMapCoord",new s.SimpleMapCoord),(0,r.default)(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),(0,r.default)(this,"config",void 0),(0,r.default)(this,"configService",void 0),(0,r.default)(this,"coordinateSystemService",void 0),(0,r.default)(this,"eventEmitter",void 0),(0,r.default)(this,"markerContainer",void 0),(0,r.default)(this,"cameraChangedCallback",void 0),(0,r.default)(this,"$mapContainer",void 0),(0,r.default)(this,"handleCameraChanged",e=>{let{lat:t,lng:n}=this.map.getCenter();this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:this.map.getBearing(),center:[n,t],viewportHeight:this.map.transform.height,pitch:this.map.getPitch(),viewportWidth:this.map.transform.width,zoom:this.map.getZoom(),cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport);}),this.config=e.mapConfig,this.configService=e.globalConfigService,this.coordinateSystemService=e.coordinateSystemService,this.eventEmitter=new o.EventEmitter;}setBgColor(e){this.bgColor=e;}addMarkerContainer(){let e=this.map.getCanvasContainer();this.markerContainer=a.DOM.create("div","l7-marker-container",e),this.markerContainer.setAttribute("tabindex","-1");}getMarkerContainer(){return this.markerContainer;}getOverlayContainer(){}getCanvasOverlays(){}on(e,t){-1!==i.MapServiceEvent.indexOf(e)?this.eventEmitter.on(e,t):this.map.on(u[e]||e,t);}off(e,t){this.map.off(u[e]||e,t),this.eventEmitter.off(e,t);}getContainer(){return this.map.getContainer();}getMapCanvasContainer(){return this.map.getCanvasContainer();}getSize(){if("SIMPLE"===this.version)return this.simpleMapCoord.getSize();let e=this.map.transform;return[e.width,e.height];}getType(){return"default";}getZoom(){return this.map.getZoom();}setZoom(e){return this.map.setZoom(e);}getCenter(){return this.map.getCenter();}setCenter(e){this.map.setCenter(e);}getPitch(){return this.map.getPitch();}getRotation(){return this.map.getBearing();}getBounds(){return this.map.getBounds().toArray();}getMinZoom(){return this.map.getMinZoom();}getMaxZoom(){return this.map.getMaxZoom();}setRotation(e){this.map.setBearing(e);}zoomIn(e,t){this.map.zoomIn(e,t);}zoomOut(e,t){this.map.zoomOut(e,t);}setPitch(e){return this.map.setPitch(e);}panTo(e){this.map.panTo(e);}panBy(e=0,t=0){this.map.panBy([e,t]);}fitBounds(e,t){this.map.fitBounds(e,t);}setMaxZoom(e){this.map.setMaxZoom(e);}setMinZoom(e){this.map.setMinZoom(e);}setMapStatus(e){!0===e.doubleClickZoom&&this.map.doubleClickZoom.enable(),!1===e.doubleClickZoom&&this.map.doubleClickZoom.disable(),!1===e.dragEnable&&this.map.dragPan.disable(),!0===e.dragEnable&&this.map.dragPan.enable(),!1===e.rotateEnable&&this.map.dragRotate.disable(),!0===e.dragEnable&&this.map.dragRotate.enable(),!1===e.keyboardEnable&&this.map.keyboard.disable(),!0===e.keyboardEnable&&this.map.keyboard.enable(),!1===e.zoomEnable&&this.map.scrollZoom.disable(),!0===e.zoomEnable&&this.map.scrollZoom.enable();}setZoomAndCenter(e,t){this.map.flyTo({zoom:e,center:t});}setMapStyle(e){var t;null===(t=this.map)||void 0===t||t.setStyle(this.getMapStyleValue(e));}meterToCoord(e,t){return 1;}pixelToLngLat(e){return this.map.unproject(e);}lngLatToPixel(e){return this.map.project(e);}containerToLngLat(e){return this.map.unproject(e);}lngLatToContainer(e){return this.map.project(e);}getMapStyle(){try{var e;let t=null!==(e=this.map.getStyle().sprite)&&void 0!==e?e:"";if(/^mapbox:\/\/sprites\/zcxduo\/\w+\/\w+$/.test(t))return null==t?void 0:t.replace(/\/\w+$/,"").replace(/sprites/,"styles");return t;}catch(e){return"";}}getMapStyleConfig(){return l.MapTheme;}getMapStyleValue(e){var t;return null!==(t=this.getMapStyleConfig()[e])&&void 0!==t?t:e;}destroy(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null);}emit(e,...t){this.eventEmitter.emit(e,...t);}once(e,...t){this.eventEmitter.once(e,...t);}getMapContainer(){return this.$mapContainer;}exportMap(e){var t;let n=null===(t=this.map)||void 0===t?void 0:t.getCanvas();return"jpg"===e?null==n?void 0:n.toDataURL("image/jpeg"):null==n?void 0:n.toDataURL("image/png");}onCameraChanged(e){this.cameraChangedCallback=e;}creatMapContainer(e){let t=e;return"string"==typeof e&&(t=document.getElementById(e)),t;}updateView(e){this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:e.bearing,center:e.center,viewportHeight:e.viewportHeight,pitch:e.pitch,viewportWidth:e.viewportWidth,zoom:e.zoom,cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport);}updateCoordinateSystemService(){let{offsetCoordinate:e=!0}=this.config;this.viewport.getZoom()>12&&e?this.coordinateSystemService.setCoordinateSystem(i.CoordinateSystem.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(i.CoordinateSystem.LNGLAT);}}},"80e60ee8":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("777fffbe"),n("5dc7140d"),n("cf7441db");},81285970:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return y;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("b131ee44")),o=r._(n("f89fb776")),s=r._(n("d812e418")),l=n("d9b661b3"),u=n("fb1ec05a"),c=n("71293cfd"),d=r._(n("4f2bad25")),f=r._(n("80dad29a")),h=n("0f809895"),p=r._(n("b5607998"));let v=["id","center","zoom","token","mapInstance","version","mapSize","minZoom","maxZoom"];!function(e,t){var n="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,r="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram);if(!n&&!r&&(t||(t=document),t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i);}var o=t.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o);}}(`.BMap_cpyCtrl .anchorBL {
  display: none !important;
}

.anchorBL {
  display: none !important;
}
`);let g={mapmove:"moving",contextmenu:"rightclick",camerachange:"update",zoomchange:"zoomend"},m="zLhopYPPERGtpGOgimcdKcCimGRyyIsh";class y extends f.default{constructor(...e){super(...e),(0,s.default)(this,"viewport",void 0),(0,s.default)(this,"styleConfig",{normal:[]}),(0,s.default)(this,"currentStyle","normal"),(0,s.default)(this,"evtCbProxyMap",new Map),(0,s.default)(this,"handleCameraChanged",()=>{this.emit("mapchange");let e=this.getMap(),{lng:t,lat:n}=e.getCenter(),r={center:[t,n],viewportHeight:e.getContainer().clientHeight,viewportWidth:e.getContainer().clientWidth,bearing:360-e.getHeading(),pitch:e.getTilt(),zoom:e.getZoom()-1.75};this.viewport.syncWithMapCamera(r),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport);});}getMap(){return this.map;}setBgColor(e){this.bgColor=e;}init(){var e=this;return(0,o.default)(function*(){e.viewport=new d.default;let t=e.config,{id:n,center:r=[121.30654632240122,31.25744185633306],zoom:o=12,token:s=m,mapInstance:l,version:c="1.0",mapSize:f=1e4,minZoom:h=0,maxZoom:g=21}=t,y=(0,a.default)(t,v);if(e.viewport=new d.default,e.version=c,e.simpleMapCoord.setSize(f),window.BMapGL||l||(yield p.default.load({key:s,version:"1.0"})),l){e.map=l,e.$mapContainer=e.map.getContainer();let t=new BMapGL.Point(r[0],r[1]);e.map.isLoaded()||e.map.centerAndZoom(t,o),e.initMapByConfig(e.config),e.map.on("update",e.handleCameraChanged);}else{let t=(0,i.default)({enableWheelZoom:!0,minZoom:h,maxZoom:g},y);if(s===m&&console.warn(`%c${e.configService.getSceneWarninfo("MapToken")}!`,"color: #873bf4;font-weigh:900;font-size: 16px;"),!n)throw Error("No container id specified");let a=u.DOM.getContainer(n),l=[...a.childNodes],c=new BMapGL.Map(a,t);e.$mapContainer=c.getContainer(),l.forEach(t=>{e.$mapContainer.appendChild(t);}),l=null,e.map=c;let d=new BMapGL.Point(r[0],r[1]);e.map.centerAndZoom(d,o),e.initMapByConfig(e.config),c.on("update",e.handleCameraChanged);}})();}destroy(){this.getMap().destroy();}onCameraChanged(e){this.cameraChangedCallback=e;}addMarkerContainer(){}getMarkerContainer(){return this.map.getPanes().markerPane;}getCanvasOverlays(){var e;return null===(e=this.getMap().getContainer().querySelector("#platform"))||void 0===e?void 0:e.lastChild;}on(e,t){if(-1!==l.MapServiceEvent.indexOf(e)){this.eventEmitter.on(e,t);return;}let n=this.evtCbProxyMap.get(e);if(n||this.evtCbProxyMap.set(e,n=new Map),n.get(t))return;let r=(...e)=>{!e[0]||"object"!=typeof e[0]||e[0].lngLat||e[0].lnglat||(e[0].lngLat=e[0].latlng||e[0].latLng),t(...e);};n.set(t,r),this.map.on(g[e]||e,r);}off(e,t){var n,r;if(-1!==l.MapServiceEvent.indexOf(e)){this.eventEmitter.off(e,t);return;}let i=null===(n=this.evtCbProxyMap.get(e))||void 0===n?void 0:n.get(t);i&&(null===(r=this.evtCbProxyMap.get(e))||void 0===r||r.delete(t),this.map.off(g[e]||e,i));}once(e,t){this.eventEmitter.once(e,t);}getContainer(){return this.getMap().getContainer();}getSize(){let e=this.getMap().getSize();return[e.width,e.height];}getMinZoom(){return this.map.getMinZoom();}getMaxZoom(){return this.map.getMaxZoom();}getType(){return"bmap";}getZoom(){return this.getMap().getZoom();}getCenter(e){if(null!=e&&e.padding){let t=this.getCenter(),n=(0,h.toPaddingOptions)(e.padding),r=this.lngLatToPixel([t.lng,t.lat]),i=[(n.right-n.left)/2,(n.bottom-n.top)/2];return this.pixelToLngLat([r.x-i[0],r.y-i[1]]);}let t=this.map.getCenter();return{lng:t.lng,lat:t.lat};}getPitch(){return this.getMap().getTilt();}getRotation(){return 360-this.getMap().getHeading();}getBounds(){let e=this.getMap().getBounds(),t=e.getNorthEast(),n=e.getSouthWest();return[[n.lng,n.lat],[t.lng,t.lat]];}getMapContainer(){return this.getMap().getContainer();}getMapCanvasContainer(){return this.getMap().getContainer();}getMapStyleConfig(){return this.styleConfig;}getMapStyleValue(e){return this.styleConfig[e];}setMapStyle(e){if(this.currentStyle===e)return;let t=Array.isArray(e)?e:this.styleConfig[e]||e;if(Array.isArray(t)){this.map.setMapStyleV2({styleJson:t}),this.currentStyle=e;return;}if("string"==typeof t){this.map.setMapStyleV2({styleId:t}),this.currentStyle=e;return;}}setRotation(e){this.getMap().setHeading(e);}zoomIn(){this.getMap().zoomIn();}zoomOut(){this.getMap().zoomOut();}panTo(e){this.getMap().panTo(new BMapGL.Point(e[0],e[1]));}panBy(e,t){this.getMap().panBy(e,t);}fitBounds(e,t){this.map.setViewport(e.map(e=>new BMapGL.Point(e[0],e[1])),t);}setZoomAndCenter(e,[t,n]){this.getMap().centerAndZoom(new BMapGL.Point(t,n),e+1.75);}setCenter([e,t],n){let r={lng:e,lat:t};if(null!=n&&n.padding){let i=(0,h.toPaddingOptions)(n.padding),a=this.lngLatToPixel([e,t]),o=[(i.right-i.left)/2,(i.bottom-i.top)/2];r=this.pixelToLngLat([a.x+o[0],a.y+o[1]]);}this.getMap().setCenter(new BMapGL.Point(r.lng,r.lat));}setPitch(e){this.getMap().setTilt(e);}setZoom(e){this.getMap().setZoom(e);}setMapStatus(e){let t=this.getMap();Object.keys(e).map(n=>{switch(n){case"doubleClickZoom":e.doubleClickZoom?t.enableDoubleClickZoom():t.disableDoubleClickZoom();break;case"dragEnable":e.dragEnable?t.enableDragging():t.disableDragging();break;case"keyboardEnable":e.keyboardEnable?t.enableKeyboard():t.disableKeyboard();break;case"resizeEnable":e.resizeEnable?t.enableAutoResize():t.disableAutoResize();break;case"rotateEnable":e.rotateEnable?(t.enableRotate(),t.enableRotateGestures()):(t.disableRotate(),t.disableRotateGestures());break;case"zoomEnable":e.zoomEnable?(this.map.enableDoubleClickZoom(),this.map.enableScrollWheelZoom(),this.map.enablePinchToZoom()):(this.map.disableDoubleClickZoom(),this.map.disableScrollWheelZoom(),this.map.disablePinchToZoom());break;case"showIndoorMap":t.setDisplayOptions({indoor:!!e.showIndoorMap});}});}meterToCoord(e,t){let n=this.getMap().getDistance(new BMapGL.Point(...e),new BMapGL.Point(...t)),[r,i]=this.lngLatToCoord(e),[a,o]=this.lngLatToCoord(t);return Math.sqrt(Math.pow(r-a,2)+Math.pow(i-o,2))/n;}pixelToLngLat([e,t]){let n=this.getMap().pixelToPoint(new BMapGL.Pixel(e,t));return{lng:n.lng,lat:n.lat};}lngLatToPixel([e,t]){let n=this.getMap().pointToPixel(new BMapGL.Point(e,t));return{x:n.x,y:n.y};}containerToLngLat([e,t]){let n=this.getMap().overlayPixelToPoint(new BMapGL.Pixel(e,t));return{lng:n.lng,lat:n.lat};}lngLatToContainer([e,t]){let n=this.getMap().pointToOverlayPixel(new BMapGL.Point(e,t));return{x:n.x,y:n.y};}lngLatToCoord([e,t]){let{x:n,y:r}=this.getMap().pointToPixel(new BMapGL.Point(e,t));return[n,-r];}lngLatToCoords(e){return e.map(e=>Array.isArray(e[0])?this.lngLatToCoords(e):this.lngLatToCoord(e));}lngLatToMercator([e,t],n){let[r,i]=this.getMap().lnglatToMercator(e,t);return{x:r,y:i,z:n};}getModelMatrix(e,t,n,r=[1,1,1]){let i=this.viewport.projectFlat(e),a=c.mat4.create();return c.mat4.translate(a,a,c.vec3.fromValues(i[0],i[1],t)),c.mat4.scale(a,a,c.vec3.fromValues(r[0],r[1],r[2])),c.mat4.rotateX(a,a,n[0]),c.mat4.rotateY(a,a,n[1]),c.mat4.rotateZ(a,a,n[2]),a;}getCustomCoordCenter(){throw Error("Method not implemented.");}exportMap(e){let t=this.getMap()._webglPainter._canvas;return"jpg"===e?null==t?void 0:t.toDataURL("image/jpeg"):null==t?void 0:t.toDataURL("image/png");}hideLogo(){let e=this.map.getContainer();e&&u.DOM.addClass(e,"bmap-contianer--hide-logo");}initMapByConfig(e){let{style:t,pitch:n=0,rotation:r=0,logoVisible:i=!0}=e;t&&this.setMapStyle(t),n&&this.setPitch(n),r&&this.setRotation(r),!1===i&&this.hideLogo();}}},"812ed3a8":function(e,t,n){"use strict";function r(e,t,n,r){this.cx=3*e,this.bx=3*(n-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(r-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=n,this.p2y=r;}e.exports=r,r.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e;},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e;},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx;},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var n=e,r=0;r<8;r++){var i=this.sampleCurveX(n)-e;if(Math.abs(i)<t)return n;var a=this.sampleCurveDerivativeX(n);if(1e-6>Math.abs(a))break;n-=i/a;}var o=0,s=1;for(r=0,n=e;r<20&&!(Math.abs((i=this.sampleCurveX(n))-e)<t);r++)e>i?o=n:s=n,n=(s-o)*.5+o;return n;},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t));}};},"81c54a07":function(e,t,n){var r=n("9a0f9519"),i=n("a917243b"),a=n("37baa790");e.exports=function(e,t,n,o,s,l){var u=1&n,c=e.length,d=t.length;if(c!=d&&!(u&&d>c))return!1;var f=l.get(e),h=l.get(t);if(f&&h)return f==t&&h==e;var p=-1,v=!0,g=2&n?new r:void 0;for(l.set(e,t),l.set(t,e);++p<c;){var m=e[p],y=t[p];if(o)var b=u?o(y,m,p,t,e,l):o(m,y,p,e,t,l);if(void 0!==b){if(b)continue;v=!1;break;}if(g){if(!i(t,function(e,t){if(!a(g,t)&&(m===e||s(m,e,n,o,l)))return g.push(t);})){v=!1;break;}}else if(!(m===y||s(m,y,n,o,l))){v=!1;break;}}return l.delete(e),l.delete(t),v;};},"81d598f3":function(e,t,n){e.exports=function(e){return e;};},"81e4157d":function(e,t,n){var r=n("7c1db5f7"),i=n("3d3bd3f9"),a=n("6f115330"),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return a(e);var t=i(e),n=[];for(var s in e)"constructor"==s&&(t||!o.call(e,s))||n.push(s);return n;};},"81e755b2":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{AABB:function(){return ea;},CSS:function(){return iY;},Camera:function(){return eO;},CameraType:function(){return eA;},Canvas:function(){return i6;},CanvasEvent:function(){return i1;},Circle:function(){return iC;},CustomElement:function(){return iL;},CustomEvent:function(){return rF;},DisplayObject:function(){return ik;},Document:function(){return iX;},ERROR_MSG_METHOD_NOT_IMPLEMENTED:function(){return ed;},ElementEvent:function(){return rX;},Ellipse:function(){return iP;},FederatedEvent:function(){return rD;},FederatedPointerEvent:function(){return rB;},Group:function(){return iN;},HTML:function(){return iI;},Image:function(){return iR;},Line:function(){return iz;},MutationEvent:function(){return r$;},Path:function(){return iU;},Polygon:function(){return ij;},Polyline:function(){return iG;},PropertySyntax:function(){return ej;},Rect:function(){return iH;},Shape:function(){return K;},Text:function(){return iZ;},convertToPath:function(){return nh;},createVec3:function(){return ev;},deg2rad:function(){return em;},getAngle:function(){return eh;},parseColor:function(){return tq;},propertyMetadataCache:function(){return nB;},rad2deg:function(){return eb;},runtime:function(){return ip;}});var r,i,a,o,s,l,u,c,d,f,h,p,v,g,m,y,b,_,x,w,E,M,S,k,C,A,L=n("777fffbe"),P=L._(n("daaa1548")),N=L._(n("1316cf9d")),O=L._(n("3d495adb")),I=L._(n("6c762716")),R=L._(n("66a06515")),D=L._(n("20defe2a")),z=L._(n("82f98358")),B=L._(n("e90c9dbd")),U=n("71293cfd");n("2b312dbf");var F=n("0d884ee9"),j=L._(n("d812e418")),V=L._(n("0389e1e1")),G=n("e1f276f6"),H=L._(n("83128d43")),W=L._(n("f89fb776")),Z=L._(n("d38f5467")),q=L._(n("b131ee44"));let Y=n("7b266b54");"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==Y||"undefined"!=typeof self&&self;var X={exports:{}};r=function(){function e(e,t,n){var r=e[t];e[t]=e[n],e[n]=r;}function t(e,t){return e<t?-1:e>t?1:0;}var n=function(e){void 0===e&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear();};function r(e,t){i(e,0,e.children.length,t,e);}function i(e,t,n,r,i){i||(i=f(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=t;o<n;o++){var s=e.children[o];a(i,e.leaf?r(s):s);}return i;}function a(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e;}function o(e,t){return e.minX-t.minX;}function s(e,t){return e.minY-t.minY;}function l(e){return(e.maxX-e.minX)*(e.maxY-e.minY);}function u(e){return e.maxX-e.minX+(e.maxY-e.minY);}function c(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY;}function d(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY;}function f(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};}function h(n,r,i,a,o){for(var s=[r,i];s.length;)if(!((i=s.pop())-(r=s.pop())<=a)){var l=r+Math.ceil((i-r)/a/2)*a;(function t(n,r,i,a,o){for(;a>i;){if(a-i>600){var s=a-i+1,l=r-i+1,u=Math.log(s),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1),f=Math.max(i,Math.floor(r-l*c/s+d)),h=Math.min(a,Math.floor(r+(s-l)*c/s+d));t(n,r,f,h,o);}var p=n[r],v=i,g=a;for(e(n,i,r),o(n[a],p)>0&&e(n,i,a);v<g;){for(e(n,v,g),v++,g--;0>o(n[v],p);)v++;for(;o(n[g],p)>0;)g--;}0===o(n[i],p)?e(n,i,g):e(n,++g,a),g<=r&&(i=g+1),r<=g&&(a=g-1);}})(n,l,r||0,i||n.length-1,o||t),s.push(r,l,l,i);}}return n.prototype.all=function(){return this._all(this.data,[]);},n.prototype.search=function(e){var t=this.data,n=[];if(!d(e,t))return n;for(var r=this.toBBox,i=[];t;){for(var a=0;a<t.children.length;a++){var o=t.children[a],s=t.leaf?r(o):o;d(e,s)&&(t.leaf?n.push(o):c(e,s)?this._all(o,n):i.push(o));}t=i.pop();}return n;},n.prototype.collides=function(e){var t=this.data;if(!d(e,t))return!1;for(var n=[];t;){for(var r=0;r<t.children.length;r++){var i=t.children[r],a=t.leaf?this.toBBox(i):i;if(d(e,a)){if(t.leaf||c(e,a))return!0;n.push(i);}}t=n.pop();}return!1;},n.prototype.load=function(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(var t=0;t<e.length;t++)this.insert(e[t]);return this;}var n=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length){if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r;}this._insert(n,this.data.height-n.height-1,!0);}}else this.data=n;return this;},n.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this;},n.prototype.clear=function(){return this.data=f([]),this;},n.prototype.remove=function(e,t){if(!e)return this;for(var n,r,i,a=this.data,o=this.toBBox(e),s=[],l=[];a||s.length;){if(a||(a=s.pop(),r=s[s.length-1],n=l.pop(),i=!0),a.leaf){var u=function(e,t,n){if(!n)return t.indexOf(e);for(var r=0;r<t.length;r++)if(n(e,t[r]))return r;return -1;}(e,a.children,t);if(-1!==u){a.children.splice(u,1),s.push(a),this._condense(s);break;}}!i&&!a.leaf&&c(a,o)?(s.push(a),l.push(n),n=0,r=a,a=a.children[0]):r?(n++,a=r.children[n],i=!1):a=null;}return this;},n.prototype.toBBox=function(e){return e;},n.prototype.compareMinX=function(e,t){return e.minX-t.minX;},n.prototype.compareMinY=function(e,t){return e.minY-t.minY;},n.prototype.toJSON=function(){return this.data;},n.prototype.fromJSON=function(e){return this.data=e,this;},n.prototype._all=function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t;},n.prototype._build=function(e,t,n,i){var a,o=n-t+1,s=this._maxEntries;if(o<=s)return r(a=f(e.slice(t,n+1)),this.toBBox),a;i||(i=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,i-1))),(a=f([])).leaf=!1,a.height=i;var l=Math.ceil(o/s),u=l*Math.ceil(Math.sqrt(s));h(e,t,n,u,this.compareMinX);for(var c=t;c<=n;c+=u){var d=Math.min(c+u-1,n);h(e,c,d,l,this.compareMinY);for(var p=c;p<=d;p+=l){var v=Math.min(p+l-1,d);a.children.push(this._build(e,p,v,i-1));}}return r(a,this.toBBox),a;},n.prototype._chooseSubtree=function(e,t,n,r){for(;r.push(t),!t.leaf&&r.length-1!==n;){for(var i=1/0,a=1/0,o=void 0,s=0;s<t.children.length;s++){var u=t.children[s],c=l(u),d=(Math.max(u.maxX,e.maxX)-Math.min(u.minX,e.minX))*(Math.max(u.maxY,e.maxY)-Math.min(u.minY,e.minY))-c;d<a?(a=d,i=c<i?c:i,o=u):d===a&&c<i&&(i=c,o=u);}t=o||t.children[0];}return t;},n.prototype._insert=function(e,t,n){var r=n?e:this.toBBox(e),i=[],o=this._chooseSubtree(r,this.data,t,i);for(o.children.push(e),a(o,r);t>=0;)if(i[t].children.length>this._maxEntries)this._split(i,t),t--;else break;this._adjustParentBBoxes(r,i,t);},n.prototype._split=function(e,t){var n=e[t],i=n.children.length,a=this._minEntries;this._chooseSplitAxis(n,a,i);var o=this._chooseSplitIndex(n,a,i),s=f(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,r(n,this.toBBox),r(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s);},n.prototype._splitRoot=function(e,t){this.data=f([e,t]),this.data.height=e.height+1,this.data.leaf=!1,r(this.data,this.toBBox);},n.prototype._chooseSplitIndex=function(e,t,n){for(var r,a=1/0,o=1/0,s=t;s<=n-t;s++){var u=i(e,0,s,this.toBBox),c=i(e,s,n,this.toBBox),d=function(e,t){var n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY);return Math.max(0,Math.min(e.maxX,t.maxX)-n)*Math.max(0,Math.min(e.maxY,t.maxY)-r);}(u,c),f=l(u)+l(c);d<a?(a=d,r=s,o=f<o?f:o):d===a&&f<o&&(o=f,r=s);}return r||n-t;},n.prototype._chooseSplitAxis=function(e,t,n){var r=e.leaf?this.compareMinX:o,i=e.leaf?this.compareMinY:s;this._allDistMargin(e,t,n,r)<this._allDistMargin(e,t,n,i)&&e.children.sort(r);},n.prototype._allDistMargin=function(e,t,n,r){e.children.sort(r);for(var o=this.toBBox,s=i(e,0,t,o),l=i(e,n-t,n,o),c=u(s)+u(l),d=t;d<n-t;d++){var f=e.children[d];a(s,e.leaf?o(f):f),c+=u(s);}for(var h=n-t-1;h>=t;h--){var p=e.children[h];a(l,e.leaf?o(p):p),c+=u(l);}return c;},n.prototype._adjustParentBBoxes=function(e,t,n){for(var r=n;r>=0;r--)a(t[r],e);},n.prototype._condense=function(e){for(var t=e.length-1,n=void 0;t>=0;t--)0===e[t].children.length?t>0?(n=e[t-1].children).splice(n.indexOf(e[t]),1):this.clear():r(e[t],this.toBBox);},n;},X.exports=r();var $=X.exports,K=((i={}).GROUP="g",i.FRAGMENT="fragment",i.CIRCLE="circle",i.ELLIPSE="ellipse",i.IMAGE="image",i.RECT="rect",i.LINE="line",i.POLYLINE="polyline",i.POLYGON="polygon",i.TEXT="text",i.PATH="path",i.HTML="html",i.MESH="mesh",i),Q=((a={})[a.ZERO=0]="ZERO",a[a.NEGATIVE_ONE=1]="NEGATIVE_ONE",a),J=U.vec3.add,ee=U.vec3.copy,et=U.vec3.max,en=U.vec3.min,er=U.vec3.scale,ei=U.vec3.sub,ea=function(){function e(){(0,N.default)(this,e),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0];}return(0,O.default)(e,[{key:"update",value:function(e,t){ee(this.center,e),ee(this.halfExtents,t),ei(this.min,this.center,this.halfExtents),J(this.max,this.center,this.halfExtents);}},{key:"setMinMax",value:function(e,t){J(this.center,t,e),er(this.center,this.center,.5),ei(this.halfExtents,t,e),er(this.halfExtents,this.halfExtents,.5),ee(this.min,e),ee(this.max,t);}},{key:"getMin",value:function(){return this.min;}},{key:"getMax",value:function(){return this.max;}},{key:"add",value:function(t){if(!e.isEmpty(t)){if(e.isEmpty(this)){this.setMinMax(t.getMin(),t.getMax());return;}var n=this.center,r=n[0],i=n[1],a=n[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],c=r-s,d=r+s,f=i-l,h=i+l,p=a-u,v=a+u,g=t.center,m=g[0],y=g[1],b=g[2],_=t.halfExtents,x=_[0],w=_[1],E=_[2],M=m-x,S=m+x,k=y-w,C=y+w,A=b-E,L=b+E;M<c&&(c=M),S>d&&(d=S),k<f&&(f=k),C>h&&(h=C),A<p&&(p=A),L>v&&(v=L),n[0]=(c+d)*.5,n[1]=(f+h)*.5,n[2]=(p+v)*.5,o[0]=(d-c)*.5,o[1]=(h-f)*.5,o[2]=(v-p)*.5,this.min[0]=c,this.min[1]=f,this.min[2]=p,this.max[0]=d,this.max[1]=h,this.max[2]=v;}}},{key:"setFromTransformedAABB",value:function(e,t){var n=this.center,r=this.halfExtents,i=e.center,a=e.halfExtents,o=t[0],s=t[4],l=t[8],u=t[1],c=t[5],d=t[9],f=t[2],h=t[6],p=t[10],v=Math.abs(o),g=Math.abs(s),m=Math.abs(l),y=Math.abs(u),b=Math.abs(c),_=Math.abs(d),x=Math.abs(f),w=Math.abs(h),E=Math.abs(p);n[0]=t[12]+o*i[0]+s*i[1]+l*i[2],n[1]=t[13]+u*i[0]+c*i[1]+d*i[2],n[2]=t[14]+f*i[0]+h*i[1]+p*i[2],r[0]=v*a[0]+g*a[1]+m*a[2],r[1]=y*a[0]+b*a[1]+_*a[2],r[2]=x*a[0]+w*a[1]+E*a[2],ei(this.min,n,r),J(this.max,n,r);}},{key:"intersects",value:function(e){var t=this.getMax(),n=this.getMin(),r=e.getMax(),i=e.getMin();return n[0]<=r[0]&&t[0]>=i[0]&&n[1]<=r[1]&&t[1]>=i[1]&&n[2]<=r[2]&&t[2]>=i[2];}},{key:"intersection",value:function(t){if(!this.intersects(t))return null;var n=new e,r=et([0,0,0],this.getMin(),t.getMin()),i=en([0,0,0],this.getMax(),t.getMax());return n.setMinMax(r,i),n;}},{key:"getNegativeFarPoint",value:function(e){return 273===e.pnVertexFlag?ee([0,0,0],this.min):272===e.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===e.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===e.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===e.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===e.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===e.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]];}},{key:"getPositiveFarPoint",value:function(e){return 273===e.pnVertexFlag?ee([0,0,0],this.max):272===e.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===e.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===e.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===e.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===e.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===e.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]];}}],[{key:"isEmpty",value:function(e){return!e||0===e.halfExtents[0]&&0===e.halfExtents[1]&&0===e.halfExtents[2];}}]);}(),eo=(0,O.default)(function e(t,n){(0,N.default)(this,e),this.distance=t||0,this.normal=n||U.vec3.fromValues(0,1,0),this.updatePNVertexFlag();},[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0);}},{key:"distanceToPoint",value:function(e){return U.vec3.dot(e,this.normal)-this.distance;}},{key:"normalize",value:function(){var e=1/U.vec3.len(this.normal);U.vec3.scale(this.normal,this.normal,e),this.distance*=e;}},{key:"intersectsLine",value:function(e,t,n){var r=this.distanceToPoint(e),i=r/(r-this.distanceToPoint(t)),a=i>=0&&i<=1;return a&&n&&U.vec3.lerp(n,e,t,i),a;}}]),es=((o={})[o.OUTSIDE=4294967295]="OUTSIDE",o[o.INSIDE=0]="INSIDE",o[o.INDETERMINATE=2147483647]="INDETERMINATE",o),el=(0,O.default)(function e(t){if((0,N.default)(this,e),this.planes=[],t)this.planes=t;else for(var n=0;n<6;n++)this.planes.push(new eo);},[{key:"extractFromVPMatrix",value:function(e){var t=(0,z.default)(e,16),n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],d=t[9],f=t[10],h=t[11],p=t[12],v=t[13],g=t[14],m=t[15];U.vec3.set(this.planes[0].normal,a-n,u-o,h-c),this.planes[0].distance=m-p,U.vec3.set(this.planes[1].normal,a+n,u+o,h+c),this.planes[1].distance=m+p,U.vec3.set(this.planes[2].normal,a+r,u+s,h+d),this.planes[2].distance=m+v,U.vec3.set(this.planes[3].normal,a-r,u-s,h-d),this.planes[3].distance=m-v,U.vec3.set(this.planes[4].normal,a-i,u-l,h-f),this.planes[4].distance=m-g,U.vec3.set(this.planes[5].normal,a+i,u+l,h+f),this.planes[5].distance=m+g,this.planes.forEach(function(e){e.normalize(),e.updatePNVertexFlag();});}}]),eu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,N.default)(this,e),this.x=0,this.y=0,this.x=t,this.y=n;}return(0,O.default)(e,[{key:"clone",value:function(){return new e(this.x,this.y);}},{key:"copyFrom",value:function(e){this.x=e.x,this.y=e.y;}}]);}(),ec=function(){function e(t,n,r,i){(0,N.default)(this,e),this.x=t,this.y=n,this.width=r,this.height=i,this.left=t,this.right=t+r,this.top=n,this.bottom=n+i;}return(0,O.default)(e,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(t){return new e(t.x,t.y,t.width,t.height);}},{key:"applyTransform",value:function(t,n){var r=U.vec4.fromValues(t.x,t.y,0,1),i=U.vec4.fromValues(t.x+t.width,t.y,0,1),a=U.vec4.fromValues(t.x,t.y+t.height,0,1),o=U.vec4.fromValues(t.x+t.width,t.y+t.height,0,1),s=U.vec4.create(),l=U.vec4.create(),u=U.vec4.create(),c=U.vec4.create();U.vec4.transformMat4(s,r,n),U.vec4.transformMat4(l,i,n),U.vec4.transformMat4(u,a,n),U.vec4.transformMat4(c,o,n);var d=Math.min(s[0],l[0],u[0],c[0]),f=Math.min(s[1],l[1],u[1],c[1]),h=Math.max(s[0],l[0],u[0],c[0]),p=Math.max(s[1],l[1],u[1],c[1]);return e.fromRect({x:d,y:f,width:h-d,height:p-f});}}]);}(),ed="Method not implemented.",ef="Use document.documentElement instead.";function eh(e){return void 0===e?0:e>360||e<-360?e%360:e;}var ep=U.vec3.create();function ev(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return Array.isArray(e)&&3===e.length?r?U.vec3.clone(e):U.vec3.copy(ep,e):(0,F.isNumber)(e)?r?U.vec3.fromValues(e,t,n):U.vec3.set(ep,e,t,n):r?U.vec3.fromValues(e[0],e[1]||t,e[2]||n):U.vec3.set(ep,e[0],e[1]||t,e[2]||n);}var eg=Math.PI/180;function em(e){return e*eg;}var ey=180/Math.PI;function eb(e){return e*ey;}var e_=Math.PI/2;function ex(e,t){var n,r,i,a,o,s,l,u,c,d,f,h,p,v,g,m,y;return 16===t.length?(i=U.mat4.getScaling(U.vec3.create(),t),o=(a=(0,z.default)(i,3))[0],s=a[1],l=a[2],(u=Math.asin(-t[2]/o))<e_?u>-e_?(n=Math.atan2(t[6]/s,t[10]/l),r=Math.atan2(t[1]/o,t[0]/o)):(r=0,n=-Math.atan2(t[4]/s,t[5]/s)):(r=0,n=Math.atan2(t[4]/s,t[5]/s)),e[0]=n,e[1]=u,e[2]=r):(c=t[0],d=t[1],f=t[2],h=t[3],m=c*c+(p=d*d)+(v=f*f)+(g=h*h),(y=c*h-d*f)>.499995*m?(e[0]=e_,e[1]=2*Math.atan2(d,c),e[2]=0):y<-.499995*m?(e[0]=-e_,e[1]=2*Math.atan2(d,c),e[2]=0):(e[0]=Math.asin(2*(c*f-h*d)),e[1]=Math.atan2(2*(c*h+d*f),1-2*(v+g)),e[2]=Math.atan2(2*(c*d+f*h),1-2*(p+v)))),e;}function ew(e){var t=e[0],n=e[1],r=e[3],i=e[4],a=Math.sqrt(t*t+n*n),o=Math.sqrt(r*r+i*i);if(t*i-n*r<0&&(t<i?a=-a:o=-o),a){var s=1/a;t*=s,n*=s;}if(o){var l=1/o;r*=l,i*=l;}var u=Math.atan2(n,t)*ey;return[e[6],e[7],a,o,u];}var eE=U.mat4.create(),eM=U.mat4.create(),eT=U.vec4.create(),eS=[U.vec3.create(),U.vec3.create(),U.vec3.create()],ek=U.vec3.create();function eC(e,t,n,r,i){e[0]=t[0]*r+n[0]*i,e[1]=t[1]*r+n[1]*i,e[2]=t[2]*r+n[2]*i;}var eA=((s={})[s.ORBITING=0]="ORBITING",s[s.EXPLORING=1]="EXPLORING",s[s.TRACKING=2]="TRACKING",s),eL=((l={})[l.DEFAULT=0]="DEFAULT",l[l.ROTATIONAL=1]="ROTATIONAL",l[l.TRANSLATIONAL=2]="TRANSLATIONAL",l[l.CINEMATIC=3]="CINEMATIC",l),eP=((u={})[u.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",u[u.PERSPECTIVE=1]="PERSPECTIVE",u),eN={UPDATED:"updated"},eO=(0,O.default)(function e(){(0,N.default)(this,e),this.clipSpaceNearZ=Q.NEGATIVE_ONE,this.eventEmitter=new B.default,this.matrix=U.mat4.create(),this.right=U.vec3.fromValues(1,0,0),this.up=U.vec3.fromValues(0,1,0),this.forward=U.vec3.fromValues(0,0,1),this.position=U.vec3.fromValues(0,0,1),this.focalPoint=U.vec3.fromValues(0,0,0),this.distanceVector=U.vec3.fromValues(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=U.mat4.create(),this.projectionMatrixInverse=U.mat4.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=eA.EXPLORING,this.trackingMode=eL.DEFAULT,this.projectionMode=eP.PERSPECTIVE,this.frustum=new el,this.orthoMatrix=U.mat4.create();},[{key:"isOrtho",value:function(){return this.projectionMode===eP.ORTHOGRAPHIC;}},{key:"getProjectionMode",value:function(){return this.projectionMode;}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix;}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse;}},{key:"getFrustum",value:function(){return this.frustum;}},{key:"getPosition",value:function(){return this.position;}},{key:"getFocalPoint",value:function(){return this.focalPoint;}},{key:"getDollyingStep",value:function(){return this.dollyingStep;}},{key:"getNear",value:function(){return this.near;}},{key:"getFar",value:function(){return this.far;}},{key:"getZoom",value:function(){return this.zoom;}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix;}},{key:"getView",value:function(){return this.view;}},{key:"setEnableUpdate",value:function(e){this.enableUpdate=e;}},{key:"setType",value:function(e,t){return this.type=e,this.type===eA.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===eA.TRACKING&&void 0!==t&&this.setTrackingMode(t),this;}},{key:"setProjectionMode",value:function(e){return this.projectionMode=e,this;}},{key:"setTrackingMode",value:function(e){if(this.type!==eA.TRACKING)throw Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=e,this;}},{key:"setWorldRotation",value:function(e){return this.rotateWorld=e,this._getAngles(),this;}},{key:"getViewTransform",value:function(){return U.mat4.invert(U.mat4.create(),this.matrix);}},{key:"getWorldTransform",value:function(){return this.matrix;}},{key:"jitterProjectionMatrix",value:function(e,t){var n=U.mat4.fromTranslation(U.mat4.create(),[e,t,0]);this.jitteredProjectionMatrix=U.mat4.multiply(U.mat4.create(),n,this.projectionMatrix);}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0;}},{key:"setMatrix",value:function(e){return this.matrix=e,this._update(),this;}},{key:"setProjectionMatrix",value:function(e){this.projectionMatrix=e;}},{key:"setFov",value:function(e){return this.setPerspective(this.near,this.far,e,this.aspect),this;}},{key:"setAspect",value:function(e){return this.setPerspective(this.near,this.far,this.fov,e),this;}},{key:"setNear",value:function(e){return this.projectionMode===eP.PERSPECTIVE?this.setPerspective(e,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,e,this.far),this;}},{key:"setFar",value:function(e){return this.projectionMode===eP.PERSPECTIVE?this.setPerspective(this.near,e,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,e),this;}},{key:"setViewOffset",value:function(e,t,n,r,i,a){return this.aspect=e/t,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.projectionMode===eP.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===eP.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"setZoom",value:function(e){return this.zoom=e,this.projectionMode===eP.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===eP.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this;}},{key:"setZoomByViewportPoint",value:function(e,t){var n=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),r=n.x,i=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(r,i),this.setFocalPoint(r,i),this.setZoom(e),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),s=o.x,l=o.y,u=U.vec3.fromValues(s-r,l-i,0),c=U.vec3.dot(u,this.right)/U.vec3.length(this.right),d=U.vec3.dot(u,this.up)/U.vec3.length(this.up),f=this.getPosition(),h=(0,z.default)(f,2),p=h[0],v=h[1],g=this.getFocalPoint(),m=(0,z.default)(g,2),y=m[0],b=m[1];return this.setPosition(p-c,v-d),this.setFocalPoint(y-c,b-d),this;}},{key:"setPerspective",value:function(e,t,n,r){this.projectionMode=eP.PERSPECTIVE,this.fov=n,this.near=e,this.far=t,this.aspect=r;var i,a=this.near*Math.tan(.5*this.fov*eg)/this.zoom,o=2*a,s=this.aspect*o,l=-.5*s;if(null!==(i=this.view)&&void 0!==i&&i.enabled){var u=this.view.fullWidth,c=this.view.fullHeight;l+=this.view.offsetX*s/u,a-=this.view.offsetY*o/c,s*=this.view.width/u,o*=this.view.height/c;}return!function(e,t,n,r,i,a,o){var s,l,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=2*a,d=n-t,f=r-i,h=o-a,p=o*a;u?(s=-o/h,l=-p/h):(s=-(o+a)/h,l=-2*p/h),e[0]=c/d,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c/f,e[6]=0,e[7]=0,e[8]=(n+t)/d,e[9]=(r+i)/f,e[10]=s,e[11]=-1,e[12]=0,e[13]=0,e[14]=l,e[15]=0;}(this.projectionMatrix,l,l+s,a-o,a,e,this.far,this.clipSpaceNearZ===Q.ZERO),U.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this;}},{key:"setOrthographic",value:function(e,t,n,r,i,a){this.projectionMode=eP.ORTHOGRAPHIC,this.rright=t,this.left=e,this.top=n,this.bottom=r,this.near=i,this.far=a;var o,s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,d=u-s,f=u+s,h=c+l,p=c-l;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var v=(this.rright-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d+=v*this.view.offsetX,f=d+v*this.view.width,h-=g*this.view.offsetY,p=h-g*this.view.height;}return this.clipSpaceNearZ===Q.NEGATIVE_ONE?U.mat4.ortho(this.projectionMatrix,d,f,h,p,i,a):U.mat4.orthoZO(this.projectionMatrix,d,f,h,p,i,a),U.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this;}},{key:"setPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2],r=ev(e,t,n);return this._setPosition(r),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this;}},{key:"setFocalPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],r=U.vec3.fromValues(0,1,0);if(this.focalPoint=ev(e,t,n),this.trackingMode===eL.CINEMATIC){var i=U.vec3.subtract(U.vec3.create(),this.focalPoint,this.position);e=i[0],t=i[1],n=i[2];var a=Math.asin(t/U.vec3.length(i))*ey,o=90+Math.atan2(n,e)*ey,s=U.mat4.create();U.mat4.rotateY(s,s,o*eg),U.mat4.rotateX(s,s,a*eg),r=U.vec3.transformMat4(U.vec3.create(),[0,1,0],s);}return U.mat4.invert(this.matrix,U.mat4.lookAt(U.mat4.create(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this;}},{key:"getDistance",value:function(){return this.distance;}},{key:"getDistanceVector",value:function(){return this.distanceVector;}},{key:"setDistance",value:function(e){if(this.distance===e||e<0)return this;this.distance=e,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var t=U.vec3.create();e=this.distance;var n=this.forward,r=this.focalPoint;return t[0]=e*n[0]+r[0],t[1]=e*n[1]+r[1],t[2]=e*n[2]+r[2],this._setPosition(t),this.triggerUpdate(),this;}},{key:"setMaxDistance",value:function(e){return this.maxDistance=e,this;}},{key:"setMinDistance",value:function(e){return this.minDistance=e,this;}},{key:"setAzimuth",value:function(e){return this.azimuth=eh(e),this.computeMatrix(),this._getAxes(),this.type===eA.ORBITING||this.type===eA.EXPLORING?this._getPosition():this.type===eA.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getAzimuth",value:function(){return this.azimuth;}},{key:"setElevation",value:function(e){return this.elevation=eh(e),this.computeMatrix(),this._getAxes(),this.type===eA.ORBITING||this.type===eA.EXPLORING?this._getPosition():this.type===eA.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getElevation",value:function(){return this.elevation;}},{key:"setRoll",value:function(e){return this.roll=eh(e),this.computeMatrix(),this._getAxes(),this.type===eA.ORBITING||this.type===eA.EXPLORING?this._getPosition():this.type===eA.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getRoll",value:function(){return this.roll;}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate();}},{key:"computeMatrix",value:function(){var e=U.quat.setAxisAngle(U.quat.create(),[0,0,1],this.roll*eg);U.mat4.identity(this.matrix);var t=U.quat.setAxisAngle(U.quat.create(),[1,0,0],(this.rotateWorld&&this.type!==eA.TRACKING||this.type===eA.TRACKING?1:-1)*this.elevation*eg),n=U.quat.setAxisAngle(U.quat.create(),[0,1,0],(this.rotateWorld&&this.type!==eA.TRACKING||this.type===eA.TRACKING?1:-1)*this.azimuth*eg),r=U.quat.multiply(U.quat.create(),n,t);r=U.quat.multiply(U.quat.create(),r,e);var i=U.mat4.fromQuat(U.mat4.create(),r);this.type===eA.ORBITING||this.type===eA.EXPLORING?(U.mat4.translate(this.matrix,this.matrix,this.focalPoint),U.mat4.multiply(this.matrix,this.matrix,i),U.mat4.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===eA.TRACKING&&(U.mat4.translate(this.matrix,this.matrix,this.position),U.mat4.multiply(this.matrix,this.matrix,i));}},{key:"_setPosition",value:function(e,t,n){this.position=ev(e,t,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix();}},{key:"_getAxes",value:function(){U.vec3.copy(this.right,ev(U.vec4.transformMat4(U.vec4.create(),[1,0,0,0],this.matrix))),U.vec3.copy(this.up,ev(U.vec4.transformMat4(U.vec4.create(),[0,1,0,0],this.matrix))),U.vec3.copy(this.forward,ev(U.vec4.transformMat4(U.vec4.create(),[0,0,1,0],this.matrix))),U.vec3.normalize(this.right,this.right),U.vec3.normalize(this.up,this.up),U.vec3.normalize(this.forward,this.forward);}},{key:"_getAngles",value:function(){var e=this.distanceVector[0],t=this.distanceVector[1],n=this.distanceVector[2],r=U.vec3.length(this.distanceVector);if(0===r){this.elevation=0,this.azimuth=0;return;}this.type===eA.TRACKING?(this.elevation=Math.asin(t/r)*ey,this.azimuth=Math.atan2(-e,-n)*ey):this.rotateWorld?(this.elevation=Math.asin(t/r)*ey,this.azimuth=Math.atan2(-e,-n)*ey):(this.elevation=-(Math.asin(t/r)*ey),this.azimuth=-(Math.atan2(-e,-n)*ey));}},{key:"_getPosition",value:function(){U.vec3.copy(this.position,ev(U.vec4.transformMat4(U.vec4.create(),[0,0,0,1],this.matrix))),this._getDistance();}},{key:"_getFocalPoint",value:function(){U.vec3.transformMat3(this.distanceVector,[0,0,-this.distance],U.mat3.fromMat4(U.mat3.create(),this.matrix)),U.vec3.add(this.focalPoint,this.position,this.distanceVector),this._getDistance();}},{key:"_getDistance",value:function(){this.distanceVector=U.vec3.subtract(U.vec3.create(),this.focalPoint,this.position),this.distance=U.vec3.length(this.distanceVector),this.dollyingStep=this.distance/100;}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===eP.ORTHOGRAPHIC){var e=this.position,t=U.quat.setAxisAngle(U.quat.create(),[0,0,1],-this.roll*Math.PI/180);U.mat4.fromRotationTranslationScaleOrigin(this.orthoMatrix,t,U.vec3.fromValues((this.rright-this.left)/2-e[0],(this.top-this.bottom)/2-e[1],0),U.vec3.fromValues(this.zoom,this.zoom,1),e);}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var e=this.getViewTransform(),t=U.mat4.multiply(U.mat4.create(),this.getPerspective(),e);this.getFrustum().extractFromVPMatrix(t),this.eventEmitter.emit(eN.UPDATED);}}},{key:"rotate",value:function(e,t,n){throw Error(ed);}},{key:"pan",value:function(e,t){throw Error(ed);}},{key:"dolly",value:function(e){throw Error(ed);}},{key:"createLandmark",value:function(e,t){throw Error(ed);}},{key:"gotoLandmark",value:function(e,t){throw Error(ed);}},{key:"cancelLandmarkAnimation",value:function(){throw Error(ed);}}]),eI=((c={})[c.Standard=0]="Standard",c),eR=((d={})[d.ADDED=0]="ADDED",d[d.REMOVED=1]="REMOVED",d[d.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",d),eD=U.vec3.create(),ez=U.mat4.create(),eB=U.quat.create();function eU(e){if(e.localDirtyFlag){if(0!==e.localSkew[0]||0!==e.localSkew[1]){U.mat4.fromRotationTranslationScaleOrigin(e.localTransform,e.localRotation,e.localPosition,U.vec3.fromValues(1,1,1),e.origin),(0!==e.localSkew[0]||0!==e.localSkew[1])&&(U.mat4.identity(ez),ez[4]=Math.tan(e.localSkew[0]),ez[1]=Math.tan(e.localSkew[1]),U.mat4.multiply(e.localTransform,e.localTransform,ez));var t=U.mat4.fromRotationTranslationScaleOrigin(ez,U.quat.set(eB,0,0,0,1),U.vec3.set(eD,1,1,1),e.localScale,e.origin);U.mat4.multiply(e.localTransform,e.localTransform,t);}else{var n=e.localTransform,r=e.localPosition,i=e.localRotation,a=e.localScale,o=e.origin,s=0!==r[0]||0!==r[1]||0!==r[2],l=1!==i[3]||0!==i[0]||0!==i[1]||0!==i[2],u=1!==a[0]||1!==a[1]||1!==a[2],c=0!==o[0]||0!==o[1]||0!==o[2];l||u||c?U.mat4.fromRotationTranslationScaleOrigin(n,i,r,a,o):s?U.mat4.fromTranslation(n,r):U.mat4.identity(n);}e.localDirtyFlag=!1;}}var eF={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new ec(0,0,0,0)},ej=((f={}).COORDINATE="<coordinate>",f.COLOR="<color>",f.PAINT="<paint>",f.NUMBER="<number>",f.ANGLE="<angle>",f.OPACITY_VALUE="<opacity-value>",f.SHADOW_BLUR="<shadow-blur>",f.LENGTH="<length>",f.PERCENTAGE="<percentage>",f.LENGTH_PERCENTAGE="<length> | <percentage>",f.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",f.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",f.LIST_OF_POINTS="<list-of-points>",f.PATH="<path>",f.FILTER="<filter>",f.Z_INDEX="<z-index>",f.OFFSET_DISTANCE="<offset-distance>",f.DEFINED_PATH="<defined-path>",f.MARKER="<marker>",f.TRANSFORM="<transform>",f.TRANSFORM_ORIGIN="<transform-origin>",f.TEXT="<text>",f.TEXT_TRANSFORM="<text-transform>",f);function eV(e,t,n){e.prototype=t.prototype=n,n.constructor=e;}function eG(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n;}function eH(){}var eW="\\s*([+-]?\\d+)\\s*",eZ="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",eq="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",eY=/^#([0-9a-f]{3,8})$/,eX=RegExp(`^rgb\\(${eW},${eW},${eW}\\)$`),e$=RegExp(`^rgb\\(${eq},${eq},${eq}\\)$`),eK=RegExp(`^rgba\\(${eW},${eW},${eW},${eZ}\\)$`),eQ=RegExp(`^rgba\\(${eq},${eq},${eq},${eZ}\\)$`),eJ=RegExp(`^hsl\\(${eZ},${eq},${eq}\\)$`),e0=RegExp(`^hsla\\(${eZ},${eq},${eq},${eZ}\\)$`),e1={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function e2(){return this.rgb().formatHex();}function e3(){return this.rgb().formatRgb();}function e5(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=eY.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?e4(t):3===n?new e6(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?e7(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?e7(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=eX.exec(e))?new e6(t[1],t[2],t[3],1):(t=e$.exec(e))?new e6(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=eK.exec(e))?e7(t[1],t[2],t[3],t[4]):(t=eQ.exec(e))?e7(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=eJ.exec(e))?tr(t[1],t[2]/100,t[3]/100,1):(t=e0.exec(e))?tr(t[1],t[2]/100,t[3]/100,t[4]):e1.hasOwnProperty(e)?e4(e1[e]):"transparent"===e?new e6(NaN,NaN,NaN,0):null;}function e4(e){return new e6(e>>16&255,e>>8&255,255&e,1);}function e7(e,t,n,r){return r<=0&&(e=t=n=NaN),new e6(e,t,n,r);}function e6(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r;}function e8(){return`#${tn(this.r)}${tn(this.g)}${tn(this.b)}`;}function e9(){let e=te(this.opacity);return`${1===e?"rgb(":"rgba("}${tt(this.r)}, ${tt(this.g)}, ${tt(this.b)}${1===e?")":`, ${e})`}`;}function te(e){return isNaN(e)?1:Math.max(0,Math.min(1,e));}function tt(e){return Math.max(0,Math.min(255,Math.round(e)||0));}function tn(e){return((e=tt(e))<16?"0":"")+e.toString(16);}function tr(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ta(e,t,n,r);}function ti(e){if(e instanceof ta)return new ta(e.h,e.s,e.l,e.opacity);if(e instanceof eH||(e=e5(e)),!e)return new ta;if(e instanceof ta)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=t===a?(n-r)/s+(n<r)*6:n===a?(r-t)/s+2:(t-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new ta(o,s,l,e.opacity);}function ta(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r;}function to(e){return(e=(e||0)%360)<0?e+360:e;}function ts(e){return Math.max(0,Math.min(1,e||0));}function tl(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255;}function tu(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw TypeError("Expected a function");var n=function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=t?t.apply(this,i):i[0],s=n.cache;if(s.has(o))return s.get(o);var l=e.apply(this,i);return n.cache=s.set(o,l)||s,l;};return n.cache=new(tu.Cache||Map),tu.cacheList.push(n.cache),n;}eV(eH,e5,{copy(e){return Object.assign(new this.constructor,this,e);},displayable(){return this.rgb().displayable();},hex:e2,formatHex:e2,formatHex8:function(){return this.rgb().formatHex8();},formatHsl:function(){return ti(this).formatHsl();},formatRgb:e3,toString:e3}),eV(e6,function(e,t,n,r){var i;return 1==arguments.length?((i=e)instanceof eH||(i=e5(i)),i)?new e6((i=i.rgb()).r,i.g,i.b,i.opacity):new e6:new e6(e,t,n,null==r?1:r);},eG(eH,{brighter(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new e6(this.r*e,this.g*e,this.b*e,this.opacity);},darker(e){return e=null==e?.7:Math.pow(.7,e),new e6(this.r*e,this.g*e,this.b*e,this.opacity);},rgb(){return this;},clamp(){return new e6(tt(this.r),tt(this.g),tt(this.b),te(this.opacity));},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1;},hex:e8,formatHex:e8,formatHex8:function(){return`#${tn(this.r)}${tn(this.g)}${tn(this.b)}${tn((isNaN(this.opacity)?1:this.opacity)*255)}`;},formatRgb:e9,toString:e9})),eV(ta,function(e,t,n,r){return 1==arguments.length?ti(e):new ta(e,t,n,null==r?1:r);},eG(eH,{brighter(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new ta(this.h,this.s,this.l*e,this.opacity);},darker(e){return e=null==e?.7:Math.pow(.7,e),new ta(this.h,this.s,this.l*e,this.opacity);},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new e6(tl(e>=240?e-240:e+120,i,r),tl(e,i,r),tl(e<120?e+240:e-120,i,r),this.opacity);},clamp(){return new ta(to(this.h),ts(this.s),ts(this.l),te(this.opacity));},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1;},formatHsl(){let e=te(this.opacity);return`${1===e?"hsl(":"hsla("}${to(this.h)}, ${100*ts(this.s)}%, ${100*ts(this.l)}%${1===e?")":`, ${e})`}`;}})),tu.Cache=Map,tu.cacheList=[],tu.clearCache=function(){tu.cacheList.forEach(function(e){return e.clear();});};var tc=((h={})[h.kUnknown=0]="kUnknown",h[h.kNumber=1]="kNumber",h[h.kPercentage=2]="kPercentage",h[h.kEms=3]="kEms",h[h.kPixels=4]="kPixels",h[h.kRems=5]="kRems",h[h.kDegrees=6]="kDegrees",h[h.kRadians=7]="kRadians",h[h.kGradians=8]="kGradians",h[h.kTurns=9]="kTurns",h[h.kMilliseconds=10]="kMilliseconds",h[h.kSeconds=11]="kSeconds",h[h.kInteger=12]="kInteger",h),td=((p={})[p.kUNumber=0]="kUNumber",p[p.kUPercent=1]="kUPercent",p[p.kULength=2]="kULength",p[p.kUAngle=3]="kUAngle",p[p.kUTime=4]="kUTime",p[p.kUOther=5]="kUOther",p),tf=((v={})[v.kYes=0]="kYes",v[v.kNo=1]="kNo",v),th=((g={})[g.kYes=0]="kYes",g[g.kNo=1]="kNo",g),tp=[{name:"em",unit_type:tc.kEms},{name:"px",unit_type:tc.kPixels},{name:"deg",unit_type:tc.kDegrees},{name:"rad",unit_type:tc.kRadians},{name:"grad",unit_type:tc.kGradians},{name:"ms",unit_type:tc.kMilliseconds},{name:"s",unit_type:tc.kSeconds},{name:"rem",unit_type:tc.kRems},{name:"turn",unit_type:tc.kTurns}],tv=((m={})[m.kUnknownType=0]="kUnknownType",m[m.kUnparsedType=1]="kUnparsedType",m[m.kKeywordType=2]="kKeywordType",m[m.kUnitType=3]="kUnitType",m[m.kSumType=4]="kSumType",m[m.kProductType=5]="kProductType",m[m.kNegateType=6]="kNegateType",m[m.kInvertType=7]="kInvertType",m[m.kMinType=8]="kMinType",m[m.kMaxType=9]="kMaxType",m[m.kClampType=10]="kClampType",m[m.kTransformType=11]="kTransformType",m[m.kPositionType=12]="kPositionType",m[m.kURLImageType=13]="kURLImageType",m[m.kColorType=14]="kColorType",m[m.kUnsupportedColorType=15]="kUnsupportedColorType",m),tg=function(e){switch(e){case tc.kNumber:case tc.kInteger:return td.kUNumber;case tc.kPercentage:return td.kUPercent;case tc.kPixels:return td.kULength;case tc.kMilliseconds:case tc.kSeconds:return td.kUTime;case tc.kDegrees:case tc.kRadians:case tc.kGradians:case tc.kTurns:return td.kUAngle;default:return td.kUOther;}},tm=function(e){switch(e){case td.kUNumber:return tc.kNumber;case td.kULength:return tc.kPixels;case td.kUPercent:return tc.kPercentage;case td.kUTime:return tc.kSeconds;case td.kUAngle:return tc.kDegrees;default:return tc.kUnknown;}},ty=function(e){var t=1;switch(e){case tc.kPixels:case tc.kDegrees:case tc.kSeconds:break;case tc.kMilliseconds:t=.001;break;case tc.kRadians:t=180/Math.PI;break;case tc.kGradians:t=.9;break;case tc.kTurns:t=360;}return t;},tb=function(e){switch(e){case tc.kNumber:case tc.kInteger:break;case tc.kPercentage:return"%";case tc.kEms:return"em";case tc.kRems:return"rem";case tc.kPixels:return"px";case tc.kDegrees:return"deg";case tc.kRadians:return"rad";case tc.kGradians:return"grad";case tc.kMilliseconds:return"ms";case tc.kSeconds:return"s";case tc.kTurns:return"turn";}return"";},t_=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"toString",value:function(){return this.buildCSSText(tf.kNo,th.kNo,"");}},{key:"isNumericValue",value:function(){return this.getType()>=tv.kUnitType&&this.getType()<=tv.kClampType;}}],[{key:"isAngle",value:function(e){return e===tc.kDegrees||e===tc.kRadians||e===tc.kGradians||e===tc.kTurns;}},{key:"isLength",value:function(e){return e>=tc.kEms&&e<tc.kDegrees;}},{key:"isRelativeUnit",value:function(e){return e===tc.kPercentage||e===tc.kEms||e===tc.kRems;}},{key:"isTime",value:function(e){return e===tc.kSeconds||e===tc.kMilliseconds;}}]),tx=function(e){function t(e){var n;return(0,N.default)(this,t),(n=(0,R.default)(this,t)).colorSpace=e,n;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"getType",value:function(){return tv.kColorType;}},{key:"to",value:function(e){return this;}}]);}(t_),tw=((y={})[y.Constant=0]="Constant",y[y.LinearGradient=1]="LinearGradient",y[y.RadialGradient=2]="RadialGradient",y),tE=function(e){function t(e,n){var r;return(0,N.default)(this,t),(r=(0,R.default)(this,t)).type=e,r.value=n,r;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"clone",value:function(){return new t(this.type,this.value);}},{key:"buildCSSText",value:function(e,t,n){return n;}},{key:"getType",value:function(){return tv.kColorType;}}]);}(t_),tM=function(e){function t(e){var n;return(0,N.default)(this,t),(n=(0,R.default)(this,t)).value=e,n;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"clone",value:function(){return new t(this.value);}},{key:"getType",value:function(){return tv.kKeywordType;}},{key:"buildCSSText",value:function(e,t,n){return n+this.value;}}]);}(t_),tT=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(e)?"NaN":e>0?"infinity":"-infinity")+t;},tS=function(e){return tm(tg(e));},tk=function(e){function t(e){var n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tc.kNumber;return(0,N.default)(this,t),r=(0,R.default)(this,t),i="string"==typeof a?(n=a)?"number"===n?tc.kNumber:"percent"===n||"%"===n?tc.kPercentage:tp.find(function(e){return e.name===n;}).unit_type:tc.kUnknown:a,r.unit=i,r.value=e,r;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"clone",value:function(){return new t(this.value,this.unit);}},{key:"equals",value:function(e){return this.value===e.value&&this.unit===e.unit;}},{key:"getType",value:function(){return tv.kUnitType;}},{key:"convertTo",value:function(e){if(this.unit===e)return new t(this.value,this.unit);var n=tS(this.unit);if(n!==tS(e)||n===tc.kUnknown)return null;var r=ty(this.unit)/ty(e);return new t(this.value*r,e);}},{key:"buildCSSText",value:function(e,t,n){var r;switch(this.unit){case tc.kUnknown:break;case tc.kInteger:r=Number(this.value).toFixed(0);break;case tc.kNumber:case tc.kPercentage:case tc.kEms:case tc.kRems:case tc.kPixels:case tc.kDegrees:case tc.kRadians:case tc.kGradians:case tc.kMilliseconds:case tc.kSeconds:case tc.kTurns:var i=this.value,a=tb(this.unit);if(i<-999999||i>999999){var o=tb(this.unit);r=!Number.isFinite(i)||Number.isNaN(i)?tT(i,o):i+(o||"");}else r="".concat(i).concat(a);}return n+r;}}]);}(t_),tC=new tk(0,"px");new tk(1,"px");var tA=new tk(0,"deg"),tL=function(e){function t(e,n,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(0,N.default)(this,t),(i=(0,R.default)(this,t,["rgb"])).r=e,i.g=n,i.b=r,i.alpha=a,i.isNone=o,i;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"clone",value:function(){return new t(this.r,this.g,this.b,this.alpha);}},{key:"buildCSSText",value:function(e,t,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")");}}]);}(tx),tP=new tM("unset"),tN={"":tP,unset:tP,initial:new tM("initial"),inherit:new tM("inherit")},tO=new tL(0,0,0,0,!0),tI=new tL(0,0,0,0),tR=tu(function(e,t,n,r){return new tL(e,t,n,r);},function(e,t,n,r){return"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(r,")");}),tD=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tc.kNumber;return new tk(e,t);};new tk(50,"%");var tz=function(){var e={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},t="";function n(e){throw Error("".concat(t,": ").concat(e));}function r(){return i("linear-gradient",e.linearGradient,o)||i("repeating-linear-gradient",e.repeatingLinearGradient,o)||i("radial-gradient",e.radialGradient,s)||i("repeating-radial-gradient",e.repeatingRadialGradient,s)||i("conic-gradient",e.conicGradient,s);}function i(t,r,i){return a(r,function(r){var a=i();return a&&!y(e.comma)&&n("Missing comma before color stops"),{type:t,orientation:a,colorStops:f(h)};});}function a(t,r){var i=y(t);if(i){y(e.startCall)||n("Missing (");var a=r(i);return y(e.endCall)||n("Missing )"),a;}}function o(){return m("directional",e.sideOrCorner,1)||m("angular",e.angleValue,1);}function s(){var n,r,i=l();return i&&((n=[]).push(i),r=t,y(e.comma)&&((i=l())?n.push(i):t=r)),n;}function l(){var e,t,n=((e=m("shape",/^(circle)/i,0))&&(e.style=g()||u()),e||((t=m("shape",/^(ellipse)/i,0))&&(t.style=v()||u()),t));if(n)n.at=c();else{var r=u();if(r){n=r;var i=c();i&&(n.at=i);}else{var a=d();a&&(n={type:"default-radial",at:a});}}return n;}function u(){return m("extent-keyword",e.extentKeywords,1);}function c(){if(m("position",/^at/,0)){var e=d();return e||n("Missing positioning value"),e;}}function d(){var e={x:v(),y:v()};if(e.x||e.y)return{type:"position",value:e};}function f(t){var r=t(),i=[];if(r)for(i.push(r);y(e.comma);)(r=t())?i.push(r):n("One extra comma");return i;}function h(){var t=m("hex",e.hexColor,1)||a(e.rgbaColor,function(){return{type:"rgba",value:f(p)};})||a(e.rgbColor,function(){return{type:"rgb",value:f(p)};})||m("literal",e.literalColor,0);return t||n("Expected color definition"),t.length=v(),t;}function p(){return y(e.number)[1];}function v(){return m("%",e.percentageValue,1)||m("position-keyword",e.positionKeywords,1)||g();}function g(){return m("px",e.pixelValue,1)||m("em",e.emValue,1);}function m(e,t,n){var r=y(t);if(r)return{type:e,value:r[n]};}function y(e){var n=/^[\n\r\t\s]+/.exec(t);n&&b(n[0].length);var r=e.exec(t);return r&&b(r[0].length),r;}function b(e){t=t.substring(e);}return function(e){var i;return t=e,i=f(r),t.length>0&&n("Invalid input not EOF"),i;};}(),tB=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,tU=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,tF=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,tj=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,tV={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},tG=tu(function(e){return tD("angular"===e.type?Number(e.value):tV[e.value]||0,"deg");}),tH=tu(function(e){var t=50,n=50,r="%",i="%";if((null==e?void 0:e.type)==="position"){var a=e.value,o=a.x,s=a.y;(null==o?void 0:o.type)==="position-keyword"&&("left"===o.value?t=0:"center"===o.value?t=50:"right"===o.value?t=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),(null==s?void 0:s.type)==="position-keyword"&&("left"===s.value?t=0:"center"===s.value?n=50:"right"===s.value?t=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),((null==o?void 0:o.type)==="px"||(null==o?void 0:o.type)==="%"||(null==o?void 0:o.type)==="em")&&(r=null==o?void 0:o.type,t=Number(o.value)),((null==s?void 0:s.type)==="px"||(null==s?void 0:s.type)==="%"||(null==s?void 0:s.type)==="em")&&(i=null==s?void 0:s.type,n=Number(s.value));}return{cx:tD(t,r),cy:tD(n,i)};}),tW=tu(function(e){if(e.indexOf("linear")>-1||e.indexOf("radial")>-1)return tz(e).map(function(e){var t=e.type,n=e.orientation,r=e.colorStops;!function(e){var t=e.length;e[t-1].length=null!==(a=e[t-1].length)&&void 0!==a?a:{type:"%",value:"100"},t>1&&(e[0].length=null!==(o=e[0].length)&&void 0!==o?o:{type:"%",value:"0"});for(var n=0,r=Number(e[0].length.value),i=1;i<t;i++){var a,o,s,l=null===(s=e[i].length)||void 0===s?void 0:s.value;if(!(0,F.isNil)(l)&&!(0,F.isNil)(r)){for(var u=1;u<i-n;u++)e[n+u].length={type:"%",value:"".concat(r+(Number(l)-r)*u/(i-n))};n=i,r=Number(l);}}}(r);var i=r.map(function(e){var t,n;return{offset:tD(Number(e.length.value),"%"),color:(t=e.type,n=e.value,"hex"===t?"#".concat(n):"literal"===t?n:"rgb"===t?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")"))};});if("linear-gradient"===t)return new tE(tw.LinearGradient,{angle:n?tG(n):tA,steps:i});if("radial-gradient"===t&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var a,o=tH(n[0].at),s=o.cx,l=o.cy;if(n[0].style){var u=n[0].style,c=u.type,d=u.value;"extent-keyword"===c?(tN[d]||(tN[d]=new tM(d)),a=tN[d]):a=tD(d,c);}return new tE(tw.RadialGradient,{cx:s,cy:l,size:a,steps:i});}});var t=e[0];if("("===e[1]||"("===e[2]){if("l"===t){var n=tB.exec(e);if(n){var r,i=(null===(r=n[2].match(tj))||void 0===r?void 0:r.map(function(e){return e.split(":");}))||[];return[new tE(tw.LinearGradient,{angle:tD(parseFloat(n[1]),"deg"),steps:i.map(function(e){var t=(0,z.default)(e,2),n=t[0],r=t[1];return{offset:tD(100*Number(n),"%"),color:r};})})];}}else if("r"===t){var a=function(e){var t=tU.exec(e);if(t){var n,r=(null===(n=t[4].match(tj))||void 0===n?void 0:n.map(function(e){return e.split(":");}))||[];return{cx:tD(50,"%"),cy:tD(50,"%"),steps:r.map(function(e){var t=(0,z.default)(e,2),n=t[0],r=t[1];return{offset:tD(100*Number(n),"%"),color:r};})};}return null;}(e);if(a){if(!(0,F.isString)(a))return[new tE(tw.RadialGradient,a)];e=a;}}else if("p"===t)return function(e){var t=tF.exec(e);if(t){var n=t[1],r=t[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat";}return{image:r,repetition:n};}return null;}(e);}});function tZ(e){return e&&!(0,F.isNil)(e.r)&&!(0,F.isNil)(e.g)&&!(0,F.isNil)(e.b);}var tq=tu(function(e){if((t=e)&&t.image)return(0,P.default)({repetition:"repeat"},e);if((0,F.isNil)(e)&&(e=""),"transparent"===e)return tI;if("currentColor"===e)e="black";else if("none"===e)return tO;var t,n=tW(e);if(n)return n;var r=e5(e),i=[0,0,0,0];return null!==r&&(i[0]=r.r||0,i[1]=r.g||0,i[2]=r.b||0,i[3]=r.opacity),tR.apply(void 0,i);});function tY(e,t){if(tZ(e)&&tZ(t))return[[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],function(e){var t=e.slice();if(t[3])for(var n=0;n<3;n++)t[n]=Math.round((0,F.clamp)(t[n],0,255));return t[3]=(0,F.clamp)(t[3],0,1),"rgba(".concat(t.join(","),")");}];}function tX(e,t){if((0,F.isNil)(t))return tD(0,"px");if(isFinite(Number(t="".concat(t).trim().toLowerCase()))){if("px".search(e)>=0)return tD(Number(t),"px");if("deg".search(e)>=0)return tD(Number(t),"deg");}var n=[];t=t.replace(e,function(e){return n.push(e),"U".concat(e);});var r="U(".concat(e.source,")");return n.map(function(e){return tD(Number(t.replace(RegExp("U".concat(e),"g"),"").replace(RegExp(r,"g"),"*0")),e);})[0];}var t$=function(e){return tX(/px/g,e);},tK=tu(t$);tu(function(e){return tX(RegExp("%","g"),e);});var tQ=function(e){return(0,F.isNumber)(e)||isFinite(Number(e))?tD(Number(e)||0,"px"):tX(RegExp("px|%|em|rem","g"),e);},tJ=tu(tQ),t0=function(e){return tX(RegExp("deg|rad|grad|turn","g"),e);},t1=tu(t0);function t2(e){var t=0;return e.unit===tc.kDegrees?t=e.value:e.unit===tc.kRadians?t=Number(e.value)*ey:e.unit===tc.kTurns?t=360*Number(e.value):e.value&&(t=e.value),t;}function t3(e,t){var n;return(Array.isArray(e)?n=e.map(function(e){return Number(e);}):(0,F.isString)(e)?n=e.split(" ").map(function(e){return Number(e);}):(0,F.isNumber)(e)&&(n=[e]),2===t)?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===t?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===t&&n.length%2==1?[].concat((0,I.default)(n),(0,I.default)(n)):n;}function t5(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e.unit===tc.kPixels)return Number(e.value);if(e.unit===tc.kPercentage&&n){var i=n.nodeName===K.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[t]:0)+e.value/100*i.halfExtents[t]*2;}return 0;}var t4=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function t7(e){return e.toString();}var t6=function(e){return"number"==typeof e?tD(e):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(e)?tD(Number(e)):tD(0);},t8=tu(t6);function t9(e,t){return[e,t,t7];}function ne(e,t){return function(n,r){return[n,r,function(n){return t7((0,F.clamp)(n,e,t));}];};}function nt(e,t){if(e.length===t.length)return[e,t,function(e){return e;}];}function nn(e){return 0===e.parsedStyle.d.totalLength&&(e.parsedStyle.d.totalLength=(0,F.getTotalLength)(e.parsedStyle.d.absolutePath)),e.parsedStyle.d.totalLength;}function nr(e,t){return e[0]===t[0]&&e[1]===t[1];}function ni(e,t){var n=e.prePoint,r=e.currentPoint,i=e.nextPoint,a=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.acos((a+o-(Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2)))/(2*Math.sqrt(a)*Math.sqrt(o)));if(!s||0===Math.sin(s)||(0,F.isNumberEqual)(s,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));return{xExtra:t/2*(1/Math.sin(s/2))*Math.cos(s/2-(l=l>Math.PI/2?Math.PI-l:l))-t/2||0,yExtra:t/2*(1/Math.sin(s/2))*Math.cos((u=u>Math.PI/2?Math.PI-u:u)-s/2)-t/2||0};}function na(e,t){return[t[0]+(t[0]-e[0]),t[1]+(t[1]-e[1])];}tu(function(e){return(0,F.isString)(e)?e.split(" ").map(t8):e.map(t8);});var no=function(e,t){var n=e.x*t.x+e.y*t.y,r=Math.sqrt((Math.pow(e.x,2)+Math.pow(e.y,2))*(Math.pow(t.x,2)+Math.pow(t.y,2)));return(e.x*t.y-e.y*t.x<0?-1:1)*Math.acos(n/r);},ns=function(e,t,n,r,i,a,o,s){t=Math.abs(t),n=Math.abs(n);var l=(r=(0,F.mod)(r,360))*eg;if(e.x===o.x&&e.y===o.y)return{x:e.x,y:e.y,ellipticalArcAngle:0};if(0===t||0===n)return{x:0,y:0,ellipticalArcAngle:0};var u=(e.x-o.x)/2,c=(e.y-o.y)/2,d={x:Math.cos(l)*u+Math.sin(l)*c,y:-Math.sin(l)*u+Math.cos(l)*c},f=Math.pow(d.x,2)/Math.pow(t,2)+Math.pow(d.y,2)/Math.pow(n,2);f>1&&(t*=Math.sqrt(f),n*=Math.sqrt(f));var h=(Math.pow(t,2)*Math.pow(n,2)-Math.pow(t,2)*Math.pow(d.y,2)-Math.pow(n,2)*Math.pow(d.x,2))/(Math.pow(t,2)*Math.pow(d.y,2)+Math.pow(n,2)*Math.pow(d.x,2)),p=(i!==a?1:-1)*Math.sqrt(h=h<0?0:h),v={x:p*(t*d.y/n),y:p*(-(n*d.x)/t)},g={x:Math.cos(l)*v.x-Math.sin(l)*v.y+(e.x+o.x)/2,y:Math.sin(l)*v.x+Math.cos(l)*v.y+(e.y+o.y)/2},m={x:(d.x-v.x)/t,y:(d.y-v.y)/n},y=no({x:1,y:0},m),b=no(m,{x:(-d.x-v.x)/t,y:(-d.y-v.y)/n});!a&&b>0?b-=2*Math.PI:a&&b<0&&(b+=2*Math.PI);var _=y+(b%=2*Math.PI)*s,x=t*Math.cos(_),w=n*Math.sin(_);return{x:Math.cos(l)*x-Math.sin(l)*w+g.x,y:Math.sin(l)*x+Math.cos(l)*w+g.y,ellipticalArcStartAngle:y,ellipticalArcEndAngle:y+b,ellipticalArcAngle:_,ellipticalArcCenter:g,resultantRx:t,resultantRy:n};};function nl(e,t){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=e.arcParams,i=r.rx,a=void 0===i?0:i,o=r.ry,s=void 0===o?0:o,l=r.xRotation,u=r.arcFlag,c=r.sweepFlag,d=ns({x:e.prePoint[0],y:e.prePoint[1]},a,s,l,!!u,!!c,{x:e.currentPoint[0],y:e.currentPoint[1]},t),f=ns({x:e.prePoint[0],y:e.prePoint[1]},a,s,l,!!u,!!c,{x:e.currentPoint[0],y:e.currentPoint[1]},n?t+.005:t-.005),h=f.x-d.x,p=f.y-d.y,v=Math.sqrt(h*h+p*p);return{x:-h/v,y:-p/v};}function nu(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]);}function nc(e,t){return nu(e)*nu(t)?(e[0]*t[0]+e[1]*t[1])/(nu(e)*nu(t)):1;}function nd(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(nc(e,t));}function nf(e,t,n,r){var i=(-1+Math.sqrt(2))/3*4,a=e*i,o=t*i,s=n-e,l=n+e,u=r-t,c=r+t;return[["M",s,r],["C",s,r-o,n-a,u,n,u],["C",n+a,u,l,r-o,l,r],["C",l,r+o,n+a,c,n,c],["C",n-a,c,s,r+o,s,r],["Z"]];}function nh(e){var t,n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.getLocalTransform(),a=[];switch(e.nodeName){case K.LINE:var o=e.parsedStyle,s=o.x1,l=o.y1,u=o.x2,c=o.y2;a=[["M",void 0===s?0:s,void 0===l?0:l],["L",void 0===u?0:u,void 0===c?0:c]];break;case K.CIRCLE:var d=e.parsedStyle,f=d.r,h=void 0===f?0:f,p=d.cx,v=d.cy;a=nf(h,h,void 0===p?0:p,void 0===v?0:v);break;case K.ELLIPSE:var g=e.parsedStyle,m=g.rx,y=g.ry,b=g.cx,_=g.cy;a=nf(void 0===m?0:m,void 0===y?0:y,void 0===b?0:b,void 0===_?0:_);break;case K.POLYLINE:case K.POLYGON:t=e.parsedStyle.points.points,n=e.nodeName===K.POLYGON,r=t.map(function(e,t){return[0===t?"M":"L",e[0],e[1]];}),n&&r.push(["Z"]),a=r;break;case K.RECT:var x=e.parsedStyle,w=x.width,E=void 0===w?0:w,M=x.height,S=void 0===M?0:M,k=x.x,C=x.y,A=x.radius;a=function(e,t,n,r,i){if(i){var a=(0,z.default)(i,4),o=a[0],s=a[1],l=a[2],u=a[3],c=e>0?1:-1,d=t>0?1:-1,f=c+d!==0?1:0;return[["M",c*o+n,r],["L",e-c*s+n,r],s?["A",s,s,0,0,f,e+n,d*s+r]:null,["L",e+n,t-d*l+r],l?["A",l,l,0,0,f,e+n-c*l,t+r]:null,["L",n+c*u,t+r],u?["A",u,u,0,0,f,n,t+r-d*u]:null,["L",n,d*o+r],o?["A",o,o,0,0,f,c*o+n,r]:null,["Z"]].filter(function(e){return e;});}return[["M",n,r],["L",n+e,r],["L",n+e,r+t],["L",n,r+t],["Z"]];}(E,S,void 0===k?0:k,void 0===C?0:C,A&&A.some(function(e){return 0!==e;})&&A.map(function(e){return(0,F.clamp)(e,0,Math.min(Math.abs(E)/2,Math.abs(S)/2));}));break;case K.PATH:var L=e.parsedStyle.d.absolutePath;a=(0,I.default)(L);}if(a.length)return a.reduce(function(e,t){var n="";if("M"===t[0]||"L"===t[0]){var r=U.vec3.fromValues(t[1],t[2],0);i&&U.vec3.transformMat4(r,r,i),n="".concat(t[0]).concat(r[0],",").concat(r[1]);}else if("Z"===t[0])n=t[0];else if("C"===t[0]){var a=U.vec3.fromValues(t[1],t[2],0),o=U.vec3.fromValues(t[3],t[4],0),s=U.vec3.fromValues(t[5],t[6],0);i&&(U.vec3.transformMat4(a,a,i),U.vec3.transformMat4(o,o,i),U.vec3.transformMat4(s,s,i)),n="".concat(t[0]).concat(a[0],",").concat(a[1],",").concat(o[0],",").concat(o[1],",").concat(s[0],",").concat(s[1]);}else if("A"===t[0]){var l=U.vec3.fromValues(t[6],t[7],0);i&&U.vec3.transformMat4(l,l,i),n="".concat(t[0]).concat(t[1],",").concat(t[2],",").concat(t[3],",").concat(t[4],",").concat(t[5],",").concat(l[0],",").concat(l[1]);}else if("Q"===t[0]){var u=U.vec3.fromValues(t[1],t[2],0),c=U.vec3.fromValues(t[3],t[4],0);i&&(U.vec3.transformMat4(u,u,i),U.vec3.transformMat4(c,c,i)),n="".concat(t[0]).concat(t[1],",").concat(t[2],",").concat(t[3],",").concat(t[4],"}");}return e+n;},"");}var np=function(e){if(""===e||Array.isArray(e)&&0===e.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};try{t=(0,F.normalizePath)(e);}catch(n){t=(0,F.normalizePath)(""),console.error("[g]: Invalid SVG Path definition: ".concat(e));}!function(e){for(var t=0;t<e.length;t++){var n=e[t-1],r=e[t];if("M"===r[0]&&n){var i=n[0],a=[r[1],r[2]],o=void 0;"L"===i||"M"===i?o=[n[1],n[2]]:("C"===i||"A"===i||"Q"===i)&&(o=[n[n.length-2],n[n.length-1]]),o&&nr(a,o)&&(e.splice(t,1),t--);}}}(t);var t,n=function(e){for(var t=!1,n=e.length,r=0;r<n;r++){var i=e[r][0];if("C"===i||"A"===i||"Q"===i){t=!0;break;}}return t;}(t),r=function(e){for(var t=[],n=[],r=[],i=0;i<e.length;i++){var a=e[i],o=a[0];"M"===o?(r.length&&(n.push(r),r=[]),r.push([a[1],a[2]])):"Z"===o?r.length&&(t.push(r),r=[]):r.push([a[1],a[2]]);}return r.length>0&&n.push(r),{polygons:t,polylines:n};}(t),i=r.polygons,a=r.polylines,o=function(e){for(var t=[],n=null,r=null,i=null,a=0,o=e.length,s=0;s<o;s++){var l=e[s];r=e[s+1];var u=l[0],c={command:u,prePoint:n,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":i=[l[1],l[2]],a=s;break;case"A":var d=function(e,t){var n=t[1],r=t[2],i=(0,F.mod)(t[3]*eg,2*Math.PI),a=t[4],o=t[5],s=e[0],l=e[1],u=t[6],c=t[7],d=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-c)/2,f=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-c)/2,h=d*d/(n*n)+f*f/(r*r);h>1&&(n*=Math.sqrt(h),r*=Math.sqrt(h));var p=n*n*(f*f)+r*r*(d*d),v=p?Math.sqrt((n*n*(r*r)-p)/p):1;a===o&&(v*=-1),isNaN(v)&&(v=0);var g=r?v*n*f/r:0,m=n?-(v*r)*d/n:0,y=(s+u)/2+Math.cos(i)*g-Math.sin(i)*m,b=(l+c)/2+Math.sin(i)*g+Math.cos(i)*m,_=[(d-g)/n,(f-m)/r],x=[(-1*d-g)/n,(-1*f-m)/r],w=nd([1,0],_),E=nd(_,x);return -1>=nc(_,x)&&(E=Math.PI),nc(_,x)>=1&&(E=0),0===o&&E>0&&(E-=2*Math.PI),1===o&&E<0&&(E+=2*Math.PI),{cx:y,cy:b,rx:nr(e,[u,c])?0:n,ry:nr(e,[u,c])?0:r,startAngle:w,endAngle:w+E,xRotation:i,arcFlag:a,sweepFlag:o};}(n,l);c.arcParams=d;}if("Z"===u)n=i,r=e[a+1];else{var f=l.length;n=[l[f-2],l[f-1]];}r&&"Z"===r[0]&&(r=e[a],t[a]&&(t[a].prePoint=n)),c.currentPoint=n,t[a]&&nr(n,t[a].currentPoint)&&(t[a].prePoint=c.prePoint);var h=r?[r[r.length-2],r[r.length-1]]:null;c.nextPoint=h;var p=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[p[0]-n[0],p[1]-n[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]];else if("Q"===u){var v=[l[1],l[2]];c.startTangent=[p[0]-v[0],p[1]-v[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]];}else if("T"===u){var g=t[s-1],m=na(g.currentPoint,p);"Q"===g.command?(c.command="Q",c.startTangent=[p[0]-m[0],p[1]-m[1]],c.endTangent=[n[0]-m[0],n[1]-m[1]]):(c.command="TL",c.startTangent=[p[0]-n[0],p[1]-n[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]]);}else if("C"===u){var y=[l[1],l[2]],b=[l[3],l[4]];c.startTangent=[p[0]-y[0],p[1]-y[1]],c.endTangent=[n[0]-b[0],n[1]-b[1]],0===c.startTangent[0]&&0===c.startTangent[1]&&(c.startTangent=[y[0]-b[0],y[1]-b[1]]),0===c.endTangent[0]&&0===c.endTangent[1]&&(c.endTangent=[b[0]-y[0],b[1]-y[1]]);}else if("S"===u){var _=t[s-1],x=na(_.currentPoint,p),w=[l[1],l[2]];"C"===_.command?(c.command="C",c.startTangent=[p[0]-x[0],p[1]-x[1]]):(c.command="SQ",c.startTangent=[p[0]-w[0],p[1]-w[1]]),c.endTangent=[n[0]-w[0],n[1]-w[1]];}else if("A"===u){var E=nl(c,0),M=E.x,S=E.y,k=nl(c,1,!1),C=k.x,A=k.y;c.startTangent=[M,S],c.endTangent=[C,A];}t.push(c);}return t;}(t),s=function(e,t){for(var n=[],r=[],i=[],a=0;a<e.length;a++){var o=e[a],s=o.currentPoint,l=o.params,u=o.prePoint,c=void 0;switch(o.command){case"Q":c=(0,G.quadBox)(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":c=(0,G.cubicBox)(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var d=o.arcParams;c=(0,G.arcBox)(d.cx,d.cy,d.rx,d.ry,d.xRotation,d.startAngle,d.endAngle);break;default:n.push(s[0]),r.push(s[1]);}c&&(o.box=c,n.push(c.x,c.x+c.width),r.push(c.y,c.y+c.height));}n=n.filter(function(e){return!Number.isNaN(e)&&e!==1/0&&e!==-1/0;}),r=r.filter(function(e){return!Number.isNaN(e)&&e!==1/0&&e!==-1/0;});var f=(0,F.min)(n),h=(0,F.min)(r),p=(0,F.max)(n),v=(0,F.max)(r);if(0===i.length)return{x:f,y:h,width:p-f,height:v-h};for(var g=0;g<i.length;g++){var m=i[g],y=m.currentPoint;y[0]===f?f-=ni(m,0).xExtra:y[0]===p&&(p+=ni(m,0).xExtra),y[1]===h?h-=ni(m,t).yExtra:y[1]===v&&(v+=ni(m,t).yExtra);}return{x:f,y:h,width:p-f,height:v-h};}(o,0),l=s.x,u=s.y,c=s.width,d=s.height;return{absolutePath:t,hasArc:n,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(c)?c:0,height:Number.isFinite(d)?d:0}};},nv=tu(np);function ng(e){return(0,F.isString)(e)?nv(e):np(e);}function nm(e,t,n){var r=e.curve,i=t.curve;r&&0!==r.length||(r=(0,F.path2Curve)(e.absolutePath,!1),e.curve=r),i&&0!==i.length||(i=(0,F.path2Curve)(t.absolutePath,!1),t.curve=i);var a=[r,i];r.length!==i.length&&(a=(0,F.equalizeSegments)(r,i));var o=(0,F.getDrawDirection)(a[0])!==(0,F.getDrawDirection)(a[1])?(0,F.reverseCurve)(a[0]):(0,F.clonePath)(a[0]);return[o,(0,F.getRotatedCurve)(a[1],o),function(e){return e;}];}function ny(e,t){return[e.points,t.points,function(e){return e;}];}var nb=/\s*(\w+)\(([^)]*)\)/g;function n_(e){return function(t){var n=0;return e.map(function(e){return null===e?t[n++]:e;});};}function nx(e){return e;}var nw={matrix:["NNNNNN",[null,null,0,0,null,null,0,0,0,0,1,0,null,null,0,1],nx],matrix3d:["NNNNNNNNNNNNNNNN",nx],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",n_([null,null,new tk(1)]),nx],scaleX:["N",n_([null,new tk(1),new tk(1)]),n_([null,new tk(1)])],scaleY:["N",n_([new tk(1),null,new tk(1)]),n_([new tk(1),null])],scaleZ:["N",n_([new tk(1),new tk(1),null])],scale3d:["NNN",nx],skew:["Aa",null,nx],skewX:["A",null,n_([null,tA])],skewY:["A",null,n_([tA,null])],translate:["Tt",n_([null,null,tC]),nx],translateX:["T",n_([null,tC,tC]),n_([null,tC])],translateY:["T",n_([tC,null,tC]),n_([tC,null])],translateZ:["L",n_([tC,tC,null])],translate3d:["TTL",nx]};function nE(e){for(var t=[],n=e.length,r=0;r<n;r++){var i=e[r],a=i[0],o=i.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!nw[a])return[];var s=o.map(function(e){return tD(e);});t.push({t:a,d:s});}return t;}function nM(e){if(Array.isArray(e))return nE(e);if("none"===(e=(e||"none").trim()))return[];var t,n=[],r=0;for(nb.lastIndex=0;(t=nb.exec(e))&&t.index===r;){r=t.index+t[0].length;var i=t[1],a=nw[i];if(!a)break;var o=t[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],d=s[u],f=void 0;if(void 0===(f=c?({A:function(e){return"0"===e.trim()?tA:t0(e);},N:t6,T:tQ,L:t$})[d.toUpperCase()](c):({a:tA,n:l[0],t:tC})[d]))return[];l.push(f);}if(n.push({t:i,d:l}),nb.lastIndex===e.length)return n;}return[];}function nT(e){switch(e.t){case"rotateX":return[1,0,0,0,0,Math.cos(i=t2(e.d[0])*eg),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return[Math.cos(i=t2(e.d[0])*eg),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return[Math.cos(i=t2(e.d[0])*eg),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":t=e.d[0].value,n=e.d[1].value,r=e.d[2].value,i=t2(e.d[3])*eg;var t,n,r,i,a=t*t+n*n+r*r;if(0===a)t=1,n=0,r=0;else if(1!==a){var o=Math.sqrt(a);t/=o,n/=o,r/=o;}var s=Math.sin(i/2),l=s*Math.cos(i/2),u=s*s;return[1-2*(n*n+r*r)*u,2*(t*n*u+r*l),2*(t*r*u-n*l),0,2*(t*n*u-r*l),1-2*(t*t+r*r)*u,2*(n*r*u+t*l),0,2*(t*r*u+n*l),2*(n*r*u-t*l),1-2*(t*t+n*n)*u,0,0,0,0,1];case"scale":return[e.d[0].value,0,0,0,0,e.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[e.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,e.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,e.d[0].value,0,0,0,0,1];case"scale3d":return[e.d[0].value,0,0,0,0,e.d[1].value,0,0,0,0,e.d[2].value,0,0,0,0,1];case"skew":var c=t2(e.d[0])*eg;return[1,Math.tan(t2(e.d[1])*eg),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return[1,0,0,0,Math.tan(i=t2(e.d[0])*eg),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return[1,Math.tan(i=t2(e.d[0])*eg),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,t=t5(e.d[0],0,null)||0,n=t5(e.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,t=t5(e.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=t5(e.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r=t5(e.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,t=t5(e.d[0],0,null)||0,n=t5(e.d[1],0,null)||0,r=t5(e.d[2],0,null)||0,1];case"perspective":var d=t5(e.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,d?-1/d:0,0,0,0,1];case"matrix":return[e.d[0].value,e.d[1].value,0,0,e.d[2].value,e.d[3].value,0,0,0,0,1,0,e.d[4].value,e.d[5].value,0,1];case"matrix3d":return e.d.map(function(e){return e.value;});}}function nS(e,t){return[e[0]*t[0]+e[4]*t[1]+e[8]*t[2]+e[12]*t[3],e[1]*t[0]+e[5]*t[1]+e[9]*t[2]+e[13]*t[3],e[2]*t[0]+e[6]*t[1]+e[10]*t[2]+e[14]*t[3],e[3]*t[0]+e[7]*t[1]+e[11]*t[2]+e[15]*t[3],e[0]*t[4]+e[4]*t[5]+e[8]*t[6]+e[12]*t[7],e[1]*t[4]+e[5]*t[5]+e[9]*t[6]+e[13]*t[7],e[2]*t[4]+e[6]*t[5]+e[10]*t[6]+e[14]*t[7],e[3]*t[4]+e[7]*t[5]+e[11]*t[6]+e[15]*t[7],e[0]*t[8]+e[4]*t[9]+e[8]*t[10]+e[12]*t[11],e[1]*t[8]+e[5]*t[9]+e[9]*t[10]+e[13]*t[11],e[2]*t[8]+e[6]*t[9]+e[10]*t[10]+e[14]*t[11],e[3]*t[8]+e[7]*t[9]+e[11]*t[10]+e[15]*t[11],e[0]*t[12]+e[4]*t[13]+e[8]*t[14]+e[12]*t[15],e[1]*t[12]+e[5]*t[13]+e[9]*t[14]+e[13]*t[15],e[2]*t[12]+e[6]*t[13]+e[10]*t[14]+e[14]*t[15],e[3]*t[12]+e[7]*t[13]+e[11]*t[14]+e[15]*t[15]];}function nk(e){var t=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return!function(e,t,n,r,i,a){if(!(!function(e,t){var n=t[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)e[i]=t[i]*r;return!0;}(eE,e)||(U.mat4.copy(eM,eE),eM[3]=0,eM[7]=0,eM[11]=0,eM[15]=1,1e-8>Math.abs(U.mat4.determinant(eM))))){var o=eE[3],s=eE[7],l=eE[11],u=eE[12],c=eE[13],d=eE[14],f=eE[15];if(0!==o||0!==s||0!==l){if(eT[0]=o,eT[1]=s,eT[2]=l,eT[3]=f,!U.mat4.invert(eM,eM))return;U.mat4.transpose(eM,eM),U.vec4.transformMat4(i,eT,eM);}else i[0]=i[1]=i[2]=0,i[3]=1;if(t[0]=u,t[1]=c,t[2]=d,eS[0][0]=eE[0],eS[0][1]=eE[1],eS[0][2]=eE[2],eS[1][0]=eE[4],eS[1][1]=eE[5],eS[1][2]=eE[6],eS[2][0]=eE[8],eS[2][1]=eE[9],eS[2][2]=eE[10],n[0]=U.vec3.length(eS[0]),U.vec3.normalize(eS[0],eS[0]),r[0]=U.vec3.dot(eS[0],eS[1]),eC(eS[1],eS[1],eS[0],1,-r[0]),n[1]=U.vec3.length(eS[1]),U.vec3.normalize(eS[1],eS[1]),r[0]/=n[1],r[1]=U.vec3.dot(eS[0],eS[2]),eC(eS[2],eS[2],eS[0],1,-r[1]),r[2]=U.vec3.dot(eS[1],eS[2]),eC(eS[2],eS[2],eS[1],1,-r[2]),n[2]=U.vec3.length(eS[2]),U.vec3.normalize(eS[2],eS[2]),r[1]/=n[2],r[2]/=n[2],U.vec3.cross(ek,eS[1],eS[2]),0>U.vec3.dot(eS[0],ek))for(var h=0;h<3;h++)n[h]*=-1,eS[h][0]*=-1,eS[h][1]*=-1,eS[h][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+eS[0][0]-eS[1][1]-eS[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-eS[0][0]+eS[1][1]-eS[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-eS[0][0]-eS[1][1]+eS[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+eS[0][0]+eS[1][1]+eS[2][2],0)),eS[2][1]>eS[1][2]&&(a[0]=-a[0]),eS[0][2]>eS[2][0]&&(a[1]=-a[1]),eS[1][0]>eS[0][1]&&(a[2]=-a[2]);}}(0===e.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:e.map(nT).reduce(nS),t,n,r,i,a),[[t,n,r,a,i]];}var nC=function(){function e(e,t){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var a=0;a<4;a++)n[r][i]+=t[r][a]*e[a][i];return n;}return function(t,n,r,i,a){for(var o,s=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=0;l<4;l++)s[l][3]=a[l];for(var u=0;u<3;u++)for(var c=0;c<3;c++)s[3][u]+=t[c]*s[c][u];var d=i[0],f=i[1],h=i[2],p=i[3],v=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];v[0][0]=1-2*(f*f+h*h),v[0][1]=2*(d*f-h*p),v[0][2]=2*(d*h+f*p),v[1][0]=2*(d*f+h*p),v[1][1]=1-2*(d*d+h*h),v[1][2]=2*(f*h-d*p),v[2][0]=2*(d*h-f*p),v[2][1]=2*(f*h+d*p),v[2][2]=1-2*(d*d+f*f),s=e(s,v);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];r[2]&&(g[2][1]=r[2],s=e(s,g)),r[1]&&(g[2][1]=0,g[2][0]=r[0],s=e(s,g)),r[0]&&(g[2][0]=0,g[1][0]=r[0],s=e(s,g));for(var m=0;m<3;m++)for(var y=0;y<3;y++)s[m][y]*=n[m];return 0===(o=s)[0][2]&&0===o[0][3]&&0===o[1][2]&&0===o[1][3]&&0===o[2][0]&&0===o[2][1]&&1===o[2][2]&&0===o[2][3]&&0===o[3][2]&&1===o[3][3]?[s[0][0],s[0][1],s[1][0],s[1][1],s[3][0],s[3][1]]:s[0].concat(s[1],s[2],s[3]);};}();function nA(e){return e.toFixed(6).replace(".000000","");}function nL(e,t){var n,r;return(e.decompositionPair!==t&&(e.decompositionPair=t,n=nk(e)),t.decompositionPair!==e&&(t.decompositionPair=e,r=nk(t)),null===n[0]||null===r[0])?[[!1],[!0],function(n){return n?t[0].d:e[0].d;}]:(n[0].push(0),r[0].push(1),[n,r,function(e){var t=function(e,t,n){var r=function(e,t){for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n;}(e,t);r=(0,F.clamp)(r,-1,1);var i=[];if(1===r)i=e;else for(var a=Math.acos(r),o=1*Math.sin(n*a)/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(e[s]*(Math.cos(n*a)-r*o)+t[s]*o);return i;}(n[0][3],r[0][3],e[5]);return nC(e[0],e[1],e[2],t,e[4]).map(nA).join(",");}]);}function nP(e){return e.replace(/[XY]/,"");}function nN(e){return e.replace(/(X|Y|Z|3d)?$/,"3d");}function nO(e,t,n){var r=!1;if(!e.length||!t.length){e.length||(r=!0,e=t,t=[]);for(var i=0;i<e.length;i++)!function(){var n=e[i],r=n.t,a=n.d,o="scale"===r.substring(0,5)?1:0;t.push({t:r,d:a.map(function(e){return"number"==typeof e?tD(o):tD(o,e.unit);})});}();}var a=[],o=[],s=[];if(e.length!==t.length){var l=nL(e,t);a=[l[0]],o=[l[1]],s=[["matrix",[l[2]]]];}else for(var u=0;u<e.length;u++){var c=e[u].t,d=t[u].t,f=e[u].d,h=t[u].d,p=nw[c],v=nw[d],g=void 0;if("perspective"===c&&"perspective"===d||("matrix"===c||"matrix3d"===c)&&("matrix"===d||"matrix3d"===d)){var m=nL([e[u]],[t[u]]);a.push(m[0]),o.push(m[1]),s.push(["matrix",[m[2]]]);continue;}if(c===d)g=c;else if(p[2]&&v[2]&&nP(c)===nP(d))g=nP(c),f=p[2](f),h=v[2](h);else if(p[1]&&v[1]&&nN(c)===nN(d))g=nN(c),f=p[1](f),h=v[1](h);else{var y=nL(e,t);a=[y[0]],o=[y[1]],s=[["matrix",[y[2]]]];break;}for(var b=[],_=[],x=[],w=0;w<f.length;w++){var E=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=e.value||0,s=t.value||0,l=tS(e.unit),u=e.convertTo(l),c=t.convertTo(l);return u&&c?(o=u.value,s=c.value,a=tb(e.unit)):(tk.isLength(e.unit)||tk.isLength(t.unit))&&(o=t5(e,i,n),s=t5(t,i,n),a="px"),[o,s,function(e){return r&&(e=Math.max(e,0)),e+a;}];}(f[w],h[w],n,!1,w);b[w]=E[0],_[w]=E[1],x.push(E[2]);}a.push(b),o.push(_),s.push([g,x]);}if(r){var M=a;a=o,o=M;}return[a,o,function(e){return e.map(function(e,t){var n=e.map(function(e,n){return s[t][1][n](e);}).join(",");return"matrix"===s[t][0]&&16===n.split(",").length&&(s[t][0]="matrix3d"),"matrix3d"===s[t][0]&&6===n.split(",").length&&(s[t][0]="matrix"),"".concat(s[t][0],"(").concat(n,")");}).join(" ");}];}var nI=tu(function(e){if((0,F.isString)(e)){if("text-anchor"===e)return[tD(0,"px"),tD(0,"px")];var t=e.split(" ");return(1===t.length&&("top"===t[0]||"bottom"===t[0]?(t[1]=t[0],t[0]="center"):t[1]="center"),2!==t.length)?null:[tJ(nR(t[0])),tJ(nR(t[1]))];}return[tD(e[0]||0,"px"),tD(e[1]||0,"px")];});function nR(e){return"center"===e?"50%":"left"===e||"top"===e?"0%":"right"===e||"bottom"===e?"100%":e;}var nD=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:ej.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:ej.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:ej.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:ej.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:ej.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:ej.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:ej.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:ej.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:ej.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:ej.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:ej.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:ej.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:ej.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:ej.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:ej.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:ej.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:ej.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:ej.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:ej.FILTER},{n:"clipPath",syntax:ej.DEFINED_PATH},{n:"textPath",syntax:ej.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:ej.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:ej.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:ej.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:ej.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:ej.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:ej.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:ej.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:ej.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:ej.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:ej.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:ej.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:ej.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:ej.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:ej.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:ej.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:ej.COORDINATE},{n:"y1",int:!0,l:!0,syntax:ej.COORDINATE},{n:"z1",int:!0,l:!0,syntax:ej.COORDINATE},{n:"x2",int:!0,l:!0,syntax:ej.COORDINATE},{n:"y2",int:!0,l:!0,syntax:ej.COORDINATE},{n:"z2",int:!0,l:!0,syntax:ej.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:ej.PATH,p:50},{n:"points",int:!0,l:!0,syntax:ej.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:ej.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:ej.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:ej.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:ej.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:ej.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:ej.NUMBER,d:function(e){return e===K.PATH||e===K.POLYGON||e===K.POLYLINE?"4":"10";}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:ej.MARKER},{n:"markerEnd",syntax:ej.MARKER},{n:"markerMid",syntax:ej.MARKER},{n:"markerStartOffset",syntax:ej.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:ej.LENGTH,l:!0,int:!0,d:"0"}],nz=new Set(nD.filter(function(e){return!!e.l;}).map(function(e){return e.n;})),nB={},nU=(0,O.default)(function e(t){var n=this;(0,N.default)(this,e),this.runtime=t,nD.forEach(function(e){n.registerMetadata(e);});},[{key:"registerMetadata",value:function(e){[e.n].concat((0,I.default)(e.a||[])).forEach(function(t){nB[t]=e;});}},{key:"getPropertySyntax",value:function(e){return this.runtime.CSSPropertySyntaxFactory[e];}},{key:"processProperties",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(e.attributes,t);var i=e.parsedStyle.clipPath,a=e.parsedStyle.offsetPath;!function(e,t){var n=nF(e);for(var r in t)n.has(r)&&(e.parsedStyle[r]=t[r]);}(e,t);var o=!!r.forceUpdateGeometry;if(!o){for(var s in t)if(nz.has(s)){o=!0;break;}}var l=nF(e);l.has("fill")&&t.fill&&(e.parsedStyle.fill=tq(t.fill)),l.has("stroke")&&t.stroke&&(e.parsedStyle.stroke=tq(t.stroke)),l.has("shadowColor")&&t.shadowColor&&(e.parsedStyle.shadowColor=tq(t.shadowColor)),l.has("filter")&&t.filter&&(e.parsedStyle.filter=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(t=t.toLowerCase().trim()))return[];for(var n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;(e=n.exec(t))&&e.index===i;)if(i=e.index+e[0].length,t4.indexOf(e[1])>-1&&r.push({name:e[1],params:e[2].split(" ").map(function(e){return tX(/deg|rad|grad|turn|px|%/g,e)||tq(e);})}),n.lastIndex===t.length)return r;return[];}(t.filter)),l.has("radius")&&!(0,F.isNil)(t.radius)&&(e.parsedStyle.radius=t3(t.radius,4)),l.has("lineDash")&&!(0,F.isNil)(t.lineDash)&&(e.parsedStyle.lineDash=t3(t.lineDash,"even")),l.has("points")&&t.points&&(e.parsedStyle.points=(n=t.points,{points:(0,F.isString)(n)?n.split(" ").map(function(e){var t=e.split(","),n=(0,z.default)(t,2),r=n[0],i=n[1];return[Number(r),Number(i)];}):n,totalLength:0,segments:[]})),l.has("d")&&""===t.d&&(e.parsedStyle.d=(0,P.default)({},eF)),l.has("d")&&t.d&&(e.parsedStyle.d=ng(t.d)),l.has("textTransform")&&t.textTransform&&this.runtime.CSSPropertySyntaxFactory[ej.TEXT_TRANSFORM].calculator(null,null,{value:t.textTransform},e,null),l.has("clipPath")&&!(0,F.isUndefined)(t.clipPath)&&this.runtime.CSSPropertySyntaxFactory[ej.DEFINED_PATH].calculator("clipPath",i,t.clipPath,e,this.runtime),l.has("offsetPath")&&t.offsetPath&&this.runtime.CSSPropertySyntaxFactory[ej.DEFINED_PATH].calculator("offsetPath",a,t.offsetPath,e,this.runtime),l.has("transform")&&t.transform&&(e.parsedStyle.transform=function(e){if(Array.isArray(e))return nE(e);if("none"===(e=(e||"none").trim()))return[];var t,n=[],r=0;for(nb.lastIndex=0;(t=nb.exec(e))&&t.index===r;){r=t.index+t[0].length;var i=t[1],a=nw[i];if(!a)break;var o=t[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],d=s[u],f=void 0;if(void 0===(f=c?({A:function(e){return"0"===e.trim()?tA:t1(e);},N:t8,T:tJ,L:tK})[d.toUpperCase()](c):({a:tA,n:l[0],t:tC})[d]))return[];l.push(f);}if(n.push({t:i,d:l}),nb.lastIndex===e.length)return n;}return[];}(t.transform)),l.has("transformOrigin")&&t.transformOrigin&&(e.parsedStyle.transformOrigin=nI(t.transformOrigin)),l.has("markerStart")&&t.markerStart&&(e.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[ej.MARKER].calculator(null,t.markerStart,t.markerStart,null,null)),l.has("markerEnd")&&t.markerEnd&&(e.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[ej.MARKER].calculator(null,t.markerEnd,t.markerEnd,null,null)),l.has("markerMid")&&t.markerMid&&(e.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[ej.MARKER].calculator("",t.markerMid,t.markerMid,null,null)),l.has("zIndex")&&!(0,F.isNil)(t.zIndex)&&this.runtime.CSSPropertySyntaxFactory[ej.Z_INDEX].postProcessor(e),l.has("offsetDistance")&&!(0,F.isNil)(t.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[ej.OFFSET_DISTANCE].postProcessor(e),l.has("transform")&&t.transform&&this.runtime.CSSPropertySyntaxFactory[ej.TRANSFORM].postProcessor(e),l.has("transformOrigin")&&t.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[ej.TRANSFORM_ORIGIN].postProcessor(e),o&&(e.geometry.dirty=!0,e.dirty(!0,!0),r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(e));}},{key:"updateGeometry",value:function(e){var t=e.nodeName,n=this.runtime.geometryUpdaterFactory[t];if(n){var r=e.geometry;r.contentBounds||(r.contentBounds=new ea),r.renderBounds||(r.renderBounds=new ea);var i=e.parsedStyle,a=n.update(i,e),o=a.cx,s=a.cy,l=a.cz,u=a.hwidth,c=void 0===u?0:u,d=a.hheight,f=void 0===d?0:d,h=a.hdepth,p=[Math.abs(c),Math.abs(f),void 0===h?0:h],v=i.stroke,g=i.lineWidth,m=i.increasedLineWidthForHitTesting,y=i.shadowType,b=void 0===y?"outer":y,_=i.shadowColor,x=i.filter,w=i.transformOrigin,E=[void 0===o?0:o,void 0===s?0:s,void 0===l?0:l];r.contentBounds.update(E,p);var M=t===K.POLYLINE||t===K.POLYGON||t===K.PATH?Math.SQRT2:.5;if(v&&!v.isNone){var S=(((void 0===g?1:g)||0)+((void 0===m?0:m)||0))*M;p[0]+=S,p[1]+=S;}if(r.renderBounds.update(E,p),_&&b&&"inner"!==b){var k=r.renderBounds,C=k.min,A=k.max,L=i.shadowBlur,P=i.shadowOffsetX,N=i.shadowOffsetY,O=L||0,I=P||0,R=N||0,D=C[0]-O+I,z=A[0]+O+I,B=C[1]-O+R,F=A[1]+O+R;C[0]=Math.min(C[0],D),A[0]=Math.max(A[0],z),C[1]=Math.min(C[1],B),A[1]=Math.max(A[1],F),r.renderBounds.setMinMax(C,A);}(void 0===x?[]:x).forEach(function(e){var t=e.name,n=e.params;if("blur"===t){var i=n[0].value;r.renderBounds.update(r.renderBounds.center,U.vec3.add(r.renderBounds.halfExtents,r.renderBounds.halfExtents,[i,i,0]));}else if("drop-shadow"===t){var a=n[0].value,o=n[1].value,s=n[2].value,l=r.renderBounds,u=l.min,c=l.max,d=u[0]-s+a,f=c[0]+s+a,h=u[1]-s+o,p=c[1]+s+o;u[0]=Math.min(u[0],d),c[0]=Math.max(c[0],f),u[1]=Math.min(u[1],h),c[1]=Math.max(c[1],p),r.renderBounds.setMinMax(u,c);}}),e.geometry.dirty=!1;var j=f<0,V=(c<0?-1:1)*(w?t5(w[0],0,e,!0):0),G=(j?-1:1)*(w?t5(w[1],1,e,!0):0);(V||G)&&e.setOrigin(V,G);}}},{key:"updateSizeAttenuation",value:function(e,t){e.style.isSizeAttenuation?(e.style.rawLineWidth||(e.style.rawLineWidth=e.style.lineWidth),e.style.lineWidth=(e.style.rawLineWidth||1)/t,e.nodeName===K.CIRCLE&&(e.style.rawR||(e.style.rawR=e.style.r),e.style.r=(e.style.rawR||1)/t)):(e.style.rawLineWidth&&(e.style.lineWidth=e.style.rawLineWidth,delete e.style.rawLineWidth),e.nodeName===K.CIRCLE&&e.style.rawR&&(e.style.r=e.style.rawR,delete e.style.rawR));}}]);function nF(e){return e.constructor.PARSED_STYLE_LIST;}var nj=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=t9;},[{key:"calculator",value:function(e,t,n,r){return t2(n);}}]),nV=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"calculator",value:function(e,t,n,r,i){return n instanceof tM&&(n=null),i.sceneGraphService.updateDisplayObjectDependency(e,t,n,r),"clipPath"===e&&r.forEach(function(e){0===e.childNodes.length&&i.sceneGraphService.dirtyToRoot(e);}),n;}}]),nG=(0,O.default)(function e(){(0,N.default)(this,e),this.parser=tq,this.mixer=tY;},[{key:"calculator",value:function(e,t,n,r){return n instanceof tM?"none"===n.value?tO:tI:n;}}]),nH=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"calculator",value:function(e,t,n){return n instanceof tM?[]:n;}}]);function nW(e){var t=e.parsedStyle.fontSize;return(0,F.isNil)(t)?null:t;}var nZ=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=t9;},[{key:"calculator",value:function(e,t,n,r,i){if((0,F.isNumber)(n))return n;if(!tk.isRelativeUnit(n.unit))return n.value;if(n.unit===tc.kPercentage)return 0;if(n.unit===tc.kEms){if(r.parentNode){var a,o=nW(r.parentNode);if(o)return o*n.value;}return 0;}if(n.unit===tc.kRems){if(null!=r&&null!==(a=r.ownerDocument)&&void 0!==a&&a.documentElement){var s=nW(r.ownerDocument.documentElement);if(s)return s*n.value;}return 0;}}}]),nq=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=nt;},[{key:"calculator",value:function(e,t,n){return n.map(function(e){return e.value;});}}]),nY=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=nt;},[{key:"calculator",value:function(e,t,n){return n.map(function(e){return e.value;});}}]),nX=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"calculator",value:function(e,t,n,r){n instanceof tM&&(n=null);var i,a=null===(i=n)||void 0===i?void 0:i.cloneNode(!0);return a&&(a.style.isMarker=!0),a;}}]),n$=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=t9;},[{key:"calculator",value:function(e,t,n){return n.value;}}]),nK=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=ne(0,1);},[{key:"calculator",value:function(e,t,n){return n.value;}},{key:"postProcessor",value:function(e){var t=e.parsedStyle,n=t.offsetPath,r=t.offsetDistance;if(n){var i=n.nodeName;if(i===K.LINE||i===K.PATH||i===K.POLYLINE){var a=n.getPoint(r);a&&e.setLocalPosition(a.x,a.y);}}}}]),nQ=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=ne(0,1);},[{key:"calculator",value:function(e,t,n){return n.value;}}]),nJ=(0,O.default)(function e(){(0,N.default)(this,e),this.parser=ng,this.mixer=nm;},[{key:"calculator",value:function(e,t,n){return n instanceof tM&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new ec(0,0,0,0)}:n;}}]),n0=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=ny;}),n1=function(e){function t(){var e;(0,N.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,R.default)(this,t,[].concat(r))).mixer=ne(0,1/0),e;}return(0,D.default)(t,e),(0,O.default)(t);}(nZ),n2=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"calculator",value:function(e,t,n,r){return n instanceof tM?"unset"===n.value?"":n.value:"".concat(n);}},{key:"postProcessor",value:function(e){e.nodeValue="".concat(e.parsedStyle.text)||"";}}]),n3=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"calculator",value:function(e,t,n,r){var i=r.getAttribute("text");if(i){var a=i;"capitalize"===n.value?a=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===n.value?a=i.toLowerCase():"uppercase"===n.value&&(a=i.toUpperCase()),r.parsedStyle.text=a;}return n.value;}}]),n5=new WeakMap,n4="undefined"!=typeof window&&void 0!==window.document;function n7(e,t){var n=Number(e.parsedStyle.zIndex||0),r=Number(t.parsedStyle.zIndex||0);if(n===r){var i=e.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(e)-a.indexOf(t);}}return n-r;}function n6(e,t){if(n4)return document.defaultView.getComputedStyle(e,null).getPropertyValue(t);}var n8={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},n9="object"==typeof performance&&performance.now?performance:Date;function re(e){return e.nodeName===K.FRAGMENT||e.getRootNode().nodeName===K.FRAGMENT;}var rt=1,rn="object"==typeof self&&self.self===self?self:"object"==typeof Y&&Y.global===Y?Y:{},rr=Date.now(),ri={},ra=Date.now(),ro=function(e){if("function"!=typeof e)throw TypeError("".concat(e," is not a function"));var t=Date.now(),n=t-ra,r=rt++;return ri[r]=e,Object.keys(ri).length>1||setTimeout(function(){ra=t;var e=ri;ri={},Object.keys(e).forEach(function(t){return e[t](rn.performance&&"function"==typeof rn.performance.now?rn.performance.now():Date.now()-rr);});},n>16?0:16-n),r;},rs=function(e){return"string"!=typeof e?ro:""===e?rn.requestAnimationFrame:rn["".concat(e,"RequestAnimationFrame")];},rl=function(e,t){for(var n=0;void 0!==e[n];){if(t(e[n]))return e[n];n+=1;}}(["","webkit","moz","ms","o"],function(e){return!!rs(e);}),ru=rs(rl),rc="string"!=typeof rl?function(e){delete ri[e];}:""===rl?rn.cancelAnimationFrame:rn["".concat(rl,"CancelAnimationFrame")]||rn["".concat(rl,"CancelRequestAnimationFrame")];rn.requestAnimationFrame=ru,rn.cancelAnimationFrame=rc;var rd=(0,O.default)(function e(){(0,N.default)(this,e),this.callbacks=[];},[{key:"getCallbacksNum",value:function(){return this.callbacks.length;}},{key:"tapPromise",value:function(e,t){this.callbacks.push(t);}},{key:"promise",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.all(this.callbacks.map(function(e){return e.apply(void 0,t);}));}}]),rf=(0,O.default)(function e(){(0,N.default)(this,e),this.callbacks=[];},[{key:"tapPromise",value:function(e,t){this.callbacks.push(t);}},{key:"promise",value:(b=(0,W.default)((0,H.default)().mark(function e(){var t,n,r,i,a=arguments;return(0,H.default)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.callbacks.length){e.next=6;break;}return e.next=1,(t=this.callbacks)[0].apply(t,a);case 1:n=e.sent,r=0;case 2:if(!(r<this.callbacks.length-1)){e.next=5;break;}return i=this.callbacks[r],e.next=3,i(n);case 3:n=e.sent;case 4:r++,e.next=2;break;case 5:return e.abrupt("return",n);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop();}},e,this);})),function(){return b.apply(this,arguments);})}]),rh=(0,O.default)(function e(){(0,N.default)(this,e),this.callbacks=[];},[{key:"tap",value:function(e,t){this.callbacks.push(t);}},{key:"call",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=arguments;this.callbacks.forEach(function(e){e.apply(void 0,r);});}}]),rp=(0,O.default)(function e(){(0,N.default)(this,e),this.callbacks=[];},[{key:"tap",value:function(e,t){this.callbacks.push(t);}},{key:"call",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this.callbacks.length){for(var r=arguments,i=this.callbacks[0].apply(void 0,r),a=0;a<this.callbacks.length-1;a++)i=(0,this.callbacks[a])(i);return i;}return null;}}]),rv=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],rg=/([\"\'])[^\'\"]+\1/;function rm(e,t,n){return U.mat4.identity(e),e[4]=Math.tan(t),e[1]=Math.tan(n),e;}var ry=U.mat4.create(),rb=U.mat4.create(),r_={scale:function(e){U.mat4.fromScaling(ry,[e[0].value,e[1].value,1]);},scaleX:function(e){U.mat4.fromScaling(ry,[e[0].value,1,1]);},scaleY:function(e){U.mat4.fromScaling(ry,[1,e[0].value,1]);},scaleZ:function(e){U.mat4.fromScaling(ry,[1,1,e[0].value]);},scale3d:function(e){U.mat4.fromScaling(ry,[e[0].value,e[1].value,e[2].value]);},translate:function(e){U.mat4.fromTranslation(ry,[e[0].value,e[1].value,0]);},translateX:function(e){U.mat4.fromTranslation(ry,[e[0].value,0,0]);},translateY:function(e){U.mat4.fromTranslation(ry,[0,e[0].value,0]);},translateZ:function(e){U.mat4.fromTranslation(ry,[0,0,e[0].value]);},translate3d:function(e){U.mat4.fromTranslation(ry,[e[0].value,e[1].value,e[2].value]);},rotate:function(e){U.mat4.fromZRotation(ry,t2(e[0])*eg);},rotateX:function(e){U.mat4.fromXRotation(ry,t2(e[0])*eg);},rotateY:function(e){U.mat4.fromYRotation(ry,t2(e[0])*eg);},rotateZ:function(e){U.mat4.fromZRotation(ry,t2(e[0])*eg);},rotate3d:function(e){U.mat4.fromRotation(ry,t2(e[3])*eg,[e[0].value,e[1].value,e[2].value]);},skew:function(e){rm(ry,e[0].value*eg,e[1].value*eg);},skewX:function(e){rm(ry,e[0].value*eg,0);},skewY:function(e){rm(ry,0,e[0].value*eg);},matrix:function(e){U.mat4.set(ry,e[0].value,e[1].value,0,0,e[2].value,e[3].value,0,0,0,0,1,0,e[4].value,e[5].value,0,1);},matrix3d:function(e){U.mat4.set.apply(U.mat4,[ry].concat((0,I.default)(e.map(function(e){return e.value;}))));}},rx=U.vec3.fromValues(1,1,1),rw=U.vec3.create(),rE={translate:function(e,t){ip.sceneGraphService.setLocalScale(e,rx,!1),ip.sceneGraphService.setLocalEulerAngles(e,rw,void 0,void 0,!1),ip.sceneGraphService.setLocalPosition(e,[t[0].value,t[1].value,0],!1),ip.sceneGraphService.dirtyLocalTransform(e,e.transformable);}},rM=(0,O.default)(function e(){(0,N.default)(this,e),this.parser=nM,this.mixer=nO;},[{key:"calculator",value:function(e,t,n,r){return n instanceof tM?[]:n;}},{key:"postProcessor",value:function(e){!function(e,t){if(e.length){if(1===e.length&&rE[e[0].t]){rE[e[0].t](t,e[0].d);return;}for(var n=U.mat4.identity(rb),r=0;r<e.length;r++){var i=e[r],a=i.t,o=i.d,s=r_[a];s&&(s(o),U.mat4.mul(n,n,ry));}t.setLocalTransform(n);}else t.resetLocalTransform();t.getLocalTransform();}(e.parsedStyle.transform,e);}}]),rT=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"postProcessor",value:function(e){var t=e.parsedStyle.transformOrigin;t[0].unit===tc.kPixels&&t[1].unit===tc.kPixels?e.setOrigin(t[0].value,t[1].value):e.getGeometryBounds();}}]),rS=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"calculator",value:function(e,t,n,r){return n.value;}},{key:"postProcessor",value:function(e){if(e.parentNode){var t=e.parentNode,n=t.renderable,r=t.sortable;n&&t.dirty(),r&&(r.dirty=!0,r.dirtyReason=eR.Z_INDEX_CHANGED);}}}]),rk=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e,t){var n=e.cx,r=e.cy,i=e.r,a=void 0===i?0:i;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:a,hheight:a};}}]),rC=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e,t){var n=e.cx,r=e.cy,i=e.rx,a=e.ry;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:void 0===i?0:i,hheight:void 0===a?0:a};}}]),rA=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e){var t=e.x1,n=e.y1,r=e.x2,i=e.y2,a=Math.min(t,r),o=Math.min(n,i),s=(Math.max(t,r)-a)/2,l=(Math.max(n,i)-o)/2;return{cx:a+s,cy:o+l,hwidth:s,hheight:l};}}]),rL=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e){var t=e.d.rect,n=t.x,r=t.y,i=t.width,a=t.height,o=i/2,s=a/2;return{cx:n+o,cy:r+s,hwidth:o,hheight:s};}}]),rP=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e){if(e.points&&(0,F.isArray)(e.points.points)){var t=e.points.points,n=Math.min.apply(Math,(0,I.default)(t.map(function(e){return e[0];}))),r=Math.max.apply(Math,(0,I.default)(t.map(function(e){return e[0];}))),i=Math.min.apply(Math,(0,I.default)(t.map(function(e){return e[1];}))),a=Math.max.apply(Math,(0,I.default)(t.map(function(e){return e[1];}))),o=(r-n)/2,s=(a-i)/2;return{cx:n+o,cy:i+s,hwidth:o,hheight:s};}return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rN=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e,t){var n=e.x,r=e.y,i=e.src,a=e.width,o=e.height,s=void 0===a?0:a,l=void 0===o?0:o;return!i||(0,F.isString)(i)||(s||(s=i.width,e.width=s),l||(l=i.height,e.height=l)),{cx:(void 0===n?0:n)+s/2,cy:(void 0===r?0:r)+l/2,hwidth:s/2,hheight:l/2};}}]),rO=(0,O.default)(function e(t){(0,N.default)(this,e),this.globalRuntime=t;},[{key:"isReadyToMeasure",value:function(e,t){return e.text;}},{key:"update",value:function(e,t){var n,r=e.text,i=e.textAlign,a=void 0===i?"start":i,o=e.lineWidth,s=void 0===o?1:o,l=e.textBaseline,u=void 0===l?"alphabetic":l,c=e.dx,d=void 0===c?0:c,f=e.dy,h=void 0===f?0:f,p=e.x,v=e.y;if(!this.isReadyToMeasure(e,t))return e.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var g=((null==t||null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,m=this.globalRuntime.textService.measureText(r,e,g);e.metrics=m;var y=m.width,b=m.height,_=y/2,x=b/2,w=(void 0===p?0:p)+_;"center"===a||"middle"===a?w+=s/2-_:("right"===a||"end"===a)&&(w+=s-2*_);var E=(void 0===v?0:v)-x;return"middle"===u?E+=x:"top"===u||"hanging"===u?E+=2*x:"alphabetic"===u||("bottom"===u||"ideographic"===u)&&(E+=0),d&&(w+=d),h&&(E+=h),{cx:w,cy:E,hwidth:_,hheight:x};}}]),rI=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e,t){return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rR=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e,t){var n=e.x,r=e.y,i=e.width,a=void 0===i?0:i,o=e.height,s=void 0===o?0:o;return{cx:(void 0===n?0:n)+a/2,cy:(void 0===r?0:r)+s/2,hwidth:a/2,hheight:s/2};}}]),rD=(0,O.default)(function e(t){(0,N.default)(this,e),this.eventPhase=e.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new eu,this.page=new eu,this.canvas=new eu,this.viewport=new eu,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t;},[{key:"name",get:function(){return this.type;}},{key:"layerX",get:function(){return this.layer.x;}},{key:"layerY",get:function(){return this.layer.y;}},{key:"pageX",get:function(){return this.page.x;}},{key:"pageY",get:function(){return this.page.y;}},{key:"x",get:function(){return this.canvas.x;}},{key:"y",get:function(){return this.canvas.y;}},{key:"canvasX",get:function(){return this.canvas.x;}},{key:"canvasY",get:function(){return this.canvas.y;}},{key:"viewportX",get:function(){return this.viewport.x;}},{key:"viewportY",get:function(){return this.viewport.y;}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path;}},{key:"propagationPath",get:function(){return this.composedPath();}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0;}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0;}},{key:"stopPropagation",value:function(){this.propagationStopped=!0;}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw Error(ed);}}]),rz=function(e){function t(){var e;(0,N.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,R.default)(this,t,[].concat(r))).client=new eu,e.movement=new eu,e.offset=new eu,e.global=new eu,e.screen=new eu,e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"clientX",get:function(){return this.client.x;}},{key:"clientY",get:function(){return this.client.y;}},{key:"movementX",get:function(){return this.movement.x;}},{key:"movementY",get:function(){return this.movement.y;}},{key:"offsetX",get:function(){return this.offset.x;}},{key:"offsetY",get:function(){return this.offset.y;}},{key:"globalX",get:function(){return this.global.x;}},{key:"globalY",get:function(){return this.global.y;}},{key:"screenX",get:function(){return this.screen.x;}},{key:"screenY",get:function(){return this.screen.y;}},{key:"getModifierState",value:function(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e);}},{key:"initMouseEvent",value:function(){throw Error(ed);}}]);}(rD),rB=function(e){function t(){var e;(0,N.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,R.default)(this,t,[].concat(r))).width=0,e.height=0,e.isPrimary=!1,e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[];}},{key:"getPredictedEvents",value:function(){throw Error("getPredictedEvents is not supported!");}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this);}}]);}(rz),rU=function(e){function t(){return(0,N.default)(this,t),(0,R.default)(this,t,arguments);}return(0,D.default)(t,e),(0,O.default)(t,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this);}}]);}(rz),rF=function(e){function t(e,n){var r;return(0,N.default)(this,t),(r=(0,R.default)(this,t,[null])).type=e,r.detail=n,Object.assign(r,n),r;}return(0,D.default)(t,e),(0,O.default)(t);}(rD),rj=(0,O.default)(function e(){(0,N.default)(this,e),this.emitter=new B.default;},[{key:"on",value:function(e,t,n){return this.addEventListener(e,t,n),this;}},{key:"addEventListener",value:function(e,t,n){var r=!1,i=!1;if((0,F.isBoolean)(n))r=n;else if(n){var a=n.capture;r=void 0!==a&&a;var o=n.once;i=void 0!==o&&o;}r&&(e+="capture"),t=(0,F.isFunction)(t)?t:t.handleEvent;var s=(0,F.isFunction)(t)?void 0:t;return i?this.emitter.once(e,t,s):this.emitter.on(e,t,s),this;}},{key:"off",value:function(e,t,n){return e?this.removeEventListener(e,t,n):this.removeAllEventListeners(),this;}},{key:"removeAllEventListeners",value:function(){var e;null===(e=this.emitter)||void 0===e||e.removeAllListeners();}},{key:"removeEventListener",value:function(e,t,n){if(!this.emitter)return this;((0,F.isBoolean)(n)?n:null==n?void 0:n.capture)&&(e+="capture"),t=(0,F.isFunction)(t)?t:null===(r=t)||void 0===r?void 0:r.handleEvent;var r,i=(0,F.isFunction)(t)?void 0:t;return this.emitter.off(e,t,i),this;}},{key:"emit",value:function(e,t){this.dispatchEvent(new rF(e,t));}},{key:"dispatchEventToSelf",value:function(e){e.target||(e.target=this),e.currentTarget=this,this.emitter.emit(e.type,e);}},{key:"dispatchEvent",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;if(i)return this.dispatchEventToSelf(e),!0;if(t=this.document?this:this.defaultView?this.defaultView:null===(n=this.ownerDocument)||void 0===n?void 0:n.defaultView){if(e.manager=t.getEventService(),!e.manager)return!1;e.defaultPrevented=!1,e.path?e.path.length=0:e.page=[],r||(e.target=this),e.manager.dispatchEvent(e,e.type,r);}else this.dispatchEventToSelf(e);return!e.defaultPrevented;}}]),rV=function(e){function t(){var e;(0,N.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,R.default)(this,t,[].concat(r))).shadow=!1,e.ownerDocument=null,e.isConnected=!1,e.baseURI="",e.childNodes=[],e.nodeType=0,e.nodeName="",e.nodeValue=null,e.parentNode=null,e.destroyed=!1,e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"textContent",get:function(){var e="";this.nodeName===K.TEXT&&(e+=this.style.text);var t,n=(0,Z.default)(this.childNodes);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.nodeName===K.TEXT?e+=r.nodeValue:e+=r.textContent;}}catch(e){n.e(e);}finally{n.f();}return e;},set:function(e){var t=this;this.childNodes.slice().forEach(function(e){t.removeChild(e);}),this.nodeName===K.TEXT&&(this.style.text="".concat(e));}},{key:"getRootNode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(e):e.composed&&this.host?this.host.getRootNode(e):this;}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0;}},{key:"isDefaultNamespace",value:function(e){throw Error(ed);}},{key:"lookupNamespaceURI",value:function(e){throw Error(ed);}},{key:"lookupPrefix",value:function(e){throw Error(ed);}},{key:"normalize",value:function(){throw Error(ed);}},{key:"isEqualNode",value:function(e){return this===e;}},{key:"isSameNode",value:function(e){return this.isEqualNode(e);}},{key:"parent",get:function(){return this.parentNode;}},{key:"parentElement",get:function(){return null;}},{key:"nextSibling",get:function(){return null;}},{key:"previousSibling",get:function(){return null;}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null;}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null;}},{key:"compareDocumentPosition",value:function(e){if(e===this)return 0;for(var n,r=e,i=this,a=[r],o=[i];null!==(n=r.parentNode)&&void 0!==n?n:i.parentNode;)r=r.parentNode?(a.push(r.parentNode),r.parentNode):r,i=i.parentNode?(o.push(i.parentNode),i.parentNode):i;if(r!==i)return t.DOCUMENT_POSITION_DISCONNECTED|t.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|t.DOCUMENT_POSITION_PRECEDING;var s=a.length>o.length?a:o,l=s===a?o:a;if(s[s.length-l.length]===l[0])return s===a?t.DOCUMENT_POSITION_CONTAINED_BY|t.DOCUMENT_POSITION_FOLLOWING:t.DOCUMENT_POSITION_CONTAINS|t.DOCUMENT_POSITION_PRECEDING;for(var u=s.length-l.length,c=l.length-1;c>=0;c--){var d=l[c],f=s[u+c];if(f!==d){var h=d.parentNode.childNodes;if(h.indexOf(d)<h.indexOf(f)){if(l===a)return t.DOCUMENT_POSITION_PRECEDING;return t.DOCUMENT_POSITION_FOLLOWING;}if(s===a)return t.DOCUMENT_POSITION_PRECEDING;break;}}return t.DOCUMENT_POSITION_FOLLOWING;}},{key:"contain",value:function(e){return this.contains(e);}},{key:"contains",value:function(e){for(var t=e;t&&this!==t;)t=t.parentNode;return!!t;}},{key:"getAncestor",value:function(e){for(var t=this;e>0&&t;)t=t.parentNode,e--;return t;}},{key:"forEach",value:function(e){for(var t=[this];t.length>0;){var n=t.pop();if(!1===e(n))break;for(var r=n.childNodes.length-1;r>=0;r--)t.push(n.childNodes[r]);}}}],[{key:"isNode",value:function(e){return!!e.childNodes;}}]);}(rj);rV.DOCUMENT_POSITION_DISCONNECTED=1,rV.DOCUMENT_POSITION_PRECEDING=2,rV.DOCUMENT_POSITION_FOLLOWING=4,rV.DOCUMENT_POSITION_CONTAINS=8,rV.DOCUMENT_POSITION_CONTAINED_BY=16,rV.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var rG=(0,O.default)(function e(t,n){var r=this;(0,N.default)(this,e),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=U.mat4.create(),this.tmpVec3=U.vec3.create(),this.onPointerDown=function(e){var t=r.createPointerEvent(e);if(r.dispatchEvent(t,"pointerdown"),"touch"===t.pointerType)r.dispatchEvent(t,"touchstart");else if("mouse"===t.pointerType||"pen"===t.pointerType){var n=2===t.button;r.dispatchEvent(t,n?"rightdown":"mousedown");}r.trackingData(e.pointerId).pressTargetsByButton[e.button]=t.composedPath(),r.freeEvent(t);},this.onPointerUp=function(e){var t=n9.now(),n=r.createPointerEvent(e,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)r.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var i=2===n.button;r.dispatchEvent(n,i?"rightup":"mouseup");}var a=r.trackingData(e.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[e.button]),s=o;if(o&&!n.composedPath().includes(o)){for(var l=o;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,r.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)r.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var u=2===n.button;r.notifyTarget(n,u?"rightupoutside":"mouseupoutside");}rV.isNode(l)&&(l=l.parentNode);}delete a.pressTargetsByButton[e.button],s=l;}if(s){var c,d=r.clonePointerEvent(n,"click");d.target=s,d.path=[],a.clicksByButton[e.button]||(a.clicksByButton[e.button]={clickCount:0,target:d.target,timeStamp:t});var f=r.context.renderingContext.root.ownerDocument.defaultView,h=a.clicksByButton[e.button];h.target===d.target&&t-h.timeStamp<f.getConfig().dblClickSpeed?++h.clickCount:h.clickCount=1,h.target=d.target,h.timeStamp=t,d.detail=h.clickCount,null!==(c=n.detail)&&void 0!==c&&c.preventClick||(r.context.config.useNativeClickEvent||"mouse"!==d.pointerType&&"touch"!==d.pointerType||r.dispatchEvent(d,"click"),r.dispatchEvent(d,"pointertap")),r.freeEvent(d);}r.freeEvent(n);},this.onPointerMove=function(e){var t=r.createPointerEvent(e,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),n="mouse"===t.pointerType||"pen"===t.pointerType,i=r.trackingData(e.pointerId),a=r.findMountedTarget(i.overTargets);if(i.overTargets&&a!==t.target){var o="mousemove"===e.type?"mouseout":"pointerout",s=r.createPointerEvent(e,o,a||void 0);if(r.dispatchEvent(s,"pointerout"),n&&r.dispatchEvent(s,"mouseout"),!t.composedPath().includes(a)){var l=r.createPointerEvent(e,"pointerleave",a||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&!t.composedPath().includes(l.target);)l.currentTarget=l.target,r.notifyTarget(l),n&&r.notifyTarget(l,"mouseleave"),rV.isNode(l.target)&&(l.target=l.target.parentNode);r.freeEvent(l);}r.freeEvent(s);}if(a!==t.target){var u="mousemove"===e.type?"mouseover":"pointerover",c=r.clonePointerEvent(t,u);r.dispatchEvent(c,"pointerover"),n&&r.dispatchEvent(c,"mouseover");for(var d=a&&rV.isNode(a)&&a.parentNode;d&&d!==(rV.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&d!==t.target;)d=d.parentNode;if(!d||d===(rV.isNode(r.rootTarget)&&r.rootTarget.parentNode)){var f=r.clonePointerEvent(t,"pointerenter");for(f.eventPhase=f.AT_TARGET;f.target&&f.target!==a&&f.target!==(rV.isNode(r.rootTarget)&&r.rootTarget.parentNode);)f.currentTarget=f.target,r.notifyTarget(f),n&&r.notifyTarget(f,"mouseenter"),rV.isNode(f.target)&&(f.target=f.target.parentNode);r.freeEvent(f);}r.freeEvent(c);}r.dispatchEvent(t,"pointermove"),"touch"===t.pointerType&&r.dispatchEvent(t,"touchmove"),n&&(r.dispatchEvent(t,"mousemove"),r.cursor=r.getCursor(t.target)),i.overTargets=t.composedPath(),r.freeEvent(t);},this.onPointerOut=function(e){var t=r.trackingData(e.pointerId);if(t.overTargets){var n="mouse"===e.pointerType||"pen"===e.pointerType,i=r.findMountedTarget(t.overTargets),a=r.createPointerEvent(e,"pointerout",i||void 0);r.dispatchEvent(a),n&&r.dispatchEvent(a,"mouseout");var o=r.createPointerEvent(e,"pointerleave",i||void 0);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(rV.isNode(r.rootTarget)&&r.rootTarget.parentNode);)o.currentTarget=o.target,r.notifyTarget(o),n&&r.notifyTarget(o,"mouseleave"),rV.isNode(o.target)&&(o.target=o.target.parentNode);t.overTargets=null,r.freeEvent(a),r.freeEvent(o);}r.cursor=null;},this.onPointerOver=function(e){var t=r.trackingData(e.pointerId),n=r.createPointerEvent(e),i="mouse"===n.pointerType||"pen"===n.pointerType;r.dispatchEvent(n,"pointerover"),i&&r.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(r.cursor=r.getCursor(n.target));var a=r.clonePointerEvent(n,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==(rV.isNode(r.rootTarget)&&r.rootTarget.parentNode);)a.currentTarget=a.target,r.notifyTarget(a),i&&r.notifyTarget(a,"mouseenter"),rV.isNode(a.target)&&(a.target=a.target.parentNode);t.overTargets=n.composedPath(),r.freeEvent(n),r.freeEvent(a);},this.onPointerUpOutside=function(e){var t=r.trackingData(e.pointerId),n=r.findMountedTarget(t.pressTargetsByButton[e.button]),i=r.createPointerEvent(e);if(n){for(var a=n;a;)i.currentTarget=a,r.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType||("mouse"===i.pointerType||"pen"===i.pointerType)&&r.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),rV.isNode(a)&&(a=a.parentNode);delete t.pressTargetsByButton[e.button];}r.freeEvent(i);},this.onWheel=function(e){var t=r.createWheelEvent(e);r.dispatchEvent(t),r.freeEvent(t);},this.onClick=function(e){if(r.context.config.useNativeClickEvent){var t=r.createPointerEvent(e);r.dispatchEvent(t),r.freeEvent(t);}},this.onPointerCancel=function(e){var t=r.createPointerEvent(e,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(t),r.freeEvent(t);},this.globalRuntime=t,this.context=n;},[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick);}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear();}},{key:"getScale",value:function(){var e=this.context.contextService.getBoundingClientRect(),t=1,n=1,r=this.context.contextService.getDomElement();if(r&&e){var i=r.offsetWidth,a=r.offsetHeight;i&&a&&(t=e.width/i,n=e.height/a);}return{scaleX:t,scaleY:n,bbox:e};}},{key:"client2Viewport",value:function(e){var t=this.getScale(),n=t.scaleX,r=t.scaleY,i=t.bbox;return new eu((e.x-((null==i?void 0:i.left)||0))/n,(e.y-((null==i?void 0:i.top)||0))/r);}},{key:"viewport2Client",value:function(e){var t=this.getScale(),n=t.scaleX,r=t.scaleY,i=t.bbox;return new eu((e.x+((null==i?void 0:i.left)||0))*n,(e.y+((null==i?void 0:i.top)||0))*r);}},{key:"viewport2Canvas",value:function(e){var t=e.x,n=e.y,r=this.rootTarget.defaultView.getCamera(),i=this.context.config,a=i.width,o=i.height,s=r.getPerspectiveInverse(),l=r.getWorldTransform(),u=U.mat4.multiply(this.tmpMatrix,l,s),c=U.vec3.set(this.tmpVec3,t/a*2-1,(1-n/o)*2-1,0);return U.vec3.transformMat4(c,c,u),new eu(c[0],c[1]);}},{key:"canvas2Viewport",value:function(e){var t=this.rootTarget.defaultView.getCamera(),n=t.getPerspective(),r=t.getViewTransform(),i=U.mat4.multiply(this.tmpMatrix,n,r),a=U.vec3.set(this.tmpVec3,e.x,e.y,0);U.vec3.transformMat4(this.tmpVec3,this.tmpVec3,i);var o=this.context.config,s=o.width,l=o.height;return new eu((a[0]+1)/2*s,(1-(a[1]+1)/2)*l);}},{key:"setPickHandler",value:function(e){this.pickHandler=e;}},{key:"addEventMapping",value:function(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort(function(e,t){return e.priority-t.priority;});}},{key:"mapEvent",value:function(e){if(this.rootTarget){var t=this.mappingTable[e.type];if(t)for(var n=0,r=t.length;n<r;n++)t[n].fn(e);else console.warn("[EventService]: Event mapping not defined for ".concat(e.type));}}},{key:"dispatchEvent",value:function(e,t,n){if(n){e.eventPhase=e.AT_TARGET;var r=this.rootTarget.defaultView||null;e.currentTarget=r,this.notifyListeners(e,t);}else e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t);}},{key:"propagate",value:function(e,t){if(e.target){var n=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(e.currentTarget=n[r],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!e.propagationStopped&&!e.propagationImmediatelyStopped){var i=n.indexOf(e.currentTarget);e.eventPhase=e.BUBBLING_PHASE;for(var a=i+1;a<n.length;a++)if(e.currentTarget=n[a],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;}}}},{key:"propagationPath",value:function(e){var t=[e],n=this.rootTarget.defaultView||null;if(n&&n===e)return t.unshift(n.document),t;for(var r=0;r<2048&&e!==this.rootTarget;r++)rV.isNode(e)&&e.parentNode&&(t.push(e.parentNode),e=e.parentNode);return n&&t.push(n),t;}},{key:"hitTest",value:function(e){var t=e.viewportX,n=e.viewportY,r=this.context.config,i=r.width,a=r.height,o=r.disableHitTesting;return t<0||n<0||t>i||n>a?null:!o&&this.pickHandler(e)||this.rootTarget||null;}},{key:"isNativeEventFromCanvas",value:function(e,t){var n,r=null==t?void 0:t.target;if(null!==(n=r)&&void 0!==n&&n.shadowRoot&&(r=t.composedPath()[0]),r){if(r===e)return!0;if(e&&e.contains)return e.contains(r);}return null!=t&&!!t.composedPath&&t.composedPath().indexOf(e)>-1;}},{key:"getExistedHTML",value:function(e){if(e.nativeEvent.composedPath)for(var t=0,n=e.nativeEvent.composedPath();t<n.length;t++){var r=n[t],i=this.nativeHTMLMap.get(r);if(i)return i;}return null;}},{key:"pickTarget",value:function(e){return this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY});}},{key:"createPointerEvent",value:function(e,t,n,r){var i=this.allocateEvent(rB);this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e;var a=this.getExistedHTML(i),o=this.context.contextService.getDomElement();return i.target=null!=n?n:a||this.isNativeEventFromCanvas(o,i.nativeEvent)&&this.pickTarget(i)||r,"string"==typeof t&&(i.type=t),i;}},{key:"createWheelEvent",value:function(e){var t=this.allocateEvent(rU);this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e;var n=this.getExistedHTML(t),r=this.context.contextService.getDomElement();return t.target=n||this.isNativeEventFromCanvas(r,t.nativeEvent)&&this.pickTarget(t),t;}},{key:"trackingData",value:function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e];}},{key:"cloneWheelEvent",value:function(e){var t=this.allocateEvent(rU);return t.nativeEvent=e.nativeEvent,t.originalEvent=e.originalEvent,this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.target=e.target,t.path=e.composedPath().slice(),t.type=e.type,t;}},{key:"clonePointerEvent",value:function(e,t){var n=this.allocateEvent(rB);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=null!=t?t:n.type,n;}},{key:"copyPointerData",value:function(e,t){t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist;}},{key:"copyMouseData",value:function(e,t){t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.client.copyFrom(e.client),t.movement.copyFrom(e.movement),t.canvas.copyFrom(e.canvas),t.screen.copyFrom(e.screen),t.global.copyFrom(e.global),t.offset.copyFrom(e.offset);}},{key:"copyWheelData",value:function(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ;}},{key:"copyData",value:function(e,t){t.isTrusted=e.isTrusted,t.timeStamp=n9.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.page.copyFrom(e.page),t.viewport.copyFrom(e.viewport);}},{key:"allocateEvent",value:function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=[],t.target=null,t;}},{key:"freeEvent",value:function(e){if(e.manager!==this)throw Error("It is illegal to free an event not managed by this EventBoundary!");var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e);}},{key:"notifyTarget",value:function(e,t){t=null!=t?t:e.type;var n=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(t,"capture"):t;this.notifyListeners(e,n),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t);}},{key:"notifyListeners",value:function(e,t){var n=e.currentTarget.emitter,r=n._events[t];if(r){if("fn"in r)r.once&&n.removeListener(t,r.fn,void 0,!0),r.fn.call(e.currentTarget||r.context,e);else for(var i=0;i<r.length&&!e.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(t,r[i].fn,void 0,!0),r[i].fn.call(e.currentTarget||r[i].context,e);}}},{key:"findMountedTarget",value:function(e){if(!e)return null;for(var t=e[e.length-1],n=e.length-2;n>=0;n--){var r=e[n];if(r===this.rootTarget||rV.isNode(r)&&r.parentNode===t)t=e[n];else break;}return t;}},{key:"getCursor",value:function(e){for(var t=e;t;){var n=!!t.getAttribute&&t.getAttribute("cursor");if(n)return n;t=rV.isNode(t)&&t.parentNode;}}}]),rH=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"getOrCreateCanvas",value:function(e,t){if(this.canvas)return this.canvas;if(e||ip.offscreenCanvas)this.canvas=e||ip.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,P.default)({willReadFrequently:!0},t));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,P.default)({willReadFrequently:!0},t)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"));}catch(e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,P.default)({willReadFrequently:!0},t));}return this.canvas.width=10,this.canvas.height=10,this.canvas;}},{key:"getOrCreateContext",value:function(e,t){return this.context||this.getOrCreateCanvas(e,t),this.context;}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0);}catch(e){}try{return document.createElement("canvas");}catch(e){}return null;}}]),rW=((_={})[_.CAMERA_CHANGED=0]="CAMERA_CHANGED",_[_.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",_[_.NONE=2]="NONE",_),rZ=(0,O.default)(function e(t,n){(0,N.default)(this,e),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new rh,initAsync:new rd,dirtycheck:new rp,cull:new rp,beginFrame:new rh,beforeRender:new rh,render:new rh,afterRender:new rh,endFrame:new rh,destroy:new rh,pick:new rf,pickSync:new rp,pointerDown:new rh,pointerUp:new rh,pointerMove:new rh,pointerOut:new rh,pointerOver:new rh,pointerWheel:new rh,pointerCancel:new rh,click:new rh},this.globalRuntime=t,this.context=n;},[{key:"init",value:function(e){var t=this,n=(0,P.default)((0,P.default)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(e){e.apply(n,t.globalRuntime);}),this.hooks.init.call(),0===this.hooks.initAsync.getCallbacksNum()?(this.inited=!0,e()):this.hooks.initAsync.promise().then(function(){t.inited=!0,e();}).catch(function(e){});}},{key:"getStats",value:function(){return this.stats;}},{key:"disableDirtyRectangleRendering",value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(rW.CAMERA_CHANGED);}},{key:"render",value:function(e,t,n){var r=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var i=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(i.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),i.renderReasons.size&&this.inited){i.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var a=1===i.renderReasons.size&&i.renderReasons.has(rW.CAMERA_CHANGED),o=!e.disableRenderHooks||!a;o&&this.renderDisplayObject(i.root,e,i),this.hooks.beginFrame.call(t),o&&i.renderListCurrentFrame.forEach(function(e){r.hooks.beforeRender.call(e),r.hooks.render.call(e),r.hooks.afterRender.call(e);}),this.hooks.endFrame.call(t),i.renderListCurrentFrame=[],i.renderReasons.clear(),n();}}},{key:"renderDisplayObject",value:function(e,t,n){for(var r=this,i=t.renderer.getConfig(),a=i.enableDirtyCheck,o=i.enableCulling,s=[e];s.length>0;){var l,u=s.pop();!function(e){var t=e.renderable,i=e.sortable,s=a?t.dirty||n.dirtyRectangleRenderingDisabled?e:null:e,l=null;s&&(l=o?r.hooks.cull.call(s,r.context.camera):s)&&(r.stats.rendered+=1,n.renderListCurrentFrame.push(l)),e.dirty(!1),i.renderOrder=r.zIndexCounter,r.zIndexCounter+=1,r.stats.total+=1,i.dirty&&(r.sort(e,i),i.dirty=!1,i.dirtyChildren=[],i.dirtyReason=void 0);}(u);for(var c=(null===(l=u.sortable)||void 0===l||null===(l=l.sorted)||void 0===l?void 0:l.length)>0?u.sortable.sorted:u.childNodes,d=c.length-1;d>=0;d--)s.push(c[d]);}}},{key:"sort",value:function(e,t){var n,r;(null==t||null===(n=t.sorted)||void 0===n?void 0:n.length)>0&&t.dirtyReason!==eR.Z_INDEX_CHANGED?t.dirtyChildren.forEach(function(n){var r=t.sorted.indexOf(n);if(r>-1&&t.sorted.splice(r,1),e.childNodes.indexOf(n)>-1){if(0===t.sorted.length)t.sorted.push(n);else{var i=function(e,t){for(var n=0,r=e.length;n<r;){var i=n+r>>>1;0>n7(e[i],t)?n=i+1:r=i;}return n;}(t.sorted,n);t.sorted.splice(i,0,n);}}}):t.sorted=e.childNodes.slice().sort(n7),(null===(r=t.sorted)||void 0===r?void 0:r.length)>0&&0===e.childNodes.filter(function(e){return e.parsedStyle.zIndex;}).length&&(t.sorted=[]);}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents();}},{key:"dirtify",value:function(){this.context.renderingContext.renderReasons.add(rW.DISPLAY_OBJECT_CHANGED);}}]),rq=/\[\s*(.*)=(.*)\s*\]/,rY=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"selectOne",value:function(e,t){var n=this;if(e.startsWith("."))return t.find(function(t){return((null==t?void 0:t.classList)||[]).indexOf(n.getIdOrClassname(e))>-1;});if(e.startsWith("#"))return t.find(function(t){return t.id===n.getIdOrClassname(e);});if(e.startsWith("[")){var r=this.getAttribute(e),i=r.name,a=r.value;return i?t.find(function(e){return t!==e&&("name"===i?e.name===a:n.attributeToString(e,i)===a);}):null;}return t.find(function(n){return t!==n&&n.nodeName===e;});}},{key:"selectAll",value:function(e,t){var n=this;if(e.startsWith("."))return t.findAll(function(r){return t!==r&&((null==r?void 0:r.classList)||[]).indexOf(n.getIdOrClassname(e))>-1;});if(e.startsWith("#"))return t.findAll(function(r){return t!==r&&r.id===n.getIdOrClassname(e);});if(e.startsWith("[")){var r=this.getAttribute(e),i=r.name,a=r.value;return i?t.findAll(function(e){return t!==e&&("name"===i?e.name===a:n.attributeToString(e,i)===a);}):[];}return t.findAll(function(n){return t!==n&&n.nodeName===e;});}},{key:"is",value:function(e,t){if(e.startsWith("."))return t.className===this.getIdOrClassname(e);if(e.startsWith("#"))return t.id===this.getIdOrClassname(e);if(e.startsWith("[")){var n=this.getAttribute(e),r=n.name,i=n.value;return"name"===r?t.name===i:this.attributeToString(t,r)===i;}return t.nodeName===e;}},{key:"getIdOrClassname",value:function(e){return e.substring(1);}},{key:"getAttribute",value:function(e){var t=e.match(rq),n="",r="";return t&&t.length>2&&(n=t[1].replace(/"/g,""),r=t[2].replace(/"/g,"")),{name:n,value:r};}},{key:"attributeToString",value:function(e,t){if(!e.getAttribute)return"";var n=e.getAttribute(t);return(0,F.isNil)(n)?"":n.toString?n.toString():"";}}]),rX=((x={}).ATTR_MODIFIED="DOMAttrModified",x.INSERTED="DOMNodeInserted",x.MOUNTED="DOMNodeInsertedIntoDocument",x.REMOVED="removed",x.UNMOUNTED="DOMNodeRemovedFromDocument",x.REPARENT="reparent",x.DESTROY="destroy",x.BOUNDS_CHANGED="bounds-changed",x.CULLED="culled",x),r$=function(e){function t(e,n,r,i,a,o,s,l){var u;return(0,N.default)(this,t),(u=(0,R.default)(this,t,[null])).relatedNode=n,u.prevValue=r,u.newValue=i,u.attrName=a,u.attrChange=o,u.prevParsedValue=s,u.newParsedValue=l,u.type=e,u;}return(0,D.default)(t,e),(0,O.default)(t);}(rD);r$.ADDITION=2,r$.MODIFICATION=1,r$.REMOVAL=3;var rK=new r$(rX.REPARENT,null,"","","",0,"",""),rQ=U.vec2.create(),rJ=U.vec3.create(),r0=U.vec3.fromValues(1,1,1),r1=U.mat4.create(),r2=U.vec2.create(),r3=U.vec3.create(),r5=U.mat4.create(),r4=U.quat.create(),r7=U.vec3.create(),r6=U.quat.create(),r8=U.vec3.create(),r9=U.vec3.create(),ie=U.vec3.create(),it=U.mat4.create(),ir=U.quat.create(),ii=U.quat.create(),ia=U.quat.create(),io={affectChildren:!0},is=(0,O.default)(function e(t){(0,N.default)(this,e),this.pendingEvents=new Map,this.boundsChangedEvent=new rF(rX.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=t;},[{key:"matches",value:function(e,t){return this.runtime.sceneGraphSelector.is(e,t);}},{key:"querySelector",value:function(e,t){return this.runtime.sceneGraphSelector.selectOne(e,t);}},{key:"querySelectorAll",value:function(e,t){return this.runtime.sceneGraphSelector.selectAll(e,t);}},{key:"attach",value:function(e,t,n){var r=!1;e.parentNode&&(r=e.parentNode!==t,this.detach(e));var i=e.nodeName===K.FRAGMENT,a=re(t);e.parentNode=t;var o=i?e.childNodes:[e];(0,F.isNumber)(n)?o.forEach(function(e){t.childNodes.splice(n,0,e),e.parentNode=t;}):o.forEach(function(e){t.childNodes.push(e),e.parentNode=t;});var s=t.sortable;if((null!=s&&null!==(u=s.sorted)&&void 0!==u&&u.length||s.dirty||e.parsedStyle.zIndex)&&(-1===s.dirtyChildren.indexOf(e)&&s.dirtyChildren.push(e),s.dirty=!0,s.dirtyReason=eR.ADDED),!a){if(i)this.dirtifyFragment(e);else{var l=e.transformable;l&&this.dirtyWorldTransform(e,l);}if(r){var u,c,d=(null===(c=t.ownerDocument)||void 0===c||null===(c=c.defaultView)||void 0===c||null===(c=c.getConfig())||void 0===c||null===(c=c.future)||void 0===c?void 0:c.experimentalCancelEventPropagation)===!0;e.dispatchEvent(rK,d,d);}}}},{key:"detach",value:function(e){if(e.parentNode){var t,n,r=e.transformable,i=e.parentNode.sortable;(null!=i&&null!==(t=i.sorted)&&void 0!==t&&t.length||null!==(n=e.style)&&void 0!==n&&n.zIndex)&&(-1===i.dirtyChildren.indexOf(e)&&i.dirtyChildren.push(e),i.dirty=!0,i.dirtyReason=eR.REMOVED);var a=e.parentNode.childNodes.indexOf(e);a>-1&&e.parentNode.childNodes.splice(a,1),r&&this.dirtyWorldTransform(e,r),e.parentNode=null;}}},{key:"getLocalPosition",value:function(e){return e.transformable.localPosition;}},{key:"getLocalRotation",value:function(e){return e.transformable.localRotation;}},{key:"getLocalScale",value:function(e){return e.transformable.localScale;}},{key:"getLocalSkew",value:function(e){return e.transformable.localSkew;}},{key:"getLocalTransform",value:function(e){var t=e.transformable;return eU(t),t.localTransform;}},{key:"setLocalPosition",value:function(e,t){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=e.transformable;r9[0]=t[0],r9[1]=t[1],r9[2]=null!==(n=t[2])&&void 0!==n?n:0,!U.vec3.equals(i.localPosition,r9)&&(U.vec3.copy(i.localPosition,r9),r&&this.dirtyLocalTransform(e,i));}},{key:"translateLocal",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof t&&(t=U.vec3.fromValues(t,n,r));var i=e.transformable;U.vec3.equals(t,rJ)||(U.vec3.transformQuat(t,t,i.localRotation),U.vec3.add(i.localPosition,i.localPosition,t),this.dirtyLocalTransform(e,i));}},{key:"setLocalRotation",value:function(e,t,n,r,i){var a=!(arguments.length>5)||void 0===arguments[5]||arguments[5];"number"==typeof t&&(t=U.quat.set(r4,t,n,r,i));var o=e.transformable;U.quat.copy(o.localRotation,t),a&&this.dirtyLocalTransform(e,o);}},{key:"rotateLocal",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof t&&(t=U.vec3.fromValues(t,n,r));var i=e.transformable;U.quat.fromEuler(ii,t[0],t[1],t[2]),U.quat.mul(i.localRotation,i.localRotation,ii),this.dirtyLocalTransform(e,i);}},{key:"setLocalScale",value:function(e,t){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=e.transformable;U.vec3.set(r3,t[0],t[1],null!==(n=t[2])&&void 0!==n?n:i.localScale[2]),!U.vec3.equals(r3,i.localScale)&&(U.vec3.copy(i.localScale,r3),r&&this.dirtyLocalTransform(e,i));}},{key:"scaleLocal",value:function(e,t){var n,r=e.transformable;U.vec3.multiply(r.localScale,r.localScale,U.vec3.set(r3,t[0],t[1],null!==(n=t[2])&&void 0!==n?n:1)),this.dirtyLocalTransform(e,r);}},{key:"setLocalSkew",value:function(e,t,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];"number"==typeof t&&(t=U.vec2.set(r2,t,n));var i=e.transformable;U.vec2.copy(i.localSkew,t),r&&this.dirtyLocalTransform(e,i);}},{key:"setLocalEulerAngles",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4];"number"==typeof t&&(t=U.vec3.fromValues(t,n,r));var a=e.transformable;U.quat.fromEuler(a.localRotation,t[0],t[1],t[2]),i&&this.dirtyLocalTransform(e,a);}},{key:"setLocalTransform",value:function(e,t){var n=U.mat4.getTranslation(r7,t),r=U.mat4.getRotation(r6,t),i=U.mat4.getScaling(r8,t);this.setLocalScale(e,i,!1),this.setLocalPosition(e,n,!1),this.setLocalRotation(e,r,void 0,void 0,void 0,!1),this.dirtyLocalTransform(e,e.transformable);}},{key:"resetLocalTransform",value:function(e){this.setLocalScale(e,r0,!1),this.setLocalPosition(e,rJ,!1),this.setLocalEulerAngles(e,rJ,void 0,void 0,!1),this.setLocalSkew(e,rQ,void 0,!1),this.dirtyLocalTransform(e,e.transformable);}},{key:"getPosition",value:function(e){var t=e.transformable;return U.mat4.getTranslation(t.position,this.getWorldTransform(e,t));}},{key:"getRotation",value:function(e){var t=e.transformable;return U.mat4.getRotation(t.rotation,this.getWorldTransform(e,t));}},{key:"getScale",value:function(e){var t=e.transformable;return U.mat4.getScaling(t.scaling,this.getWorldTransform(e,t));}},{key:"getOrigin",value:function(e){return e.getGeometryBounds(),e.transformable.origin;}},{key:"getWorldTransform",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transformable;return(t.localDirtyFlag||t.dirtyFlag)&&(e.parentNode&&e.parentNode.transformable&&this.getWorldTransform(e.parentNode),this.internalUpdateTransform(e)),t.worldTransform;}},{key:"setPosition",value:function(e,t){var n,r=e.transformable;if(ie[0]=t[0],ie[1]=t[1],ie[2]=null!==(n=t[2])&&void 0!==n?n:0,!U.vec3.equals(this.getPosition(e),ie)){if(U.vec3.copy(r.position,ie),null!==e.parentNode&&e.parentNode.transformable){var i=e.parentNode.transformable;U.mat4.copy(it,i.worldTransform),U.mat4.invert(it,it),U.vec3.transformMat4(r.localPosition,ie,it);}else U.vec3.copy(r.localPosition,ie);this.dirtyLocalTransform(e,r);}}},{key:"translate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof t&&(t=U.vec3.set(r3,t,n,r)),U.vec3.equals(t,rJ)||(U.vec3.add(r3,this.getPosition(e),t),this.setPosition(e,r3));}},{key:"setRotation",value:function(e,t,n,r,i){var a=e.transformable;if("number"==typeof t&&(t=U.quat.fromValues(t,n,r,i)),null!==e.parentNode&&e.parentNode.transformable){var o=this.getRotation(e.parentNode);U.quat.copy(r4,o),U.quat.invert(r4,r4),U.quat.multiply(a.localRotation,r4,t),U.quat.normalize(a.localRotation,a.localRotation),this.dirtyLocalTransform(e,a);}else this.setLocalRotation(e,t);}},{key:"rotate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof t&&(t=U.vec3.fromValues(t,n,r));var i=e.transformable;if(null!==e.parentNode&&e.parentNode.transformable){U.quat.fromEuler(r4,t[0],t[1],t[2]);var a=this.getRotation(e),o=this.getRotation(e.parentNode);U.quat.copy(ia,o),U.quat.invert(ia,ia),U.quat.multiply(r4,ia,r4),U.quat.multiply(i.localRotation,r4,a),U.quat.normalize(i.localRotation,i.localRotation),this.dirtyLocalTransform(e,i);}else this.rotateLocal(e,t);}},{key:"setOrigin",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof t&&(t=[t,n,r]);var i=e.transformable;if(t[0]!==i.origin[0]||t[1]!==i.origin[1]||t[2]!==i.origin[2]){var a=i.origin;a[0]=t[0],a[1]=t[1],a[2]=t[2]||0,this.dirtyLocalTransform(e,i);}}},{key:"setEulerAngles",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof t&&(t=U.vec3.fromValues(t,n,r));var i=e.transformable;if(null!==e.parentNode&&e.parentNode.transformable){U.quat.fromEuler(i.localRotation,t[0],t[1],t[2]);var a=this.getRotation(e.parentNode);U.quat.copy(ir,U.quat.invert(r4,a)),U.quat.mul(i.localRotation,i.localRotation,ir),this.dirtyLocalTransform(e,i);}else this.setLocalEulerAngles(e,t);}},{key:"getTransformedGeometryBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.getGeometryBounds(e,t);if(!ea.isEmpty(r)){var i=n||new ea;return i.setFromTransformedAABB(r,this.getWorldTransform(e)),i;}return null;}},{key:"getGeometryBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.geometry;return n.dirty&&ip.styleValueRegistry.updateGeometry(e),(t?n.renderBounds:n.contentBounds||null)||new ea;}},{key:"getBounds",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.renderable;if(!r.boundsDirty&&!n&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&n&&r.renderBounds)return r.renderBounds;var i=n?r.renderBounds:r.bounds,a=this.getTransformedGeometryBounds(e,n,i);if(e.childNodes.forEach(function(e){var r=t.getBounds(e,n);r&&(a?a.add(r):(a=i||new ea).update(r.center,r.halfExtents));}),a||(a=new ea),n){var o=function(e){var t,n=e;do{if(null===(t=n.parsedStyle)||void 0===t?void 0:t.clipPath)return n;n=n.parentElement;}while(null!==n)return null;}(e);if(o){var s=o.parsedStyle.clipPath.getBounds(n);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents);}}return n?(r.renderBounds=a,r.renderBoundsDirty=!1):(r.bounds=a,r.boundsDirty=!1),a;}},{key:"getLocalBounds",value:function(e){if(e.parentNode){var t=r1;e.parentNode.transformable&&(t=U.mat4.invert(r5,this.getWorldTransform(e.parentNode)));var n=this.getBounds(e);if(!ea.isEmpty(n)){var r=new ea;return r.setFromTransformedAABB(n,t),r;}}return this.getBounds(e);}},{key:"getBoundingClientRect",value:function(e){var t,n,r=this.getGeometryBounds(e);ea.isEmpty(r)||(n=new ea).setFromTransformedAABB(r,this.getWorldTransform(e));var i=null===(t=e.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t?void 0:t.getContextService().getBoundingClientRect();if(n){var a=n.getMin(),o=(0,z.default)(a,2),s=o[0],l=o[1],u=n.getMax(),c=(0,z.default)(u,2),d=c[0],f=c[1];return new ec(s+((null==i?void 0:i.left)||0),l+((null==i?void 0:i.top)||0),d-s,f-l);}return new ec((null==i?void 0:i.left)||0,(null==i?void 0:i.top)||0,0,0);}},{key:"internalUpdateTransform",value:function(e){var t,n,r=null===(n=e.parentNode)||void 0===n?void 0:n.transformable;eU(e.transformable),(t=e.transformable).dirtyFlag&&(r?U.mat4.multiply(t.worldTransform,r.worldTransform,t.localTransform):U.mat4.copy(t.worldTransform,t.localTransform),t.dirtyFlag=!1);}},{key:"internalUpdateElement",value:function(e,t){var n=(null===(s=e.ownerDocument)||void 0===s||null===(s=s.defaultView)||void 0===s||null===(s=s.getConfig())||void 0===s||null===(s=s.future)||void 0===s?void 0:s.experimentalAttributeUpdateOptimization)===!0,r=t[t.length-1],i=(null==r?void 0:r.transformDirty)||(null===(l=e.transformable)||void 0===l?void 0:l.localDirtyFlag);e.transformable&&((d=e.transformable).dirtyFlag||(d.dirtyFlag=i)),this.internalUpdateTransform(e),i&&(null===(f=e.dirty)||void 0===f||f.call(e,!0,!0));var a=(null===(u=e.renderable)||void 0===u?void 0:u.boundsDirty)||(null===(c=e.renderable)||void 0===c?void 0:c.renderBoundsDirty);if((i||a)&&(null==r?void 0:r.shapeUpdated)===!1&&n)for(var o=t.length-1;o>=0;){var s,l,u,c,d,f,h,p,v=t[o];if(v.shapeUpdated)break;null===(h=(p=v.node).dirty)||void 0===h||h.call(p,!0,!0),v.shapeUpdated=!0,o-=1;}return i;}},{key:"syncHierarchy",value:function(e){for(var t,n,r=[e],i=e.parentNode?[{node:e.parentNode,transformDirty:(null===(t=e.parentNode.transformable)||void 0===t?void 0:t.localDirtyFlag)||(null===(n=e.parentNode.transformable)||void 0===n?void 0:n.dirtyFlag),shapeUpdated:!1}]:[];r.length>0;){for(var a=r.pop(),o=i[i.length-1];i.length>0&&a.parentNode!==o.node;)o=i.pop();var s=this.internalUpdateElement(a,i);if(a.childNodes.length>0){for(var l=a.childNodes.length-1;l>=0;l--)r.push(a.childNodes[l]);i.push({node:a,transformDirty:s,shapeUpdated:!1});}}}},{key:"dirtyLocalTransform",value:function(e,t){re(e)||t.localDirtyFlag||(t.localDirtyFlag=!0,t.dirtyFlag||this.dirtyWorldTransform(e,t));}},{key:"dirtyWorldTransform",value:function(e,t){this.dirtifyWorldInternal(e,t),this.dirtyToRoot(e,!0);}},{key:"dirtifyWorldInternal",value:function(e,t){var n,r=this,i=(null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization)===!0;t.dirtyFlag||(t.dirtyFlag=!0,e.dirty(!0,!0),i||e.childNodes.forEach(function(e){var t=e.transformable;r.dirtifyWorldInternal(e,t);}));}},{key:"dirtyToRoot",value:function(e){for(var t,n,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e,o=(null===(t=e.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig())||void 0===t||null===(t=t.future)||void 0===t?void 0:t.experimentalAttributeUpdateOptimization)===!0;a&&(null===(n=(r=a).dirty)||void 0===n||n.call(r,!0,!0),!o);)a=a.parentNode;i&&e.forEach(function(e){var t;null===(t=e.dirty)||void 0===t||t.call(e,!0,!0);}),this.informDependentDisplayObjects(e),this.pendingEvents.set(e,i);}},{key:"dirtifyFragment",value:function(e){var t,n=e.transformable;n&&(n.dirtyFlag=!0,n.localDirtyFlag=!0),null===(t=e.dirty)||void 0===t||t.call(e,!0,!0);for(var r=e.childNodes.length,i=0;i<r;i++)this.dirtifyFragment(e.childNodes[i]);e.nodeName===K.FRAGMENT&&this.pendingEvents.set(e,!1);}},{key:"triggerPendingEvents",value:function(){var e,t,n=this,r=new Set,i=function(t,i){if(!(!t.isConnected||r.has(t))&&t.nodeName!==K.FRAGMENT){if(n.boundsChangedEvent.detail=i,n.boundsChangedEvent.target=t,t.isMutationObserved)t.dispatchEvent(n.boundsChangedEvent);else{if(void 0===e){var a;e=(null===(a=t.ownerDocument.defaultView)||void 0===a||null===(a=a.getConfig())||void 0===a||null===(a=a.future)||void 0===a?void 0:a.experimentalCancelEventPropagation)===!0;}t.ownerDocument.defaultView.dispatchEvent(n.boundsChangedEvent,!0,e);}r.add(t);}};this.pendingEvents.forEach(function(e,n){if(n.nodeName!==K.FRAGMENT){if(void 0===t){var r;t=(null===(r=n.ownerDocument)||void 0===r||null===(r=r.defaultView)||void 0===r||null===(r=r.getConfig())||void 0===r||null===(r=r.future)||void 0===r?void 0:r.experimentalAttributeUpdateOptimization)===!0;}io.affectChildren=e,t?i(n,io):e?n.forEach(function(e){i(e,io);}):i(n,io);}}),r.clear(),this.clearPendingEvents();}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear();}},{key:"updateDisplayObjectDependency",value:function(e,t,n,r){if(t&&t!==n){var i=this.displayObjectDependencyMap.get(t);if(i&&i[e]){var a=i[e].indexOf(r);i[e].splice(a,1);}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[e]||(o[e]=[]),o[e].push(r);}}},{key:"informDependentDisplayObjects",value:function(e){var t,n=this,r=this.displayObjectDependencyMap.get(e);if(r){var i=null===(t=e.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig())||void 0===t||null===(t=t.future)||void 0===t?void 0:t.experimentalCancelEventPropagation;Object.keys(r).forEach(function(e){r[e].forEach(function(t){n.dirtyToRoot(t,!0),t.dispatchEvent(new r$(rX.ATTR_MODIFIED,t,n,n,e,r$.MODIFICATION,n,n),i,i),t.isCustomElement&&t.isConnected&&t.attributeChangedCallback&&t.attributeChangedCallback(e,n,n);});});}}}]),il={MetricsString:"|\xc9q\xc5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},iu=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,ic=new RegExp("".concat(/[!%),.:;?\]}¢°·'""†‡›℃∶、。〃〆〕〗〞﹚﹜！＂％＇），．：；？！］｝～]/.source,"|").concat(/[!),.:;?\]}¢·–—'"•"、。〆〞〕〉》」︰︱︲︳﹐﹑﹒﹓﹔﹕﹖﹘﹚﹜！），．：；？︶︸︺︼︾﹀﹂﹗］｜｝､]/.source,"|").concat(/[)\]｝〕〉》」』】〙〗〟'"｠»ヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻‐゠–〜?!‼⁇⁈⁉・、:;,。.]/.source,"|").concat(/[!%),.:;?\]}¢°'"†‡℃〆〈《「『〕！％），．：；？］｝]/.source)),id=new RegExp("".concat(/[$(£¥·'"〈《「『【〔〖〝﹙﹛＄（．［｛￡￥]/.source,"|").concat(/[([{£¥'"‵〈《「『〔〝︴﹙﹛（｛︵︷︹︻︽︿﹁﹃﹏]/.source,"|").concat(/[([｛〔〈《「『【〘〖〝'"｟«—...‥〳〴〵]/.source,"|").concat(/[$([{£¥'"々〇〉》」〔＄（［｛｠￥￦#]/.source)),ih=(0,O.default)(function e(t){var n=this;(0,N.default)(this,e),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(e,t){return!n.isBreakingSpace(t)&&!!(e&&(id.exec(t)||ic.exec(e)));},this.trimByKinsokuShorui=function(e){var t=(0,I.default)(e),n=t[t.length-2];if(!n)return e;var r=n[n.length-1];return t[t.length-2]=n.slice(0,-1),t[t.length-1]=r+t[t.length-1],t;},this.runtime=t;},[{key:"measureFont",value:function(e,t){if(this.fontMetricsCache[e])return this.fontMetricsCache[e];var n={ascent:0,descent:0,fontSize:0},r=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(t),i=this.runtime.offscreenCanvasCreator.getOrCreateContext(t,{willReadFrequently:!0});i.font=e;var a=il.MetricsString+il.BaselineSymbol,o=Math.ceil(i.measureText(a).width),s=Math.ceil(i.measureText(il.BaselineSymbol).width),l=il.HeightMultiplier*s;s=s*il.BaselineMultiplier|0,r.width=o,r.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(a,0,s);var u=i.getImageData(0,0,o||1,l||1).data,c=u.length,d=4*o,f=0,h=0,p=!1;for(f=0;f<s;++f){for(var v=0;v<d;v+=4)if(255!==u[h+v]){p=!0;break;}if(p)break;h+=d;}for(n.ascent=s-f,h=c-d,p=!1,f=l;f>s;--f){for(var g=0;g<d;g+=4)if(255!==u[h+g]){p=!0;break;}if(p)break;h-=d;}return n.descent=f-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[e]=n,n;}},{key:"measureText",value:function(e,t,n){var r=t.fontSize,i=void 0===r?16:r,a=t.wordWrap,o=t.lineHeight,s=t.lineWidth,l=void 0===s?1:s,u=t.textBaseline,c=void 0===u?"alphabetic":u,d=t.textAlign,f=void 0===d?"start":d,h=t.letterSpacing,p=void 0===h?0:h,v=t.textPath;t.textPathSide,t.textPathStartOffset;var g=t.leading,m=void 0===g?0:g,y=function(e){for(var t=e.fontSize,n=void 0===t?16:t,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight,s=(0,F.isNumber)(n)&&"".concat(n,"px")||"16px",l=(void 0===r?"sans-serif":r).split(","),u=l.length-1;u>=0;u--){var c=l[u].trim();!rg.test(c)&&0>rv.indexOf(c)&&(c='"'.concat(c,'"')),l[u]=c;}return"".concat(void 0===i?"normal":i," ").concat(void 0===a?"normal":a," ").concat(void 0===o?"normal":o," ").concat(s," ").concat(l.join(","));}(t),b=this.measureFont(y,n);0===b.fontSize&&(b.fontSize=i,b.ascent=i);var _=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);_.font=y,t.isOverflowing=!1;var x=(void 0!==a&&a?this.wordWrap(e,t,n):e).split(/(?:\r\n|\r|\n)/),w=Array(x.length),E=0;if(v){v.getTotalLength();for(var M=0;M<x.length;M++)_.measureText(x[M]).width,x[M].length;}else{for(var S=0;S<x.length;S++){var k=_.measureText(x[S]).width+(x[S].length-1)*p;w[S]=k,E=Math.max(E,k);}var C=E+l,A=o||b.fontSize+l,L=Math.max(A,b.fontSize+l)+(x.length-1)*(A+m);A+=m;var P=0;return"middle"===c?P=-L/2:"bottom"===c||"alphabetic"===c||"ideographic"===c?P=-L:("top"===c||"hanging"===c)&&(P=0),{font:y,width:C,height:L,lines:x,lineWidths:w,lineHeight:A,maxLineWidth:E,fontProperties:b,lineMetrics:w.map(function(e,t){var n=0;return"center"===f||"middle"===f?n-=e/2:("right"===f||"end"===f)&&(n-=e),new ec(n-l/2,P+t*A,e+l,A);})};}}},{key:"wordWrap",value:function(e,t,n){var r=this,i=Array.from(e);if(0===i.length)return"";var a=this,o=t.wordWrapWidth,s=t.letterSpacing,l=void 0===s?0:s,u=t.maxLines,c=void 0===u?1/0:u,d=t.textOverflow,f=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),h=(void 0===o?0:o)+l,p="";"ellipsis"===d?p="...":d&&"clip"!==d&&(p=d);var v=[""],g=0,m=0,y=-1,b={},_=function(e){return r.getFromCache(e,l,b,f);},x=_(p);function w(e,t,n,r){for(;_(e)<r&&t<i.length-1&&!a.isNewline(i[t+1]);)t+=1,e+=i[t];for(;_(e)>r&&t>=n;)t-=1,e=e.slice(0,-1);return{lineTxt:e,txtLastCharIndex:t};}function E(e,t){if(!(x<=0)&&!(x>h)){if(!v[e]){v[e]=p;return;}var n=w(v[e],t,y+1,h-x);v[e]=n.lineTxt+p;}}for(var M=0;M<i.length;M++){var S=i[M],k=i[M-1],C=i[M+1],A=_(S);if(this.isNewline(S)){if(g+1>=c){M<i.length-1&&E(g,M-1),t.isOverflowing=!0;break;}y=M-1,m=0,v[g+=1]="";continue;}if(A>h){E(g,M-1),t.isOverflowing=!0;break;}if(m>0&&m+A>h){var L=w(v[g],M-1,y+1,h);if(L.txtLastCharIndex!==M-1){if(v[g]=L.lineTxt,L.txtLastCharIndex===i.length-1)break;S=i[M=L.txtLastCharIndex+1],k=i[M-1],C=i[M+1],A=_(S);}if(g+1>=c){E(g,M-1),t.isOverflowing=!0;break;}if(y=M-1,m=0,v[g+=1]="",this.isBreakingSpace(S))continue;this.canBreakInLastChar(S)||(v=this.trimToBreakable(v),m=this.sumTextWidthByCache(v[g]||"",_)),this.shouldBreakByKinsokuShorui(S,C)&&(v=this.trimByKinsokuShorui(v),m+=_(k||""));}m+=A,v[g]+=S;}return v.join("\n");}},{key:"isBreakingSpace",value:function(e){return"string"==typeof e&&il.BreakingSpaces.indexOf(e.charCodeAt(0))>=0;}},{key:"isNewline",value:function(e){return"string"==typeof e&&il.Newlines.indexOf(e.charCodeAt(0))>=0;}},{key:"trimToBreakable",value:function(e){var t=(0,I.default)(e),n=t[t.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return t;var i=n.slice(r,r+1),a=this.isBreakingSpace(i);return t[t.length-1]+=n.slice(r+1,n.length),t[t.length-2]=n.slice(0,r+(a?0:1)),t;}},{key:"canBreakInLastChar",value:function(e){return!(e&&iu.test(e));}},{key:"sumTextWidthByCache",value:function(e,t){return e.split("").reduce(function(e,n){return e+t(n);},0);}},{key:"findBreakableIndex",value:function(e){for(var t=e.length-1;t>=0;t--)if(!iu.test(e[t]))return t;return -1;}},{key:"getFromCache",value:function(e,t,n,r){var i=n[e];if("number"!=typeof i){var a=e.length*t;i=r.measureText(e).width+a,n[e]=i;}return i;}}]),ip={},iv=(E=new rN,M=new rP,w={},(0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)(w,K.FRAGMENT,null),K.CIRCLE,new rk),K.ELLIPSE,new rC),K.RECT,E),K.IMAGE,E),K.GROUP,new rI),K.LINE,new rA),K.TEXT,new rO(ip)),K.POLYLINE,M),K.POLYGON,M),(0,j.default)((0,j.default)((0,j.default)(w,K.PATH,new rL),K.HTML,new rR),K.MESH,null)),ig=(k=new nG,C=new nZ,S={},(0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)(S,ej.PERCENTAGE,null),ej.NUMBER,new n$),ej.ANGLE,new nj),ej.DEFINED_PATH,new nV),ej.PAINT,k),ej.COLOR,k),ej.FILTER,new nH),ej.LENGTH,C),ej.LENGTH_PERCENTAGE,C),ej.LENGTH_PERCENTAGE_12,new nq),(0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)(S,ej.LENGTH_PERCENTAGE_14,new nY),ej.COORDINATE,new nZ),ej.OFFSET_DISTANCE,new nK),ej.OPACITY_VALUE,new nQ),ej.PATH,new nJ),ej.LIST_OF_POINTS,new n0),ej.SHADOW_BLUR,new n1),ej.TEXT,new n2),ej.TEXT_TRANSFORM,new n3),ej.TRANSFORM,new rM),(0,j.default)((0,j.default)((0,j.default)(S,ej.TRANSFORM_ORIGIN,new rT),ej.Z_INDEX,new rS),ej.MARKER,new nX));ip.CameraContribution=eO,ip.AnimationTimeline=null,ip.EasingFunction=null,ip.offscreenCanvasCreator=new rH,ip.sceneGraphSelector=new rY,ip.sceneGraphService=new is(ip),ip.textService=new ih(ip),ip.geometryUpdaterFactory=iv,ip.CSSPropertySyntaxFactory=ig,ip.styleValueRegistry=new nU(ip),ip.layoutRegistry=null,ip.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==Y?Y:{},ip.enableStyleSyntax=!0,ip.enableSizeAttenuation=!1;var im=0,iy=new r$(rX.INSERTED,null,"","","",0,"",""),ib=new r$(rX.REMOVED,null,"","","",0,"",""),i_=new rF(rX.DESTROY),ix=function(e){function t(){var e;(0,N.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,R.default)(this,t,[].concat(r))).entity=im++,e.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},e.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},e.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},e.cullable={strategy:eI.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},e.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},e.rBushNode={aabb:void 0},e.namespaceURI="g",e.scrollLeft=0,e.scrollTop=0,e.clientTop=0,e.clientLeft=0,e.style={},e.computedStyle={},e.parsedStyle={},e.attributes={},e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"dirty",value:function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.renderable.dirty=e,t&&(this.renderable.boundsDirty=e,this.renderable.renderBoundsDirty=e);}},{key:"className",get:function(){return this.getAttribute("class")||"";},set:function(e){this.setAttribute("class",e);}},{key:"classList",get:function(){return this.className.split(" ").filter(function(e){return""!==e;});}},{key:"tagName",get:function(){return this.nodeName;}},{key:"children",get:function(){return this.childNodes;}},{key:"childElementCount",get:function(){return this.childNodes.length;}},{key:"firstElementChild",get:function(){return this.firstChild;}},{key:"lastElementChild",get:function(){return this.lastChild;}},{key:"parentElement",get:function(){return this.parentNode;}},{key:"nextSibling",get:function(){if(this.parentNode){var e=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[e+1]||null;}return null;}},{key:"previousSibling",get:function(){if(this.parentNode){var e=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[e-1]||null;}return null;}},{key:"cloneNode",value:function(e){throw Error(ed);}},{key:"appendChild",value:function(e,t){var n;if(e.destroyed)throw Error("Cannot append a destroyed element.");return ip.sceneGraphService.attach(e,this,t),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(re(this)||e.nodeName!==K.FRAGMENT?this.ownerDocument.defaultView.mountChildren(e):this.ownerDocument.defaultView.mountFragment(e)),this.isMutationObserved&&(iy.relatedNode=this,e.dispatchEvent(iy)),e;}},{key:"insertBefore",value:function(e,t){if(t){e.parentElement&&e.parentElement.removeChild(e);var n=this.childNodes.indexOf(t);-1===n?this.appendChild(e):this.appendChild(e,n);}else this.appendChild(e);return e;}},{key:"replaceChild",value:function(e,t){var n=this.childNodes.indexOf(t);return this.removeChild(t),this.appendChild(e,n),t;}},{key:"removeChild",value:function(e){var t,n,r=(null===(t=this.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation)===!0;return ib.relatedNode=this,e.dispatchEvent(ib,r,r),null!==(n=e.ownerDocument)&&void 0!==n&&n.defaultView&&e.ownerDocument.defaultView.unmountChildren(e),ip.sceneGraphService.detach(e),e;}},{key:"removeChildren",value:function(){for(var e=this.childNodes.length-1;e>=0;e--){var t=this.childNodes[e];this.removeChild(t);}}},{key:"destroyChildren",value:function(){for(var e=this.childNodes.length-1;e>=0;e--){var t=this.childNodes[e];t.childNodes.length>0&&t.destroyChildren(),t.destroy();}}},{key:"matches",value:function(e){return ip.sceneGraphService.matches(e,this);}},{key:"getElementById",value:function(e){return ip.sceneGraphService.querySelector("#".concat(e),this);}},{key:"getElementsByName",value:function(e){return ip.sceneGraphService.querySelectorAll('[name="'.concat(e,'"]'),this);}},{key:"getElementsByClassName",value:function(e){return ip.sceneGraphService.querySelectorAll(".".concat(e),this);}},{key:"getElementsByTagName",value:function(e){return ip.sceneGraphService.querySelectorAll(e,this);}},{key:"querySelector",value:function(e){return ip.sceneGraphService.querySelector(e,this);}},{key:"querySelectorAll",value:function(e){return ip.sceneGraphService.querySelectorAll(e,this);}},{key:"closest",value:function(e){var t=this;do{if(ip.sceneGraphService.matches(e,t))return t;t=t.parentElement;}while(null!==t)return null;}},{key:"find",value:function(e){var t=this,n=null;return this.forEach(function(r){return!(r!==t&&e(r))||(n=r,!1);}),n;}},{key:"findAll",value:function(e){var t=this,n=[];return this.forEach(function(r){r!==t&&e(r)&&n.push(r);}),n;}},{key:"after",value:function(){var e=this;if(this.parentNode){for(var t=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(n,r){var i;return null===(i=e.parentNode)||void 0===i?void 0:i.appendChild(n,t+r+1);});}}},{key:"before",value:function(){if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n[0],a=n.slice(1);this.parentNode.appendChild(i,e),i.after.apply(i,(0,I.default)(a));}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove();}},{key:"append",value:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach(function(t){return e.appendChild(t);});}},{key:"prepend",value:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach(function(t,n){return e.appendChild(t,n);});}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments);}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this;}},{key:"destroy",value:function(){var e,t=(null===(e=this.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;this.destroyChildren(),this.dispatchEvent(i_,t,t),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0;}},{key:"getGeometryBounds",value:function(){return ip.sceneGraphService.getGeometryBounds(this);}},{key:"getRenderBounds",value:function(){return ip.sceneGraphService.getBounds(this,!0);}},{key:"getBounds",value:function(){return ip.sceneGraphService.getBounds(this);}},{key:"getLocalBounds",value:function(){return ip.sceneGraphService.getLocalBounds(this);}},{key:"getBoundingClientRect",value:function(){return ip.sceneGraphService.getBoundingClientRect(this);}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle));}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes);}},{key:"getAttribute",value:function(e){if("symbol"!=typeof e)return this.attributes[e];}},{key:"hasAttribute",value:function(e){return this.getAttributeNames().includes(e);}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length;}},{key:"removeAttribute",value:function(e){this.setAttribute(e,null),delete this.attributes[e];}},{key:"setAttribute",value:function(e,t,n,r){this.attributes[e]=t;}},{key:"getAttributeNS",value:function(e,t){throw Error(ed);}},{key:"getAttributeNode",value:function(e){throw Error(ed);}},{key:"getAttributeNodeNS",value:function(e,t){throw Error(ed);}},{key:"hasAttributeNS",value:function(e,t){throw Error(ed);}},{key:"removeAttributeNS",value:function(e,t){throw Error(ed);}},{key:"removeAttributeNode",value:function(e){throw Error(ed);}},{key:"setAttributeNS",value:function(e,t,n){throw Error(ed);}},{key:"setAttributeNode",value:function(e){throw Error(ed);}},{key:"setAttributeNodeNS",value:function(e){throw Error(ed);}},{key:"toggleAttribute",value:function(e,t){throw Error(ed);}}]);}(rV);function iw(e){return!!(null!=e&&e.nodeName);}var iE=ip.globalThis.Proxy?ip.globalThis.Proxy:function(){},iM=new r$(rX.ATTR_MODIFIED,null,null,null,null,r$.MODIFICATION,null,null),iT=U.vec3.create(),iS=U.quat.create(),ik=function(e){function t(e){var n;return(0,N.default)(this,t),(n=(0,R.default)(this,t)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=e,n.id=e.id||"",n.name=e.name||"",(e.className||e.class)&&(n.className=e.className||e.class),n.nodeName=e.type||K.GROUP,e.initialParsedStyle&&Object.assign(n.parsedStyle,e.initialParsedStyle),n.initAttributes(e.style),ip.enableStyleSyntax&&(n.style=new iE({setProperty:function(e,t){n.setAttribute(e,t);},getPropertyValue:function(e){return n.getAttribute(e);},removeProperty:function(e){n.removeAttribute(e);},item:function(){return"";}},{get:function(e,t){return void 0!==e[t]?e[t]:n.getAttribute(t);},set:function(e,t,r){return n.setAttribute(t,r),!0;}})),n;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"destroy",value:function(){(0,V.default)(t,"destroy",this,3)([]),this.getAnimations().forEach(function(e){e.cancel();});}},{key:"cloneNode",value:function(e,t){var n=(0,P.default)({},this.attributes);for(var r in n){var i=n[r];iw(i)&&"clipPath"!==r&&"offsetPath"!==r&&"textPath"!==r&&(n[r]=i.cloneNode(e)),t&&(n[r]=t(r,i));}var a=new this.constructor((0,P.default)((0,P.default)({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),e&&this.children.forEach(function(t){if(!t.style.isMarker){var n=t.cloneNode(e);a.appendChild(n);}}),a;}},{key:"initAttributes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ip.styleValueRegistry.processProperties(this,e,{forceUpdateGeometry:!0}),this.dirty();}},{key:"setAttribute",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];!(0,F.isUndefined)(n)&&(r||n!==this.attributes[e])&&(this.internalSetAttribute(e,n,{memoize:i}),(0,V.default)(t,"setAttribute",this,3)([e,n]));}},{key:"internalSetAttribute",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.attributes[e],a=this.parsedStyle[e];ip.styleValueRegistry.processProperties(this,(0,j.default)({},e,t),r),this.dirty();var o=this.parsedStyle[e];if(this.isConnected){if(iM.relatedNode=this,iM.prevValue=i,iM.newValue=t,iM.attrName=e,iM.prevParsedValue=a,iM.newParsedValue=o,this.isMutationObserved)this.dispatchEvent(iM);else{var s,l=(null===(s=this.ownerDocument.defaultView.getConfig().future)||void 0===s?void 0:s.experimentalCancelEventPropagation)===!0;iM.target=this,this.ownerDocument.defaultView.dispatchEvent(iM,!0,l);}}(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(n=this.attributeChangedCallback)||void 0===n||n.call(this,e,i,t,a,o));}},{key:"getBBox",value:function(){var e=this.getBounds(),t=e.getMin(),n=(0,z.default)(t,2),r=n[0],i=n[1],a=e.getMax(),o=(0,z.default)(a,2);return new ec(r,i,o[0]-r,o[1]-i);}},{key:"setOrigin",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ip.sceneGraphService.setOrigin(this,ev(e,t,n,!1)),this;}},{key:"getOrigin",value:function(){return ip.sceneGraphService.getOrigin(this);}},{key:"setPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ip.sceneGraphService.setPosition(this,ev(e,t,n,!1)),this;}},{key:"setLocalPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ip.sceneGraphService.setLocalPosition(this,ev(e,t,n,!1)),this;}},{key:"translate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ip.sceneGraphService.translate(this,ev(e,t,n,!1)),this;}},{key:"translateLocal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ip.sceneGraphService.translateLocal(this,ev(e,t,n,!1)),this;}},{key:"getPosition",value:function(){return ip.sceneGraphService.getPosition(this);}},{key:"getLocalPosition",value:function(){return ip.sceneGraphService.getLocalPosition(this);}},{key:"scale",value:function(e,t,n){return this.scaleLocal(e,t,n);}},{key:"scaleLocal",value:function(e,t,n){return"number"==typeof e&&(t=t||e,n=n||e,e=ev(e,t,n,!1)),ip.sceneGraphService.scaleLocal(this,e),this;}},{key:"setLocalScale",value:function(e,t,n){return"number"==typeof e&&(t=t||e,n=n||e,e=ev(e,t,n,!1)),ip.sceneGraphService.setLocalScale(this,e),this;}},{key:"getLocalScale",value:function(){return ip.sceneGraphService.getLocalScale(this);}},{key:"getScale",value:function(){return ip.sceneGraphService.getScale(this);}},{key:"getEulerAngles",value:function(){var e=ex(iT,ip.sceneGraphService.getWorldTransform(this));return(0,z.default)(e,3)[2]*ey;}},{key:"getLocalEulerAngles",value:function(){var e=ex(iT,ip.sceneGraphService.getLocalRotation(this));return(0,z.default)(e,3)[2]*ey;}},{key:"setEulerAngles",value:function(e){return ip.sceneGraphService.setEulerAngles(this,0,0,e),this;}},{key:"setLocalEulerAngles",value:function(e){return ip.sceneGraphService.setLocalEulerAngles(this,0,0,e),this;}},{key:"rotateLocal",value:function(e,t,n){return(0,F.isNil)(t)&&(0,F.isNil)(n)?ip.sceneGraphService.rotateLocal(this,0,0,e):ip.sceneGraphService.rotateLocal(this,e,t,n),this;}},{key:"rotate",value:function(e,t,n){return(0,F.isNil)(t)&&(0,F.isNil)(n)?ip.sceneGraphService.rotate(this,0,0,e):ip.sceneGraphService.rotate(this,e,t,n),this;}},{key:"setRotation",value:function(e,t,n,r){return ip.sceneGraphService.setRotation(this,e,t,n,r),this;}},{key:"setLocalRotation",value:function(e,t,n,r){return ip.sceneGraphService.setLocalRotation(this,e,t,n,r),this;}},{key:"setLocalSkew",value:function(e,t){return ip.sceneGraphService.setLocalSkew(this,e,t),this;}},{key:"getRotation",value:function(){return ip.sceneGraphService.getRotation(this);}},{key:"getLocalRotation",value:function(){return ip.sceneGraphService.getLocalRotation(this);}},{key:"getLocalSkew",value:function(){return ip.sceneGraphService.getLocalSkew(this);}},{key:"getLocalTransform",value:function(){return ip.sceneGraphService.getLocalTransform(this);}},{key:"getWorldTransform",value:function(){return ip.sceneGraphService.getWorldTransform(this);}},{key:"setLocalTransform",value:function(e){return ip.sceneGraphService.setLocalTransform(this,e),this;}},{key:"resetLocalTransform",value:function(){ip.sceneGraphService.resetLocalTransform(this);}},{key:"getAnimations",value:function(){return this.activeAnimations;}},{key:"animate",value:function(e,t){var n,r=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return r?r.play(this,e,t):null;}},{key:"isVisible",value:function(){var e;return(null===(e=this.parsedStyle)||void 0===e?void 0:e.visibility)!=="hidden";}},{key:"interactive",get:function(){return this.isInteractive();},set:function(e){this.style.pointerEvents=e?"auto":"none";}},{key:"isInteractive",value:function(){var e;return(null===(e=this.parsedStyle)||void 0===e?void 0:e.pointerEvents)!=="none";}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible);}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,I.default)(this.parentNode.children.map(function(e){return Number(e.style.zIndex);})))+1),this;}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,I.default)(this.parentNode.children.map(function(e){return Number(e.style.zIndex);})))-1),this;}},{key:"getConfig",value:function(){return this.config;}},{key:"attr",value:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n[0],a=n[1];return i?(0,F.isObject)(i)?(Object.keys(i).forEach(function(t){e.setAttribute(t,i[t]);}),this):2===n.length?(this.setAttribute(i,a),this):this.attributes[i]:this.attributes;}},{key:"getMatrix",value:function(e){var t,n,r,i=e||this.getWorldTransform(),a=U.mat4.getTranslation(iT,i),o=(0,z.default)(a,2),s=o[0],l=o[1],u=U.mat4.getScaling(iT,i),c=(0,z.default)(u,2),d=c[0],f=c[1],h=ex(iT,U.mat4.getRotation(iS,i)),p=(0,z.default)(h,3),v=p[0],g=p[2];return n=Math.cos(t=v||g),r=Math.sin(t),U.mat3.fromValues(d*n,f*r,0,-d*r,f*n,0,s,l,1);}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform());}},{key:"setMatrix",value:function(e){var t=ew(e),n=(0,z.default)(t,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setEulerAngles(s).setPosition(r,i).setLocalScale(a,o);}},{key:"setLocalMatrix",value:function(e){var t=ew(e),n=(0,z.default)(t,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setLocalEulerAngles(s).setLocalPosition(r,i).setLocalScale(a,o);}},{key:"show",value:function(){this.forEach(function(e){e.style.visibility="visible";});}},{key:"hide",value:function(){this.forEach(function(e){e.style.visibility="hidden";});}},{key:"getCount",value:function(){return this.childElementCount;}},{key:"getParent",value:function(){return this.parentElement;}},{key:"getChildren",value:function(){return this.children;}},{key:"getFirst",value:function(){return this.firstElementChild;}},{key:"getLast",value:function(){return this.lastElementChild;}},{key:"getChildByIndex",value:function(e){return this.children[e]||null;}},{key:"add",value:function(e,t){return this.appendChild(e,t);}},{key:"set",value:function(e,t){this.config[e]=t;}},{key:"get",value:function(e){return this.config[e];}},{key:"moveTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(e,t,n),this;}},{key:"move",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(e,t,n),this;}},{key:"setZIndex",value:function(e){return this.style.zIndex=e,this;}}]);}(ix);ik.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var iC=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:K.CIRCLE},e)]);}return(0,D.default)(t,e),(0,O.default)(t);}(ik);iC.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ik.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var iA=["style"],iL=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iA);return(0,N.default)(this,t),(e=(0,R.default)(this,t,[(0,P.default)({style:r},i)])).isCustomElement=!0,e;}return(0,D.default)(t,e),(0,O.default)(t);}(ik);iL.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iP=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:K.ELLIPSE},e)]);}return(0,D.default)(t,e),(0,O.default)(t);}(ik);iP.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ik.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),function(e){function t(){return(0,N.default)(this,t),(0,R.default)(this,t,[{type:K.FRAGMENT}]);}return(0,D.default)(t,e),(0,O.default)(t);}(ik).PARSED_STYLE_LIST=new Set(["class","className"]);var iN=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:K.GROUP},e)]);}return(0,D.default)(t,e),(0,O.default)(t);}(ik);iN.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iO=["style"],iI=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iO);return(0,N.default)(this,t),(e=(0,R.default)(this,t,[(0,P.default)({type:K.HTML,style:r},i)])).cullable.enable=!1,e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"getDomElement",value:function(){return this.parsedStyle.$el;}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"getLocalBounds",value:function(){if(this.parentNode){var e=U.mat4.invert(U.mat4.create(),this.parentNode.getWorldTransform()),t=this.getBounds();if(!ea.isEmpty(t)){var n=new ea;return n.setFromTransformedAABB(t,e),n;}}return this.getBounds();}}]);}(ik);iI.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ik.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var iR=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:K.IMAGE},e)]);}return(0,D.default)(t,e),(0,O.default)(t);}(ik);iR.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ik.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var iD=["style"],iz=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iD);(0,N.default)(this,t),(e=(0,R.default)(this,t,[(0,P.default)({type:K.LINE,style:(0,P.default)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},r)},i)])).markerStartAngle=0,e.markerEndAngle=0;var a=e.parsedStyle,o=a.markerStart,s=a.markerEnd;return o&&iw(o)&&(e.markerStartAngle=o.getLocalEulerAngles(),e.appendChild(o)),s&&iw(s)&&(e.markerEndAngle=s.getLocalEulerAngles(),e.appendChild(s)),e.transformMarker(!0),e.transformMarker(!1),e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"attributeChangedCallback",value:function(e,t,n,r,i){"x1"===e||"y1"===e||"x2"===e||"y2"===e||"markerStartOffset"===e||"markerEndOffset"===e?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===e?(r&&iw(r)&&(this.markerStartAngle=0,r.remove()),i&&iw(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===e&&(r&&iw(r)&&(this.markerEndAngle=0,r.remove()),i&&iw(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)));}},{key:"transformMarker",value:function(e){var t,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,d=s.markerEndOffset,f=s.x1,h=s.x2,p=s.y1,v=s.y2,g=e?l:u;if(g&&iw(g)){var m=0;e?(r=f,i=p,t=h-f,n=v-p,a=c||0,o=this.markerStartAngle):(r=h,i=v,t=f-h,n=p-v,a=d||0,o=this.markerEndAngle),m=Math.atan2(n,t),g.setLocalEulerAngles(180*m/Math.PI+o),g.setLocalPosition(r+Math.cos(m)*a,i+Math.sin(m)*a);}}},{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,r=n.x1,i=n.y1,a=n.x2,o=n.y2,s=(0,G.linePointAt)(r,i,a,o,e),l=s.x,u=s.y,c=U.vec3.transformMat4(U.vec3.create(),U.vec3.fromValues(l,u,0),t?this.getWorldTransform():this.getLocalTransform());return new eu(c[0],c[1]);}},{key:"getPointAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(e/this.getTotalLength(),t);}},{key:"getTotalLength",value:function(){var e=this.parsedStyle,t=e.x1,n=e.y1,r=e.x2,i=e.y2;return(0,G.lineLength)(t,n,r,i);}}]);}(ik);iz.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ik.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var iB=["style"],iU=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iB);(0,N.default)(this,t),(e=(0,R.default)(this,t,[(0,P.default)({type:K.PATH,style:r,initialParsedStyle:{miterLimit:4,d:(0,P.default)({},eF)}},i)])).markerStartAngle=0,e.markerEndAngle=0,e.markerMidList=[];var a=e.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&iw(o)&&(e.markerStartAngle=o.getLocalEulerAngles(),e.appendChild(o)),l&&iw(l)&&e.placeMarkerMid(l),s&&iw(s)&&(e.markerEndAngle=s.getLocalEulerAngles(),e.appendChild(s)),e.transformMarker(!0),e.transformMarker(!1),e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"attributeChangedCallback",value:function(e,t,n,r,i){"d"===e?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===e||"markerEndOffset"===e?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===e?(r&&iw(r)&&(this.markerStartAngle=0,r.remove()),i&&iw(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===e?(r&&iw(r)&&(this.markerEndAngle=0,r.remove()),i&&iw(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===e&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(e){var t,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,d=s.markerEndOffset,f=e?l:u;if(f&&iw(f)){var h=0;if(e){var p=this.getStartTangent(),v=(0,z.default)(p,2),g=v[0],m=v[1];r=m[0],i=m[1],t=g[0]-m[0],n=g[1]-m[1],a=c||0,o=this.markerStartAngle;}else{var y=this.getEndTangent(),b=(0,z.default)(y,2),_=b[0],x=b[1];r=x[0],i=x[1],t=_[0]-x[0],n=_[1]-x[1],a=d||0,o=this.markerEndAngle;}h=Math.atan2(n,t),f.setLocalEulerAngles(180*h/Math.PI+o),f.setLocalPosition(r+Math.cos(h)*a,i+Math.sin(h)*a);}}},{key:"placeMarkerMid",value:function(e){var t=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(e){e.remove();}),e&&iw(e))for(var n=1;n<t.length-1;n++){var r=(0,z.default)(t[n].currentPoint,2),i=r[0],a=r[1],o=1===n?e:e.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(i,a);}}},{key:"getTotalLength",value:function(){return nn(this);}},{key:"getPointAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.d.absolutePath,r=(0,F.getPointAtLength)(n,e),i=r.x,a=r.y,o=U.vec3.transformMat4(U.vec3.create(),U.vec3.fromValues(i,a,0),t?this.getWorldTransform():this.getLocalTransform());return new eu(o[0],o[1]);}},{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(e*nn(this),t);}},{key:"getStartTangent",value:function(){var e=this.parsedStyle.d.segments,t=[];if(e.length>1){var n=e[0].currentPoint,r=e[1].currentPoint,i=e[1].startTangent;t=[],i?t.push([n[0]-i[0],n[1]-i[1]]):t.push([r[0],r[1]]),t.push([n[0],n[1]]);}return t;}},{key:"getEndTangent",value:function(){var e=this.parsedStyle.d.segments,t=e.length,n=[];if(t>1){var r=e[t-2].currentPoint,i=e[t-1].currentPoint,a=e[t-1].endTangent;n=[],a?n.push([i[0]-a[0],i[1]-a[1]]):n.push([r[0],r[1]]),n.push([i[0],i[1]]);}return n;}}]);}(ik);iU.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ik.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var iF=["style"],ij=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iF);(0,N.default)(this,t),(e=(0,R.default)(this,t,[(0,P.default)({type:K.POLYGON,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},i)])).markerStartAngle=0,e.markerEndAngle=0,e.markerMidList=[];var a=e.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&iw(o)&&(e.markerStartAngle=o.getLocalEulerAngles(),e.appendChild(o)),l&&iw(l)&&e.placeMarkerMid(l),s&&iw(s)&&(e.markerEndAngle=s.getLocalEulerAngles(),e.appendChild(s)),e.transformMarker(!0),e.transformMarker(!1),e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"attributeChangedCallback",value:function(e,t,n,r,i){"points"===e?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===e||"markerEndOffset"===e?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===e?(r&&iw(r)&&(this.markerStartAngle=0,r.remove()),i&&iw(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===e?(r&&iw(r)&&(this.markerEndAngle=0,r.remove()),i&&iw(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===e&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(e){var t,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,d=s.markerEndOffset,f=(s.points||{}).points,h=e?l:u;if(h&&iw(h)&&f){var p=0;if(r=f[0][0],i=f[0][1],e)t=f[1][0]-f[0][0],n=f[1][1]-f[0][1],a=c||0,o=this.markerStartAngle;else{var v=f.length;this.parsedStyle.isClosed?(t=f[v-1][0]-f[0][0],n=f[v-1][1]-f[0][1]):(r=f[v-1][0],i=f[v-1][1],t=f[v-2][0]-f[v-1][0],n=f[v-2][1]-f[v-1][1]),a=d||0,o=this.markerEndAngle;}p=Math.atan2(n,t),h.setLocalEulerAngles(180*p/Math.PI+o),h.setLocalPosition(r+Math.cos(p)*a,i+Math.sin(p)*a);}}},{key:"placeMarkerMid",value:function(e){var t=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach(function(e){e.remove();}),this.markerMidList=[],e&&iw(e)&&t)for(var n=1;n<(this.parsedStyle.isClosed?t.length:t.length-1);n++){var r=t[n][0],i=t[n][1],a=1===n?e:e.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(r,i);}}}]);}(ik);ij.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ik.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var iV=["style"],iG=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.style,r=(0,q.default)(e,iV);return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:K.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},r)]);}return(0,D.default)(t,e),(0,O.default)(t,[{key:"getTotalLength",value:function(){return 0===this.parsedStyle.points.totalLength&&(this.parsedStyle.points.totalLength=(0,G.polylineLength)(this.parsedStyle.points.points)),this.parsedStyle.points.totalLength;}},{key:"getPointAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(e/this.getTotalLength(),t);}},{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var r,i,a=[],o=0,s=this.getTotalLength();n.forEach(function(e,t){n[t+1]&&((r=[0,0])[0]=o/s,i=(0,G.lineLength)(e[0],e[1],n[t+1][0],n[t+1][1]),o+=i,r[1]=o/s,a.push(r));}),this.parsedStyle.points.segments=a;}var l=0,u=0;this.parsedStyle.points.segments.forEach(function(t,n){e>=t[0]&&e<=t[1]&&(l=(e-t[0])/(t[1]-t[0]),u=n);});var c=(0,G.linePointAt)(n[u][0],n[u][1],n[u+1][0],n[u+1][1],l),d=c.x,f=c.y,h=U.vec3.transformMat4(U.vec3.create(),U.vec3.fromValues(d,f,0),t?this.getWorldTransform():this.getLocalTransform());return new eu(h[0],h[1]);}},{key:"getStartTangent",value:function(){var e=this.parsedStyle.points.points,t=[];return t.push([e[1][0],e[1][1]]),t.push([e[0][0],e[0][1]]),t;}},{key:"getEndTangent",value:function(){var e=this.parsedStyle.points.points,t=e.length-1,n=[];return n.push([e[t-1][0],e[t-1][1]]),n.push([e[t][0],e[t][1]]),n;}}]);}(ij);iG.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ij.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var iH=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:K.RECT},e)]);}return(0,D.default)(t,e),(0,O.default)(t);}(ik);iH.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ik.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var iW=["style"],iZ=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.style,r=(0,q.default)(e,iW);return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:K.TEXT,style:(0,P.default)({fill:"black"},n)},r)]);}return(0,D.default)(t,e),(0,O.default)(t,[{key:"getComputedTextLength",value:function(){var e;return this.getGeometryBounds(),(null===(e=this.parsedStyle.metrics)||void 0===e?void 0:e.maxLineWidth)||0;}},{key:"getLineBoundingRects",value:function(){var e;return this.getGeometryBounds(),(null===(e=this.parsedStyle.metrics)||void 0===e?void 0:e.lineMetrics)||[];}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing;}}]);}(ik);iZ.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ik.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textPathSide","textPathStartOffset","metrics","dx","dy"]));var iq=(0,O.default)(function e(){(0,N.default)(this,e),this.registry={},this.define(K.CIRCLE,iC),this.define(K.ELLIPSE,iP),this.define(K.RECT,iH),this.define(K.IMAGE,iR),this.define(K.LINE,iz),this.define(K.GROUP,iN),this.define(K.PATH,iU),this.define(K.POLYGON,ij),this.define(K.POLYLINE,iG),this.define(K.TEXT,iZ),this.define(K.HTML,iI);},[{key:"define",value:function(e,t){this.registry[e]=t;}},{key:"get",value:function(e){return this.registry[e];}}]),iY={number:function(e){return new tk(e);},percent:function(e){return new tk(e,"%");},px:function(e){return new tk(e,"px");},em:function(e){return new tk(e,"em");},rem:function(e){return new tk(e,"rem");},deg:function(e){return new tk(e,"deg");},grad:function(e){return new tk(e,"grad");},rad:function(e){return new tk(e,"rad");},turn:function(e){return new tk(e,"turn");},s:function(e){return new tk(e,"s");},ms:function(e){return new tk(e,"ms");},registerProperty:function(e){var t=e.name,n=e.inherits,r=e.interpolable,i=e.initialValue,a=e.syntax;ip.styleValueRegistry.registerMetadata({n:t,inh:n,int:r,d:i,syntax:a});},registerLayout:function(e,t){ip.layoutRegistry.registerLayout(e,t);}},iX=function(e){var t,n;function r(){(0,N.default)(this,r),(e=(0,R.default)(this,r)).defaultView=null,e.ownerDocument=null,e.nodeName="document";try{e.timeline=new ip.AnimationTimeline(e);}catch(e){}var e,t={};return nD.forEach(function(e){var n=e.n,r=e.inh,i=e.d;r&&i&&(t[n]=(0,F.isFunction)(i)?i(K.GROUP):i);}),e.documentElement=new iN({id:"g-root",style:t}),e.documentElement.ownerDocument=e,e.documentElement.parentNode=e,e.childNodes=[e.documentElement],e;}return(0,D.default)(r,e),(0,O.default)(r,[{key:"children",get:function(){return this.childNodes;}},{key:"childElementCount",get:function(){return this.childNodes.length;}},{key:"firstElementChild",get:function(){return this.firstChild;}},{key:"lastElementChild",get:function(){return this.lastChild;}},{key:"createElement",value:function(e,t){if("svg"===e)return this.documentElement;var n=this.defaultView.customElements.get(e);n||(console.warn("Unsupported tagName: ",e),n="tspan"===e?iZ:iN);var r=new n(t);return r.ownerDocument=this,r;}},{key:"createElementNS",value:function(e,t,n){return this.createElement(t,n);}},{key:"cloneNode",value:function(e){throw Error(ed);}},{key:"destroy",value:function(){try{this.documentElement.destroyChildren(),this.timeline.destroy();}catch(e){}}},{key:"elementsFromBBox",value:function(e,t,n,r){var i=this.defaultView.context.rBushRoot.search({minX:e,minY:t,maxX:n,maxY:r}),a=[];return i.forEach(function(e){var t=e.displayObject,n=t.parsedStyle.pointerEvents,r=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(void 0===n?"auto":n);(!r||r&&t.isVisible())&&!t.isCulled()&&t.isInteractive()&&a.push(t);}),a.sort(function(e,t){return t.sortable.renderOrder-e.sortable.renderOrder;}),a;}},{key:"elementFromPointSync",value:function(e,t){var n=this.defaultView.canvas2Viewport({x:e,y:t}),r=n.x,i=n.y,a=this.defaultView.getConfig(),o=a.width,s=a.height;if(r<0||i<0||r>o||i>s)return null;var l=this.defaultView.viewport2Client({x:r,y:i}),u=l.x,c=l.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:e,y:t,viewportX:r,viewportY:i,clientX:u,clientY:c},picked:[]}).picked;return d&&d[0]||this.documentElement;}},{key:"elementFromPoint",value:(t=(0,W.default)((0,H.default)().mark(function e(t,n){var r,i,a,o,s,l,u,c,d,f;return(0,H.default)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(r=this.defaultView.canvas2Viewport({x:t,y:n})).x,a=r.y,s=(o=this.defaultView.getConfig()).width,l=o.height,!(i<0||a<0||i>s||a>l)){e.next=1;break;}return e.abrupt("return",null);case 1:return c=(u=this.defaultView.viewport2Client({x:i,y:a})).x,d=u.y,e.next=2,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:t,y:n,viewportX:i,viewportY:a,clientX:c,clientY:d},picked:[]});case 2:return f=e.sent.picked,e.abrupt("return",f&&f[0]||this.documentElement);case 3:case"end":return e.stop();}},e,this);})),function(e,n){return t.apply(this,arguments);})},{key:"elementsFromPointSync",value:function(e,t){var n=this.defaultView.canvas2Viewport({x:e,y:t}),r=n.x,i=n.y,a=this.defaultView.getConfig(),o=a.width,s=a.height;if(r<0||i<0||r>o||i>s)return[];var l=this.defaultView.viewport2Client({x:r,y:i}),u=l.x,c=l.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:e,y:t,viewportX:r,viewportY:i,clientX:u,clientY:c},picked:[]}).picked;return d[d.length-1]!==this.documentElement&&d.push(this.documentElement),d;}},{key:"elementsFromPoint",value:(n=(0,W.default)((0,H.default)().mark(function e(t,n){var r,i,a,o,s,l,u,c,d,f;return(0,H.default)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(r=this.defaultView.canvas2Viewport({x:t,y:n})).x,a=r.y,s=(o=this.defaultView.getConfig()).width,l=o.height,!(i<0||a<0||i>s||a>l)){e.next=1;break;}return e.abrupt("return",[]);case 1:return c=(u=this.defaultView.viewport2Client({x:i,y:a})).x,d=u.y,e.next=2,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:t,y:n,viewportX:i,viewportY:a,clientX:c,clientY:d},picked:[]});case 2:return(f=e.sent.picked)[f.length-1]!==this.documentElement&&f.push(this.documentElement),e.abrupt("return",f);case 3:case"end":return e.stop();}},e,this);})),function(e,t){return n.apply(this,arguments);})},{key:"appendChild",value:function(e,t){throw Error(ef);}},{key:"insertBefore",value:function(e,t){throw Error(ef);}},{key:"removeChild",value:function(e,t){throw Error(ef);}},{key:"replaceChild",value:function(e,t,n){throw Error(ef);}},{key:"append",value:function(){throw Error(ef);}},{key:"prepend",value:function(){throw Error(ef);}},{key:"getElementById",value:function(e){return this.documentElement.getElementById(e);}},{key:"getElementsByName",value:function(e){return this.documentElement.getElementsByName(e);}},{key:"getElementsByTagName",value:function(e){return this.documentElement.getElementsByTagName(e);}},{key:"getElementsByClassName",value:function(e){return this.documentElement.getElementsByClassName(e);}},{key:"querySelector",value:function(e){return this.documentElement.querySelector(e);}},{key:"querySelectorAll",value:function(e){return this.documentElement.querySelectorAll(e);}},{key:"find",value:function(e){return this.documentElement.find(e);}},{key:"findAll",value:function(e){return this.documentElement.findAll(e);}}]);}(rV),i$=function(){function e(t){(0,N.default)(this,e),this.strategies=t;}return(0,O.default)(e,[{key:"apply",value:function(t){var n=t.config,r=t.camera,i=t.renderingService,a=t.renderingContext,o=this.strategies;i.hooks.cull.tap(e.tag,function(e){if(e){var t,i=e.cullable;if(0===o.length?i.visible=a.unculledEntities.indexOf(e.entity)>-1:i.visible=o.every(function(t){return t.isVisible(r,e);}),!e.isCulled()&&e.isVisible())return e;var s=(null===(t=n.future)||void 0===t?void 0:t.experimentalCancelEventPropagation)===!0;return e.dispatchEvent(new rF(rX.CULLED),s,s),null;}return e;}),i.hooks.afterRender.tap(e.tag,function(e){e.cullable.visibilityPlaneMask=-1;});}}]);}();i$.tag="Culling";var iK=function(){function e(){var t=this;(0,N.default)(this,e),this.autoPreventDefault=!1,this.rootPointerEvent=new rB(null),this.rootWheelEvent=new rU(null),this.onPointerMove=function(e){var n=null===(r=t.context.renderingContext.root)||void 0===r||null===(r=r.ownerDocument)||void 0===r?void 0:r.defaultView;if(!n.supportsTouchEvents||"touch"!==e.pointerType){var r,i,a=t.normalizeToPointerEvent(e,n),o=(0,Z.default)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=t.bootstrapEvent(t.rootPointerEvent,s,n,e);t.context.eventService.mapEvent(l);}}catch(e){o.e(e);}finally{o.f();}t.setCursor(t.context.eventService.cursor);}},this.onClick=function(e){var n,r,i=null===(n=t.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,a=t.normalizeToPointerEvent(e,i),o=(0,Z.default)(a);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=t.bootstrapEvent(t.rootPointerEvent,s,i,e);t.context.eventService.mapEvent(l);}}catch(e){o.e(e);}finally{o.f();}t.setCursor(t.context.eventService.cursor);};}return(0,O.default)(e,[{key:"apply",value:function(t){var n=this;this.context=t;var r=t.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(e){return n.context.renderingService.hooks.pickSync.call({position:e,picked:[],topmost:!0}).picked[0]||null;}),r.hooks.pointerWheel.tap(e.tag,function(e){var t=n.normalizeWheelEvent(e);n.context.eventService.mapEvent(t);}),r.hooks.pointerDown.tap(e.tag,function(e){if(!i.supportsTouchEvents||"touch"!==e.pointerType){var t=n.normalizeToPointerEvent(e,i);n.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();var r,a=(0,Z.default)(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,e);n.context.eventService.mapEvent(s);}}catch(e){a.e(e);}finally{a.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerUp.tap(e.tag,function(e){if(!i.supportsTouchEvents||"touch"!==e.pointerType){var t,r=n.context.contextService.getDomElement(),a=n.context.eventService.isNativeEventFromCanvas(r,e)?"":"outside",o=n.normalizeToPointerEvent(e,i),s=(0,Z.default)(o);try{for(s.s();!(t=s.n()).done;){var l=t.value,u=n.bootstrapEvent(n.rootPointerEvent,l,i,e);u.type+=a,n.context.eventService.mapEvent(u);}}catch(e){s.e(e);}finally{s.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerMove.tap(e.tag,this.onPointerMove),r.hooks.pointerOver.tap(e.tag,this.onPointerMove),r.hooks.pointerOut.tap(e.tag,this.onPointerMove),r.hooks.click.tap(e.tag,this.onClick),r.hooks.pointerCancel.tap(e.tag,function(e){var t,r=n.normalizeToPointerEvent(e,i),a=(0,Z.default)(r);try{for(a.s();!(t=a.n()).done;){var o=t.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,e);n.context.eventService.mapEvent(s);}}catch(e){a.e(e);}finally{a.f();}n.setCursor(n.context.eventService.cursor);});}},{key:"bootstrapEvent",value:function(e,t,n,r){e.view=n,e.originalEvent=null,e.nativeEvent=r,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t);var i=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),a=i.x,o=i.y;e.viewport.x=a,e.viewport.y=o;var s=this.context.eventService.viewport2Canvas(e.viewport),l=s.x,u=s.y;return e.canvas.x=l,e.canvas.y=u,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=r.isTrusted,"pointerleave"===e.type&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=n8[e.type]||e.type),e;}},{key:"normalizeWheelEvent",value:function(e){var t=this.rootWheelEvent;this.transferMouseData(t,e),t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ;var n=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),r=n.x,i=n.y;t.viewport.x=r,t.viewport.y=i;var a=this.context.eventService.viewport2Canvas(t.viewport),o=a.x,s=a.y;return t.canvas.x=o,t.canvas.y=s,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.nativeEvent=e,t.type=e.type,t;}},{key:"transferMouseData",value:function(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=n9.now(),e.type=t.type,e.altKey=t.altKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.screen.x=t.screenX,e.screen.y=t.screenY,e.relatedTarget=null;}},{key:"setCursor",value:function(e){this.context.contextService.applyCursorStyle(e||this.context.config.cursor||"default");}},{key:"normalizeToPointerEvent",value:function(e,t){var n=[];if(t.isTouchEvent(e))for(var r=0;r<e.changedTouches.length;r++){var i=e.changedTouches[r];(0,F.isUndefined)(i.button)&&(i.button=0),(0,F.isUndefined)(i.buttons)&&(i.buttons=1),(0,F.isUndefined)(i.isPrimary)&&(i.isPrimary=1===e.touches.length&&"touchstart"===e.type),(0,F.isUndefined)(i.width)&&(i.width=i.radiusX||1),(0,F.isUndefined)(i.height)&&(i.height=i.radiusY||1),(0,F.isUndefined)(i.tiltX)&&(i.tiltX=0),(0,F.isUndefined)(i.tiltY)&&(i.tiltY=0),(0,F.isUndefined)(i.pointerType)&&(i.pointerType="touch"),(0,F.isUndefined)(i.pointerId)&&(i.pointerId=i.identifier||0),(0,F.isUndefined)(i.pressure)&&(i.pressure=i.force||.5),(0,F.isUndefined)(i.twist)&&(i.twist=0),(0,F.isUndefined)(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=e.type,n.push(i);}else t.isMouseEvent(e)&&((0,F.isUndefined)(e.isPrimary)&&(e.isPrimary=!0),(0,F.isUndefined)(e.width)&&(e.width=1),(0,F.isUndefined)(e.height)&&(e.height=1),(0,F.isUndefined)(e.tiltX)&&(e.tiltX=0),(0,F.isUndefined)(e.tiltY)&&(e.tiltY=0),(0,F.isUndefined)(e.pointerType)&&(e.pointerType="mouse"),(0,F.isUndefined)(e.pointerId)&&(e.pointerId=1),(0,F.isUndefined)(e.pressure)&&(e.pressure=.5),(0,F.isUndefined)(e.twist)&&(e.twist=0),(0,F.isUndefined)(e.tangentialPressure)&&(e.tangentialPressure=0),e.isNormalized=!0),n.push(e);return n;}}]);}();iK.tag="Event";var iQ=[K.CIRCLE,K.ELLIPSE,K.IMAGE,K.RECT,K.LINE,K.POLYLINE,K.POLYGON,K.TEXT,K.PATH,K.HTML],iJ=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"isVisible",value:function(e,t){var n,r=t.cullable;if(!r.enable)return!0;var i=t.getRenderBounds();if(ea.isEmpty(i))return!1;var a=e.getFrustum(),o=null===(n=t.parentNode)||void 0===n||null===(n=n.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(t,i,o||es.INDETERMINATE,a.planes),r.visible=r.visibilityPlaneMask!==es.OUTSIDE,r.visible;}},{key:"computeVisibilityWithPlaneMask",value:function(e,t,n,r){if(n===es.OUTSIDE||n===es.INSIDE)return n;for(var i=es.INSIDE,a=iQ.indexOf(e.nodeName)>-1,o=0,s=r.length;o<s;++o){var l=1<<o;if((n&l)!=0&&(!a||4!==o&&5!==o)){var u=r[o],c=u.normal,d=u.distance;if(U.vec3.dot(c,t.getPositiveFarPoint(r[o]))+d<0)return es.OUTSIDE;U.vec3.dot(c,t.getNegativeFarPoint(r[o]))+d<0&&(i|=l);}}return i;}}]),i0=function(){function e(){(0,N.default)(this,e),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1;}return(0,O.default)(e,[{key:"apply",value:function(t){var n,r,i=this,a=t.config,o=t.renderingService,s=t.renderingContext,l=t.rBushRoot,u=s.root.ownerDocument.defaultView;this.rBush=l;var c=function(e){o.dirtify();},d=function(e){i.syncTasks.set(e.target,e.detail.affectChildren),o.dirtify();},f=function(e){var t=e.target;ip.enableSizeAttenuation&&ip.styleValueRegistry.updateSizeAttenuation(t,u.getCamera().getZoom());},h=function(e){var t=e.target,n=t.rBushNode;null!=n&&n.aabb&&i.rBush.remove(n.aabb),i.syncTasks.delete(t),ip.sceneGraphService.dirtyToRoot(t),o.dirtify();};o.hooks.init.tap(e.tag,function(){u.addEventListener(rX.MOUNTED,f),u.addEventListener(rX.UNMOUNTED,h),u.addEventListener(rX.ATTR_MODIFIED,c),u.addEventListener(rX.BOUNDS_CHANGED,d);}),o.hooks.destroy.tap(e.tag,function(){u.removeEventListener(rX.MOUNTED,f),u.removeEventListener(rX.UNMOUNTED,h),u.removeEventListener(rX.ATTR_MODIFIED,c),u.removeEventListener(rX.BOUNDS_CHANGED,d),i.syncTasks.clear();});var p=null!==(n=ip.globalThis.requestIdleCallback)&&void 0!==n?n:ru.bind(ip.globalThis),v=(null===(r=a.future)||void 0===r?void 0:r.experimentalRICSyncRTree)===!0;o.hooks.endFrame.tap(e.tag,function(){i.isFirstTimeRendering?(i.isFirstTimeRendering=!1,i.syncing=!0,p(function(){i.syncRTree(!0),i.isFirstTimeRenderingFinished=!0;})):v&&ip.globalThis.requestIdleCallback&&ip.globalThis.cancelIdleCallback?(ip.globalThis.cancelIdleCallback(i.ricSyncRTreeId),i.ricSyncRTreeId=ip.globalThis.requestIdleCallback(function(){return i.syncRTree();})):i.syncRTree();});}},{key:"syncNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.isConnected){var n=e.rBushNode;n.aabb&&this.rBush.remove(n.aabb);var r=e.getRenderBounds();if(r){var i=e.renderable;t&&(i.dirtyRenderBounds||(i.dirtyRenderBounds=new ea),i.dirtyRenderBounds.update(r.center,r.halfExtents));var a=r.getMin(),o=(0,z.default)(a,2),s=o[0],l=o[1],u=r.getMax(),c=(0,z.default)(u,2),d=c[0],f=c[1];n.aabb||(n.aabb={}),n.aabb.displayObject=e,n.aabb.minX=s,n.aabb.minY=l,n.aabb.maxX=d,n.aabb.maxY=f;}if(n.aabb&&!isNaN(n.aabb.maxX)&&!isNaN(n.aabb.maxX)&&!isNaN(n.aabb.minX)&&!isNaN(n.aabb.minY))return n.aabb;}}},{key:"syncRTree",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t||!this.syncing&&0!==this.syncTasks.size){this.syncing=!0;var n=[],r=new Set,i=function(i){if(!r.has(i)&&i.renderable){var a=e.syncNode(i,t);a&&(n.push(a),r.add(i));}};this.syncTasks.forEach(function(e,t){e&&t.forEach(i);for(var n=t;n;)i(n),n=n.parentElement;}),this.rBush.load(n),n.length=0,this.syncing=!1;}}}]);}();i0.tag="Prepare";var i1=((A={}).READY="ready",A.BEFORE_RENDER="beforerender",A.RERENDER="rerender",A.AFTER_RENDER="afterrender",A.BEFORE_DESTROY="beforedestroy",A.AFTER_DESTROY="afterdestroy",A.RESIZE="resize",A.DIRTY_RECTANGLE="dirtyrectangle",A.RENDERER_CHANGED="rendererchanged",A),i2=new rF(rX.MOUNTED),i3=new rF(rX.UNMOUNTED),i5=new rF(i1.BEFORE_RENDER),i4=new rF(i1.RERENDER),i7=new rF(i1.AFTER_RENDER),i6=function(e){function t(e){(0,N.default)(this,t),(i=(0,R.default)(this,t)).Element=ik,i.inited=!1,i.context={};var n,r,i,a=e.container,o=e.canvas,s=e.renderer,l=e.width,u=e.height,c=e.background,d=e.cursor,f=e.supportsMutipleCanvasesInOneContainer,h=e.cleanUpOnDestroy,p=void 0===h||h,v=e.offscreenCanvas,g=e.devicePixelRatio,m=e.requestAnimationFrame,y=e.cancelAnimationFrame,b=e.createImage,_=e.supportsTouchEvents,x=e.supportsPointerEvents,w=e.isTouchEvent,E=e.isMouseEvent,M=e.dblClickSpeed,S=l,k=u,C=g||n4&&window.devicePixelRatio||1;return C=C>=1?Math.ceil(C):1,o&&(S=l||("auto"===(n=n6(o,"width"))?o.offsetWidth:parseFloat(n))||o.width/C,k=u||("auto"===(r=n6(o,"height"))?o.offsetHeight:parseFloat(r))||o.height/C),i.customElements=new iq,i.devicePixelRatio=C,i.requestAnimationFrame=null!=m?m:ru.bind(ip.globalThis),i.cancelAnimationFrame=null!=y?y:rc.bind(ip.globalThis),i.createImage=null!=b?b:function(){return new window.Image;},i.supportsTouchEvents=null!=_?_:"ontouchstart"in ip.globalThis,i.supportsPointerEvents=null!=x?x:!!ip.globalThis.PointerEvent,i.isTouchEvent=null!=w?w:function(e){return i.supportsTouchEvents&&e instanceof ip.globalThis.TouchEvent;},i.isMouseEvent=null!=E?E:function(e){return!ip.globalThis.MouseEvent||e instanceof ip.globalThis.MouseEvent&&(!i.supportsPointerEvents||!(e instanceof ip.globalThis.PointerEvent));},v&&(ip.offscreenCanvas=v),i.document=new iX,i.document.defaultView=i,f||function(e,t,n){if(e){var r="string"==typeof e?document.getElementById(e):e;n5.has(r)&&n5.get(r).destroy(n),n5.set(r,t);}}(a,i,p),i.initRenderingContext((0,P.default)((0,P.default)({},e),{},{width:S,height:k,background:null!=c?c:"transparent",cursor:null!=d?d:"default",cleanUpOnDestroy:p,devicePixelRatio:C,requestAnimationFrame:i.requestAnimationFrame,cancelAnimationFrame:i.cancelAnimationFrame,createImage:i.createImage,supportsTouchEvents:i.supportsTouchEvents,supportsPointerEvents:i.supportsPointerEvents,isTouchEvent:i.isTouchEvent,isMouseEvent:i.isMouseEvent,dblClickSpeed:null!=M?M:200})),i.initDefaultCamera(S,k,s.clipSpaceNearZ),i.initRenderer(s,!0),i;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"initRenderingContext",value:function(e){this.context.config=e,this.context.renderingContext={root:this.document.documentElement,unculledEntities:[],renderListCurrentFrame:[],renderReasons:new Set,force:!1,dirty:!1};}},{key:"initDefaultCamera",value:function(e,t,n){var r=this,i=new ip.CameraContribution;i.clipSpaceNearZ=n,i.setType(eA.EXPLORING,eL.DEFAULT).setPosition(e/2,t/2,500).setFocalPoint(e/2,t/2,0).setOrthographic(-(e/2),e/2,t/2,-(t/2),.1,1e3),i.canvas=this,i.eventEmitter.on(eN.UPDATED,function(){r.context.renderingContext.renderReasons.add(rW.CAMERA_CHANGED),ip.enableSizeAttenuation&&r.getConfig().renderer.getConfig().enableSizeAttenuation&&r.updateSizeAttenuation();}),this.context.camera=i;}},{key:"updateSizeAttenuation",value:function(){var e=this.getCamera().getZoom();this.document.documentElement.forEach(function(t){ip.styleValueRegistry.updateSizeAttenuation(t,e);});}},{key:"getConfig",value:function(){return this.context.config;}},{key:"getRoot",value:function(){return this.document.documentElement;}},{key:"getCamera",value:function(){return this.context.camera;}},{key:"getContextService",value:function(){return this.context.contextService;}},{key:"getEventService",value:function(){return this.context.eventService;}},{key:"getRenderingService",value:function(){return this.context.renderingService;}},{key:"getRenderingContext",value:function(){return this.context.renderingContext;}},{key:"getStats",value:function(){return this.getRenderingService().getStats();}},{key:"ready",get:function(){var e=this;return!this.readyPromise&&(this.readyPromise=new Promise(function(t){e.resolveReadyPromise=function(){t(e);};}),this.inited&&this.resolveReadyPromise()),this.readyPromise;}},{key:"destroy",value:function(){var e,t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],n=arguments.length>1?arguments[1]:void 0;tu.clearCache();var r=(null===(e=this.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;n||this.dispatchEvent(new rF(i1.BEFORE_DESTROY),r,r),this.frameId&&this.cancelAnimationFrame(this.frameId);var i=this.getRoot();t&&(this.unmountChildren(i),this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),this.context.rBushRoot&&this.context.rBushRoot.clear(),n||this.dispatchEvent(new rF(i1.AFTER_DESTROY),r,r);var a=function(e){e.currentTarget=null,e.manager=null,e.target=null,e.relatedNode=null;};a(i2),a(i3),a(i5),a(i4),a(i7),a(iM),a(iy),a(ib),a(i_);}},{key:"changeSize",value:function(e,t){this.resize(e,t);}},{key:"resize",value:function(e,t){var n,r=this.context.config;r.width=e,r.height=t,this.getContextService().resize(e,t);var i=this.context.camera,a=i.getProjectionMode();i.setPosition(e/2,t/2,500).setFocalPoint(e/2,t/2,0),a===eP.ORTHOGRAPHIC?i.setOrthographic(-(e/2),e/2,t/2,-(t/2),i.getNear(),i.getFar()):i.setAspect(e/t);var o=(null===(n=r.future)||void 0===n?void 0:n.experimentalCancelEventPropagation)===!0;this.dispatchEvent(new rF(i1.RESIZE,{width:e,height:t}),o,o);}},{key:"appendChild",value:function(e,t){return this.document.documentElement.appendChild(e,t);}},{key:"insertBefore",value:function(e,t){return this.document.documentElement.insertBefore(e,t);}},{key:"removeChild",value:function(e){return this.document.documentElement.removeChild(e);}},{key:"removeChildren",value:function(){this.document.documentElement.removeChildren();}},{key:"destroyChildren",value:function(){this.document.documentElement.destroyChildren();}},{key:"render",value:function(e){var t,n=this;e&&(i5.detail=e,i7.detail=e);var r=(null===(t=this.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation)===!0;this.dispatchEvent(i5,r,r),this.getRenderingService().render(this.getConfig(),e,function(){n.dispatchEvent(i4,r,r);}),this.dispatchEvent(i7,r,r);}},{key:"run",value:function(){var e=this,t=function(n,r){e.render(r),e.frameId=e.requestAnimationFrame(t);};t();}},{key:"initRenderer",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)throw Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new $,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new iK,new i0,new i$([new iJ])),this.loadRendererContainerModule(e),this.context.contextService=new this.context.ContextService((0,P.default)((0,P.default)({},ip),this.context)),this.context.renderingService=new rZ(ip,this.context),this.context.eventService=new rG(ip,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(e,n,!0)):this.context.contextService.initAsync().then(function(){t.initRenderingService(e,n);}).catch(function(e){console.error(e);});}},{key:"initRenderingService",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.context.renderingService.init(function(){t.inited=!0;var i,a=(null===(i=t.getConfig().future)||void 0===i?void 0:i.experimentalCancelEventPropagation)===!0;n?r?t.requestAnimationFrame(function(){t.dispatchEvent(new rF(i1.READY),a,a);}):t.dispatchEvent(new rF(i1.READY),a,a):t.dispatchEvent(new rF(i1.RENDERER_CHANGED),a,a),t.readyPromise&&t.resolveReadyPromise(),n||t.getRoot().forEach(function(e){var t;null===(t=e.dirty)||void 0===t||t.call(e,!0,!0);}),t.mountChildren(t.getRoot()),e.getConfig().enableAutoRendering&&t.run();});}},{key:"loadRendererContainerModule",value:function(e){var t=this;e.getPlugins().forEach(function(e){e.context=t.context,e.init(ip);});}},{key:"setRenderer",value:function(e){var t=this.getConfig();if(t.renderer!==e){var n=t.renderer;t.renderer=e,this.destroy(!1,!0),(0,I.default)((null==n?void 0:n.getPlugins())||[]).reverse().forEach(function(e){e.destroy(ip);}),this.initRenderer(e);}}},{key:"setCursor",value:function(e){this.getConfig().cursor=e,this.getContextService().applyCursorStyle(e);}},{key:"unmountChildren",value:function(e){var t=this;if(e.childNodes.forEach(function(e){t.unmountChildren(e);}),this.inited){if(e.isMutationObserved)e.dispatchEvent(i3);else{var n,r=(null===(n=this.getConfig().future)||void 0===n?void 0:n.experimentalCancelEventPropagation)===!0;i3.target=e,this.dispatchEvent(i3,!0,r);}e!==this.document.documentElement&&(e.ownerDocument=null),e.isConnected=!1;}e.isCustomElement&&e.disconnectedCallback&&e.disconnectedCallback();}},{key:"mountChildren",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re(e);if(this.inited){if(!e.isConnected&&(e.ownerDocument=this.document,e.isConnected=!0,!n)){if(e.isMutationObserved)e.dispatchEvent(i2);else{var r,i=(null===(r=this.getConfig().future)||void 0===r?void 0:r.experimentalCancelEventPropagation)===!0;i2.target=e,this.dispatchEvent(i2,!0,i);}}}else console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",e.nodeName);e.childNodes.forEach(function(e){t.mountChildren(e,n);}),e.isCustomElement&&e.connectedCallback&&e.connectedCallback();}},{key:"mountFragment",value:function(e){this.mountChildren(e,!1);}},{key:"client2Viewport",value:function(e){return this.getEventService().client2Viewport(e);}},{key:"viewport2Client",value:function(e){return this.getEventService().viewport2Client(e);}},{key:"viewport2Canvas",value:function(e){return this.getEventService().viewport2Canvas(e);}},{key:"canvas2Viewport",value:function(e){return this.getEventService().canvas2Viewport(e);}},{key:"getPointByClient",value:function(e,t){return this.client2Viewport({x:e,y:t});}},{key:"getClientByPoint",value:function(e,t){return this.viewport2Client({x:e,y:t});}}]);}(rj);},"81e8f94e":function(e,t,n){var r=n("1a87dd23"),i=n("7c1db5f7"),a=n("e3d5f8e1"),o=0/0,s=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(a(e))return o;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t;}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=l.test(e);return n||u.test(e)?c(e.slice(2),n?2:8):s.test(e)?o:+e;};},82438925:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{TwoFingersTouchPitchHandler:function(){return f;},TwoFingersTouchRotateHandler:function(){return c;},TwoFingersTouchZoomHandler:function(){return l;}});var r=n("777fffbe")._(n("d812e418")),i=n("e31a659c");class a{constructor(){(0,r.default)(this,"_enabled",void 0),(0,r.default)(this,"_active",void 0),(0,r.default)(this,"_firstTwoTouches",void 0),(0,r.default)(this,"_vector",void 0),(0,r.default)(this,"_startVector",void 0),(0,r.default)(this,"_aroundCenter",void 0),this.reset();}reset(){this._active=!1,delete this._firstTwoTouches;}touchstart(e,t,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([t[0],t[1]]));}touchmove(e,t,n){if(!this._firstTwoTouches)return;e.preventDefault();let[r,i]=this._firstTwoTouches,a=o(n,t,r),s=o(n,t,i);if(!a||!s)return;let l=this._aroundCenter?null:a.add(s).div(2);return this._move([a,s],l,e);}touchend(e,t,n){if(!this._firstTwoTouches)return;let[r,a]=this._firstTwoTouches,s=o(n,t,r),l=o(n,t,a);s&&l||(this._active&&i.DOM.suppressClick(),this.reset());}touchcancel(){this.reset();}enable(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around;}disable(){this._enabled=!1,this.reset();}isEnabled(){return!!this._enabled;}isActive(){return!!this._active;}}function o(e,t,n){for(let r=0;r<e.length;r++)if(e[r].identifier===n)return t[r];}function s(e,t){return Math.log(e/t)/Math.LN2;}class l extends a{constructor(...e){super(...e),(0,r.default)(this,"_distance",void 0),(0,r.default)(this,"_startDistance",void 0);}reset(){super.reset(),delete this._distance,delete this._startDistance;}_start(e){this._startDistance=this._distance=e[0].dist(e[1]);}_move(e,t){let n=this._distance;if(this._distance=e[0].dist(e[1]),!(!this._active&&.1>Math.abs(s(this._distance,this._startDistance))))return this._active=!0,{zoomDelta:s(this._distance,n),pinchAround:t};}}function u(e,t){return 180*e.angleWith(t)/Math.PI;}class c extends a{constructor(...e){super(...e),(0,r.default)(this,"_minDiameter",void 0);}reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector;}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1]);}_move(e,t,n){let r=this._vector;if(this._vector=e[0].sub(e[1]),!(!this._active&&this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:u(this._vector,r),pinchAround:t};}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());let t=Math.PI*this._minDiameter;return Math.abs(u(e,this._startVector))<25/t*360;}}function d(e){return Math.abs(e.y)>Math.abs(e.x);}class f extends a{constructor(e){super(),(0,r.default)(this,"_valid",void 0),(0,r.default)(this,"_firstMove",void 0),(0,r.default)(this,"_lastPoints",void 0),(0,r.default)(this,"_map",void 0),(0,r.default)(this,"_currentTouchCount",0),this._map=e;}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints;}touchstart(e,t,n){super.touchstart(e,t,n),this._currentTouchCount=n.length;}_start(e){this._lastPoints=e,d(e[0].sub(e[1]))&&(this._valid=!1);}_move(e,t,n){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;let r=e[0].sub(this._lastPoints[0]),i=e[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(r,i,n.timeStamp),this._valid)return this._lastPoints=e,this._active=!0,{pitchDelta:-.5*((r.y+i.y)/2)};}gestureBeginsVertically(e,t,n){if(void 0!==this._valid)return this._valid;let r=e.mag()>=2,i=t.mag()>=2;if(!r&&!i)return;if(!r||!i){if(void 0===this._firstMove&&(this._firstMove=n),n-this._firstMove<100)return;return!1;}let a=e.y>0==t.y>0;return d(e)&&d(t)&&a;}}},"8494a095":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("a556cf14")),a=r._(n("2eb295f7"));function o(e){return e.index;}function s(e,t){var n=e.get(t);if(!n)throw Error("node not found: "+t);return n;}function l(e){var t,n,r,l,u,c,d=o,f=function(e){return 1/Math.min(l[e.source.index],l[e.target.index]);},h=(0,i.default)(30),p=1;function v(r){for(var i=0,o=e.length;i<p;++i)for(var s,l,d,f,h,v,g,m=0;m<o;++m)l=(s=e[m]).source,v=((v=Math.sqrt((f=(d=s.target).x+d.vx-l.x-l.vx||(0,a.default)(c))*f+(h=d.y+d.vy-l.y-l.vy||(0,a.default)(c))*h))-n[m])/v*r*t[m],f*=v,h*=v,d.vx-=f*(g=u[m]),d.vy-=h*g,l.vx+=f*(g=1-g),l.vy+=h*g;}function g(){if(r){var i,a,o=r.length,c=e.length,f=new Map(r.map((e,t)=>[d(e,t,r),e]));for(i=0,l=Array(o);i<c;++i)(a=e[i]).index=i,"object"!=typeof a.source&&(a.source=s(f,a.source)),"object"!=typeof a.target&&(a.target=s(f,a.target)),l[a.source.index]=(l[a.source.index]||0)+1,l[a.target.index]=(l[a.target.index]||0)+1;for(i=0,u=Array(c);i<c;++i)a=e[i],u[i]=l[a.source.index]/(l[a.source.index]+l[a.target.index]);t=Array(c),m(),n=Array(c),y();}}function m(){if(r)for(var n=0,i=e.length;n<i;++n)t[n]=+f(e[n],n,e);}function y(){if(r)for(var t=0,i=e.length;t<i;++t)n[t]=+h(e[t],t,e);}return null==e&&(e=[]),v.initialize=function(e,t){r=e,c=t,g();},v.links=function(t){return arguments.length?(e=t,g(),v):e;},v.id=function(e){return arguments.length?(d=e,v):d;},v.iterations=function(e){return arguments.length?(p=+e,v):p;},v.strength=function(e){return arguments.length?(f="function"==typeof e?e:(0,i.default)(+e),m(),v):f;},v.distance=function(e){return arguments.length?(h="function"==typeof e?e:(0,i.default)(+e),y(),v):h;},v;}},"84b4727a":function(e,t,n){"use strict";function r(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,a=(r=Math.floor(t))+1;else{for(var o,s,l=i-n||1,u=this._root;n>e||e>=i||r>t||t>=a;)switch(s=(t<r)<<1|e<n,(o=[,,,,])[s]=u,u=o,l*=2,s){case 0:i=n+l,a=r+l;break;case 1:n=i-l,a=r+l;break;case 2:i=n+l,r=a-l;break;case 3:n=i-l,r=a-l;}this._root&&this._root.length&&(this._root=u);}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"84cff855":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("9d065c04"),i=(0,n("14d0d13c").createDeepCompareEffect)(r.useEffect);},"84f4444b":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return d;}});var r=n("777fffbe"),i=r._(n("6ebbe753")),a=r._(n("d45a39b7")),o=r._(n("391cdac3")),s=r._(n("705631d2")),l=r._(n("4b80ecba")),u=r._(n("673e833b"));function c(e){var t=this.__data__=new i.default(e);this.size=t.size;}c.prototype.clear=a.default,c.prototype.delete=o.default,c.prototype.get=s.default,c.prototype.has=l.default,c.prototype.set=u.default;var d=c;},85163435:function(e,t,n){var r=n("16b3b059"),i=n("d5217792"),a="object"==typeof t&&t&&!t.nodeType&&t,o=a&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===a?r.Buffer:void 0,l=s?s.isBuffer:void 0;e.exports=l||i;},"8549ce27":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=n("201ec6be"),a=r._(n("a556cf14")),o=r._(n("2eb295f7"));function s(e){return e.x+e.vx;}function l(e){return e.y+e.vy;}function u(e){var t,n,r,u=1,c=1;function d(){for(var e,a,d,h,p,v,g,m=t.length,y=0;y<c;++y)for(e=0,a=(0,i.quadtree)(t,s,l).visitAfter(f);e<m;++e)g=(v=n[(d=t[e]).index])*v,h=d.x+d.vx,p=d.y+d.vy,a.visit(b);function b(e,t,n,i,a){var s=e.data,l=e.r,c=v+l;if(s){if(s.index>d.index){var f=h-s.x-s.vx,m=p-s.y-s.vy,y=f*f+m*m;y<c*c&&(0===f&&(y+=(f=(0,o.default)(r))*f),0===m&&(y+=(m=(0,o.default)(r))*m),y=(c-(y=Math.sqrt(y)))/y*u,d.vx+=(f*=y)*(c=(l*=l)/(g+l)),d.vy+=(m*=y)*c,s.vx-=f*(c=1-c),s.vy-=m*c);}return;}return t>h+c||i<h-c||n>p+c||a<p-c;}}function f(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r);}function h(){if(t){var r,i,a=t.length;for(r=0,n=Array(a);r<a;++r)n[(i=t[r]).index]=+e(i,r,t);}}return"function"!=typeof e&&(e=(0,a.default)(null==e?1:+e)),d.initialize=function(e,n){t=e,r=n,h();},d.iterations=function(e){return arguments.length?(c=+e,d):c;},d.strength=function(e){return arguments.length?(u=+e,d):u;},d.radius=function(t){return arguments.length?(e="function"==typeof t?t:(0,a.default)(+t),h(),d):e;},d;}},"85f42f11":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return h;}});var r=n("777fffbe"),i=r._(n("b131ee44")),a=r._(n("daaa1548")),o=r._(n("f89fb776")),s=r._(n("d812e418")),l=n("fb1ec05a"),u=r._(n("ebd74549")),c=r._(n("bec2d0e3"));let d=["rasterData"],f={positions:[0,1],colors:["#000","#fff"]};class h extends c.default{constructor(...e){super(...e),(0,s.default)(this,"colorTexture",void 0);}initTileLayer(){var e=this;return(0,o.default)(function*(){let t=e.parent.getLayerAttributeConfig(),n=e.getLayerOptions(),r=e.getSourceOption(),{rampColors:i,domain:o}=e.getLayerOptions();e.colorTexture=e.parent.textureService.getColorTexture(i,o);let s=new u.default((0,a.default)((0,a.default)({},n),{},{colorTexture:e.colorTexture})).source(r.data,r.options);t&&Object.keys(t).forEach(e=>{var n,r;s[e](null===(n=t[e])||void 0===n?void 0:n.field,null===(r=t[e])||void 0===r?void 0:r.values);}),yield e.addLayer(s),e.isLoaded=!0;})();}getSourceOption(){let e=this.parent.getSource(),t=this.sourceTile.data.data,{rasterData:n}=t,r=(0,i.default)(t,d);return{data:n,options:{parser:(0,a.default)({type:"raster",extent:this.sourceTile.bounds},r),transforms:e.transforms}};}styleUpdate(...e){let{rampColors:t=f,domain:n}=e;this.colorTexture=this.parent.textureService.getColorTexture(t,n||(0,l.getDefaultDomain)(t)),this.layers.forEach(e=>e.style({colorTexture:this.colorTexture}));}destroy(){this.layers.forEach(e=>e.destroy());}}},"860e2ef1":function(e,t,n){var r=n("d26a46d3"),i=n("a3290df2"),a=n("4cec1b4c"),o=n("8f024eb4"),s=n("99400a9e"),l=n("f3f72fb5");function u(e){var t=this.__data__=new r(e);this.size=t.size;}u.prototype.clear=i,u.prototype.delete=a,u.prototype.get=o,u.prototype.has=s,u.prototype.set=l,e.exports=u;},"86852c8f":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=r._(n("4ce96d25")),s=r._(n("2b4400a7"));class l extends o.default{constructor(...e){super(...e),(0,a.default)(this,"type","MaskLayer");}buildModels(){var e=this;return(0,i.default)(function*(){let t=e.getModelType();e.layerModel=new s.default[t](e),yield e.initLayerModels();})();}getModelType(){return"fill";}}},"86aaa5a5":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{cloneDeep:function(){return i.default;},isEqual:function(){return a.default;},isNull:function(){return o.default;},isNumber:function(){return s.default;},isUndefined:function(){return l.default;}});var r=n("777fffbe"),i=r._(n("3d1ed70c")),a=r._(n("9b584275")),o=r._(n("7b7551ff")),s=r._(n("76d49047")),l=r._(n("02b75865"));},"871ff507":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{PointTriangulation:function(){return s;},default:function(){return l;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=n("d9b661b3"),o=r._(n("755bc4f8"));function s(e){let t=e.coordinates;return{vertices:[...t],indices:[0],size:t.length};}class l extends o.default{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9});}getDefaultStyle(){return{blend:"additive"};}getCommonUniformsInfo(){return this.getUniformsBufferInfo({u_size_scale:.5});}initModels(){var e=this;return(0,i.default)(function*(){return e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){return e.layer.triangulation=s,e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\n\nlayout(std140) uniform u_Common {\n  float u_size_scale;\n};\n\nout vec4 v_color;\n\n#pragma include "projection"\n#pragma include "project"\n\nvoid main() {\n  v_color = vec4(a_Color.xyz, a_Color.w * opacity);\n\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\n  gl_Position = project_common_position_to_clipspace(project_pos);\n\n  gl_PointSize = a_Size * u_size_scale * 2.0 * u_DevicePixelRatio;\n}\n',fragmentShader:"in vec4 v_color;\nout vec4 outputColor;\nvoid main() {\n  outputColor = v_color;\n}",triangulation:s,defines:e.getDefines(),inject:e.getInject(),depth:{enable:!1},primitive:a.gl.POINTS,pick:!1}))];})();}clearModels(){}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:a.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:a.gl.DYNAMIC_DRAW,data:[],type:a.gl.FLOAT},size:1,update:e=>{let{size:t=1}=e;return Array.isArray(t)?[t[0]]:[t];}}});}}},"87d0acba":function(e,t,n){var r=n("ed2bf8a3"),i=n("95baa305");e.exports=function(e,t,n,r){return function(e,t,n,r){var a,o,s={},l=new i,u=function(e){var t=e.v!==a?e.v:e.w,r=s[t],i=n(e),u=o.distance+i;if(i<0)throw Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+i);u<r.distance&&(r.distance=u,r.predecessor=a,l.decrease(t,u));};for(e.nodes().forEach(function(e){var n=e===t?0:Number.POSITIVE_INFINITY;s[e]={distance:n},l.add(e,n);});l.size()>0&&(o=s[a=l.removeMin()]).distance!==Number.POSITIVE_INFINITY;)r(a).forEach(u);return s;}(e,String(t),n||a,r||function(t){return e.outEdges(t);});};var a=r.constant(1);},"8851df56":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("a556cf14"));function i(e,t,n){var i,a,o,s=(0,r.default)(.1);function l(e){for(var r=0,s=i.length;r<s;++r){var l=i[r],u=l.x-t||1e-6,c=l.y-n||1e-6,d=Math.sqrt(u*u+c*c),f=(o[r]-d)*a[r]*e/d;l.vx+=u*f,l.vy+=c*f;}}function u(){if(i){var t,n=i.length;for(t=0,a=Array(n),o=Array(n);t<n;++t)o[t]=+e(i[t],t,i),a[t]=isNaN(o[t])?0:+s(i[t],t,i);}}return"function"!=typeof e&&(e=(0,r.default)(+e)),null==t&&(t=0),null==n&&(n=0),l.initialize=function(e){i=e,u();},l.strength=function(e){return arguments.length?(s="function"==typeof e?e:(0,r.default)(+e),u(),l):s;},l.radius=function(t){return arguments.length?(e="function"==typeof t?t:(0,r.default)(+t),u(),l):e;},l.x=function(e){return arguments.length?(t=+e,l):t;},l.y=function(e){return arguments.length?(n=+e,l):n;},l;}},"885a1eb4":function(e,t,n){var r=/\s/;e.exports=function(e){for(var t=e.length;t--&&r.test(e.charAt(t)););return t;};},"88a41c13":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("494da66d")),i=function(e){var t=this.__data__,n=(0,r.default)(t,e);return n<0?void 0:t[n][1];};},"88bde59d":function(e,t,n){var r=n("cdf1a659"),i=n("f10a19cc"),a=n("32f27622"),o=n("dc323adb"),s=n("617c7249"),l=n("689596c4"),u=n("0b8e6291"),c=n("81d598f3"),d=n("c0051812");e.exports=function(e,t,n){t=t.length?r(t,function(e){return d(e)?function(t){return i(t,1===e.length?e[0]:e);}:e;}):[c];var f=-1;return t=r(t,l(a)),s(o(e,function(e,n,i){return{criteria:r(t,function(t){return t(e);}),index:++f,value:e};}),function(e,t){return u(e,t,n);});};},"892fbddc":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=r._(n("4ce96d25")),s=n("4dd8dc26"),l=r._(n("0877494d"));class u extends o.default{constructor(...e){super(...e),(0,a.default)(this,"type","HeatMapLayer");}buildModels(){var e=this;return(0,i.default)(function*(){let t=e.getModelType();e.layerModel=new l.default[t](e),yield e.initLayerModels();})();}prerender(){"heatmap"===this.getModelType()&&this.layerModel&&this.layerModel.prerender();}renderModels(e={}){return"heatmap"===this.getModelType()?this.layerModel&&this.layerModel.render(e):this.encodeDataLength<=0&&!this.forceRender||(this.hooks.beforeRender.call(),this.models.forEach(t=>t.draw({uniforms:this.layerModel.getUninforms(),blend:this.layerModel.getBlend(),stencil:this.layerModel.getStencil(e)})),this.hooks.afterRender.call()),this;}updateModelData(e){e.attributes&&e.elements?this.models[0].updateAttributesAndElements(e.attributes,e.elements):console.warn("data error");}getModelType(){var e;let t=this.styleAttributeService.getLayerStyleAttribute("shape"),{shape3d:n}=this.getLayerConfig(),r=this.getSource().data.type,i=(null==t||null===(e=t.scale)||void 0===e?void 0:e.field)||"heatmap";return"heatmap"===i||"heatmap3d"===i?"heatmap":"hexagon"===r?(null==n?void 0:n.indexOf(i))===-1?"hexagon":"grid3d":"grid"===r?(null==n?void 0:n.indexOf(i))===-1?"grid":"grid3d":"heatmap";}getLegend(e){if("heatmap"!==this.getModelType())return super.getLegend(e);{if("color"!==e)return{type:void 0,field:void 0,items:[]};let t=this.getLayerConfig().rampColors;return(0,s.rampColor2legend)(t,e);}}}},89326327:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("8d3f7781")),a=r._(n("3a988df8")),o=function e(t,n,r,o,s){return t===n||(null!=t&&null!=n&&((0,a.default)(t)||(0,a.default)(n))?(0,i.default)(t,n,r,o,e,s):t!=t&&n!=n);};},"895bdbd3":function(e,t,n){!function(){function e(e){this.count=e.length,this.parent={};for(var t=0;t<e.length;t++){var n=e[t];this.parent[n]=n;}}e.prototype.find=function(e){for(;this.parent[e]!==e;)e=this.parent[e];return e;},e.prototype.union=function(e,t){var n=this.find(e),r=this.find(t);n!==r&&(n<r?(this.parent[t]!==t&&this.union(this.parent[t],e),this.parent[t]=this.parent[e]):(this.parent[e]!==e&&this.union(this.parent[e],t),this.parent[e]=this.parent[t]));},e.prototype.connected=function(e,t){return this.find(e)===this.find(t);};}();},"89b6e2f1":function(e,t,n){var r=n("e06645db")(n("16b3b059"),"WeakMap");e.exports=r;},"89dc7153":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("5dc7140d")),a=r._(n("318fb8cd")),o=r._(n("6c35bac1")),s=function(e,t,n){if(!(0,a.default)(e)&&!(0,o.default)(e))return e;var r=n;return(0,i.default)(e,function(e,n){r=t(r,e,n);}),r;};},"89eaa0ba":function(e,t,n){},"8ab1b7bd":function(e,t,n){var r=n("1911a24b"),i=n("c0051812");e.exports=function(e,t,n){var a=t(e);return i(e)?a:r(a,n(e));};},"8ad38dd4":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=n("9d065c04"),a=r._(n("2cebf917")),o=n("11002994"),s=r._(n("397243de")),l=function(e){s.default&&!(0,o.isFunction)(e)&&console.error("useUnmount expected parameter is a function, got ".concat(typeof e));var t=(0,a.default)(e);(0,i.useEffect)(function(){return function(){t.current();};},[]);};},"8af5aa53":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{MapTheme:function(){return u;},default:function(){return u;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("d812e418")),o=n("520d367a"),s=n("631fd3ae"),l=r._(n("8e397f88"));class u extends l.default{constructor(...e){super(...e),(0,a.default)(this,"onMapThemeChange",()=>{this.mapsService.setMapStyle(this.selectValue[0]);});}getDefault(e){return(0,i.default)((0,i.default)({},super.getDefault(e)),{},{title:"\u5730\u56FE\u6837\u5F0F",btnIcon:(0,s.createL7Icon)("l7-icon-color"),options:[]});}getStyleOptions(){let e="mapbox"===this.mapsService.getType()?o.MapboxMapStyleConfig:o.GaodeMapStyleConfig;return Object.entries(this.mapsService.getMapStyleConfig()).filter(([e,t])=>"string"==typeof t&&"blank"!==e).map(([t,n])=>{var r;let{text:i,img:a}=null!==(r=e[t])&&void 0!==r?r:{};return{text:null!=i?i:t,value:n,img:a,key:t};});}getMapStyle(){return this.mapsService.getMapStyle();}onAdd(){var e,t,n;if(null!==(e=this.controlOption.options)&&void 0!==e&&e.length||(this.controlOption.options=this.getStyleOptions()),this.controlOption.defaultValue){let e=this.controlOption.defaultValue;this.controlOption.defaultValue=null!==(t=null===(n=this.controlOption.options.find(t=>t.key===e))||void 0===n?void 0:n.value)&&void 0!==t?t:e;}else{let e=this.getMapStyle();e?this.controlOption.defaultValue=e:this.mapsService.map.once("styledata",()=>{let e=this.mapsService.getMapStyle();this.controlOption.defaultValue=e,this.setSelectValue(e,!1);});}return this.on("selectChange",this.onMapThemeChange),super.onAdd();}getIsMultiple(){return!1;}}},"8b65b5b5":function(e,t,n){var r=n("011deb24"),i=n("0cf0a3f9");e.exports=function(e,t){return i(e||[],t||[],r);};},"8b6f13b3":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("e489f84a")),i=function(e){var t=(0,r.default)(e);return t.charAt(0).toLowerCase()+t.substring(1);};},"8bacc570":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("f89fb776")),i=n("d9b661b3");class a{build(e){return(0,r.default)(function*(){e.prepareBuildModel(),yield e.buildModels();})();}initLayerModel(e){var t=this;return(0,r.default)(function*(){yield t.build(e),e.styleNeedUpdate=!1;})();}prepareLayerModel(e){var t=this;return(0,r.default)(function*(){yield t.build(e),e.styleNeedUpdate=!1;})();}apply(e){var t,n=this;e.hooks.init.tapPromise("LayerModelPlugin",(0,r.default)(function*(){if(e.getSource().isTile){e.prepareBuildModel();return;}e.log(i.IDebugLog.BuildModelStart,i.ILayerStage.INIT),yield n.initLayerModel(e),e.log(i.IDebugLog.BuildModelEnd,i.ILayerStage.INIT);})),e.hooks.beforeRenderData.tapPromise("LayerModelPlugin",(t=(0,r.default)(function*(t){return!!t&&!e.getSource().isTile&&(e.log(i.IDebugLog.BuildModelStart,i.ILayerStage.UPDATE),yield n.prepareLayerModel(e),e.log(i.IDebugLog.BuildModelEnd,i.ILayerStage.UPDATE),!0);}),function(e){return t.apply(this,arguments);}));}}},"8bcb4c2b":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return h;}});var r=n("777fffbe"),i=r._(n("b131ee44")),a=r._(n("f89fb776")),o=r._(n("daaa1548")),s=r._(n("d812e418")),l=n("d9b661b3"),u=r._(n("755bc4f8")),c=n("f717bab4");let d=["data"],f=["rasterData"];class h extends u.default{constructor(...e){super(...e),(0,s.default)(this,"texture",void 0),(0,s.default)(this,"dataOption",{});}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9});}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,o.default)((0,o.default)({},e.uniformsOption),t.uniformsOption);}getCommonUniformsInfo(){let{opacity:e=1,noDataValue:t=0}=this.layer.getLayerConfig(),{rMinMax:n=[0,255],gMinMax:r=[0,255],bMinMax:i=[0,255]}=this.dataOption,a={u_rminmax:n,u_gminmax:r,u_bminmax:i,u_opacity:e||1,u_noDataValue:t,u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(a);}getRasterData(e){var t=this;return(0,a.default)(function*(){if(Array.isArray(e.data)){let{data:n}=e,r=(0,i.default)(e,d);return t.dataOption=r,(0,o.default)({data:n},r);}let n=yield e.data,{rasterData:r}=n,a=(0,i.default)(n,f);return(t.dataOption=a,Array.isArray(r))?(0,o.default)({data:r},a):(0,o.default)({data:Array.from(r)},a);})();}initModels(){var e=this;return(0,a.default)(function*(){e.initUniformsBuffer();let t=e.layer.getSource(),{createTexture2D:n}=e.rendererService,r=t.data.dataArray[0],{data:i,width:a,height:o}=yield e.getRasterData(r);return e.texture=n({data:new Float32Array(i),width:a,height:o,format:l.gl.RGB,type:l.gl.FLOAT}),[(yield e.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\nlayout(std140) uniform commonUniforms {\n  vec2 u_rminmax;\n  vec2 u_gminmax;\n  vec2 u_bminmax;\n  float u_opacity;\n  float u_noDataValue;\n};\n\nout vec2 v_texCoord;\n\n#pragma include "projection"\n\nvoid main() {\n  v_texCoord = a_Uv;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));\n}\n',fragmentShader:"uniform sampler2D u_texture;\nlayout(std140) uniform commonUniforms {\n vec2 u_rminmax;\n vec2 u_gminmax;\n vec2 u_bminmax;\n float u_opacity;\n float u_noDataValue;\n};\n\nin vec2 v_texCoord;\n\nout vec4 outputColor;\n\nvoid main() {\n\n  vec3 rgb = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y)).rgb;\n\n  if(rgb == vec3(u_noDataValue)) {\n    outputColor = vec4(0.0, 0, 0, 0.0);\n  } else {\n    outputColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);\n  }\n\n  if(outputColor.a < 0.01)\n    discard;\n \n}",defines:e.getDefines(),triangulation:c.RasterImageTriangulation,primitive:l.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1}))];})();}buildModels(){var e=this;return(0,a.default)(function*(){return e.initModels();})();}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy();}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:l.AttributeType.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:l.gl.DYNAMIC_DRAW,data:[],type:l.gl.FLOAT},size:2,update:(e,t,n)=>[n[3],n[4]]}});}}},"8c5cea5d":function(e,t,n){var r=n("16b3b059"),i="object"==typeof t&&t&&!t.nodeType&&t,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,o=a&&a.exports===i?r.Buffer:void 0,s=o?o.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=s?s(n):new e.constructor(n);return e.copy(r),r;};},"8c9788de":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("7e78caeb")),a=r._(n("bc4ab95d")),o=Object.prototype.hasOwnProperty,s=function(e){if(!(0,i.default)(e))return(0,a.default)(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t;};},"8c9f46f3":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"getRotatedCurve",{enumerable:!0,get:function(){return i;}});var r=n("d1adb660");function i(e,t){var n,i,a=e.length-1,o=[],s=0,l=(i=(n=e.length)-1,e.map(function(t,r){return e.map(function(t,a){var o=r+a;return 0===a||e[o]&&"M"===e[o][0]?["M"].concat(e[o].slice(-2)):(o>=n&&(o-=i),e[o]);});}));return l.forEach(function(n,i){e.slice(1).forEach(function(n,o){s+=(0,r.distanceSquareRoot)(e[(i+o)%a].slice(-2),t[o%a].slice(-2));}),o[i]=s,s=0;}),l[o.indexOf(Math.min.apply(null,o))];}},"8cac3abd":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=/^(?:0|[1-9]\d*)$/,i=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&r.test(e))&&e>-1&&e%1==0&&e<t;};},"8d019a48":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"Plugin",{enumerable:!0,get:function(){return I;}});var r=n("777fffbe"),i=r._(n("d812e418")),a=r._(n("daaa1548")),o=r._(n("1316cf9d")),s=r._(n("3d495adb")),l=r._(n("66a06515")),u=r._(n("20defe2a")),c=n("ef642ab1"),d=r._(n("82f98358")),f=r._(n("6c762716")),h=r._(n("5f6e51a9")),p=r._(n("734d0cc9")),v=n("71293cfd"),g=n("0d884ee9"),m=n("4e68b4c7"),y=(0,p.default)("renderState"),b=function(){function e(t){(0,o.default)(this,e),this.removedRBushNodeAABBs=[],this.renderQueue=[],Object.defineProperty(this,y,{writable:!0,value:{restoreStack:[],prevObject:null,currentContext:new Map}}),this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=v.mat4.create(),this.dprMatrix=v.mat4.create(),this.tmpMat4=v.mat4.create(),this.vec3a=v.vec3.create(),this.vec3b=v.vec3.create(),this.vec3c=v.vec3.create(),this.vec3d=v.vec3.create(),this.canvasRendererPluginOptions=t;}return(0,s.default)(e,[{key:"apply",value:function(t,n){var r=this;this.context=t;var i=this.context,a=i.config,o=i.camera,s=i.renderingService,l=i.renderingContext,u=i.rBushRoot,d=i.pathGeneratorFactory,p=a.renderer.getConfig().enableRenderingOptimization;a.renderer.getConfig().enableDirtyCheck=!1,a.renderer.getConfig().enableDirtyRectangleRendering=!1,this.rBush=u,this.pathGeneratorFactory=d;var g=t.contextService,m=l.root.ownerDocument.defaultView,b=function(e){var t=e.target.rBushNode;t.aabb&&r.removedRBushNodeAABBs.push(t.aabb);},_=function(e){var t=e.target.rBushNode;t.aabb&&r.removedRBushNodeAABBs.push(t.aabb);};s.hooks.init.tap(e.tag,function(){m.addEventListener(c.ElementEvent.UNMOUNTED,b),m.addEventListener(c.ElementEvent.CULLED,_);var e=g.getDPR(),t=a.width,n=a.height,i=g.getContext();r.clearRect(i,0,0,t*e,n*e,a.background);}),s.hooks.destroy.tap(e.tag,function(){m.removeEventListener(c.ElementEvent.UNMOUNTED,b),m.removeEventListener(c.ElementEvent.CULLED,_),r.renderQueue=[],r.removedRBushNodeAABBs=[],(0,h.default)(r,y)[y]={restoreStack:[],prevObject:null,currentContext:null};}),s.hooks.beginFrame.tap(e.tag,function(){var e,t=g.getContext(),n=g.getDPR(),i=a.width,o=a.height,l=r.canvasRendererPluginOptions,u=l.dirtyObjectNumThreshold,c=l.dirtyObjectRatioThreshold,d=s.getStats(),f=d.total,h=d.rendered;r.clearFullScreen=r.clearFullScreenLastFrame||!(null!==(e=m.context.renderingPlugins[1])&&void 0!==e&&e.isFirstTimeRenderingFinished)||s.disableDirtyRectangleRendering()||h>u&&h/f>c,t&&("function"==typeof t.resetTransform?t.resetTransform():t.setTransform(1,0,0,1,0,0),r.clearFullScreen&&r.clearRect(t,0,0,i*n,o*n,a.background));});var x=function(e,t){for(var i=[e];i.length>0;){var a,o=i.pop();o.isVisible()&&!o.isCulled()&&(p?r.renderDisplayObjectOptimized(o,t,r.context,(0,h.default)(r,y)[y],n):r.renderDisplayObject(o,t,r.context,(0,h.default)(r,y)[y],n));for(var s=(null===(a=o.sortable)||void 0===a||null===(a=a.sorted)||void 0===a?void 0:a.length)>0?o.sortable.sorted:o.childNodes,l=s.length-1;l>=0;l--)i.push(s[l]);}};s.hooks.endFrame.tap(e.tag,function(){if(0===l.root.childNodes.length){r.clearFullScreenLastFrame=!0;return;}p=a.renderer.getConfig().enableRenderingOptimization,(0,h.default)(r,y)[y]={restoreStack:[],prevObject:null,currentContext:(0,h.default)(r,y)[y].currentContext},(0,h.default)(r,y)[y].currentContext.clear(),r.clearFullScreenLastFrame=!1;var e=g.getContext(),t=g.getDPR();if(v.mat4.fromScaling(r.dprMatrix,[t,t,1]),v.mat4.multiply(r.vpMatrix,r.dprMatrix,o.getOrthoMatrix()),r.clearFullScreen)p?(e.save(),x(l.root,e),e.restore()):x(l.root,e),r.removedRBushNodeAABBs=[];else{var i=r.safeMergeAABB.apply(r,[r.mergeDirtyAABBs(r.renderQueue)].concat((0,f.default)(r.removedRBushNodeAABBs.map(function(e){var t=e.minX,n=e.minY,r=e.maxX,i=e.maxY,a=new c.AABB;return a.setMinMax([t,n,0],[r,i,0]),a;}))));if(r.removedRBushNodeAABBs=[],c.AABB.isEmpty(i)){r.renderQueue=[];return;}var s=r.convertAABB2Rect(i),u=s.x,d=s.y,b=s.width,_=s.height,w=v.vec3.transformMat4(r.vec3a,[u,d,0],r.vpMatrix),E=v.vec3.transformMat4(r.vec3b,[u+b,d,0],r.vpMatrix),M=v.vec3.transformMat4(r.vec3c,[u,d+_,0],r.vpMatrix),S=v.vec3.transformMat4(r.vec3d,[u+b,d+_,0],r.vpMatrix),k=Math.min(w[0],E[0],S[0],M[0]),C=Math.min(w[1],E[1],S[1],M[1]),A=Math.max(w[0],E[0],S[0],M[0]),L=Math.max(w[1],E[1],S[1],M[1]),P=Math.floor(k),N=Math.floor(C),O=Math.ceil(A-k),I=Math.ceil(L-C);e.save(),r.clearRect(e,P,N,O,I,a.background),e.beginPath(),e.rect(P,N,O,I),e.clip(),e.setTransform(r.vpMatrix[0],r.vpMatrix[1],r.vpMatrix[4],r.vpMatrix[5],r.vpMatrix[12],r.vpMatrix[13]),a.renderer.getConfig().enableDirtyRectangleRenderingDebug&&m.dispatchEvent(new c.CustomEvent(c.CanvasEvent.DIRTY_RECTANGLE,{dirtyRect:{x:P,y:N,width:O,height:I}})),r.searchDirtyObjects(i).sort(function(e,t){return e.sortable.renderOrder-t.sortable.renderOrder;}).forEach(function(t){t&&t.isVisible()&&!t.isCulled()&&r.renderDisplayObject(t,e,r.context,(0,h.default)(r,y)[y],n);}),e.restore(),r.renderQueue.forEach(function(e){r.saveDirtyAABB(e);}),r.renderQueue=[];}(0,h.default)(r,y)[y].restoreStack.forEach(function(){e.restore();}),(0,h.default)(r,y)[y].restoreStack=[];}),s.hooks.render.tap(e.tag,function(e){r.clearFullScreen||r.renderQueue.push(e);});}},{key:"clearRect",value:function(e,t,n,r,i,a){e.clearRect(t,n,r,i),a&&(e.fillStyle=a,e.fillRect(t,n,r,i));}},{key:"renderDisplayObjectOptimized",value:function(e,t,n,r,i){var a=e.nodeName,o=!1,s=this.context.styleRendererFactory[a],l=this.pathGeneratorFactory[a],u=e.parsedStyle.clipPath;if(u){r.prevObject&&v.mat4.exactEquals(u.getWorldTransform(),r.prevObject.getWorldTransform())||(this.applyWorldTransform(t,u),r.prevObject=null);var d=this.pathGeneratorFactory[u.nodeName];d&&(t.save(),o=!0,t.beginPath(),d(t,u.parsedStyle),t.closePath(),t.clip());}if(s){r.prevObject&&v.mat4.exactEquals(e.getWorldTransform(),r.prevObject.getWorldTransform())||this.applyWorldTransform(t,e);var f=!r.prevObject;if(!f){var p=r.prevObject.nodeName;f=a===c.Shape.TEXT?p!==c.Shape.TEXT:a===c.Shape.IMAGE?p!==c.Shape.IMAGE:p===c.Shape.TEXT||p===c.Shape.IMAGE;}s.applyStyleToContext(t,e,f,r),r.prevObject=e;}l&&(t.beginPath(),l(t,e.parsedStyle),a!==c.Shape.LINE&&a!==c.Shape.PATH&&a!==c.Shape.POLYLINE&&t.closePath()),s&&s.drawToContext(t,e,(0,h.default)(this,y)[y],this,i),o&&t.restore(),e.renderable.dirty=!1;}},{key:"renderDisplayObject",value:function(e,t,n,r,i){var a=e.nodeName,o=r.restoreStack[r.restoreStack.length-1];o&&!(e.compareDocumentPosition(o)&c.Node.DOCUMENT_POSITION_CONTAINS)&&(t.restore(),r.restoreStack.pop());var s=this.context.styleRendererFactory[a],l=this.pathGeneratorFactory[a],u=e.parsedStyle.clipPath;if(u){this.applyWorldTransform(t,u);var d=this.pathGeneratorFactory[u.nodeName];d&&(t.save(),r.restoreStack.push(e),t.beginPath(),d(t,u.parsedStyle),t.closePath(),t.clip());}s&&(this.applyWorldTransform(t,e),t.save(),this.applyAttributesToContext(t,e)),l&&(t.beginPath(),l(t,e.parsedStyle),a!==c.Shape.LINE&&a!==c.Shape.PATH&&a!==c.Shape.POLYLINE&&t.closePath()),s&&(s.render(t,e.parsedStyle,e,n,this,i),t.restore()),e.renderable.dirty=!1;}},{key:"applyAttributesToContext",value:function(e,t){var n=t.parsedStyle,r=n.stroke,i=n.fill,a=n.opacity,o=n.lineDash,s=n.lineDashOffset;o&&e.setLineDash(o),(0,g.isNil)(s)||(e.lineDashOffset=s),(0,g.isNil)(a)||(e.globalAlpha*=a),(0,g.isNil)(r)||Array.isArray(r)||r.isNone||(e.strokeStyle=t.attributes.stroke),(0,g.isNil)(i)||Array.isArray(i)||i.isNone||(e.fillStyle=t.attributes.fill);}},{key:"convertAABB2Rect",value:function(e){var t=e.getMin(),n=e.getMax(),r=Math.floor(t[0]),i=Math.floor(t[1]);return{x:r,y:i,width:Math.ceil(n[0])-r,height:Math.ceil(n[1])-i};}},{key:"mergeDirtyAABBs",value:function(e){var t=new c.AABB;return e.forEach(function(e){var n=e.getRenderBounds();t.add(n);var r=e.renderable.dirtyRenderBounds;r&&t.add(r);}),t;}},{key:"searchDirtyObjects",value:function(e){var t=e.getMin(),n=(0,d.default)(t,2),r=n[0],i=n[1],a=e.getMax(),o=(0,d.default)(a,2),s=o[0],l=o[1];return this.rBush.search({minX:r,minY:i,maxX:s,maxY:l}).map(function(e){return e.displayObject;});}},{key:"saveDirtyAABB",value:function(e){var t=e.renderable;t.dirtyRenderBounds||(t.dirtyRenderBounds=new c.AABB);var n=e.getRenderBounds();n&&t.dirtyRenderBounds.update(n.center,n.halfExtents);}},{key:"applyWorldTransform",value:function(e,t,n){n?(v.mat4.copy(this.tmpMat4,t.getLocalTransform()),v.mat4.multiply(this.tmpMat4,n,this.tmpMat4)):v.mat4.copy(this.tmpMat4,t.getWorldTransform()),v.mat4.multiply(this.tmpMat4,this.vpMatrix,this.tmpMat4),e.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13]);}},{key:"safeMergeAABB",value:function(){for(var e=new c.AABB,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach(function(t){e.add(t);}),e;}}]);}();function _(e,t,n,r,i,a,o){if("rect"===e.image.nodeName){var s,l,u=e.image.parsedStyle,c=u.width,d=u.height;l=r.contextService.getDPR();var f=r.config.offscreenCanvas;(s=a.offscreenCanvasCreator.getOrCreateCanvas(f)).width=c*l,s.height=d*l;var h=a.offscreenCanvasCreator.getOrCreateContext(f),p={restoreStack:[],prevObject:null,currentContext:new Map};e.image.forEach(function(e){i.renderDisplayObject(e,h,r,p,a);}),p.restoreStack.forEach(function(){h.restore();});}return o.getOrCreatePatternSync(t,e,n,s,l,t.getGeometryBounds().min,function(){t.renderable.dirty=!0,r.renderingService.dirtify();});}function x(e,t,n,r){var i;if(e.type===c.GradientType.LinearGradient||e.type===c.GradientType.RadialGradient){var o=t.getGeometryBounds(),s=o&&2*o.halfExtents[0]||1,l=o&&2*o.halfExtents[1]||1,u=o&&o.min||[0,0];i=r.getOrCreateGradient((0,a.default)((0,a.default)({type:e.type},e.value),{},{min:u,width:s,height:l}),n);}return i;}b.tag="CanvasRenderer";var w=["shadowBlur","shadowOffsetX","shadowOffsetY"],E=["lineCap","lineJoin","miterLimit"],M={globalAlpha:1,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",filter:"none",globalCompositeOperation:"source-over",strokeStyle:"#000",strokeOpacity:1,lineWidth:1,lineDash:[],lineDashOffset:0,lineCap:"butt",lineJoin:"miter",miterLimit:10,fillStyle:"#000",fillOpacity:1},S={};function k(e,t,n,r){var i=r.has(t)?r.get(t):M[t];return i!==n&&("lineDash"===t?e.setLineDash(n):e[t]=n,r.set(t,n)),i;}var C=function(e){function t(){return(0,o.default)(this,t),(0,l.default)(this,t,arguments);}return(0,u.default)(t,e),(0,s.default)(t,[{key:"render",value:function(e,t,n,r,i,a){var o=t.fill,s=t.fillRule,l=t.opacity,u=void 0===l?1:l,d=t.fillOpacity,f=t.stroke,h=t.strokeOpacity,p=t.lineWidth,v=void 0===p?1:p,m=t.lineCap,y=t.lineJoin,b=t.shadowType,_=t.shadowColor,x=t.shadowBlur,w=t.filter,E=t.miterLimit,S=o&&!o.isNone,k=f&&!f.isNone&&v>0,C=(null==o?void 0:o.alpha)===0,N=!!(w&&w.length),O=!(0,g.isNil)(_)&&x>0,I=n.nodeName,R="inner"===b,D=k&&O&&(I===c.Shape.PATH||I===c.Shape.LINE||I===c.Shape.POLYLINE||C||R);S&&(e.globalAlpha=u*(void 0===d?1:d),D||A(n,e,O),L(e,n,o,s,r,i,a,this.imagePool),D||this.clearShadowAndFilter(e,N,O)),k&&(e.globalAlpha=u*(void 0===h?1:h),e.lineWidth=v,(0,g.isNil)(E)||(e.miterLimit=E),(0,g.isNil)(m)||(e.lineCap=m),(0,g.isNil)(y)||(e.lineJoin=y),D&&(R&&(e.globalCompositeOperation="source-atop"),A(n,e,!0),R&&(P(e,n,f,r,i,a,this.imagePool),e.globalCompositeOperation=M.globalCompositeOperation,this.clearShadowAndFilter(e,N,!0))),P(e,n,f,r,i,a,this.imagePool));}},{key:"clearShadowAndFilter",value:function(e,t,n){if(n&&(e.shadowColor="transparent",e.shadowBlur=0),t){var r=e.filter;!(0,g.isNil)(r)&&r.indexOf("drop-shadow")>-1&&(e.filter=r.replace(/drop-shadow\([^)]*\)/,"").trim()||"none");}}}]);}((0,s.default)(function e(t){(0,o.default)(this,e),this.imagePool=t;},[{key:"applyAttributesToContext",value:function(e,t){}},{key:"render",value:function(e,t,n,r,i,a){}},{key:"applyCommonStyleToContext",value:function(e,t,n,r){var i=n?S:r.prevObject.parsedStyle,a=t.parsedStyle;(n||a.opacity!==i.opacity)&&k(e,"globalAlpha",(0,g.isNil)(a.opacity)?M.globalAlpha:a.opacity,r.currentContext),(n||a.blend!==i.blend)&&k(e,"globalCompositeOperation",(0,g.isNil)(a.blend)?M.globalCompositeOperation:a.blend,r.currentContext);}},{key:"applyStrokeFillStyleToContext",value:function(e,t,n,r){var i=n?S:r.prevObject.parsedStyle,a=t.parsedStyle,o=a.lineWidth,s=void 0===o?M.lineWidth:o,l=a.fill&&!a.fill.isNone;if(a.stroke&&!a.stroke.isNone&&s>0){(n||t.attributes.stroke!==r.prevObject.attributes.stroke)&&k(e,"strokeStyle",(0,g.isNil)(a.stroke)||Array.isArray(a.stroke)||a.stroke.isNone?M.strokeStyle:t.attributes.stroke,r.currentContext),(n||a.lineWidth!==i.lineWidth)&&k(e,"lineWidth",(0,g.isNil)(a.lineWidth)?M.lineWidth:a.lineWidth,r.currentContext),(n||a.lineDash!==i.lineDash)&&k(e,"lineDash",a.lineDash||M.lineDash,r.currentContext),(n||a.lineDashOffset!==i.lineDashOffset)&&k(e,"lineDashOffset",(0,g.isNil)(a.lineDashOffset)?M.lineDashOffset:a.lineDashOffset,r.currentContext);for(var u=0;u<E.length;u++){var c=E[u];(n||a[c]!==i[c])&&k(e,c,(0,g.isNil)(a[c])?M[c]:a[c],r.currentContext);}}l&&(n||t.attributes.fill!==r.prevObject.attributes.fill)&&k(e,"fillStyle",(0,g.isNil)(a.fill)||Array.isArray(a.fill)||a.fill.isNone?M.fillStyle:t.attributes.fill,r.currentContext);}},{key:"applyStyleToContext",value:function(e,t,n,r){var i=t.nodeName;this.applyCommonStyleToContext(e,t,n,r),i===c.Shape.IMAGE||this.applyStrokeFillStyleToContext(e,t,n,r);}},{key:"applyShadowAndFilterStyleToContext",value:function(e,t,n,r){var i=t.parsedStyle;if(n){k(e,"shadowColor",i.shadowColor.toString(),r.currentContext);for(var a=0;a<w.length;a++){var o=w[a];k(e,o,i[o]||M[o],r.currentContext);}}i.filter&&i.filter.length&&k(e,"filter",t.attributes.filter,r.currentContext);}},{key:"clearShadowAndFilterStyleForContext",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(t){k(e,"shadowColor",M.shadowColor,r.currentContext);for(var a=0;a<w.length;a++){var o=w[a];k(e,o,M[o],r.currentContext);}}if(n){if(t&&i){var s=e.filter;!(0,g.isNil)(s)&&s.indexOf("drop-shadow")>-1&&k(e,"filter",s.replace(/drop-shadow\([^)]*\)/,"").trim()||M.filter,r.currentContext);}else k(e,"filter",M.filter,r.currentContext);}}},{key:"fillToContext",value:function(e,t,n,r,i){var a=this,o=t.parsedStyle,s=o.fill,l=o.fillRule,u=null;if(Array.isArray(s)&&s.length>0)s.forEach(function(r){var i=k(e,"fillStyle",x(r,t,e,a.imagePool),n.currentContext);u=null!=u?u:i,l?e.fill(l):e.fill();});else{if((0,c.isPattern)(s)){var d=_(s,t,e,t.ownerDocument.defaultView.context,r,i,this.imagePool);d&&(e.fillStyle=d,u=!0);}l?e.fill(l):e.fill();}null!==u&&k(e,"fillStyle",u,n.currentContext);}},{key:"strokeToContext",value:function(e,t,n,r,i){var a=this,o=t.parsedStyle.stroke,s=null;if(Array.isArray(o)&&o.length>0)o.forEach(function(r){var i=k(e,"strokeStyle",x(r,t,e,a.imagePool),n.currentContext);s=null!=s?s:i,e.stroke();});else{if((0,c.isPattern)(o)){var l=_(o,t,e,t.ownerDocument.defaultView.context,r,i,this.imagePool);if(l){var u=k(e,"strokeStyle",l,n.currentContext);s=null!=s?s:u;}}e.stroke();}null!==s&&k(e,"strokeStyle",s,n.currentContext);}},{key:"drawToContext",value:function(e,t,n,r,i){var a,o=t.nodeName,s=t.parsedStyle,l=s.opacity,u=void 0===l?M.globalAlpha:l,d=s.fillOpacity,f=void 0===d?M.fillOpacity:d,h=s.strokeOpacity,p=void 0===h?M.strokeOpacity:h,v=s.lineWidth,m=void 0===v?M.lineWidth:v,y=s.fill&&!s.fill.isNone,b=s.stroke&&!s.stroke.isNone&&m>0;if(y||b){var _=!(0,g.isNil)(s.shadowColor)&&s.shadowBlur>0,x="inner"===s.shadowType,w=(null===(a=s.fill)||void 0===a?void 0:a.alpha)===0,E=!!(s.filter&&s.filter.length),S=_&&b&&(o===c.Shape.PATH||o===c.Shape.LINE||o===c.Shape.POLYLINE||w||x),C=null;if(y&&(S||this.applyShadowAndFilterStyleToContext(e,t,_,n),C=k(e,"globalAlpha",u*f,n.currentContext),this.fillToContext(e,t,n,r,i),S||this.clearShadowAndFilterStyleForContext(e,_,E,n)),b){var A=!1,L=k(e,"globalAlpha",u*p,n.currentContext);if(C=y?C:L,S&&(this.applyShadowAndFilterStyleToContext(e,t,_,n),A=!0,x)){var P=e.globalCompositeOperation;e.globalCompositeOperation="source-atop",this.strokeToContext(e,t,n,r,i),e.globalCompositeOperation=P,this.clearShadowAndFilterStyleForContext(e,_,E,n,!0);}this.strokeToContext(e,t,n,r,i),A&&this.clearShadowAndFilterStyleForContext(e,_,E,n);}null!==C&&k(e,"globalAlpha",C,n.currentContext);}}}]));function A(e,t,n){var r=e.parsedStyle,i=r.filter,a=r.shadowColor,o=r.shadowBlur,s=r.shadowOffsetX,l=r.shadowOffsetY;i&&i.length&&(t.filter=e.style.filter),n&&(t.shadowColor=a.toString(),t.shadowBlur=o||0,t.shadowOffsetX=s||0,t.shadowOffsetY=l||0);}function L(e,t,n,r,i,a,o,s){var l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];Array.isArray(n)?n.forEach(function(n){e.fillStyle=x(n,t,e,s),l||(r?e.fill(r):e.fill());}):((0,c.isPattern)(n)&&(e.fillStyle=_(n,t,e,i,a,o,s)),l||(r?e.fill(r):e.fill()));}function P(e,t,n,r,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];Array.isArray(n)?n.forEach(function(n){e.strokeStyle=x(n,t,e,o),s||e.stroke();}):((0,c.isPattern)(n)&&(e.strokeStyle=_(n,t,e,r,i,a,o)),s||e.stroke());}var N=function(e){function t(){return(0,o.default)(this,t),(0,l.default)(this,t,arguments);}return(0,u.default)(t,e),(0,s.default)(t,[{key:"renderDownSampled",value:function(e,t,n,r){var i=r.src,a=r.imageCache;if(!a.downSampled){this.imagePool.createDownSampledImage(i,n).then(function(){n.ownerDocument&&(n.renderable.dirty=!0,n.ownerDocument.defaultView.context.renderingService.dirtify());}).catch(function(e){console.error(e);});return;}e.drawImage(a.downSampled,Math.floor(r.drawRect[0]),Math.floor(r.drawRect[1]),Math.ceil(r.drawRect[2]),Math.ceil(r.drawRect[3]));}},{key:"renderTile",value:function(e,t,n,r){var i=r.src,a=r.imageCache,o=r.imageRect,s=r.drawRect,l=a.size,u=e.getTransform(),c=u.a,d=u.b,f=u.c,h=u.d,p=u.e,v=u.f;if(e.resetTransform(),!(null!=a&&a.gridSize)){this.imagePool.createImageTiles(i,[],function(){n.ownerDocument&&(n.renderable.dirty=!0,n.ownerDocument.defaultView.context.renderingService.dirtify());},n).catch(function(e){console.error(e);});return;}for(var g=[l[0]/o[2],l[1]/o[3]],m=[a.tileSize[0]/g[0],a.tileSize[1]/g[1]],y=[Math.floor((s[0]-o[0])/m[0]),Math.ceil((s[0]+s[2]-o[0])/m[0])],b=y[0],_=y[1],x=[Math.floor((s[1]-o[1])/m[1]),Math.ceil((s[1]+s[3]-o[1])/m[1])],w=x[0],E=x[1],M=w;M<=E;M++)for(var S=b;S<=_;S++){var k=a.tiles[M][S];if(k){var C=[Math.floor(o[0]+k.tileX*m[0]),Math.floor(o[1]+k.tileY*m[1]),Math.ceil(m[0]),Math.ceil(m[1])];e.drawImage(k.data,C[0],C[1],C[2],C[3]);}}e.setTransform(c,d,f,h,p,v);}},{key:"render",value:function(e,n,r){var i=n.x,a=void 0===i?0:i,o=n.y,s=void 0===o?0:o,l=n.width,u=n.height,c=n.src,f=n.shadowColor,h=n.shadowBlur,p=this.imagePool.getImageSync(c,r),y=null==p?void 0:p.img,b=l,_=u;if(y){b||(b=y.width),_||(_=y.height),A(r,e,!(0,g.isNil)(f)&&h>0);try{var x,w,E,M,S,k,C,L,P,N,O,I,R,D,z,B,U,F,j,V,G=r.ownerDocument.defaultView.getContextService().getDomElement(),H=G.width,W=G.height,Z=e.getTransform(),q=Z.a,Y=Z.b,X=Z.c,$=Z.d,K=Z.e,Q=Z.f,J=v.mat4.fromValues(q,X,0,0,Y,$,0,0,0,0,1,0,K,Q,0,1),ee=(x=[a,s,b,_],w=v.vec3.transformMat4(v.vec3.create(),[x[0],x[1],0],J),E=v.vec3.transformMat4(v.vec3.create(),[x[0]+x[2],x[1],0],J),M=v.vec3.transformMat4(v.vec3.create(),[x[0],x[1]+x[3],0],J),S=v.vec3.transformMat4(v.vec3.create(),[x[0]+x[2],x[1]+x[3],0],J),[Math.min(w[0],E[0],M[0],S[0]),Math.min(w[1],E[1],M[1],S[1]),Math.max(w[0],E[0],M[0],S[0])-Math.min(w[0],E[0],M[0],S[0]),Math.max(w[1],E[1],M[1],S[1])-Math.min(w[1],E[1],M[1],S[1])]),et=(k=[0,0,H,W],L=(C=(0,d.default)(k,4))[0],P=C[1],N=C[2],O=C[3],R=(I=(0,d.default)(ee,4))[0],D=I[1],z=I[2],B=I[3],U=Math.max(L,R),F=Math.max(P,D),j=Math.min(L+N,R+z),V=Math.min(P+O,D+B),j<=U||V<=F?null:[U,F,j-U,V-F]);if(!et)return;if(!r.ownerDocument.defaultView.getConfig().enableLargeImageOptimization){t.renderFull(e,n,r,{image:y,drawRect:[a,s,b,_]});return;}if(ee[2]/p.size[0]<(p.downSamplingRate||.5)){this.renderDownSampled(e,n,r,{src:c,imageCache:p,drawRect:[a,s,b,_]});return;}if(!m.ImagePool.isSupportTile){t.renderFull(e,n,r,{image:y,drawRect:[a,s,b,_]});return;}this.renderTile(e,n,r,{src:c,imageCache:p,imageRect:ee,drawRect:et});}catch(e){}}}},{key:"drawToContext",value:function(e,t,n,r,i){this.render(e,t.parsedStyle,t);}}],[{key:"renderFull",value:function(e,t,n,r){e.drawImage(r.image,Math.floor(r.drawRect[0]),Math.floor(r.drawRect[1]),Math.ceil(r.drawRect[2]),Math.ceil(r.drawRect[3]));}}]);}(C),O=function(e){function t(){return(0,o.default)(this,t),(0,l.default)(this,t,arguments);}return(0,u.default)(t,e),(0,s.default)(t,[{key:"render",value:function(e,t,n,r,i,a){n.getBounds();var o=t.lineWidth,s=void 0===o?1:o,l=t.textAlign,u=void 0===l?"start":l,c=t.textBaseline,d=void 0===c?"alphabetic":c,f=t.lineJoin,h=t.miterLimit,p=void 0===h?10:h,v=t.letterSpacing,m=void 0===v?0:v,y=t.stroke,b=t.fill,_=t.fillRule,x=t.fillOpacity,w=void 0===x?1:x,E=t.strokeOpacity,M=void 0===E?1:E,S=t.opacity,k=void 0===S?1:S,C=t.metrics,L=t.x,P=t.y,N=t.dx,O=t.dy,I=t.shadowColor,R=t.shadowBlur,D=C.font,z=C.lines,B=C.height,U=C.lineHeight,F=C.lineMetrics;e.font=D,e.lineWidth=s,e.textAlign="middle"===u?"center":u;var j=d;"alphabetic"===j&&(j="bottom"),e.lineJoin=void 0===f?"miter":f,(0,g.isNil)(p)||(e.miterLimit=p);var V=void 0===P?0:P;"middle"===d?V+=-B/2-U/2:"bottom"===d||"alphabetic"===d||"ideographic"===d?V+=-B:("top"===d||"hanging"===d)&&(V+=-U);var G=(void 0===L?0:L)+(N||0);V+=O||0,1===z.length&&("bottom"===j?(j="middle",V-=.5*B):"top"===j&&(j="middle",V+=.5*B)),e.textBaseline=j,A(n,e,!(0,g.isNil)(I)&&R>0);for(var H=0;H<z.length;H++){var W=s/2+G;V+=U,(0,g.isNil)(y)||y.isNone||!s||this.drawLetterSpacing(e,n,z[H],F[H],u,W,V,m,b,_,w,y,M,k,!0,r,i,a),(0,g.isNil)(b)||this.drawLetterSpacing(e,n,z[H],F[H],u,W,V,m,b,_,w,y,M,k,!1,r,i,a);}}},{key:"drawLetterSpacing",value:function(e,t,n,r,i,a,o,s,l,u,c,d,f,h,p,v,g,m){if(0===s){p?this.strokeText(e,t,n,a,o,d,f,v,g,m):this.fillText(e,t,n,a,o,l,u,c,h,v,g,m);return;}var y=e.textAlign;e.textAlign="left";var b=a;"center"===i||"middle"===i?b=a-r.width/2:("right"===i||"end"===i)&&(b=a-r.width);for(var _=Array.from(n),x=e.measureText(n).width,w=0,E=0;E<_.length;++E){var M=_[E];p?this.strokeText(e,t,M,b,o,d,f,v,g,m):this.fillText(e,t,M,b,o,l,u,c,h,v,g,m),b+=x-(w=e.measureText(n.substring(E+1)).width)+s,x=w;}e.textAlign=y;}},{key:"fillText",value:function(e,t,n,r,i,a,o,s,l,u,c,d){L(e,t,a,o,u,c,d,this.imagePool,!0);var f,h=!(0,g.isNil)(s)&&1!==s;h&&(f=e.globalAlpha,e.globalAlpha=s*l),e.fillText(n,r,i),h&&(e.globalAlpha=f);}},{key:"strokeText",value:function(e,t,n,r,i,a,o,s,l,u){P(e,t,a,s,l,u,this.imagePool,!0);var c,d=!(0,g.isNil)(o)&&1!==o;d&&(c=e.globalAlpha,e.globalAlpha=o),e.strokeText(n,r,i),d&&(e.globalAlpha=c);}},{key:"drawToContext",value:function(e,t,n,r,i){this.render(e,t.parsedStyle,t,t.ownerDocument.defaultView.context,r,i);}}]);}(C),I=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.default)(this,t),(e=(0,l.default)(this,t)).name="canvas-renderer",e.options=n,e;}return(0,u.default)(t,e),(0,s.default)(t,[{key:"init",value:function(){var e,t=(0,a.default)({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),n=this.context.imagePool,r=new C(n),o=(e={},(0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)(e,c.Shape.CIRCLE,r),c.Shape.ELLIPSE,r),c.Shape.RECT,r),c.Shape.IMAGE,new N(n)),c.Shape.TEXT,new O(n)),c.Shape.LINE,r),c.Shape.POLYLINE,r),c.Shape.POLYGON,r),c.Shape.PATH,r),c.Shape.GROUP,void 0),(0,i.default)((0,i.default)((0,i.default)(e,c.Shape.HTML,void 0),c.Shape.MESH,void 0),c.Shape.FRAGMENT,void 0));this.context.defaultStyleRendererFactory=o,this.context.styleRendererFactory=o,this.addRenderingPlugin(new b(t));}},{key:"destroy",value:function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory;}}]);}(c.AbstractRendererPlugin);},"8d15a3f4":function(e,t,n){var r=n("e06645db")(Object,"create");e.exports=r;},"8d3f7781":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return g;}});var r=n("777fffbe"),i=r._(n("84f4444b")),a=r._(n("05c30d73")),o=r._(n("eed78134")),s=r._(n("5ca30fb9")),l=r._(n("ebc8c370")),u=r._(n("416bfed3")),c=r._(n("e656c7f2")),d=r._(n("0916dbe6")),f="[object Arguments]",h="[object Array]",p="[object Object]",v=Object.prototype.hasOwnProperty,g=function(e,t,n,r,g,m){var y=(0,u.default)(e),b=(0,u.default)(t),_=y?h:(0,l.default)(e),x=b?h:(0,l.default)(t);_=_==f?p:_,x=x==f?p:x;var w=_==p,E=x==p,M=_==x;if(M&&(0,c.default)(e)){if(!(0,c.default)(t))return!1;y=!0,w=!1;}if(M&&!w)return m||(m=new i.default),y||(0,d.default)(e)?(0,a.default)(e,t,n,r,g,m):(0,o.default)(e,t,_,n,r,g,m);if(!(1&n)){var S=w&&v.call(e,"__wrapped__"),k=E&&v.call(t,"__wrapped__");if(S||k){var C=S?e.value():e,A=k?t.value():t;return m||(m=new i.default),g(C,A,n,r,m);}}return!!M&&(m||(m=new i.default),(0,s.default)(e,t,n,r,g,m));};},"8e0f3f05":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{PopperControl:function(){return u;},default:function(){return u;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("d812e418")),o=n("e9ce9d12"),s=r._(n("3198c185"));let l={topleft:"right-start",topcenter:"bottom",topright:"left-start",bottomleft:"right-end",bottomcenter:"top",bottomright:"left-end",lefttop:"bottom-start",leftcenter:"right",leftbottom:"top-start",righttop:"bottom-end",rightcenter:"left",rightbottom:"top-end"};class u extends s.default{constructor(...e){super(...e),(0,a.default)(this,"popper",void 0);}getPopper(){return this.popper;}hide(){this.popper.hide(),super.hide();}getDefault(e){var t;let n=super.getDefault(e),r=null!==(t=null==e?void 0:e.position)&&void 0!==t?t:n.position;return(0,i.default)((0,i.default)({},super.getDefault(e)),{},{popperPlacement:r instanceof Element?"bottom":l[r],popperTrigger:"click"});}onAdd(){let e=super.onAdd();return this.initPopper(),e;}onRemove(){this.popper.destroy();}initPopper(){let{popperClassName:e,popperPlacement:t,popperTrigger:n}=this.controlOption,r=this.mapsService.getMapContainer();return this.popper=new o.Popper(this.button,{className:e,placement:t,trigger:n,container:r,unique:!0}),this.popper.on("show",()=>{this.emit("popperShow",this);}).on("hide",()=>{this.emit("popperHide",this);}),this.popper;}setOptions(e){if(super.setOptions(e),this.checkUpdateOption(e,["popperPlacement","popperTrigger","popperClassName"])){let e=this.popper.getContent();this.popper.destroy(),this.initPopper(),this.popper.setContent(e);}}}},"8e397f88":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{SelectControl:function(){return l;},default:function(){return l;}});var r,i=n("777fffbe")._(n("d812e418")),a=n("fb1ec05a"),o=n("8e0f3f05"),s=((r=s||{}).ActiveOptionClassName="l7-select-control-item-active",r.OptionValueAttrKey="data-option-value",r.OptionIndexAttrKey="data-option-index",r);class l extends o.PopperControl{constructor(...e){super(...e),(0,i.default)(this,"selectValue",[]),(0,i.default)(this,"optionDOMList",void 0),(0,i.default)(this,"createNormalOption",e=>{let t=this.selectValue.includes(e.value),n=a.DOM.create("div",`l7-select-control-item ${t?s.ActiveOptionClassName:""}`);this.getIsMultiple()?n.appendChild(this.createCheckbox(t)):n.appendChild(this.createRadio(t)),e.icon&&n.appendChild(e.icon);let r=a.DOM.create("span");return r.innerText=e.text,n.appendChild(r),n;}),(0,i.default)(this,"onItemClick",e=>{if(this.getIsMultiple()){let t=this.selectValue.findIndex(t=>t===e.value);t>-1?this.selectValue.splice(t,1):this.selectValue=[...this.selectValue,e.value];}else this.selectValue=[e.value];this.setSelectValue(this.selectValue);});}setOptions(e){super.setOptions(e);let{options:t}=e;t&&this.popper.setContent(this.getPopperContent(t));}onAdd(){let e=super.onAdd(),{defaultValue:t}=this.controlOption;return t&&(this.selectValue=this.transSelectValue(t)),this.popper.setContent(this.getPopperContent(this.controlOption.options)),e;}getSelectValue(){return this.getIsMultiple()?this.selectValue:this.selectValue[0];}setSelectValue(e,t=!0){let n=this.transSelectValue(e);this.optionDOMList.forEach(e=>{let t=e.getAttribute(s.OptionValueAttrKey),r=e.querySelector("input[type=checkbox]"),i=e.querySelector("input[type=radio]"),o=n.includes(t),l=(t,n)=>{a.DOM.toggleClass(e,s.ActiveOptionClassName,n),t&&a.DOM.setChecked(t,n);};l(r,o),l(i,o);}),this.selectValue=n,t&&this.emit("selectChange",this.getIsMultiple()?n:n[0]);}getIsMultiple(){return!1;}getPopperContent(e){let t=this.isImageOptions(),n=a.DOM.create("div",t?"l7-select-control--image":"l7-select-control--normal");this.getIsMultiple()&&a.DOM.addClass(n,"l7-select-control--multiple");let r=e.map((e,n)=>{let r=t?this.createImageOption(e):this.createNormalOption(e);return r.setAttribute(s.OptionValueAttrKey,e.value),r.setAttribute(s.OptionIndexAttrKey,window.String(n)),r.addEventListener("click",this.onItemClick.bind(this,e)),r;});return n.append(...r),this.optionDOMList=r,n;}createImageOption(e){let t=this.selectValue.includes(e.value),n=a.DOM.create("div",`l7-select-control-item ${t?s.ActiveOptionClassName:""}`),r=a.DOM.create("img");r.setAttribute("src",e.img),a.DOM.setUnDraggable(r),n.appendChild(r);let i=a.DOM.create("div","l7-select-control-item-row");this.getIsMultiple()&&n.appendChild(this.createCheckbox(t));let o=a.DOM.create("span");return o.innerText=e.text,i.appendChild(o),n.appendChild(i),n;}createCheckbox(e){let t=a.DOM.create("input");return t.setAttribute("type","checkbox"),e&&a.DOM.setChecked(t,!0),t;}createRadio(e){let t=a.DOM.create("input");return t.setAttribute("type","radio"),e&&a.DOM.setChecked(t,!0),t;}isImageOptions(){return!!this.controlOption.options.find(e=>e.img);}transSelectValue(e){return Array.isArray(e)?e:[e];}}},"8e5ff89f":function(e,t,n){"use strict";function r(){let e=1;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"8ef9d700":function(e,t,n){var r=n("0341a906"),i=n("7af463cb"),a=n("c692a276"),o=n("32f27622"),s=n("3656a04e"),l=n("c0051812"),u=n("85163435"),c=n("d59953b5"),d=n("7c1db5f7"),f=n("c31b66bd");e.exports=function(e,t,n){var h=l(e),p=h||u(e)||f(e);if(t=o(t,4),null==n){var v=e&&e.constructor;n=p?h?new v:[]:d(e)&&c(v)?i(s(e)):{};}return(p?r:a)(e,function(e,r,i){return t(n,e,r,i);}),n;};},"8f024eb4":function(e,t,n){e.exports=function(e){return this.__data__.get(e);};},"8f2a3c48":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("0ca866ed")),a=r._(n("d28588fd")),o=r._(n("7e78caeb")),s=function(e){return"function"!=typeof e.constructor||(0,o.default)(e)?{}:(0,i.default)((0,a.default)(e));};},"8f7ff84b":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return f;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("daaa1548")),o=r._(n("d812e418")),s=n("d9b661b3"),l=n("fb1ec05a"),u=r._(n("755bc4f8")),c=n("f717bab4"),d=n("0ee4a6af");class f extends u.default{constructor(...e){super(...e),(0,o.default)(this,"texture",void 0);}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,UV:11});}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,a.default)((0,a.default)({},e.uniformsOption),t.uniformsOption);}getCommonUniformsInfo(){let{mapTexture:e,heightfixed:t=!1,raisingHeight:n=0,topsurface:r=!0,sidesurface:i=!0,sourceColor:a,targetColor:o}=this.layer.getLayerConfig(),s=0,u=[1,1,1,1],c=[1,1,1,1];a&&o&&(u=(0,l.rgb2arr)(a),c=(0,l.rgb2arr)(o),s=1);let d={u_sourceColor:u,u_targetColor:c,u_linearColor:s,u_topsurface:Number(r),u_sidesurface:Number(i),u_heightfixed:Number(t),u_raisingHeight:Number(n)};return e&&this.texture&&(d.u_texture=this.texture,this.textures=[this.texture]),this.getUniformsBufferInfo(d);}initModels(){var e=this;return(0,i.default)(function*(){return yield e.loadTexture(),e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){let{frag:t,vert:n,type:r}=e.getShaders();return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:r,vertexShader:n,fragmentShader:t,depth:{enable:!0},defines:e.getDefines(),inject:e.getInject(),triangulation:c.PolygonExtrudeTriangulation}))];})();}getShaders(){let{pickLight:e,mapTexture:t}=this.layer.getLayerConfig();return t?{frag:'uniform sampler2D u_texture;\n\nlayout(std140) uniform commonUniforms {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_linearColor;\n  float u_topsurface;\n  float u_sidesurface;\n  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A\n  float u_raisingHeight;\n};\n\nin vec4 v_Color;\nin vec3 v_uvs;\nin vec2 v_texture_data;\n\n#pragma include "scene_uniforms"\n#pragma include "picking"\n\nout vec4 outputColor;\n\nvoid main() {\n  float opacity = u_opacity;\n  float isSide = v_texture_data.x;\n  float lightWeight = v_texture_data.y;\n  float topU = v_uvs[0];\n  float topV = 1.0 - v_uvs[1];\n  float sidey = v_uvs[2];\n\n  outputColor = texture(SAMPLER_2D(u_texture), vec2(topU, topV));\n  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9\n  if (isSide < 0.999) {// \u662F\u5426\u662F\u8FB9\u7F18\n    // side face\n    if (u_sidesurface < 1.0) {\n      discard;\n    }\n\n    if (u_linearColor == 1.0) {\n      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);\n      linearColor.rgb *= lightWeight;\n      outputColor = linearColor;\n    } else {\n      outputColor = v_Color;\n    }\n  } else {\n     // top face\n    if (u_topsurface < 1.0) {\n      discard;\n    }\n  }\n  \n  outputColor.a *= opacity;\n  outputColor = filterColor(outputColor);\n}\n',vert:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;\n\nlayout(std140) uniform commonUniforms {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_linearColor;\n  float u_topsurface;\n  float u_sidesurface;\n  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A\n  float u_raisingHeight;\n};\n\nout vec4 v_Color;\nout vec3 v_uvs;\nout vec2 v_texture_data;\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);\n  vec4 project_pos = project_position(pos, a_Position64Low);\n  float lightWeight = calc_lighting(project_pos);\n  v_uvs = a_uvs;\n  v_Color = a_Color;\n  v_Color.a *= opacity;\n\n  v_texture_data = vec2(a_Position.z, lightWeight);\n\n  if (u_heightfixed > 0.0) {\n    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6\n    project_pos.z = a_Position.z * a_Size;\n    project_pos.z += u_raisingHeight;\n\n    if (\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n    ) {\n      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);\n      project_pos.z *= mapboxZoomScale;\n      project_pos.z += u_raisingHeight * mapboxZoomScale;\n    }\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',type:"polygonExtrudeTexture"}:e?{frag:'\nlayout(std140) uniform commonUniforms {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_linearColor;\n  float u_topsurface;\n  float u_sidesurface;\n  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A\n  float u_raisingHeight;\n};\n\nin vec4 v_Color;\nin vec3 v_uvs;\nin vec2 v_texture_data;\nout vec4 outputColor;\n\n#pragma include "scene_uniforms"\n#pragma include "picking"\n\nvoid main() {\n  float isSide =  v_texture_data.x;\n  float sidey = v_uvs[2];\n  float lightWeight = v_texture_data.y;\n\n  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9\n  if(isSide < 0.999) {\n    // side face\n    if(u_sidesurface < 1.0) {\n      discard;\n    }\n    \n    if( u_linearColor == 1.0) {\n      // side use linear\n      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);\n      linearColor.rgb *= lightWeight;\n      outputColor = linearColor;\n    } else {\n      // side notuse linear\n       outputColor = v_Color;\n    }\n  } else {\n    // top face\n    if(u_topsurface < 1.0) {\n      discard;\n    }\n    outputColor = v_Color;\n  }\n\n  outputColor = filterColorAlpha(outputColor, lightWeight);\n}\n',vert:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;\n\nlayout(std140) uniform commonUniforms {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_linearColor;\n  float u_topsurface;\n  float u_sidesurface;\n  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A\n  float u_raisingHeight;\n};\n\nout vec4 v_Color;\nout vec3 v_uvs;\nout vec2 v_texture_data;\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  v_uvs = a_uvs;\n  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);\n  vec4 project_pos = project_position(pos, a_Position64Low);\n\n  if (u_heightfixed > 0.0) {\n    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6\n    project_pos.z = a_Position.z * a_Size;\n    project_pos.z += u_raisingHeight;\n    if (\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n    ) {\n      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);\n      project_pos.z *= mapboxZoomScale;\n      project_pos.z += u_raisingHeight * mapboxZoomScale;\n    }\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  float lightWeight = calc_lighting(project_pos);\n  v_texture_data = vec2(a_Position.z, lightWeight);\n\n  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);\n\n  setPickingColor(a_PickingColor);\n}\n',type:"polygonExtrudePickLight"}:{frag:'layout(std140) uniform commonUniforms {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_linearColor;\n  float u_topsurface;\n  float u_sidesurface;\n  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A\n  float u_raisingHeight;\n};\n\nin vec4 v_Color;\n#pragma include "scene_uniforms"\n#pragma include "picking"\nout vec4 outputColor;\nvoid main() {\n\n     // top face\n    if(u_topsurface < 1.0) {\n      discard;\n    }\n\n    outputColor = v_Color;\n  \n  outputColor = filterColor(outputColor);\n}\n',vert:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;\n\nlayout(std140) uniform commonUniforms {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_linearColor;\n  float u_topsurface;\n  float u_sidesurface;\n  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A\n  float u_raisingHeight;\n};\n\nout vec4 v_Color;\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  float isSide = a_Position.z;\n  float topU = a_uvs[0];\n  float topV = 1.0 - a_uvs[1];\n  float sidey = a_uvs[2];\n\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);\n\n  vec4 project_pos = project_position(pos, a_Position64Low);\n  float lightWeight = calc_lighting(project_pos);\n\n  if (u_heightfixed > 0.0) {\n    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6\n    project_pos.z = a_Position.z * a_Size;\n    project_pos.z += u_raisingHeight;\n\n    if (\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n    ) {\n      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);\n      project_pos.z *= mapboxZoomScale;\n      project_pos.z += u_raisingHeight * mapboxZoomScale;\n    }\n  }\n\n gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9\n  if (isSide < 0.999) {\n    // side face\n    // if(u_sidesurface < 1.0) {\n    //   discard;\n    // }\n\n    if (u_linearColor == 1.0) {\n      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);\n      linearColor.rgb *= lightWeight;\n      v_Color = linearColor;\n    } else {\n      v_Color = a_Color;\n    }\n\n  } else {\n    v_Color = a_Color;\n  }\n\n  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);\n\n  setPickingColor(a_PickingColor);\n}\n',type:"polygonExtrude"};}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy(),this.textures=[];}registerBuiltinAttributes(){let e=this.layer.getSource().extent,t=e[2]-e[0],n=e[3]-e[1];this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uvs",type:s.AttributeType.Attribute,descriptor:{name:"a_uvs",shaderLocation:this.attributeLocation.UV,buffer:{usage:s.gl.STATIC_DRAW,data:[],type:s.gl.FLOAT},size:3,update:(r,i,a)=>{let o=a[0],s=a[1];return[(o-e[0])/t,(s-e[1])/n,a[4]];}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:s.AttributeType.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:s.gl.STATIC_DRAW,data:[],type:s.gl.FLOAT},size:3,update:(e,t,n,r,i)=>i}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:s.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:s.gl.DYNAMIC_DRAW,data:[],type:s.gl.FLOAT},size:1,update:e=>{let{size:t=10}=e;return Array.isArray(t)?[t[0]]:[t];}}});}loadTexture(){var e=this;return(0,i.default)(function*(){let{mapTexture:t}=e.layer.getLayerConfig(),{createTexture2D:n}=e.rendererService;if(e.texture=n({height:1,width:1}),t){let r=yield(0,d.loadImage)(t);e.texture=n({data:r,width:r.width,height:r.height,wrapS:s.gl.CLAMP_TO_EDGE,wrapT:s.gl.CLAMP_TO_EDGE,min:s.gl.LINEAR,mag:s.gl.LINEAR});}})();}}},90197723:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{drawFrag:function(){return i;},drawVert:function(){return r;},fullScreenFrag:function(){return l;},fullScreenVert:function(){return s;},updateFrag:function(){return o;},updateVert:function(){return a;}});let r=`
 precision mediump float;

 attribute float a_index;

 uniform sampler2D u_particles;
 uniform float u_particles_res;

 varying vec2 v_particle_pos;

 void main() {
     vec4 color = texture2D(u_particles, vec2(
         fract(a_index / u_particles_res),
         floor(a_index / u_particles_res) / u_particles_res)
     );

     // decode current particle position from the pixel's RGBA value
     v_particle_pos = vec2( color.r / 255.0 + color.b, color.g / 255.0 + color.a);

     gl_PointSize = 1.0;
     gl_Position = vec4(2.0 * v_particle_pos.x - 1.0, 1.0 - 2.0 * v_particle_pos.y, 0, 1);
 }`,i=`
 precision mediump float;

 uniform sampler2D u_wind;
 uniform vec2 u_wind_min;
 uniform vec2 u_wind_max;
 uniform sampler2D u_color_ramp;

 varying vec2 v_particle_pos;

 void main() {
     vec2 velocity = mix(u_wind_min, u_wind_max, texture2D(u_wind, v_particle_pos).rg);
     float speed_t = length(velocity) / length(u_wind_max);

     // color ramp is encoded in a 16x16 texture
     vec2 ramp_pos = vec2( fract(16.0 * speed_t), floor(16.0 * speed_t) / 16.0);

     gl_FragColor = texture2D(u_color_ramp, ramp_pos);
 }`,a=`
 precision mediump float;

 attribute vec2 a_pos;

 varying vec2 v_tex_pos;

 void main() {
     v_tex_pos = a_pos;
     gl_Position = vec4(1.0 - 2.0 * a_pos, 0, 1);
     // framebuffer \u{59CB}\u{7EC8}\u{7528}\u{94FA}\u{6EE1}\u{5C4F}\u{5E55}\u{7684} texture
 }`,o=`
 precision highp float;

 uniform sampler2D u_particles;
 uniform sampler2D u_wind;
 uniform vec2 u_wind_res;
 uniform vec2 u_wind_min;
 uniform vec2 u_wind_max;
 uniform float u_rand_seed;
 uniform float u_speed_factor;
 uniform float u_drop_rate;
 uniform float u_drop_rate_bump;

 varying vec2 v_tex_pos;

 // pseudo-random generator
 const vec3 rand_constants = vec3(12.9898, 78.233, 4375.85453);
 float rand(const vec2 co) {
 float t = dot(rand_constants.xy, co);
     return fract(sin(t) * (rand_constants.z + t));
 }

 // wind speed lookup; use manual bilinear filtering based on 4 adjacent pixels for smooth interpolation
 vec2 lookup_wind(const vec2 uv) {
     // return texture2D(u_wind, uv).rg; // lower-res hardware filtering
     vec2 px = 1.0 / u_wind_res;
     vec2 vc = (floor(uv * u_wind_res)) * px;
     vec2 f = fract(uv * u_wind_res);
     vec2 tl = texture2D(u_wind, vc).rg;
     vec2 tr = texture2D(u_wind, vc + vec2(px.x, 0)).rg;
     vec2 bl = texture2D(u_wind, vc + vec2(0, px.y)).rg;
     vec2 br = texture2D(u_wind, vc + px).rg;
     return mix(mix(tl, tr, f.x), mix(bl, br, f.x), f.y);
 }

 void main() {
     vec4 color = texture2D(u_particles, v_tex_pos);
     vec2 pos = vec2(
         color.r / 255.0 + color.b,
         color.g / 255.0 + color.a); // decode particle position from pixel RGBA
     vec2 velocity = mix(u_wind_min, u_wind_max, lookup_wind(pos));
     float speed_t = length(velocity) / length(u_wind_max);

     // take EPSG:4236 distortion into account for calculating where the particle moved
     float distortion = cos(radians(pos.y * 180.0 - 90.0));
     vec2 offset = vec2(velocity.x / distortion, -velocity.y) * 0.0001 * u_speed_factor;

     // update particle position, wrapping around the date line
     pos = fract(1.0 + pos + offset);

     // a random seed to use for the particle drop
     vec2 seed = (pos + v_tex_pos) * u_rand_seed;

     // drop rate is a chance a particle will restart at random position, to avoid degeneration
     float drop_rate = u_drop_rate + speed_t * u_drop_rate_bump;
     float drop = step(1.0 - drop_rate, rand(seed));

     vec2 random_pos = vec2(
         rand(seed + 1.3),
         rand(seed + 2.1));
         pos = mix(pos, random_pos, drop);

     // encode the new particle position back into RGBA
     gl_FragColor = vec4(
         fract(pos * 255.0),
         floor(pos * 255.0) / 255.0);
 }`,s=`
     precision mediump float;

     attribute vec2 a_pos;

     varying vec2 v_tex_pos;

     void main() {
         v_tex_pos = a_pos;
         gl_Position = vec4(1.0 - 2.0 * a_pos, 0.0, 1.0);
         gl_PointSize = 100.0;
 }`,l=`
 precision mediump float;

 uniform sampler2D u_screen;
 uniform float u_opacity;
 varying vec2 v_tex_pos;

 void main() {
     vec4 color = texture2D(u_screen, 1.0 - v_tex_pos);

     // a hack to guarantee opacity fade out even with a value close to 1.0
     gl_FragColor = vec4(floor(255.0 * color * u_opacity) / 255.0);
 }`;},"909eb2d3":function(e,t,n){"use strict";var r,i,a,o,s;n.d(t,"__esModule",{value:!0}),n.e(t,{CanvasUpdateType:function(){return f;},LinearDir:function(){return u;},SizeUnitType:function(){return d;},TextureBlend:function(){return c;},lineStyleType:function(){return l;}});let l=((r={})[r.solid=0]="solid",r[r.dash=1]="dash",r),u=((i={}).VERTICAL="vertical",i.HORIZONTAL="horizontal",i),c=((a={}).NORMAL="normal",a.REPLACE="replace",a),d=((o={})[o.pixel=0]="pixel",o[o.meter=1]="meter",o),f=((s={}).ALWAYS="always",s.DRAGEND="dragend",s);},"90b8a4ed":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"findAllWithinRadius",{enumerable:!0,get:function(){return i;}});let r=(e,t,n,r,i,a)=>Math.sqrt((e-r)**2+(t-i)**2+(n-a)**2);function i(e,t,n,i){let a=[],o=e-i,s=t-i,l=n-i,u=e+i,c=t+i,d=n+i;return this.visit((f,h,p,v,g,m,y)=>{if(!f.length)do{let o=f.data;r(e,t,n,this._x(o),this._y(o),this._z(o))<=i&&a.push(o);}while(f=f.next)return h>u||p>c||v>d||g<o||m<s||y<l;}),a;}},"90d6521d":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0});var r=n("a24d4a8c");!function(){function e(e){this.arr=e;}e.prototype.getArr=function(){return this.arr||[];},e.prototype.add=function(t){var n,r=t.arr;if(!(null===(n=this.arr)||void 0===n?void 0:n.length))return new e(r);if(!(null==r?void 0:r.length))return new e(this.arr);if(this.arr.length===r.length){var i=[];for(var a in this.arr)i[a]=this.arr[a]+r[a];return new e(i);}},e.prototype.subtract=function(t){var n,r=t.arr;if(!(null===(n=this.arr)||void 0===n?void 0:n.length))return new e(r);if(!(null==r?void 0:r.length))return new e(this.arr);if(this.arr.length===r.length){var i=[];for(var a in this.arr)i[a]=this.arr[a]-r[a];return new e(i);}},e.prototype.avg=function(t){var n=[];if(0!==t)for(var r in this.arr)n[r]=this.arr[r]/t;return new e(n);},e.prototype.negate=function(){var t=[];for(var n in this.arr)t[n]=-this.arr[n];return new e(t);},e.prototype.squareEuclideanDistance=function(e){var t,n=e.arr;if(!(null===(t=this.arr)||void 0===t?void 0:t.length)||!(null==n?void 0:n.length))return 0;if(this.arr.length===n.length){var r=0;for(var i in this.arr)r+=Math.pow(this.arr[i]-e.arr[i],2);return r;}},e.prototype.euclideanDistance=function(e){var t,n=e.arr;if(!(null===(t=this.arr)||void 0===t?void 0:t.length)||!(null==n?void 0:n.length))return 0;if(this.arr.length===n.length){var r=0;for(var i in this.arr)r+=Math.pow(this.arr[i]-e.arr[i],2);return Math.sqrt(r);}console.error("The two vectors are unequal in length.");},e.prototype.normalize=function(){var t=[],n=(0,r.clone)(this.arr);n.sort(function(e,t){return e-t;});var i=n[n.length-1],a=n[0];for(var o in this.arr)t[o]=(this.arr[o]-a)/(i-a);return new e(t);},e.prototype.norm2=function(){if(!(null===(e=this.arr)||void 0===e?void 0:e.length))return 0;var e,t=0;for(var n in this.arr)t+=Math.pow(this.arr[n],2);return Math.sqrt(t);},e.prototype.dot=function(e){var t,n=e.arr;if(!(null===(t=this.arr)||void 0===t?void 0:t.length)||!(null==n?void 0:n.length))return 0;if(this.arr.length===n.length){var r=0;for(var i in this.arr)r+=this.arr[i]*e.arr[i];return r;}console.error("The two vectors are unequal in length.");},e.prototype.equal=function(e){var t,n=e.arr;if((null===(t=this.arr)||void 0===t?void 0:t.length)!==(null==n?void 0:n.length))return!1;for(var r in this.arr)if(this.arr[r]!==n[r])return!1;return!0;};}();},"90fbbd39":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{Fullscreen:function(){return d;},default:function(){return d;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("f89fb776")),o=r._(n("d812e418")),s=n("fb1ec05a"),l=n("631fd3ae"),u=r._(n("f200d4d8")),c=r._(n("3198c185"));class d extends c.default{constructor(e){var t;super(e),t=this,(0,o.default)(this,"isFullscreen",!1),(0,o.default)(this,"mapContainer",void 0),(0,o.default)(this,"toggleFullscreen",(0,a.default)(function*(){u.default.isEnabled&&(yield u.default.toggle(t.mapContainer));})),(0,o.default)(this,"onClick",()=>{this.toggleFullscreen();}),(0,o.default)(this,"onFullscreenChange",()=>{this.isFullscreen=!!document.fullscreenElement;let{btnText:e,btnIcon:t,title:n,exitBtnText:r,exitBtnIcon:i,exitTitle:a}=this.controlOption;this.isFullscreen?(this.setBtnTitle(a),this.setBtnText(r),this.setBtnIcon(i)):(this.setBtnTitle(n),this.setBtnText(e),this.setBtnIcon(t)),this.emit("fullscreenChange",this.isFullscreen);}),u.default.isEnabled||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u5BF9\u5730\u56FE\u5168\u5C4F\u5316");}setOptions(e){let{exitBtnText:t,exitBtnIcon:n,exitTitle:r}=e;this.isFullscreen&&(this.checkUpdateOption(e,["exitBtnIcon"])&&this.setBtnIcon(n),this.checkUpdateOption(e,["exitBtnText"])&&this.setBtnText(t),this.checkUpdateOption(e,["exitTitle"])&&this.setBtnTitle(r)),super.setOptions(e);}onAdd(){let e=super.onAdd();return e.addEventListener("click",this.onClick),this.mapContainer=s.DOM.getContainer(this.scene.getSceneConfig().id),this.mapContainer.addEventListener("fullscreenchange",this.onFullscreenChange),e;}onRemove(){super.onRemove(),this.mapContainer.removeEventListener("fullscreenchange",this.onFullscreenChange);}getDefault(e){return(0,i.default)((0,i.default)({},super.getDefault(e)),{},{title:"\u5168\u5C4F",btnIcon:(0,l.createL7Icon)("l7-icon-fullscreen"),exitTitle:"\u9000\u51FA\u5168\u5C4F",exitBtnIcon:(0,l.createL7Icon)("l7-icon-exit-fullscreen")});}}},"9133840c":function(e,t,n){e.exports=function(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e;};},"9148c331":function(e,t,n){var r="\ud800-\udfff",i="\\u2700-\\u27bf",a="a-z\\xdf-\\xf6\\xf8-\\xff",o="A-Z\\xc0-\\xd6\\xd8-\\xde",s="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",l="['\u2019]",u="["+s+"]",c="["+a+"]",d="[^"+r+s+"\\d+"+i+a+o+"]",f="(?:\ud83c[\udde6-\uddff]){2}",h="[\ud800-\udbff][\udc00-\udfff]",p="["+o+"]",v="(?:"+c+"|"+d+")",g="(?:"+p+"|"+d+")",m="(?:"+l+"(?:d|ll|m|re|s|t|ve))?",y="(?:"+l+"(?:D|LL|M|RE|S|T|VE))?",b="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\ud83c[\udffb-\udfff])?",_="[\\ufe0e\\ufe0f]?",x="(?:\\u200d(?:"+["[^"+r+"]",f,h].join("|")+")"+_+b+")*",w="(?:"+["["+i+"]",f,h].join("|")+")"+(_+b+x),E=RegExp([p+"?"+c+"+"+m+"(?="+[u,p,"$"].join("|")+")",g+"+"+y+"(?="+[u,p+v,"$"].join("|")+")",p+"?"+v+"+"+m,p+"+"+y,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",w].join("|"),"g");e.exports=function(e){return e.match(E)||[];};},"91904a29":function(e,t,n){var r=Array.prototype;r.splice,r.indexOf;},92215959:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"DragRotateHandler",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("d812e418"));class i{constructor(e,t,n){(0,r.default)(this,"_mouseRotate",void 0),(0,r.default)(this,"_mousePitch",void 0),(0,r.default)(this,"_pitchWithRotate",void 0),this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=n;}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable();}disable(){this._mouseRotate.disable(),this._mousePitch.disable();}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled());}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive();}}},"924d5fcb":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0});var r=n("d2dabb01"),i=n("9716b304");let a=" ".repeat(2),o=" ".repeat(4);function s(e,t={}){let{maxRows:n=15,maxColumns:r=10,maxNumSize:i=8,padMinus:u="auto"}=t;return`${e.constructor.name} {
${a}[
${o}${function(e,t,n,r,i){let{rows:a,columns:s}=e,u=Math.min(a,t),c=Math.min(s,n),d=[];if("auto"===i){i=!1;t:for(let t=0;t<u;t++)for(let n=0;n<c;n++)if(0>e.get(t,n)){i=!0;break t;}}for(let t=0;t<u;t++){let n=[];for(let a=0;a<c;a++){var f,h;n.push((f=e.get(t,a),h=i,(f>=0&&h?` ${l(f,r-1)}`:l(f,r)).padEnd(r)));}d.push(`${n.join(" ")}`);}return c!==s&&(d[d.length-1]+=` ... ${s-n} more columns`),u!==a&&d.push(`... ${a-t} more rows`),d.join(`
${o}`);}(e,n,r,i,u)}
${a}]
${a}rows: ${e.rows}
${a}columns: ${e.columns}
}`;}function l(e,t){let n=e.toString();if(n.length<=t)return n;let r=e.toFixed(t);if(r.length>t&&(r=e.toFixed(Math.max(0,t-(r.length-t)))),r.length<=t&&!r.startsWith("0.000")&&!r.startsWith("-0.000"))return r;let i=e.toExponential(t);return i.length>t&&(i=e.toExponential(Math.max(0,t-(i.length-t)))),i.slice(0);}function u(e,t,n){let r=n?e.rows:e.rows-1;if(t<0||t>r)throw RangeError("Row index out of range");}function c(e,t,n){let r=n?e.columns:e.columns-1;if(t<0||t>r)throw RangeError("Column index out of range");}function d(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw RangeError("vector size must be the same as the number of columns");return t;}function f(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw RangeError("vector size must be the same as the number of rows");return t;}function h(e,t){if(!r.isAnyArray(t))throw TypeError("row indices must be an array");for(let n=0;n<t.length;n++)if(t[n]<0||t[n]>=e.rows)throw RangeError("row indices are out of range");}function p(e,t){if(!r.isAnyArray(t))throw TypeError("column indices must be an array");for(let n=0;n<t.length;n++)if(t[n]<0||t[n]>=e.columns)throw RangeError("column indices are out of range");}function v(e,t,n,r,i){if(5!=arguments.length)throw RangeError("expected 4 arguments");if(m("startRow",t),m("endRow",n),m("startColumn",r),m("endColumn",i),t>n||r>i||t<0||t>=e.rows||n<0||n>=e.rows||r<0||r>=e.columns||i<0||i>=e.columns)throw RangeError("Submatrix indices are out of range");}function g(e,t=0){let n=[];for(let r=0;r<e;r++)n.push(t);return n;}function m(e,t){if("number"!=typeof t)throw TypeError(`${e} must be a number`);}function y(e){if(e.isEmpty())throw Error("Empty matrix has no elements to index");}class b{static from1DArray(e,t,n){if(e*t!==n.length)throw RangeError("data length does not match given dimensions");let r=new x(e,t);for(let i=0;i<e;i++)for(let e=0;e<t;e++)r.set(i,e,n[i*t+e]);return r;}static rowVector(e){let t=new x(1,e.length);for(let n=0;n<e.length;n++)t.set(0,n,e[n]);return t;}static columnVector(e){let t=new x(e.length,1);for(let n=0;n<e.length;n++)t.set(n,0,e[n]);return t;}static zeros(e,t){return new x(e,t);}static ones(e,t){return new x(e,t).fill(1);}static rand(e,t,n={}){if("object"!=typeof n)throw TypeError("options must be an object");let{random:r=Math.random}=n,i=new x(e,t);for(let n=0;n<e;n++)for(let e=0;e<t;e++)i.set(n,e,r());return i;}static randInt(e,t,n={}){if("object"!=typeof n)throw TypeError("options must be an object");let{min:r=0,max:i=1e3,random:a=Math.random}=n;if(!Number.isInteger(r))throw TypeError("min must be an integer");if(!Number.isInteger(i))throw TypeError("max must be an integer");if(r>=i)throw RangeError("min must be smaller than max");let o=i-r,s=new x(e,t);for(let n=0;n<e;n++)for(let e=0;e<t;e++){let t=r+Math.round(a()*o);s.set(n,e,t);}return s;}static eye(e,t,n){void 0===t&&(t=e),void 0===n&&(n=1);let r=Math.min(e,t),i=this.zeros(e,t);for(let e=0;e<r;e++)i.set(e,e,n);return i;}static diag(e,t,n){let r=e.length;void 0===t&&(t=r),void 0===n&&(n=t);let i=Math.min(r,t,n),a=this.zeros(t,n);for(let t=0;t<i;t++)a.set(t,t,e[t]);return a;}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);let n=e.rows,r=e.columns,i=new x(n,r);for(let a=0;a<n;a++)for(let n=0;n<r;n++)i.set(a,n,Math.min(e.get(a,n),t.get(a,n)));return i;}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);let n=e.rows,r=e.columns,i=new this(n,r);for(let a=0;a<n;a++)for(let n=0;n<r;n++)i.set(a,n,Math.max(e.get(a,n),t.get(a,n)));return i;}static checkMatrix(e){return b.isMatrix(e)?e:new x(e);}static isMatrix(e){return null!=e&&"Matrix"===e.klass;}get size(){return this.rows*this.columns;}apply(e){if("function"!=typeof e)throw TypeError("callback must be a function");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.call(this,t,n);return this;}to1DArray(){let e=[];for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.push(this.get(t,n));return e;}to2DArray(){let e=[];for(let t=0;t<this.rows;t++){e.push([]);for(let n=0;n<this.columns;n++)e[t].push(this.get(t,n));}return e;}toJSON(){return this.to2DArray();}isRowVector(){return 1===this.rows;}isColumnVector(){return 1===this.columns;}isVector(){return 1===this.rows||1===this.columns;}isSquare(){return this.rows===this.columns;}isEmpty(){return 0===this.rows||0===this.columns;}isSymmetric(){if(this.isSquare()){for(let e=0;e<this.rows;e++)for(let t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0;}return!1;}isDistance(){if(!this.isSymmetric())return!1;for(let e=0;e<this.rows;e++)if(0!==this.get(e,e))return!1;return!0;}isEchelonForm(){let e=0,t=0,n=-1,r=!0,i=!1;for(;e<this.rows&&r;){for(t=0,i=!1;t<this.columns&&!1===i;)0===this.get(e,t)?t++:1===this.get(e,t)&&t>n?(i=!0,n=t):(r=!1,i=!0);e++;}return r;}isReducedEchelonForm(){let e=0,t=0,n=-1,r=!0,i=!1;for(;e<this.rows&&r;){for(t=0,i=!1;t<this.columns&&!1===i;)0===this.get(e,t)?t++:1===this.get(e,t)&&t>n?(i=!0,n=t):(r=!1,i=!0);for(let n=t+1;n<this.rows;n++)0!==this.get(e,n)&&(r=!1);e++;}return r;}echelonForm(){let e=this.clone(),t=0,n=0;for(;t<e.rows&&n<e.columns;){let r=t;for(let i=t;i<e.rows;i++)e.get(i,n)>e.get(r,n)&&(r=i);if(0===e.get(r,n))n++;else{e.swapRows(t,r);let i=e.get(t,n);for(let r=n;r<e.columns;r++)e.set(t,r,e.get(t,r)/i);for(let r=t+1;r<e.rows;r++){let i=e.get(r,n)/e.get(t,n);e.set(r,n,0);for(let a=n+1;a<e.columns;a++)e.set(r,a,e.get(r,a)-e.get(t,a)*i);}t++,n++;}}return e;}reducedEchelonForm(){let e=this.echelonForm(),t=e.columns,n=e.rows,r=n-1;for(;r>=0;)if(0===e.maxRow(r))r--;else{let i=0,a=!1;for(;i<n&&!1===a;)1===e.get(r,i)?a=!0:i++;for(let n=0;n<r;n++){let a=e.get(n,i);for(let o=i;o<t;o++){let t=e.get(n,o)-a*e.get(r,o);e.set(n,o,t);}}r--;}return e;}set(){throw Error("set method is unimplemented");}get(){throw Error("get method is unimplemented");}repeat(e={}){if("object"!=typeof e)throw TypeError("options must be an object");let{rows:t=1,columns:n=1}=e;if(!Number.isInteger(t)||t<=0)throw TypeError("rows must be a positive integer");if(!Number.isInteger(n)||n<=0)throw TypeError("columns must be a positive integer");let r=new x(this.rows*t,this.columns*n);for(let e=0;e<t;e++)for(let t=0;t<n;t++)r.setSubMatrix(this,this.rows*e,this.columns*t);return r;}fill(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,e);return this;}neg(){return this.mulS(-1);}getRow(e){u(this,e);let t=[];for(let n=0;n<this.columns;n++)t.push(this.get(e,n));return t;}getRowVector(e){return x.rowVector(this.getRow(e));}setRow(e,t){u(this,e),t=d(this,t);for(let n=0;n<this.columns;n++)this.set(e,n,t[n]);return this;}swapRows(e,t){u(this,e),u(this,t);for(let n=0;n<this.columns;n++){let r=this.get(e,n);this.set(e,n,this.get(t,n)),this.set(t,n,r);}return this;}getColumn(e){c(this,e);let t=[];for(let n=0;n<this.rows;n++)t.push(this.get(n,e));return t;}getColumnVector(e){return x.columnVector(this.getColumn(e));}setColumn(e,t){c(this,e),t=f(this,t);for(let n=0;n<this.rows;n++)this.set(n,e,t[n]);return this;}swapColumns(e,t){c(this,e),c(this,t);for(let n=0;n<this.rows;n++){let r=this.get(n,e);this.set(n,e,this.get(n,t)),this.set(n,t,r);}return this;}addRowVector(e){e=d(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e[n]);return this;}subRowVector(e){e=d(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e[n]);return this;}mulRowVector(e){e=d(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e[n]);return this;}divRowVector(e){e=d(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e[n]);return this;}addColumnVector(e){e=f(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e[t]);return this;}subColumnVector(e){e=f(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e[t]);return this;}mulColumnVector(e){e=f(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e[t]);return this;}divColumnVector(e){e=f(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e[t]);return this;}mulRow(e,t){u(this,e);for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this;}mulColumn(e,t){c(this,e);for(let n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this;}max(e){if(this.isEmpty())return NaN;switch(e){case"row":{let e=Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)>e[t]&&(e[t]=this.get(t,n));return e;}case"column":{let e=Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)>e[n]&&(e[n]=this.get(t,n));return e;}case void 0:{let e=this.get(0,0);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e;}default:throw Error(`invalid option: ${e}`);}}maxIndex(){y(this);let e=this.get(0,0),t=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)>e&&(e=this.get(n,r),t[0]=n,t[1]=r);return t;}min(e){if(this.isEmpty())return NaN;switch(e){case"row":{let e=Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)<e[t]&&(e[t]=this.get(t,n));return e;}case"column":{let e=Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)<e[n]&&(e[n]=this.get(t,n));return e;}case void 0:{let e=this.get(0,0);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e;}default:throw Error(`invalid option: ${e}`);}}minIndex(){y(this);let e=this.get(0,0),t=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)<e&&(e=this.get(n,r),t[0]=n,t[1]=r);return t;}maxRow(e){if(u(this,e),this.isEmpty())return NaN;let t=this.get(e,0);for(let n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t;}maxRowIndex(e){u(this,e),y(this);let t=this.get(e,0),n=[e,0];for(let r=1;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r),n[1]=r);return n;}minRow(e){if(u(this,e),this.isEmpty())return NaN;let t=this.get(e,0);for(let n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t;}minRowIndex(e){u(this,e),y(this);let t=this.get(e,0),n=[e,0];for(let r=1;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r),n[1]=r);return n;}maxColumn(e){if(c(this,e),this.isEmpty())return NaN;let t=this.get(0,e);for(let n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t;}maxColumnIndex(e){c(this,e),y(this);let t=this.get(0,e),n=[0,e];for(let r=1;r<this.rows;r++)this.get(r,e)>t&&(t=this.get(r,e),n[0]=r);return n;}minColumn(e){if(c(this,e),this.isEmpty())return NaN;let t=this.get(0,e);for(let n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t;}minColumnIndex(e){c(this,e),y(this);let t=this.get(0,e),n=[0,e];for(let r=1;r<this.rows;r++)this.get(r,e)<t&&(t=this.get(r,e),n[0]=r);return n;}diag(){let e=Math.min(this.rows,this.columns),t=[];for(let n=0;n<e;n++)t.push(this.get(n,n));return t;}norm(e="frobenius"){switch(e){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw RangeError(`unknown norm type: ${e}`);}}cumulativeSum(){let e=0;for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e+=this.get(t,n),this.set(t,n,e);return this;}dot(e){b.isMatrix(e)&&(e=e.to1DArray());let t=this.to1DArray();if(t.length!==e.length)throw RangeError("vectors do not have the same size");let n=0;for(let r=0;r<t.length;r++)n+=t[r]*e[r];return n;}mmul(e){e=x.checkMatrix(e);let t=this.rows,n=this.columns,r=e.columns,i=new x(t,r),a=new Float64Array(n);for(let o=0;o<r;o++){for(let t=0;t<n;t++)a[t]=e.get(t,o);for(let e=0;e<t;e++){let t=0;for(let r=0;r<n;r++)t+=this.get(e,r)*a[r];i.set(e,o,t);}}return i;}mpow(e){if(!this.isSquare())throw RangeError("Matrix must be square");if(!Number.isInteger(e)||e<0)throw RangeError("Exponent must be a non-negative integer");let t=x.eye(this.rows),n=this;for(let r=e;r>=1;r/=2)(1&r)!=0&&(t=t.mmul(n)),n=n.mmul(n);return t;}strassen2x2(e){e=x.checkMatrix(e);let t=new x(2,2),n=this.get(0,0),r=e.get(0,0),i=this.get(0,1),a=e.get(0,1),o=this.get(1,0),s=e.get(1,0),l=this.get(1,1),u=e.get(1,1),c=(n+l)*(r+u),d=(o+l)*r,f=n*(a-u),h=l*(s-r),p=(n+i)*u;return t.set(0,0,c+h-p+(i-l)*(s+u)),t.set(0,1,f+p),t.set(1,0,d+h),t.set(1,1,c-d+f+(o-n)*(r+a)),t;}strassen3x3(e){e=x.checkMatrix(e);let t=new x(3,3),n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),a=this.get(1,0),o=this.get(1,1),s=this.get(1,2),l=this.get(2,0),u=this.get(2,1),c=this.get(2,2),d=e.get(0,0),f=e.get(0,1),h=e.get(0,2),p=e.get(1,0),v=e.get(1,1),g=e.get(1,2),m=e.get(2,0),y=e.get(2,1),b=e.get(2,2),_=(n-a)*(-f+v),w=(-n+a+o)*(d-f+v),E=(a+o)*(-d+f),M=n*d,S=(-n+l+u)*(d-h+g),k=(-n+l)*(h-g),C=(l+u)*(-d+h),A=(-i+u+c)*(v+m-y),L=(i-c)*(v-y),P=i*m,N=(u+c)*(-m+y),O=(-i+o+s)*(g+m-b),I=(i-s)*(g-b),R=(o+s)*(-m+b);return t.set(0,0,M+P+r*p),t.set(0,1,(n+r+i-a-o-u-c)*v+w+E+M+A+P+N),t.set(0,2,M+S+C+(n+r+i-o-s-l-u)*g+P+O+R),t.set(1,0,_+o*(-d+f+p-v-g-m+b)+w+M+P+O+I),t.set(1,1,_+w+E+M+s*y),t.set(1,2,P+O+I+R+a*h),t.set(2,0,M+S+k+u*(-d+h+p-v-g-m+y)+A+L+P),t.set(2,1,A+L+P+N+l*f),t.set(2,2,M+S+k+C+c*b),t;}mmulStrassen(e){e=x.checkMatrix(e);let t=this.clone(),n=t.rows,r=t.columns,i=e.rows,a=e.columns;function o(e,t,n){let r=e.rows,i=e.columns;return r===t&&i===n?e:b.zeros(t,n).setSubMatrix(e,0,0);}r!==i&&console.warn(`Multiplying ${n} x ${r} and ${i} x ${a} matrix: dimensions do not match.`);let s=Math.max(n,i),l=Math.max(r,a);return function e(t,n,r,i){if(r<=512||i<=512)return t.mmul(n);r%2==1&&i%2==1?(t=o(t,r+1,i+1),n=o(n,r+1,i+1)):r%2==1?(t=o(t,r+1,i),n=o(n,r+1,i)):i%2==1&&(t=o(t,r,i+1),n=o(n,r,i+1));let a=parseInt(t.rows/2,10),s=parseInt(t.columns/2,10),l=t.subMatrix(0,a-1,0,s-1),u=n.subMatrix(0,a-1,0,s-1),c=t.subMatrix(0,a-1,s,t.columns-1),d=n.subMatrix(0,a-1,s,n.columns-1),f=t.subMatrix(a,t.rows-1,0,s-1),h=n.subMatrix(a,n.rows-1,0,s-1),p=t.subMatrix(a,t.rows-1,s,t.columns-1),v=n.subMatrix(a,n.rows-1,s,n.columns-1),g=e(b.add(l,p),b.add(u,v),a,s),m=e(b.add(f,p),u,a,s),y=e(l,b.sub(d,v),a,s),_=e(p,b.sub(h,u),a,s),x=e(b.add(l,c),v,a,s),w=e(b.sub(f,l),b.add(u,d),a,s),E=e(b.sub(c,p),b.add(h,v),a,s),M=b.add(g,_);M.sub(x),M.add(E);let S=b.add(y,x),k=b.add(m,_),C=b.sub(g,m);C.add(y),C.add(w);let A=b.zeros(2*M.rows,2*M.columns);return(A=(A=(A=(A=A.setSubMatrix(M,0,0)).setSubMatrix(S,M.rows,0)).setSubMatrix(k,0,M.columns)).setSubMatrix(C,M.rows,M.columns)).subMatrix(0,r-1,0,i-1);}(t=o(t,s,l),e=o(e,s,l),s,l);}scaleRows(e={}){if("object"!=typeof e)throw TypeError("options must be an object");let{min:t=0,max:n=1}=e;if(!Number.isFinite(t))throw TypeError("min must be a number");if(!Number.isFinite(n))throw TypeError("max must be a number");if(t>=n)throw RangeError("min must be smaller than max");let r=new x(this.rows,this.columns);for(let e=0;e<this.rows;e++){let a=this.getRow(e);a.length>0&&i(a,{min:t,max:n,output:a}),r.setRow(e,a);}return r;}scaleColumns(e={}){if("object"!=typeof e)throw TypeError("options must be an object");let{min:t=0,max:n=1}=e;if(!Number.isFinite(t))throw TypeError("min must be a number");if(!Number.isFinite(n))throw TypeError("max must be a number");if(t>=n)throw RangeError("min must be smaller than max");let r=new x(this.rows,this.columns);for(let e=0;e<this.columns;e++){let a=this.getColumn(e);a.length&&i(a,{min:t,max:n,output:a}),r.setColumn(e,a);}return r;}flipRows(){let e=Math.ceil(this.columns/2);for(let t=0;t<this.rows;t++)for(let n=0;n<e;n++){let e=this.get(t,n),r=this.get(t,this.columns-1-n);this.set(t,n,r),this.set(t,this.columns-1-n,e);}return this;}flipColumns(){let e=Math.ceil(this.rows/2);for(let t=0;t<this.columns;t++)for(let n=0;n<e;n++){let e=this.get(n,t),r=this.get(this.rows-1-n,t);this.set(n,t,r),this.set(this.rows-1-n,t,e);}return this;}kroneckerProduct(e){e=x.checkMatrix(e);let t=this.rows,n=this.columns,r=e.rows,i=e.columns,a=new x(t*r,n*i);for(let o=0;o<t;o++)for(let t=0;t<n;t++)for(let n=0;n<r;n++)for(let s=0;s<i;s++)a.set(r*o+n,i*t+s,this.get(o,t)*e.get(n,s));return a;}kroneckerSum(e){if(e=x.checkMatrix(e),!this.isSquare()||!e.isSquare())throw Error("Kronecker Sum needs two Square Matrices");let t=this.rows,n=e.rows,r=this.kroneckerProduct(x.eye(n,n)),i=x.eye(t,t).kroneckerProduct(e);return r.add(i);}transpose(){let e=new x(this.columns,this.rows);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.set(n,t,this.get(t,n));return e;}sortRows(e=_){for(let t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this;}sortColumns(e=_){for(let t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this;}subMatrix(e,t,n,r){v(this,e,t,n,r);let i=new x(t-e+1,r-n+1);for(let a=e;a<=t;a++)for(let t=n;t<=r;t++)i.set(a-e,t-n,this.get(a,t));return i;}subMatrixRow(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.columns-1),t>n||t<0||t>=this.columns||n<0||n>=this.columns)throw RangeError("Argument out of range");let r=new x(e.length,n-t+1);for(let i=0;i<e.length;i++)for(let a=t;a<=n;a++){if(e[i]<0||e[i]>=this.rows)throw RangeError(`Row index out of range: ${e[i]}`);r.set(i,a-t,this.get(e[i],a));}return r;}subMatrixColumn(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.rows-1),t>n||t<0||t>=this.rows||n<0||n>=this.rows)throw RangeError("Argument out of range");let r=new x(n-t+1,e.length);for(let i=0;i<e.length;i++)for(let a=t;a<=n;a++){if(e[i]<0||e[i]>=this.columns)throw RangeError(`Column index out of range: ${e[i]}`);r.set(a-t,i,this.get(a,e[i]));}return r;}setSubMatrix(e,t,n){if((e=x.checkMatrix(e)).isEmpty())return this;let r=t+e.rows-1,i=n+e.columns-1;v(this,t,r,n,i);for(let r=0;r<e.rows;r++)for(let i=0;i<e.columns;i++)this.set(t+r,n+i,e.get(r,i));return this;}selection(e,t){h(this,e),p(this,t);let n=new x(e.length,t.length);for(let r=0;r<e.length;r++){let i=e[r];for(let e=0;e<t.length;e++){let a=t[e];n.set(r,e,this.get(i,a));}}return n;}trace(){let e=Math.min(this.rows,this.columns),t=0;for(let n=0;n<e;n++)t+=this.get(n,n);return t;}clone(){return this.constructor.copy(this,new x(this.rows,this.columns));}static copy(e,t){for(let[n,r,i]of e.entries())t.set(n,r,i);return t;}sum(e){switch(e){case"row":return function(e){let t=g(e.rows);for(let n=0;n<e.rows;++n)for(let r=0;r<e.columns;++r)t[n]+=e.get(n,r);return t;}(this);case"column":return function(e){let t=g(e.columns);for(let n=0;n<e.rows;++n)for(let r=0;r<e.columns;++r)t[r]+=e.get(n,r);return t;}(this);case void 0:return function(e){let t=0;for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)t+=e.get(n,r);return t;}(this);default:throw Error(`invalid option: ${e}`);}}product(e){switch(e){case"row":return function(e){let t=g(e.rows,1);for(let n=0;n<e.rows;++n)for(let r=0;r<e.columns;++r)t[n]*=e.get(n,r);return t;}(this);case"column":return function(e){let t=g(e.columns,1);for(let n=0;n<e.rows;++n)for(let r=0;r<e.columns;++r)t[r]*=e.get(n,r);return t;}(this);case void 0:return function(e){let t=1;for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)t*=e.get(n,r);return t;}(this);default:throw Error(`invalid option: ${e}`);}}mean(e){let t=this.sum(e);switch(e){case"row":for(let e=0;e<this.rows;e++)t[e]/=this.columns;return t;case"column":for(let e=0;e<this.columns;e++)t[e]/=this.rows;return t;case void 0:return t/this.size;default:throw Error(`invalid option: ${e}`);}}variance(e,t={}){if("object"==typeof e&&(t=e,e=void 0),"object"!=typeof t)throw TypeError("options must be an object");let{unbiased:n=!0,mean:i=this.mean(e)}=t;if("boolean"!=typeof n)throw TypeError("unbiased must be a boolean");switch(e){case"row":if(!r.isAnyArray(i))throw TypeError("mean must be an array");return function(e,t,n){let r=e.rows,i=e.columns,a=[];for(let o=0;o<r;o++){let r=0,s=0,l=0;for(let t=0;t<i;t++)r+=l=e.get(o,t)-n[o],s+=l*l;t?a.push((s-r*r/i)/(i-1)):a.push((s-r*r/i)/i);}return a;}(this,n,i);case"column":if(!r.isAnyArray(i))throw TypeError("mean must be an array");return function(e,t,n){let r=e.rows,i=e.columns,a=[];for(let o=0;o<i;o++){let i=0,s=0,l=0;for(let t=0;t<r;t++)i+=l=e.get(t,o)-n[o],s+=l*l;t?a.push((s-i*i/r)/(r-1)):a.push((s-i*i/r)/r);}return a;}(this,n,i);case void 0:if("number"!=typeof i)throw TypeError("mean must be a number");return function(e,t,n){let r=e.rows,i=e.columns,a=r*i,o=0,s=0,l=0;for(let t=0;t<r;t++)for(let r=0;r<i;r++)o+=l=e.get(t,r)-n,s+=l*l;return t?(s-o*o/a)/(a-1):(s-o*o/a)/a;}(this,n,i);default:throw Error(`invalid option: ${e}`);}}standardDeviation(e,t){"object"==typeof e&&(t=e,e=void 0);let n=this.variance(e,t);if(void 0===e)return Math.sqrt(n);for(let e=0;e<n.length;e++)n[e]=Math.sqrt(n[e]);return n;}center(e,t={}){if("object"==typeof e&&(t=e,e=void 0),"object"!=typeof t)throw TypeError("options must be an object");let{center:n=this.mean(e)}=t;switch(e){case"row":if(!r.isAnyArray(n))throw TypeError("center must be an array");return!function(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t[n]);}(this,n),this;case"column":if(!r.isAnyArray(n))throw TypeError("center must be an array");return!function(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t[r]);}(this,n),this;case void 0:if("number"!=typeof n)throw TypeError("center must be a number");return!function(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t);}(this,n),this;default:throw Error(`invalid option: ${e}`);}}scale(e,t={}){if("object"==typeof e&&(t=e,e=void 0),"object"!=typeof t)throw TypeError("options must be an object");let n=t.scale;switch(e){case"row":if(void 0===n)n=function(e){let t=[];for(let n=0;n<e.rows;n++){let r=0;for(let t=0;t<e.columns;t++)r+=e.get(n,t)**2/(e.columns-1);t.push(Math.sqrt(r));}return t;}(this);else if(!r.isAnyArray(n))throw TypeError("scale must be an array");return!function(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t[n]);}(this,n),this;case"column":if(void 0===n)n=function(e){let t=[];for(let n=0;n<e.columns;n++){let r=0;for(let t=0;t<e.rows;t++)r+=e.get(t,n)**2/(e.rows-1);t.push(Math.sqrt(r));}return t;}(this);else if(!r.isAnyArray(n))throw TypeError("scale must be an array");return!function(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t[r]);}(this,n),this;case void 0:if(void 0===n)n=function(e){let t=e.size-1,n=0;for(let r=0;r<e.columns;r++)for(let i=0;i<e.rows;i++)n+=e.get(i,r)**2/t;return Math.sqrt(n);}(this);else if("number"!=typeof n)throw TypeError("scale must be a number");return!function(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t);}(this,n),this;default:throw Error(`invalid option: ${e}`);}}toString(e){return s(this,e);}[Symbol.iterator](){return this.entries();}*entries(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)yield[e,t,this.get(e,t)];}*values(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)yield this.get(e,t);}}function _(e,t){return e-t;}b.prototype.klass="Matrix","undefined"!=typeof Symbol&&(b.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return s(this);}),b.random=b.rand,b.randomInt=b.randInt,b.diagonal=b.diag,b.prototype.diagonal=b.prototype.diag,b.identity=b.eye,b.prototype.negate=b.prototype.neg,b.prototype.tensorProduct=b.prototype.kroneckerProduct;class x extends b{data;#e(e,t){if(this.data=[],Number.isInteger(t)&&t>=0)for(let n=0;n<e;n++)this.data.push(new Float64Array(t));else throw TypeError("nColumns must be a positive integer");this.rows=e,this.columns=t;}constructor(e,t){if(super(),x.isMatrix(e))this.#e(e.rows,e.columns),x.copy(e,this);else if(Number.isInteger(e)&&e>=0)this.#e(e,t);else if(r.isAnyArray(e)){let n=e;if("number"!=typeof(t=(e=n.length)?n[0].length:0))throw TypeError("Data must be a 2D array with at least one element");this.data=[];for(let r=0;r<e;r++){if(n[r].length!==t)throw RangeError("Inconsistent array dimensions");if(!n[r].every(e=>"number"==typeof e))throw TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(n[r]));}this.rows=e,this.columns=t;}else throw TypeError("First argument must be a positive number or an array");}set(e,t,n){return this.data[e][t]=n,this;}get(e,t){return this.data[e][t];}removeRow(e){return u(this,e),this.data.splice(e,1),this.rows-=1,this;}addRow(e,t){return void 0===t&&(t=e,e=this.rows),u(this,e,!0),t=Float64Array.from(d(this,t)),this.data.splice(e,0,t),this.rows+=1,this;}removeColumn(e){c(this,e);for(let t=0;t<this.rows;t++){let n=new Float64Array(this.columns-1);for(let r=0;r<e;r++)n[r]=this.data[t][r];for(let r=e+1;r<this.columns;r++)n[r-1]=this.data[t][r];this.data[t]=n;}return this.columns-=1,this;}addColumn(e,t){void 0===t&&(t=e,e=this.columns),c(this,e,!0),t=f(this,t);for(let n=0;n<this.rows;n++){let r=new Float64Array(this.columns+1),i=0;for(;i<e;i++)r[i]=this.data[n][i];for(r[i++]=t[n];i<this.columns+1;i++)r[i]=this.data[n][i-1];this.data[n]=r;}return this.columns+=1,this;}}b.prototype.add=function(e){return"number"==typeof e?this.addS(e):this.addM(e);},b.prototype.addS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e);return this;},b.prototype.addM=function(e){if(e=x.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e.get(t,n));return this;},b.add=function(e,t){return new x(e).add(t);},b.prototype.sub=function(e){return"number"==typeof e?this.subS(e):this.subM(e);},b.prototype.subS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e);return this;},b.prototype.subM=function(e){if(e=x.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e.get(t,n));return this;},b.sub=function(e,t){return new x(e).sub(t);},b.prototype.subtract=b.prototype.sub,b.prototype.subtractS=b.prototype.subS,b.prototype.subtractM=b.prototype.subM,b.subtract=b.sub,b.prototype.mul=function(e){return"number"==typeof e?this.mulS(e):this.mulM(e);},b.prototype.mulS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this;},b.prototype.mulM=function(e){if(e=x.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e.get(t,n));return this;},b.mul=function(e,t){return new x(e).mul(t);},b.prototype.multiply=b.prototype.mul,b.prototype.multiplyS=b.prototype.mulS,b.prototype.multiplyM=b.prototype.mulM,b.multiply=b.mul,b.prototype.div=function(e){return"number"==typeof e?this.divS(e):this.divM(e);},b.prototype.divS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e);return this;},b.prototype.divM=function(e){if(e=x.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e.get(t,n));return this;},b.div=function(e,t){return new x(e).div(t);},b.prototype.divide=b.prototype.div,b.prototype.divideS=b.prototype.divS,b.prototype.divideM=b.prototype.divM,b.divide=b.div,b.prototype.mod=function(e){return"number"==typeof e?this.modS(e):this.modM(e);},b.prototype.modS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)%e);return this;},b.prototype.modM=function(e){if(e=x.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)%e.get(t,n));return this;},b.mod=function(e,t){return new x(e).mod(t);},b.prototype.modulus=b.prototype.mod,b.prototype.modulusS=b.prototype.modS,b.prototype.modulusM=b.prototype.modM,b.modulus=b.mod,b.prototype.and=function(e){return"number"==typeof e?this.andS(e):this.andM(e);},b.prototype.andS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)&e);return this;},b.prototype.andM=function(e){if(e=x.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)&e.get(t,n));return this;},b.and=function(e,t){return new x(e).and(t);},b.prototype.or=function(e){return"number"==typeof e?this.orS(e):this.orM(e);},b.prototype.orS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)|e);return this;},b.prototype.orM=function(e){if(e=x.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)|e.get(t,n));return this;},b.or=function(e,t){return new x(e).or(t);},b.prototype.xor=function(e){return"number"==typeof e?this.xorS(e):this.xorM(e);},b.prototype.xorS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)^e);return this;},b.prototype.xorM=function(e){if(e=x.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)^e.get(t,n));return this;},b.xor=function(e,t){return new x(e).xor(t);},b.prototype.leftShift=function(e){return"number"==typeof e?this.leftShiftS(e):this.leftShiftM(e);},b.prototype.leftShiftS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)<<e);return this;},b.prototype.leftShiftM=function(e){if(e=x.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)<<e.get(t,n));return this;},b.leftShift=function(e,t){return new x(e).leftShift(t);},b.prototype.signPropagatingRightShift=function(e){return"number"==typeof e?this.signPropagatingRightShiftS(e):this.signPropagatingRightShiftM(e);},b.prototype.signPropagatingRightShiftS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>e);return this;},b.prototype.signPropagatingRightShiftM=function(e){if(e=x.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>e.get(t,n));return this;},b.signPropagatingRightShift=function(e,t){return new x(e).signPropagatingRightShift(t);},b.prototype.rightShift=function(e){return"number"==typeof e?this.rightShiftS(e):this.rightShiftM(e);},b.prototype.rightShiftS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>>e);return this;},b.prototype.rightShiftM=function(e){if(e=x.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>>e.get(t,n));return this;},b.rightShift=function(e,t){return new x(e).rightShift(t);},b.prototype.zeroFillRightShift=b.prototype.rightShift,b.prototype.zeroFillRightShiftS=b.prototype.rightShiftS,b.prototype.zeroFillRightShiftM=b.prototype.rightShiftM,b.zeroFillRightShift=b.rightShift,b.prototype.not=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,~this.get(e,t));return this;},b.not=function(e){return new x(e).not();},b.prototype.abs=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.abs(this.get(e,t)));return this;},b.abs=function(e){return new x(e).abs();},b.prototype.acos=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.acos(this.get(e,t)));return this;},b.acos=function(e){return new x(e).acos();},b.prototype.acosh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.acosh(this.get(e,t)));return this;},b.acosh=function(e){return new x(e).acosh();},b.prototype.asin=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.asin(this.get(e,t)));return this;},b.asin=function(e){return new x(e).asin();},b.prototype.asinh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.asinh(this.get(e,t)));return this;},b.asinh=function(e){return new x(e).asinh();},b.prototype.atan=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.atan(this.get(e,t)));return this;},b.atan=function(e){return new x(e).atan();},b.prototype.atanh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.atanh(this.get(e,t)));return this;},b.atanh=function(e){return new x(e).atanh();},b.prototype.cbrt=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.cbrt(this.get(e,t)));return this;},b.cbrt=function(e){return new x(e).cbrt();},b.prototype.ceil=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.ceil(this.get(e,t)));return this;},b.ceil=function(e){return new x(e).ceil();},b.prototype.clz32=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.clz32(this.get(e,t)));return this;},b.clz32=function(e){return new x(e).clz32();},b.prototype.cos=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.cos(this.get(e,t)));return this;},b.cos=function(e){return new x(e).cos();},b.prototype.cosh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.cosh(this.get(e,t)));return this;},b.cosh=function(e){return new x(e).cosh();},b.prototype.exp=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.exp(this.get(e,t)));return this;},b.exp=function(e){return new x(e).exp();},b.prototype.expm1=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.expm1(this.get(e,t)));return this;},b.expm1=function(e){return new x(e).expm1();},b.prototype.floor=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.floor(this.get(e,t)));return this;},b.floor=function(e){return new x(e).floor();},b.prototype.fround=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.fround(this.get(e,t)));return this;},b.fround=function(e){return new x(e).fround();},b.prototype.log=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log(this.get(e,t)));return this;},b.log=function(e){return new x(e).log();},b.prototype.log1p=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log1p(this.get(e,t)));return this;},b.log1p=function(e){return new x(e).log1p();},b.prototype.log10=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log10(this.get(e,t)));return this;},b.log10=function(e){return new x(e).log10();},b.prototype.log2=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log2(this.get(e,t)));return this;},b.log2=function(e){return new x(e).log2();},b.prototype.round=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.round(this.get(e,t)));return this;},b.round=function(e){return new x(e).round();},b.prototype.sign=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sign(this.get(e,t)));return this;},b.sign=function(e){return new x(e).sign();},b.prototype.sin=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sin(this.get(e,t)));return this;},b.sin=function(e){return new x(e).sin();},b.prototype.sinh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sinh(this.get(e,t)));return this;},b.sinh=function(e){return new x(e).sinh();},b.prototype.sqrt=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sqrt(this.get(e,t)));return this;},b.sqrt=function(e){return new x(e).sqrt();},b.prototype.tan=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.tan(this.get(e,t)));return this;},b.tan=function(e){return new x(e).tan();},b.prototype.tanh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.tanh(this.get(e,t)));return this;},b.tanh=function(e){return new x(e).tanh();},b.prototype.trunc=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.trunc(this.get(e,t)));return this;},b.trunc=function(e){return new x(e).trunc();},b.pow=function(e,t){return new x(e).pow(t);},b.prototype.pow=function(e){return"number"==typeof e?this.powS(e):this.powM(e);},b.prototype.powS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)**e);return this;},b.prototype.powM=function(e){if(e=x.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)**e.get(t,n));return this;};class w extends b{#t;get size(){return this.#t.size;}get rows(){return this.#t.rows;}get columns(){return this.#t.columns;}get diagonalSize(){return this.rows;}static isSymmetricMatrix(e){return x.isMatrix(e)&&"SymmetricMatrix"===e.klassType;}static zeros(e){return new this(e);}static ones(e){return new this(e).fill(1);}constructor(e){if(super(),x.isMatrix(e)){if(!e.isSymmetric())throw TypeError("not symmetric data");this.#t=x.copy(e,new x(e.rows,e.rows));}else if(Number.isInteger(e)&&e>=0)this.#t=new x(e,e);else if(this.#t=new x(e),!this.isSymmetric())throw TypeError("not symmetric data");}clone(){let e=new w(this.diagonalSize);for(let[t,n,r]of this.upperRightEntries())e.set(t,n,r);return e;}toMatrix(){return new x(this);}get(e,t){return this.#t.get(e,t);}set(e,t,n){return this.#t.set(e,t,n),this.#t.set(t,e,n),this;}removeCross(e){return this.#t.removeRow(e),this.#t.removeColumn(e),this;}addCross(e,t){void 0===t&&(t=e,e=this.diagonalSize);let n=t.slice();return n.splice(e,1),this.#t.addRow(e,n),this.#t.addColumn(e,t),this;}applyMask(e){if(e.length!==this.diagonalSize)throw RangeError("Mask size do not match with matrix size");let t=[];for(let[n,r]of e.entries())r||t.push(n);for(let e of(t.reverse(),t))this.removeCross(e);return this;}toCompact(){let{diagonalSize:e}=this,t=Array(e*(e+1)/2);for(let n=0,r=0,i=0;i<t.length;i++)t[i]=this.get(r,n),++n>=e&&(n=++r);return t;}static fromCompact(e){let t=e.length,n=(Math.sqrt(8*t+1)-1)/2;if(!Number.isInteger(n))throw TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(e)}`);let r=new w(n);for(let i=0,a=0,o=0;o<t;o++)r.set(i,a,e[o]),++i>=n&&(i=++a);return r;}*upperRightEntries(){for(let e=0,t=0;e<this.diagonalSize;){let n=this.get(e,t);yield[e,t,n],++t>=this.diagonalSize&&(t=++e);}}*upperRightValues(){for(let e=0,t=0;e<this.diagonalSize;){let n=this.get(e,t);yield n,++t>=this.diagonalSize&&(t=++e);}}}w.prototype.klassType="SymmetricMatrix";class E extends w{static isDistanceMatrix(e){return w.isSymmetricMatrix(e)&&"DistanceMatrix"===e.klassSubType;}constructor(e){if(super(e),!this.isDistance())throw TypeError("Provided arguments do no produce a distance matrix");}set(e,t,n){return e===t&&(n=0),super.set(e,t,n);}addCross(e,t){return void 0===t&&(t=e,e=this.diagonalSize),(t=t.slice())[e]=0,super.addCross(e,t);}toSymmetricMatrix(){return new w(this);}clone(){let e=new E(this.diagonalSize);for(let[t,n,r]of this.upperRightEntries())t!==n&&e.set(t,n,r);return e;}toCompact(){let{diagonalSize:e}=this,t=Array((e-1)*e/2);for(let n=1,r=0,i=0;i<t.length;i++)t[i]=this.get(r,n),++n>=e&&(n=++r+1);return t;}static fromCompact(e){let t=e.length;if(0===t)return new this(0);let n=(Math.sqrt(8*t+1)+1)/2;if(!Number.isInteger(n))throw TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(e)}`);let r=new this(n);for(let i=1,a=0,o=0;o<t;o++)r.set(i,a,e[o]),++i>=n&&(i=++a+1);return r;}}E.prototype.klassSubType="DistanceMatrix";class M extends b{constructor(e,t,n){super(),this.matrix=e,this.rows=t,this.columns=n;}}class S extends M{constructor(e,t,n){h(e,t),p(e,n),super(e,t.length,n.length),this.rowIndices=t,this.columnIndices=n;}set(e,t,n){return this.matrix.set(this.rowIndices[e],this.columnIndices[t],n),this;}get(e,t){return this.matrix.get(this.rowIndices[e],this.columnIndices[t]);}}class k extends b{constructor(e,t={}){let{rows:n=1}=t;if(e.length%n!=0)throw Error("the data length is not divisible by the number of rows");super(),this.rows=n,this.columns=e.length/n,this.data=e;}set(e,t,n){let r=this._calculateIndex(e,t);return this.data[r]=n,this;}get(e,t){let n=this._calculateIndex(e,t);return this.data[n];}_calculateIndex(e,t){return e*this.columns+t;}}class C extends b{constructor(e){super(),this.data=e,this.rows=e.length,this.columns=e[0].length;}set(e,t,n){return this.data[e][t]=n,this;}get(e,t){return this.data[e][t];}}class A{constructor(e){let t,n,r,i,a,o,s,l,u;let c=(e=C.checkMatrix(e)).clone(),d=c.rows,f=c.columns,h=new Float64Array(d),p=1;for(t=0;t<d;t++)h[t]=t;for(n=0,l=new Float64Array(d);n<f;n++){for(t=0;t<d;t++)l[t]=c.get(t,n);for(t=0;t<d;t++){for(r=0,u=Math.min(t,n),a=0;r<u;r++)a+=c.get(t,r)*l[r];l[t]-=a,c.set(t,n,l[t]);}for(i=n,t=n+1;t<d;t++)Math.abs(l[t])>Math.abs(l[i])&&(i=t);if(i!==n){for(r=0;r<f;r++)o=c.get(i,r),c.set(i,r,c.get(n,r)),c.set(n,r,o);s=h[i],h[i]=h[n],h[n]=s,p=-p;}if(n<d&&0!==c.get(n,n))for(t=n+1;t<d;t++)c.set(t,n,c.get(t,n)/c.get(n,n));}this.LU=c,this.pivotVector=h,this.pivotSign=p;}isSingular(){let e=this.LU,t=e.columns;for(let n=0;n<t;n++)if(0===e.get(n,n))return!0;return!1;}solve(e){let t,n,r;e=x.checkMatrix(e);let i=this.LU;if(i.rows!==e.rows)throw Error("Invalid matrix dimensions");if(this.isSingular())throw Error("LU matrix is singular");let a=e.columns,o=e.subMatrixRow(this.pivotVector,0,a-1),s=i.columns;for(r=0;r<s;r++)for(t=r+1;t<s;t++)for(n=0;n<a;n++)o.set(t,n,o.get(t,n)-o.get(r,n)*i.get(t,r));for(r=s-1;r>=0;r--){for(n=0;n<a;n++)o.set(r,n,o.get(r,n)/i.get(r,r));for(t=0;t<r;t++)for(n=0;n<a;n++)o.set(t,n,o.get(t,n)-o.get(r,n)*i.get(t,r));}return o;}get determinant(){let e=this.LU;if(!e.isSquare())throw Error("Matrix must be square");let t=this.pivotSign,n=e.columns;for(let r=0;r<n;r++)t*=e.get(r,r);return t;}get lowerTriangularMatrix(){let e=this.LU,t=e.rows,n=e.columns,r=new x(t,n);for(let i=0;i<t;i++)for(let t=0;t<n;t++)i>t?r.set(i,t,e.get(i,t)):i===t?r.set(i,t,1):r.set(i,t,0);return r;}get upperTriangularMatrix(){let e=this.LU,t=e.rows,n=e.columns,r=new x(t,n);for(let i=0;i<t;i++)for(let t=0;t<n;t++)i<=t?r.set(i,t,e.get(i,t)):r.set(i,t,0);return r;}get pivotPermutationVector(){return Array.from(this.pivotVector);}}function L(e,t){let n=0;return Math.abs(e)>Math.abs(t)?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):0!==t?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0;}class P{constructor(e){let t,n,r,i;let a=(e=C.checkMatrix(e)).clone(),o=e.rows,s=e.columns,l=new Float64Array(s);for(r=0;r<s;r++){let e=0;for(t=r;t<o;t++)e=L(e,a.get(t,r));if(0!==e){for(0>a.get(r,r)&&(e=-e),t=r;t<o;t++)a.set(t,r,a.get(t,r)/e);for(a.set(r,r,a.get(r,r)+1),n=r+1;n<s;n++){for(i=0,t=r;t<o;t++)i+=a.get(t,r)*a.get(t,n);for(i=-i/a.get(r,r),t=r;t<o;t++)a.set(t,n,a.get(t,n)+i*a.get(t,r));}}l[r]=-e;}this.QR=a,this.Rdiag=l;}solve(e){let t,n,r,i;e=x.checkMatrix(e);let a=this.QR,o=a.rows;if(e.rows!==o)throw Error("Matrix row dimensions must agree");if(!this.isFullRank())throw Error("Matrix is rank deficient");let s=e.columns,l=e.clone(),u=a.columns;for(r=0;r<u;r++)for(n=0;n<s;n++){for(i=0,t=r;t<o;t++)i+=a.get(t,r)*l.get(t,n);for(i=-i/a.get(r,r),t=r;t<o;t++)l.set(t,n,l.get(t,n)+i*a.get(t,r));}for(r=u-1;r>=0;r--){for(n=0;n<s;n++)l.set(r,n,l.get(r,n)/this.Rdiag[r]);for(t=0;t<r;t++)for(n=0;n<s;n++)l.set(t,n,l.get(t,n)-l.get(r,n)*a.get(t,r));}return l.subMatrix(0,u-1,0,s-1);}isFullRank(){let e=this.QR.columns;for(let t=0;t<e;t++)if(0===this.Rdiag[t])return!1;return!0;}get upperTriangularMatrix(){let e,t,n=this.QR,r=n.columns,i=new x(r,r);for(e=0;e<r;e++)for(t=0;t<r;t++)e<t?i.set(e,t,n.get(e,t)):e===t?i.set(e,t,this.Rdiag[e]):i.set(e,t,0);return i;}get orthogonalMatrix(){let e,t,n,r,i=this.QR,a=i.rows,o=i.columns,s=new x(a,o);for(n=o-1;n>=0;n--){for(e=0;e<a;e++)s.set(e,n,0);for(s.set(n,n,1),t=n;t<o;t++)if(0!==i.get(n,n)){for(r=0,e=n;e<a;e++)r+=i.get(e,n)*s.get(e,t);for(r=-r/i.get(n,n),e=n;e<a;e++)s.set(e,t,s.get(e,t)+r*i.get(e,n));}}return s;}}class N{constructor(e,t={}){let n;if((e=C.checkMatrix(e)).isEmpty())throw Error("Matrix must be non-empty");let r=e.rows,i=e.columns,{computeLeftSingularVectors:a=!0,computeRightSingularVectors:o=!0,autoTranspose:s=!1}=t,l=!!a,u=!!o,c=!1;if(r<i){if(s){r=(n=e.transpose()).rows,i=n.columns,c=!0;let t=l;l=u,u=t;}else n=e.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");}else n=e.clone();let d=Math.min(r,i),f=Math.min(r+1,i),h=new Float64Array(f),p=new x(r,d),v=new x(i,i),g=new Float64Array(i),m=new Float64Array(r),y=new Float64Array(f);for(let e=0;e<f;e++)y[e]=e;let b=Math.min(r-1,i),_=Math.max(0,Math.min(i-2,r)),w=Math.max(b,_);for(let e=0;e<w;e++){if(e<b){h[e]=0;for(let t=e;t<r;t++)h[e]=L(h[e],n.get(t,e));if(0!==h[e]){0>n.get(e,e)&&(h[e]=-h[e]);for(let t=e;t<r;t++)n.set(t,e,n.get(t,e)/h[e]);n.set(e,e,n.get(e,e)+1);}h[e]=-h[e];}for(let t=e+1;t<i;t++){if(e<b&&0!==h[e]){let i=0;for(let a=e;a<r;a++)i+=n.get(a,e)*n.get(a,t);i=-i/n.get(e,e);for(let a=e;a<r;a++)n.set(a,t,n.get(a,t)+i*n.get(a,e));}g[t]=n.get(e,t);}if(l&&e<b)for(let t=e;t<r;t++)p.set(t,e,n.get(t,e));if(e<_){g[e]=0;for(let t=e+1;t<i;t++)g[e]=L(g[e],g[t]);if(0!==g[e]){g[e+1]<0&&(g[e]=0-g[e]);for(let t=e+1;t<i;t++)g[t]/=g[e];g[e+1]+=1;}if(g[e]=-g[e],e+1<r&&0!==g[e]){for(let t=e+1;t<r;t++)m[t]=0;for(let t=e+1;t<r;t++)for(let r=e+1;r<i;r++)m[t]+=g[r]*n.get(t,r);for(let t=e+1;t<i;t++){let i=-g[t]/g[e+1];for(let a=e+1;a<r;a++)n.set(a,t,n.get(a,t)+i*m[a]);}}if(u)for(let t=e+1;t<i;t++)v.set(t,e,g[t]);}}let E=Math.min(i,r+1);if(b<i&&(h[b]=n.get(b,b)),r<E&&(h[E-1]=0),_+1<E&&(g[_]=n.get(_,E-1)),g[E-1]=0,l){for(let e=b;e<d;e++){for(let t=0;t<r;t++)p.set(t,e,0);p.set(e,e,1);}for(let e=b-1;e>=0;e--)if(0!==h[e]){for(let t=e+1;t<d;t++){let n=0;for(let i=e;i<r;i++)n+=p.get(i,e)*p.get(i,t);n=-n/p.get(e,e);for(let i=e;i<r;i++)p.set(i,t,p.get(i,t)+n*p.get(i,e));}for(let t=e;t<r;t++)p.set(t,e,-p.get(t,e));p.set(e,e,1+p.get(e,e));for(let t=0;t<e-1;t++)p.set(t,e,0);}else{for(let t=0;t<r;t++)p.set(t,e,0);p.set(e,e,1);}}if(u)for(let e=i-1;e>=0;e--){if(e<_&&0!==g[e])for(let t=e+1;t<i;t++){let n=0;for(let r=e+1;r<i;r++)n+=v.get(r,e)*v.get(r,t);n=-n/v.get(e+1,e);for(let r=e+1;r<i;r++)v.set(r,t,v.get(r,t)+n*v.get(r,e));}for(let t=0;t<i;t++)v.set(t,e,0);v.set(e,e,1);}let M=E-1,S=Number.EPSILON;for(;E>0;){let e,t;for(e=E-2;e>=-1&&-1!==e;e--){let t=Number.MIN_VALUE+S*Math.abs(h[e]+Math.abs(h[e+1]));if(Math.abs(g[e])<=t||Number.isNaN(g[e])){g[e]=0;break;}}if(e===E-2)t=4;else{let n;for(n=E-1;n>=e&&n!==e;n--){let t=(n!==E?Math.abs(g[n]):0)+(n!==e+1?Math.abs(g[n-1]):0);if(Math.abs(h[n])<=S*t){h[n]=0;break;}}n===e?t=3:n===E-1?t=1:(t=2,e=n);}switch(e++,t){case 1:{let t=g[E-2];g[E-2]=0;for(let n=E-2;n>=e;n--){let r=L(h[n],t),a=h[n]/r,o=t/r;if(h[n]=r,n!==e&&(t=-o*g[n-1],g[n-1]=a*g[n-1]),u)for(let e=0;e<i;e++)r=a*v.get(e,n)+o*v.get(e,E-1),v.set(e,E-1,-o*v.get(e,n)+a*v.get(e,E-1)),v.set(e,n,r);}break;}case 2:{let t=g[e-1];g[e-1]=0;for(let n=e;n<E;n++){let i=L(h[n],t),a=h[n]/i,o=t/i;if(h[n]=i,t=-o*g[n],g[n]=a*g[n],l)for(let t=0;t<r;t++)i=a*p.get(t,n)+o*p.get(t,e-1),p.set(t,e-1,-o*p.get(t,n)+a*p.get(t,e-1)),p.set(t,n,i);}break;}case 3:{let t=Math.max(Math.abs(h[E-1]),Math.abs(h[E-2]),Math.abs(g[E-2]),Math.abs(h[e]),Math.abs(g[e])),n=h[E-1]/t,a=h[E-2]/t,o=g[E-2]/t,s=h[e]/t,c=g[e]/t,d=((a+n)*(a-n)+o*o)/2,f=n*o*(n*o),m=0;(0!==d||0!==f)&&(m=d<0?0-Math.sqrt(d*d+f):Math.sqrt(d*d+f),m=f/(d+m));let y=(s+n)*(s-n)+m,b=s*c;for(let t=e;t<E-1;t++){let n=L(y,b);0===n&&(n=Number.MIN_VALUE);let a=y/n,o=b/n;if(t!==e&&(g[t-1]=n),y=a*h[t]+o*g[t],g[t]=a*g[t]-o*h[t],b=o*h[t+1],h[t+1]=a*h[t+1],u)for(let e=0;e<i;e++)n=a*v.get(e,t)+o*v.get(e,t+1),v.set(e,t+1,-o*v.get(e,t)+a*v.get(e,t+1)),v.set(e,t,n);if(0===(n=L(y,b))&&(n=Number.MIN_VALUE),a=y/n,o=b/n,h[t]=n,y=a*g[t]+o*h[t+1],h[t+1]=-o*g[t]+a*h[t+1],b=o*g[t+1],g[t+1]=a*g[t+1],l&&t<r-1)for(let e=0;e<r;e++)n=a*p.get(e,t)+o*p.get(e,t+1),p.set(e,t+1,-o*p.get(e,t)+a*p.get(e,t+1)),p.set(e,t,n);}g[E-2]=y;break;}case 4:if(h[e]<=0&&(h[e]=h[e]<0?-h[e]:0,u))for(let t=0;t<=M;t++)v.set(t,e,-v.get(t,e));for(;e<M&&!(h[e]>=h[e+1]);){let t=h[e];if(h[e]=h[e+1],h[e+1]=t,u&&e<i-1)for(let n=0;n<i;n++)t=v.get(n,e+1),v.set(n,e+1,v.get(n,e)),v.set(n,e,t);if(l&&e<r-1)for(let n=0;n<r;n++)t=p.get(n,e+1),p.set(n,e+1,p.get(n,e)),p.set(n,e,t);e++;}E--;}}if(c){let e=v;v=p,p=e;}this.m=r,this.n=i,this.s=h,this.U=p,this.V=v;}solve(e){let t=this.threshold,n=this.s.length,r=x.zeros(n,n);for(let e=0;e<n;e++)Math.abs(this.s[e])<=t?r.set(e,e,0):r.set(e,e,1/this.s[e]);let i=this.U,a=this.rightSingularVectors,o=a.mmul(r),s=a.rows,l=i.rows,u=x.zeros(s,l);for(let e=0;e<s;e++)for(let t=0;t<l;t++){let r=0;for(let a=0;a<n;a++)r+=o.get(e,a)*i.get(t,a);u.set(e,t,r);}return u.mmul(e);}solveForDiagonal(e){return this.solve(x.diag(e));}inverse(){let e=this.V,t=this.threshold,n=e.rows,r=e.columns,i=new x(n,this.s.length);for(let a=0;a<n;a++)for(let n=0;n<r;n++)Math.abs(this.s[n])>t&&i.set(a,n,e.get(a,n)/this.s[n]);let a=this.U,o=a.rows,s=a.columns,l=new x(n,o);for(let e=0;e<n;e++)for(let t=0;t<o;t++){let n=0;for(let r=0;r<s;r++)n+=i.get(e,r)*a.get(t,r);l.set(e,t,n);}return l;}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1];}get norm2(){return this.s[0];}get rank(){let e=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,t=0,n=this.s;for(let r=0,i=n.length;r<i;r++)n[r]>e&&t++;return t;}get diagonal(){return Array.from(this.s);}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0];}get leftSingularVectors(){return this.U;}get rightSingularVectors(){return this.V;}get diagonalMatrix(){return x.diag(this.s);}}function O(e,t,n=!1){return(e=C.checkMatrix(e),t=C.checkMatrix(t),n)?new N(e).solve(t):e.isSquare()?new A(e).solve(t):new P(e).solve(t);}class I{constructor(e,t={}){let n,r;let{assumeSymmetric:i=!1}=t;if(!(e=C.checkMatrix(e)).isSquare())throw Error("Matrix is not a square matrix");if(e.isEmpty())throw Error("Matrix must be non-empty");let a=e.columns,o=new x(a,a),s=new Float64Array(a),l=new Float64Array(a),u=e;if(i||e.isSymmetric()){for(n=0;n<a;n++)for(r=0;r<a;r++)o.set(n,r,u.get(n,r));(function(e,t,n,r){let i,a,o,s,l,u,c,d;for(l=0;l<e;l++)n[l]=r.get(e-1,l);for(s=e-1;s>0;s--){for(u=0,d=0,o=0;u<s;u++)d+=Math.abs(n[u]);if(0===d)for(l=0,t[s]=n[s-1];l<s;l++)n[l]=r.get(s-1,l),r.set(s,l,0),r.set(l,s,0);else{for(u=0;u<s;u++)n[u]/=d,o+=n[u]*n[u];for(i=n[s-1],a=Math.sqrt(o),i>0&&(a=-a),t[s]=d*a,o-=i*a,n[s-1]=i-a,l=0;l<s;l++)t[l]=0;for(l=0;l<s;l++){for(i=n[l],r.set(l,s,i),a=t[l]+r.get(l,l)*i,u=l+1;u<=s-1;u++)a+=r.get(u,l)*n[u],t[u]+=r.get(u,l)*i;t[l]=a;}for(l=0,i=0;l<s;l++)t[l]/=o,i+=t[l]*n[l];for(l=0,c=i/(o+o);l<s;l++)t[l]-=c*n[l];for(l=0;l<s;l++){for(i=n[l],a=t[l],u=l;u<=s-1;u++)r.set(u,l,r.get(u,l)-(i*t[u]+a*n[u]));n[l]=r.get(s-1,l),r.set(s,l,0);}}n[s]=o;}for(s=0;s<e-1;s++){if(r.set(e-1,s,r.get(s,s)),r.set(s,s,1),0!==(o=n[s+1])){for(u=0;u<=s;u++)n[u]=r.get(u,s+1)/o;for(l=0;l<=s;l++){for(u=0,a=0;u<=s;u++)a+=r.get(u,s+1)*r.get(u,l);for(u=0;u<=s;u++)r.set(u,l,r.get(u,l)-a*n[u]);}}for(u=0;u<=s;u++)r.set(u,s+1,0);}for(l=0;l<e;l++)n[l]=r.get(e-1,l),r.set(e-1,l,0);r.set(e-1,e-1,1),t[0]=0;})(a,l,s,o),function(e,t,n,r){let i,a,o,s,l,u,c,d,f,h,p,v,g,m,y,b;for(o=1;o<e;o++)t[o-1]=t[o];t[e-1]=0;let _=0,x=0,w=Number.EPSILON;for(u=0;u<e;u++){for(x=Math.max(x,Math.abs(n[u])+Math.abs(t[u])),c=u;c<e&&!(Math.abs(t[c])<=w*x);)c++;if(c>u)do{for(i=n[u],f=L(d=(n[u+1]-i)/(2*t[u]),1),d<0&&(f=-f),n[u]=t[u]/(d+f),n[u+1]=t[u]*(d+f),h=n[u+1],a=i-n[u],o=u+2;o<e;o++)n[o]-=a;for(_+=a,d=n[c],v=p=1,g=p,m=t[u+1],y=0,b=0,o=c-1;o>=u;o--)for(l=0,g=v,v=p,b=y,i=p*t[o],a=p*d,f=L(d,t[o]),t[o+1]=y*f,y=t[o]/f,d=(p=d/f)*n[o]-y*i,n[o+1]=a+y*(p*i+y*n[o]);l<e;l++)a=r.get(l,o+1),r.set(l,o+1,y*r.get(l,o)+p*a),r.set(l,o,p*r.get(l,o)-y*a);d=-y*b*g*m*t[u]/h,t[u]=y*d,n[u]=p*d;}while(Math.abs(t[u])>w*x)n[u]=n[u]+_,t[u]=0;}for(o=0;o<e-1;o++){for(l=o,d=n[o],s=o+1;s<e;s++)n[s]<d&&(l=s,d=n[s]);if(l!==o)for(s=0,n[l]=n[o],n[o]=d;s<e;s++)d=r.get(s,o),r.set(s,o,r.get(s,l)),r.set(s,l,d);}}(a,l,s,o);}else{let e=new x(a,a),t=new Float64Array(a);for(r=0;r<a;r++)for(n=0;n<a;n++)e.set(n,r,u.get(n,r));(function(e,t,n,r){let i,a,o,s,l,u,c;let d=e-1;for(u=1;u<=d-1;u++){for(c=0,s=u;s<=d;s++)c+=Math.abs(t.get(s,u-1));if(0!==c){for(o=0,s=d;s>=u;s--)n[s]=t.get(s,u-1)/c,o+=n[s]*n[s];for(a=Math.sqrt(o),n[u]>0&&(a=-a),o-=n[u]*a,n[u]=n[u]-a,l=u;l<e;l++){for(i=0,s=d;s>=u;s--)i+=n[s]*t.get(s,l);for(i/=o,s=u;s<=d;s++)t.set(s,l,t.get(s,l)-i*n[s]);}for(s=0;s<=d;s++){for(i=0,l=d;l>=u;l--)i+=n[l]*t.get(s,l);for(i/=o,l=u;l<=d;l++)t.set(s,l,t.get(s,l)-i*n[l]);}n[u]=c*n[u],t.set(u,u-1,c*a);}}for(s=0;s<e;s++)for(l=0;l<e;l++)r.set(s,l,s===l?1:0);for(u=d-1;u>=1;u--)if(0!==t.get(u,u-1)){for(s=u+1;s<=d;s++)n[s]=t.get(s,u-1);for(l=u;l<=d;l++){for(a=0,s=u;s<=d;s++)a+=n[s]*r.get(s,l);for(a=a/n[u]/t.get(u,u-1),s=u;s<=d;s++)r.set(s,l,r.get(s,l)+a*n[s]);}}})(a,e,t,o),function(e,t,n,r,i){let a,o,s,l,u,c,d,f,h,p,v,g,m,y,b,_=e-1,x=e-1,w=Number.EPSILON,E=0,M=0,S=0,k=0,C=0,A=0,L=0,P=0;for(a=0;a<e;a++)for((a<0||a>x)&&(n[a]=i.get(a,a),t[a]=0),o=Math.max(a-1,0);o<e;o++)M+=Math.abs(i.get(a,o));for(;_>=0;){for(l=_;l>0&&(0===(A=Math.abs(i.get(l-1,l-1))+Math.abs(i.get(l,l)))&&(A=M),!(Math.abs(i.get(l,l-1))<w*A));)l--;if(l===_)i.set(_,_,i.get(_,_)+E),n[_]=i.get(_,_),t[_]=0,_--,P=0;else if(l===_-1){if(d=i.get(_,_-1)*i.get(_-1,_),L=Math.sqrt(Math.abs(k=(S=(i.get(_-1,_-1)-i.get(_,_))/2)*S+d)),i.set(_,_,i.get(_,_)+E),i.set(_-1,_-1,i.get(_-1,_-1)+E),f=i.get(_,_),k>=0){for(L=S>=0?S+L:S-L,n[_-1]=f+L,n[_]=n[_-1],0!==L&&(n[_]=f-d/L),t[_-1]=0,t[_]=0,A=Math.abs(f=i.get(_,_-1))+Math.abs(L),C=Math.sqrt((S=f/A)*S+(k=L/A)*k),S/=C,k/=C,o=_-1;o<e;o++)L=i.get(_-1,o),i.set(_-1,o,k*L+S*i.get(_,o)),i.set(_,o,k*i.get(_,o)-S*L);for(a=0;a<=_;a++)L=i.get(a,_-1),i.set(a,_-1,k*L+S*i.get(a,_)),i.set(a,_,k*i.get(a,_)-S*L);for(a=0;a<=x;a++)L=r.get(a,_-1),r.set(a,_-1,k*L+S*r.get(a,_)),r.set(a,_,k*r.get(a,_)-S*L);}else n[_-1]=f+S,n[_]=f+S,t[_-1]=L,t[_]=-L;_-=2,P=0;}else{if(f=i.get(_,_),h=0,d=0,l<_&&(h=i.get(_-1,_-1),d=i.get(_,_-1)*i.get(_-1,_)),10===P){for(E+=f,a=0;a<=_;a++)i.set(a,a,i.get(a,a)-f);f=h=.75*(A=Math.abs(i.get(_,_-1))+Math.abs(i.get(_-1,_-2))),d=-.4375*A*A;}if(30===P&&(A=(A=(h-f)/2)*A+d)>0){for(A=Math.sqrt(A),h<f&&(A=-A),A=f-d/((h-f)/2+A),a=0;a<=_;a++)i.set(a,a,i.get(a,a)-A);E+=A,f=h=d=.964;}for(P+=1,u=_-2;u>=l&&(A=Math.abs(S=((C=f-(L=i.get(u,u)))*(A=h-L)-d)/i.get(u+1,u)+i.get(u,u+1))+Math.abs(k=i.get(u+1,u+1)-L-C-A)+Math.abs(C=i.get(u+2,u+1)),S/=A,k/=A,C/=A,!(u===l||Math.abs(i.get(u,u-1))*(Math.abs(k)+Math.abs(C))<w*(Math.abs(S)*(Math.abs(i.get(u-1,u-1))+Math.abs(L)+Math.abs(i.get(u+1,u+1))))));)u--;for(a=u+2;a<=_;a++)i.set(a,a-2,0),a>u+2&&i.set(a,a-3,0);for(s=u;s<=_-1&&(y=s!==_-1,s!==u&&0!==(f=Math.abs(S=i.get(s,s-1))+Math.abs(k=i.get(s+1,s-1))+Math.abs(C=y?i.get(s+2,s-1):0))&&(S/=f,k/=f,C/=f),0!==f);s++)if(A=Math.sqrt(S*S+k*k+C*C),S<0&&(A=-A),0!==A){for(s!==u?i.set(s,s-1,-A*f):l!==u&&i.set(s,s-1,-i.get(s,s-1)),S+=A,f=S/A,h=k/A,L=C/A,k/=S,C/=S,o=s;o<e;o++)S=i.get(s,o)+k*i.get(s+1,o),y&&(S+=C*i.get(s+2,o),i.set(s+2,o,i.get(s+2,o)-S*L)),i.set(s,o,i.get(s,o)-S*f),i.set(s+1,o,i.get(s+1,o)-S*h);for(a=0;a<=Math.min(_,s+3);a++)S=f*i.get(a,s)+h*i.get(a,s+1),y&&(S+=L*i.get(a,s+2),i.set(a,s+2,i.get(a,s+2)-S*C)),i.set(a,s,i.get(a,s)-S),i.set(a,s+1,i.get(a,s+1)-S*k);for(a=0;a<=x;a++)S=f*r.get(a,s)+h*r.get(a,s+1),y&&(S+=L*r.get(a,s+2),r.set(a,s+2,r.get(a,s+2)-S*C)),r.set(a,s,r.get(a,s)-S),r.set(a,s+1,r.get(a,s+1)-S*k);}}}if(0!==M){for(_=e-1;_>=0;_--)if(S=n[_],0===(k=t[_]))for(l=_,i.set(_,_,1),a=_-1;a>=0;a--){for(d=i.get(a,a)-S,C=0,o=l;o<=_;o++)C+=i.get(a,o)*i.get(o,_);if(t[a]<0)L=d,A=C;else if(l=a,0===t[a]?i.set(a,_,0!==d?-C/d:-C/(w*M)):(f=i.get(a,a+1),h=i.get(a+1,a),c=(f*A-L*C)/(k=(n[a]-S)*(n[a]-S)+t[a]*t[a]),i.set(a,_,c),i.set(a+1,_,Math.abs(f)>Math.abs(L)?(-C-d*c)/f:(-A-h*c)/L)),w*(c=Math.abs(i.get(a,_)))*c>1)for(o=a;o<=_;o++)i.set(o,_,i.get(o,_)/c);}else if(k<0)for(l=_-1,Math.abs(i.get(_,_-1))>Math.abs(i.get(_-1,_))?(i.set(_-1,_-1,k/i.get(_,_-1)),i.set(_-1,_,-(i.get(_,_)-S)/i.get(_,_-1))):(b=R(0,-i.get(_-1,_),i.get(_-1,_-1)-S,k),i.set(_-1,_-1,b[0]),i.set(_-1,_,b[1])),i.set(_,_-1,0),i.set(_,_,1),a=_-2;a>=0;a--){for(p=0,v=0,o=l;o<=_;o++)p+=i.get(a,o)*i.get(o,_-1),v+=i.get(a,o)*i.get(o,_);if(d=i.get(a,a)-S,t[a]<0)L=d,C=p,A=v;else if(l=a,0===t[a]?(b=R(-p,-v,d,k),i.set(a,_-1,b[0]),i.set(a,_,b[1])):(f=i.get(a,a+1),h=i.get(a+1,a),g=(n[a]-S)*(n[a]-S)+t[a]*t[a]-k*k,m=(n[a]-S)*2*k,0===g&&0===m&&(g=w*M*(Math.abs(d)+Math.abs(k)+Math.abs(f)+Math.abs(h)+Math.abs(L))),b=R(f*C-L*p+k*v,f*A-L*v-k*p,g,m),i.set(a,_-1,b[0]),i.set(a,_,b[1]),Math.abs(f)>Math.abs(L)+Math.abs(k)?(i.set(a+1,_-1,(-p-d*i.get(a,_-1)+k*i.get(a,_))/f),i.set(a+1,_,(-v-d*i.get(a,_)-k*i.get(a,_-1))/f)):(b=R(-C-h*i.get(a,_-1),-A-h*i.get(a,_),L,k),i.set(a+1,_-1,b[0]),i.set(a+1,_,b[1]))),w*(c=Math.max(Math.abs(i.get(a,_-1)),Math.abs(i.get(a,_))))*c>1)for(o=a;o<=_;o++)i.set(o,_-1,i.get(o,_-1)/c),i.set(o,_,i.get(o,_)/c);}for(a=0;a<e;a++)if(a<0||a>x)for(o=a;o<e;o++)r.set(a,o,i.get(a,o));for(o=e-1;o>=0;o--)for(a=0;a<=x;a++){for(s=0,L=0;s<=Math.min(o,x);s++)L+=r.get(a,s)*i.get(s,o);r.set(a,o,L);}}}(a,l,s,o,e);}this.n=a,this.e=l,this.d=s,this.V=o;}get realEigenvalues(){return Array.from(this.d);}get imaginaryEigenvalues(){return Array.from(this.e);}get eigenvectorMatrix(){return this.V;}get diagonalMatrix(){let e,t,n=this.n,r=this.e,i=this.d,a=new x(n,n);for(e=0;e<n;e++){for(t=0;t<n;t++)a.set(e,t,0);a.set(e,e,i[e]),r[e]>0?a.set(e,e+1,r[e]):r[e]<0&&a.set(e,e-1,r[e]);}return a;}}function R(e,t,n,r){let i,a;return Math.abs(n)>Math.abs(r)?(i=r/n,a=n+i*r,[(e+i*t)/a,(t-i*e)/a]):(i=n/r,a=r+i*n,[(i*e+t)/a,(i*t-e)/a]);}class D{constructor(e){let t,n,r;if(!(e=C.checkMatrix(e)).isSymmetric())throw Error("Matrix is not symmetric");let i=e,a=i.rows,o=new x(a,a),s=!0;for(n=0;n<a;n++){let e=0;for(r=0;r<n;r++){let a=0;for(t=0;t<r;t++)a+=o.get(r,t)*o.get(n,t);a=(i.get(n,r)-a)/o.get(r,r),o.set(n,r,a),e+=a*a;}for(e=i.get(n,n)-e,s&&(s=e>0),o.set(n,n,Math.sqrt(Math.max(e,0))),r=n+1;r<a;r++)o.set(n,r,0);}this.L=o,this.positiveDefinite=s;}isPositiveDefinite(){return this.positiveDefinite;}solve(e){let t,n,r;e=C.checkMatrix(e);let i=this.L,a=i.rows;if(e.rows!==a)throw Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw Error("Matrix is not positive definite");let o=e.columns,s=e.clone();for(r=0;r<a;r++)for(n=0;n<o;n++){for(t=0;t<r;t++)s.set(r,n,s.get(r,n)-s.get(t,n)*i.get(r,t));s.set(r,n,s.get(r,n)/i.get(r,r));}for(r=a-1;r>=0;r--)for(n=0;n<o;n++){for(t=r+1;t<a;t++)s.set(r,n,s.get(r,n)-s.get(t,n)*i.get(t,r));s.set(r,n,s.get(r,n)/i.get(r,r));}return s;}get lowerTriangularMatrix(){return this.L;}}class z{constructor(e,t={}){let n,i,a,o,s;e=C.checkMatrix(e);let{Y:l}=t,{scaleScores:u=!1,maxIterations:c=1e3,terminationCriteria:d=1e-10}=t;if(l){if((l=r.isAnyArray(l)&&"number"==typeof l[0]?x.columnVector(l):C.checkMatrix(l)).rows!==e.rows)throw Error("Y should have the same number of rows as X");n=l.getColumnVector(0);}else n=e.getColumnVector(0);let f=1;for(let t=0;t<c&&f>d;t++)o=(o=e.transpose().mmul(n).div(n.transpose().mmul(n).get(0,0))).div(o.norm()),i=e.mmul(o).div(o.transpose().mmul(o).get(0,0)),t>0&&(f=i.clone().sub(s).pow(2).sum()),s=i.clone(),l?(a=(a=l.transpose().mmul(i).div(i.transpose().mmul(i).get(0,0))).div(a.norm()),n=l.mmul(a).div(a.transpose().mmul(a).get(0,0))):n=i;if(l){let t=e.transpose().mmul(i).div(i.transpose().mmul(i).get(0,0));t=t.div(t.norm());let r=e.clone().sub(i.clone().mmul(t.transpose())),s=n.transpose().mmul(i).div(i.transpose().mmul(i).get(0,0)),u=l.clone().sub(i.clone().mulS(s.get(0,0)).mmul(a.transpose()));this.t=i,this.p=t.transpose(),this.w=o.transpose(),this.q=a,this.u=n,this.s=i.transpose().mmul(i),this.xResidual=r,this.yResidual=u,this.betas=s;}else this.w=o.transpose(),this.s=i.transpose().mmul(i).sqrt(),u?this.t=i.clone().div(this.s.get(0,0)):this.t=i,this.xResidual=e.sub(i.mmul(o.transpose()));}}t.AbstractMatrix=b,t.CHO=D,t.CholeskyDecomposition=D,t.DistanceMatrix=E,t.EVD=I,t.EigenvalueDecomposition=I,t.LU=A,t.LuDecomposition=A,t.Matrix=x,t.MatrixColumnSelectionView=class extends M{constructor(e,t){p(e,t),super(e,e.rows,t.length),this.columnIndices=t;}set(e,t,n){return this.matrix.set(e,this.columnIndices[t],n),this;}get(e,t){return this.matrix.get(e,this.columnIndices[t]);}},t.MatrixColumnView=class extends M{constructor(e,t){c(e,t),super(e,e.rows,1),this.column=t;}set(e,t,n){return this.matrix.set(e,this.column,n),this;}get(e){return this.matrix.get(e,this.column);}},t.MatrixFlipColumnView=class extends M{constructor(e){super(e,e.rows,e.columns);}set(e,t,n){return this.matrix.set(e,this.columns-t-1,n),this;}get(e,t){return this.matrix.get(e,this.columns-t-1);}},t.MatrixFlipRowView=class extends M{constructor(e){super(e,e.rows,e.columns);}set(e,t,n){return this.matrix.set(this.rows-e-1,t,n),this;}get(e,t){return this.matrix.get(this.rows-e-1,t);}},t.MatrixRowSelectionView=class extends M{constructor(e,t){h(e,t),super(e,t.length,e.columns),this.rowIndices=t;}set(e,t,n){return this.matrix.set(this.rowIndices[e],t,n),this;}get(e,t){return this.matrix.get(this.rowIndices[e],t);}},t.MatrixRowView=class extends M{constructor(e,t){u(e,t),super(e,1,e.columns),this.row=t;}set(e,t,n){return this.matrix.set(this.row,t,n),this;}get(e,t){return this.matrix.get(this.row,t);}},t.MatrixSelectionView=S,t.MatrixSubView=class extends M{constructor(e,t,n,r,i){v(e,t,n,r,i),super(e,n-t+1,i-r+1),this.startRow=t,this.startColumn=r;}set(e,t,n){return this.matrix.set(this.startRow+e,this.startColumn+t,n),this;}get(e,t){return this.matrix.get(this.startRow+e,this.startColumn+t);}},t.MatrixTransposeView=class extends M{constructor(e){super(e,e.columns,e.rows);}set(e,t,n){return this.matrix.set(t,e,n),this;}get(e,t){return this.matrix.get(t,e);}},t.NIPALS=z,t.Nipals=z,t.QR=P,t.QrDecomposition=P,t.SVD=N,t.SingularValueDecomposition=N,t.SymmetricMatrix=w,t.WrapperMatrix1D=k,t.WrapperMatrix2D=C,t.correlation=function(e,t=e,n={}){e=new x(e);let i=!1;if("object"!=typeof t||x.isMatrix(t)||r.isAnyArray(t)?t=new x(t):(n=t,t=e,i=!0),e.rows!==t.rows)throw TypeError("Both matrices must have the same number of rows");let{center:a=!0,scale:o=!0}=n;a&&(e.center("column"),i||t.center("column")),o&&(e.scale("column"),i||t.scale("column"));let s=e.standardDeviation("column",{unbiased:!0}),l=i?s:t.standardDeviation("column",{unbiased:!0}),u=e.transpose().mmul(t);for(let t=0;t<u.rows;t++)for(let n=0;n<u.columns;n++)u.set(t,n,u.get(t,n)*(1/(s[t]*l[n]))*(1/(e.rows-1)));return u;},t.covariance=function(e,t=e,n={}){e=new x(e);let i=!1;if("object"!=typeof t||x.isMatrix(t)||r.isAnyArray(t)?t=new x(t):(n=t,t=e,i=!0),e.rows!==t.rows)throw TypeError("Both matrices must have the same number of rows");let{center:a=!0}=n;a&&(e=e.center("column"),i||(t=t.center("column")));let o=e.transpose().mmul(t);for(let t=0;t<o.rows;t++)for(let n=0;n<o.columns;n++)o.set(t,n,o.get(t,n)*(1/(e.rows-1)));return o;},t.default=x,t.determinant=function e(t){if((t=x.checkMatrix(t)).isSquare()){let n,r,i;if(0===t.columns)return 1;if(2===t.columns)return n=t.get(0,0),r=t.get(0,1),i=t.get(1,0),n*t.get(1,1)-r*i;if(3!==t.columns)return new A(t).determinant;{let a,o,s;return a=new S(t,[1,2],[1,2]),o=new S(t,[1,2],[0,2]),s=new S(t,[1,2],[0,1]),n=t.get(0,0),r=t.get(0,1),i=t.get(0,2),n*e(a)-r*e(o)+i*e(s);}}throw Error("determinant can only be calculated for a square matrix");},t.inverse=function(e,t=!1){return(e=C.checkMatrix(e),t)?new N(e).inverse():O(e,x.eye(e.rows));},t.linearDependencies=function(e,t={}){let{thresholdValue:n=1e-9,thresholdError:r=1e-9}=t,i=(e=x.checkMatrix(e)).rows,a=new x(i,i);for(let t=0;t<i;t++){let o=x.columnVector(e.getRow(t)),s=e.subMatrixRow(function(e,t){let n=[];for(let r=0;r<e;r++)r!==t&&n.push(r);return n;}(i,t)).transpose(),l=new N(s).solve(o),u=x.sub(o,s.mmul(l)).abs().max();a.setRow(t,function(e,t,n,r=1e-9,i=1e-9){if(e>i)return Array(t.rows+1).fill(0);{let e=t.addRow(n,[0]);for(let t=0;t<e.rows;t++)Math.abs(e.get(t,0))<r&&e.set(t,0,0);return e.to1DArray();}}(u,l,t,n,r));}return a;},t.pseudoInverse=function(e,t=Number.EPSILON){if((e=x.checkMatrix(e)).isEmpty())return e.transpose();let n=new N(e,{autoTranspose:!0}),r=n.leftSingularVectors,i=n.rightSingularVectors,a=n.diagonal;for(let e=0;e<a.length;e++)Math.abs(a[e])>t?a[e]=1/a[e]:a[e]=0;return i.mmul(x.diag(a).mmul(r.transpose()));},t.solve=O,t.wrap=function(e,t){if(r.isAnyArray(e))return e[0]&&r.isAnyArray(e[0])?new C(e):new k(e,t);throw Error("the argument is not an array");};},"933e3867":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0});var r=n("a24d4a8c"),i=n("62b16a10"),a=function(){function e(e,t,n,r,a){this.fromNode=e,this.toNode=t,this.nodeEdgeNodeLabel={nodeLabel1:n||i.VACANT_NODE_LABEL,edgeLabel:r||i.VACANT_EDGE_LABEL,nodeLabel2:a||i.VACANT_NODE_LABEL};}return e.prototype.equalTo=function(e){return this.fromNode===e.formNode&&this.toNode===e.toNode&&this.nodeEdgeNodeLabel===e.nodeEdgeNodeLabel;},e.prototype.notEqualTo=function(e){return!this.equalTo(e);},e;}(),o=function(){function e(){this.rmpath=[],this.dfsEdgeList=[];}return e.prototype.equalTo=function(e){var t=this.dfsEdgeList.length;if(t!==e.length)return!1;for(var n=0;n<t;n++)if(this.dfsEdgeList[n]!==e[n])return!1;return!0;},e.prototype.notEqualTo=function(e){return!this.equalTo(e);},e.prototype.pushBack=function(e,t,n,r,i){return this.dfsEdgeList.push(new a(e,t,n,r,i)),this.dfsEdgeList;},e.prototype.toGraph=function(e,t){void 0===e&&(e=i.VACANT_GRAPH_ID),void 0===t&&(t=!1);var n=new i.Graph(e,!0,t);return this.dfsEdgeList.forEach(function(e){var t=e.fromNode,r=e.toNode,a=e.nodeEdgeNodeLabel,o=a.nodeLabel1,s=a.edgeLabel,l=a.nodeLabel2;o!==i.VACANT_NODE_LABEL&&n.addNode(t,o),l!==i.VACANT_NODE_LABEL&&n.addNode(r,l),o!==i.VACANT_NODE_LABEL&&l!==o&&n.addEdge(void 0,t,r,s);}),n;},e.prototype.buildRmpath=function(){this.rmpath=[];for(var e=void 0,t=this.dfsEdgeList.length,n=t-1;n>=0;n--){var r=this.dfsEdgeList[n],i=r.fromNode,a=r.toNode;i<a&&(void 0===e||a===e)&&(this.rmpath.push(n),e=i);}return this.rmpath;},e.prototype.getNodeNum=function(){var e={};return this.dfsEdgeList.forEach(function(t){e[t.fromNode]||(e[t.fromNode]=!0),e[t.toNode]||(e[t.toNode]=!0);}),Object.keys(e).length;},e;}(),s=function(){function e(e){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],e){for(;e;){var t=e.edge;this.edges.push(t),this.nodesUsed[t.from]=1,this.nodesUsed[t.to]=1,this.edgesUsed[t.id]=1,e=e.preNode;}this.edges=this.edges.reverse();}}return e.prototype.hasNode=function(e){return 1===this.nodesUsed[e.id];},e.prototype.hasEdge=function(e){return 1===this.edgesUsed[e.id];},e;}();!function(){function e(e){var t=e.graphs,n=e.minSupport,r=e.minNodeNum,i=e.maxNodeNum,a=e.top,s=e.directed,l=e.verbose;this.graphs=t,this.dfsCode=new o,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=void 0===n?2:n,this.top=void 0===a?10:a,this.directed=void 0!==s&&s,this.counter=0,this.maxNodeNum=void 0===i?4:i,this.minNodeNum=void 0===r?1:r,this.verbose=void 0!==l&&l,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[];}e.prototype.findForwardRootEdges=function(e,t){var n=this,r=[],i=e.nodeMap;return t.edges.forEach(function(e){(n.directed||t.label<=i[e.to].label)&&r.push(e);}),r;},e.prototype.findBackwardEdge=function(e,t,n,r){if(!this.directed&&t===n)return null;for(var i=e.nodeMap,a=i[n.to].edges,o=a.length,s=0;s<o;s++){var l=a[s];if(!r.hasEdge(l)&&l.to===t.from){if(this.directed){if(i[t.from].label<i[n.to].label||i[t.from].label===i[n.to].label&&t.label<=l.label)return l;}else if(t.label<l.label||t.label===l.label&&i[t.to].label<=i[n.to].label)return l;}}return null;},e.prototype.findForwardPureEdges=function(e,t,n,r){for(var i=[],a=t.to,o=e.nodeMap[a].edges,s=o.length,l=0;l<s;l++){var u=o[l],c=e.nodeMap[u.to];n<=c.label&&!r.hasNode(c)&&i.push(u);}return i;},e.prototype.findForwardRmpathEdges=function(e,t,n,r){for(var i=[],a=e.nodeMap,o=a[t.to].label,s=a[t.from].edges,l=s.length,u=0;u<l;u++){var c=s[u],d=a[c.to].label;!(t.to===c.to||n>d||r.hasNode(a[c.to]))&&(t.label<c.label||t.label===c.label&&o<=d)&&i.push(c);}return i;},e.prototype.getSupport=function(e){var t={};return e.forEach(function(e){t[e.graphId]||(t[e.graphId]=!0);}),Object.keys(t).length;},e.prototype.findMinLabel=function(e){var t=void 0;return Object.keys(e).forEach(function(n){var r=e[n],i=r.nodeLabel1,a=r.edgeLabel,o=r.nodeLabel2;if(!t){t={nodeLabel1:i,edgeLabel:a,nodeLabel2:o};return;}(i<t.nodeLabel1||i===t.nodeLabel1&&a<t.edgeLabel||i===t.nodeLabel1&&a===t.edgeLabel&&o<t.nodeLabel2)&&(t={nodeLabel1:i,edgeLabel:a,nodeLabel2:o});}),t;},e.prototype.isMin=function(){var e=this,t=this.dfsCode;if(this.verbose&&console.log("isMin checking",t),1===t.dfsEdgeList.length)return!0;var n=this.directed,r=t.toGraph(i.VACANT_GRAPH_ID,n),l=r.nodeMap,u=new o,c={};r.nodes.forEach(function(t){e.findForwardRootEdges(r,t).forEach(function(e){var n=l[e.to],i="".concat(t.label,"-").concat(e.label,"-").concat(n.label);c[i]||(c[i]={projected:[],nodeLabel1:t.label,edgeLabel:e.label,nodeLabel2:n.label});var a={graphId:r.id,edge:e,preNode:null};c[i].projected.push(a);});});var d=this.findMinLabel(c);if(d)return u.dfsEdgeList.push(new a(0,1,d.nodeLabel1,d.edgeLabel,d.nodeLabel2)),function o(c){for(var d=u.buildRmpath(),f=u.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,h=u.dfsEdgeList[d[0]].toNode,p={},v=!1,g=0,m=n?-1:0,y=function(t){if(v)return"break";c.forEach(function(n){var i=new s(n),a=e.findBackwardEdge(r,i.edges[d[t]],i.edges[d[0]],i);a&&(p[a.label]||(p[a.label]={projected:[],edgeLabel:a.label}),p[a.label].projected.push({graphId:r.id,edge:p,preNode:n}),g=u.dfsEdgeList[d[t]].fromNode,v=!0);});},b=d.length-1;b>m&&"break"!==y(b);b--);if(v){var _=e.findMinLabel(p);u.dfsEdgeList.push(new a(h,g,i.VACANT_NODE_LABEL,_.edgeLabel,i.VACANT_NODE_LABEL));var x=u.dfsEdgeList.length-1;return e.dfsCode.dfsEdgeList[x]===u.dfsEdgeList[x]&&o(p[_.edgeLabel].projected);}var w={};v=!1;var E=0;c.forEach(function(t){var n=new s(t),i=e.findForwardPureEdges(r,n.edges[d[0]],f,n);i.length>0&&(v=!0,E=h,i.forEach(function(e){var n="".concat(e.label,"-").concat(l[e.to].label);w[n]||(w[n]={projected:[],edgeLabel:e.label,nodeLabel2:l[e.to].label}),w[n].projected.push({graphId:r.id,edge:e,preNode:t});}));});for(var M=d.length,b=0;b<M&&"break"!==function(t){if(v)return"break";var n=d[t];c.forEach(function(t){var i=new s(t),a=e.findForwardRmpathEdges(r,i.edges[n],f,i);a.length>0&&(v=!0,E=u.dfsEdgeList[n].fromNode,a.forEach(function(e){var n="".concat(e.label,"-").concat(l[e.to].label);w[n]||(w[n]={projected:[],edgeLabel:e.label,nodeLabel2:l[e.to].label}),w[n].projected.push({graphId:r.id,edge:e,preNode:t});}));});}(b);b++);if(!v)return!0;var S=e.findMinLabel(w);u.dfsEdgeList.push(new a(E,h+1,i.VACANT_NODE_LABEL,S.edgeLabel,S.nodeLabel2));var k=u.dfsEdgeList.length-1;return t.dfsEdgeList[k]===u.dfsEdgeList[k]&&o(w["".concat(S.edgeLabel,"-").concat(S.nodeLabel2)].projected);}(c["".concat(d.nodeLabel1,"-").concat(d.edgeLabel,"-").concat(d.nodeLabel2)].projected);},e.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var e=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push((0,r.clone)(e));}},e.prototype.subGraphMining=function(e){var t=this;if(!(this.getSupport(e)<this.minSupport)&&this.isMin()){this.report();var n=this.dfsCode.getNodeNum(),r=this.dfsCode.buildRmpath(),o=this.dfsCode.dfsEdgeList[r[0]].toNode,l=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,u={},c={};e.forEach(function(e){for(var i=t.graphs[e.graphId],a=i.nodeMap,d=new s(e),f=r.length-1;f>=0;f--){var h=t.findBackwardEdge(i,d.edges[r[f]],d.edges[r[0]],d);if(h){var p="".concat(t.dfsCode.dfsEdgeList[r[f]].fromNode,"-").concat(h.label);c[p]||(c[p]={projected:[],toNodeId:t.dfsCode.dfsEdgeList[r[f]].fromNode,edgeLabel:h.label}),c[p].projected.push({graphId:e.graphId,edge:h,preNode:e});}}if(!(n>=t.maxNodeNum)){t.findForwardPureEdges(i,d.edges[r[0]],l,d).forEach(function(t){var n="".concat(o,"-").concat(t.label,"-").concat(a[t.to].label);u[n]||(u[n]={projected:[],fromNodeId:o,edgeLabel:t.label,nodeLabel2:a[t.to].label}),u[n].projected.push({graphId:e.graphId,edge:t,preNode:e});});for(var v=function(n){t.findForwardRmpathEdges(i,d.edges[r[n]],l,d).forEach(function(i){var o="".concat(t.dfsCode.dfsEdgeList[r[n]].fromNode,"-").concat(i.label,"-").concat(a[i.to].label);u[o]||(u[o]={projected:[],fromNodeId:t.dfsCode.dfsEdgeList[r[n]].fromNode,edgeLabel:i.label,nodeLabel2:a[i.to].label}),u[o].projected.push({graphId:e.graphId,edge:i,preNode:e});});},f=0;f<r.length;f++)v(f);}}),Object.keys(c).forEach(function(e){var n=c[e],r=n.toNodeId,i=n.edgeLabel;t.dfsCode.dfsEdgeList.push(new a(o,r,"-1",i,"-1")),t.subGraphMining(c[e].projected),t.dfsCode.dfsEdgeList.pop();}),Object.keys(u).forEach(function(e){var n=u[e],r=n.fromNodeId,s=n.edgeLabel,l=n.nodeLabel2;t.dfsCode.dfsEdgeList.push(new a(r,o+1,i.VACANT_NODE_LABEL,s,l)),t.subGraphMining(u[e].projected),t.dfsCode.dfsEdgeList.pop();});}},e.prototype.generate1EdgeFrequentSubGraphs=function(){var e=this.graphs,t=this.directed,n=this.minSupport,r=this.frequentSize1Subgraphs,i={},a={},o={},s={};return Object.keys(e).forEach(function(n){var r=e[n],l=r.nodeMap;r.nodes.forEach(function(e,r){var u=e.label,c="".concat(n,"-").concat(u);if(!o[c]){var d=i[u]||0;d++,i[u]=d;}o[c]={graphKey:n,label:u},e.edges.forEach(function(e){var r=u,i=l[e.to].label;if(!t&&r>i){var o=i;i=r,r=o;}var c=e.label,d="".concat(n,"-").concat(r,"-").concat(c,"-").concat(i),f="".concat(r,"-").concat(c,"-").concat(i);if(!a[f]){var h=a[f]||0;h++,a[f]=h;}s[d]={graphId:n,nodeLabel1:r,edgeLabel:c,nodeLabel2:i};});});}),Object.keys(i).forEach(function(e){if(!(i[e]<n)){var t={nodes:[],edges:[]};t.nodes.push({id:"0",label:e}),r.push(t);}}),r;},e.prototype.run=function(){var e=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var t=this.graphs;this.directed;var n={};Object.keys(t).forEach(function(r){var i=t[r],a=i.nodeMap;i.nodes.forEach(function(t){e.findForwardRootEdges(i,t).forEach(function(e){var i=a[e.to],o="".concat(t.label,"-").concat(e.label,"-").concat(i.label);n[o]||(n[o]={projected:[],nodeLabel1:t.label,edgeLabel:e.label,nodeLabel2:i.label}),n[o].projected.push({graphId:r,edge:e,preNode:null});});});}),Object.keys(n).forEach(function(t){var r=n[t],i=r.projected,o=r.nodeLabel1,s=r.edgeLabel,l=r.nodeLabel2;e.dfsCode.dfsEdgeList.push(new a(0,1,o,s,l)),e.subGraphMining(i),e.dfsCode.dfsEdgeList.pop();});}};}();},"93407ee1":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return d;}});var r,i=n("777fffbe"),a=i._(n("f89fb776")),o=i._(n("daaa1548")),s=i._(n("d812e418")),l=n("d9b661b3"),u=i._(n("755bc4f8")),c=((r=c||{}).UP="up",r.DOWN="down",r);class d extends u.default{constructor(...e){super(...e),(0,s.default)(this,"texture",void 0),(0,s.default)(this,"mapTexture",void 0),(0,s.default)(this,"positions",void 0),(0,s.default)(this,"indices",void 0),(0,s.default)(this,"timer",void 0),(0,s.default)(this,"spriteTop",void 0),(0,s.default)(this,"spriteUpdate",void 0),(0,s.default)(this,"spriteAnimate",void 0),(0,s.default)(this,"planeGeometryUpdateTriangulation",()=>{let{spriteBottom:e=-10}=this.layer.getLayerConfig(),t=this.spriteUpdate,n=this.spriteTop;for(let r=0;r<this.positions.length;r+=5)this.spriteAnimate===c.UP?(this.positions[r+2]+=t,this.positions[r+2]>n&&(this.positions[r+2]=e)):(this.positions[r+2]-=t,this.positions[r+2]<e&&(this.positions[r+2]=n));return{vertices:this.positions,indices:this.indices,size:5};}),(0,s.default)(this,"updatePosition",()=>{var e;this.planeGeometryUpdateTriangulation();let t=null===(e=this.styleAttributeService.getLayerStyleAttribute("position"))||void 0===e?void 0:e.vertexAttribute;if(t){let e=[];for(let t=0;t<this.positions.length;t+=5)e.push(this.positions[t],this.positions[t+1],this.positions[t+2]);t.updateBuffer({data:e,offset:0});}this.layerService.throttleRenderLayers(),this.timer=requestAnimationFrame(this.updatePosition);}),(0,s.default)(this,"planeGeometryTriangulation",()=>{let{center:e=[120,30],spriteCount:t=100,spriteRadius:n=10}=this.layer.getLayerConfig(),{indices:r,positions:i}=this.initSprite(n,t,...e);return this.positions=i,this.indices=r,{vertices:i,indices:r,size:5};});}initSprite(e=10,t=100,n=120,r=30){let i=[],a=[],o=this.spriteAnimate===c.UP?-this.spriteTop:this.spriteTop;for(let i=0;i<t;i++){let t=Math.random()*o;a.push(...function(t){let i=e*Math.random(),a=e*Math.random();return[-e/2+i+n,-(-e/2+a)+r,t,0,0];}(t));}for(let e=0;e<t;e++)i.push(e);return{indices:i,positions:a};}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,o.default)((0,o.default)({},e.uniformsOption),t.uniformsOption);}getCommonUniformsInfo(){let{opacity:e,mapTexture:t,spriteScale:n=1}=this.layer.getLayerConfig();if(this.mapTexture!==t){var r;this.mapTexture=t,null===(r=this.texture)||void 0===r||r.destroy(),this.textures=[],this.updateTexture(t);}let i={u_opacity:e||1,u_mapFlag:t?1:0,u_Scale:n,u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(i);}clearModels(){var e;cancelAnimationFrame(this.timer),null===(e=this.texture)||void 0===e||e.destroy(),this.textures=[];}initModels(){var e=this;return(0,a.default)(function*(){let{mapTexture:t,spriteTop:n=300,spriteUpdate:r=10,spriteAnimate:i=c.DOWN}=e.layer.getLayerConfig();e.initUniformsBuffer(),e.mapTexture=t,e.spriteTop=n,e.spriteUpdate=r,"up"===i?e.spriteAnimate=c.UP:e.spriteAnimate=c.DOWN;let{createTexture2D:a}=e.rendererService;return e.texture=a({height:0,width:0}),e.updateTexture(t),setTimeout(()=>{e.updatePosition();},100),[(yield e.layer.buildLayerModel({moduleName:"geometrySprite",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec3 a_Color;\n\nlayout(std140) uniform commonUniforms {\n  float u_opacity;\n  float u_mapFlag;\n  float u_Scale;\n};\n\nout vec3 v_Color;\nout float v_d;\n\n#pragma include "projection"\nvoid main() {\n  v_Color = a_Color.xyz;\n  v_d = a_Position.z;\n\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, a_Position.z, 1.0));\n  gl_PointSize = pow(u_Zoom - 1.0, 2.0) * u_Scale;\n}\n',fragmentShader:"\nlayout(std140) uniform commonUniforms {\n  float u_opacity;\n  float u_mapFlag;\n  float u_Scale;\n};\nuniform sampler2D u_texture;\n\nin vec3 v_Color;\nin float v_d;\nout vec4 outputColor;\n\nvoid main() {\n\n  if(v_d < 0.0) {\n    discard;\n  }\n\n  if(u_mapFlag > 0.0) {\n    outputColor = texture(SAMPLER_2D(u_texture), gl_PointCoord);\n    outputColor.a *= u_opacity;\n  } else {\n    outputColor = vec4(v_Color, u_opacity);\n  }\n}\n",triangulation:e.planeGeometryTriangulation,defines:e.getDefines(),inject:e.getInject(),primitive:l.gl.POINTS,depth:{enable:!1},blend:e.getBlend()}))];})();}buildModels(){var e=this;return(0,a.default)(function*(){return e.initModels();})();}updateTexture(e){let{createTexture2D:t}=this.rendererService;if(e){let n=new Image;n.crossOrigin="anonymous",n.onload=()=>{this.texture=t({data:n,width:n.width,height:n.height,wrapS:l.gl.CLAMP_TO_EDGE,wrapT:l.gl.CLAMP_TO_EDGE}),this.layerService.reRender();},n.src=e;}else this.texture=t({width:1,height:1});}registerBuiltinAttributes(){return"";}}},"936c3082":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"ProxyFuncs",{enumerable:!0,get:function(){return r;}});let r=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive","disableMask","enableMask","addMask","removeMask"];},"93d9af53":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"useSceneEvent",{enumerable:!0,get:function(){return o;}});var r=n("af467690"),i=n("6dca7af8");function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r;}var o=function(e,t){var n;(0,r.useTrackedEffect)(function(t,n,r){if(e){var a=t.filter(function(e){return!!e;}).map(function(e){return e-1;});t.includes(0)&&(a=i.SceneEventList.map(function(e,t){return t;})),a.forEach(function(t){var a=i.SceneEventMap[i.SceneEventList[t]],o=n[t+1],s=r[t+1];o&&e.off(a,o),s&&e.on(a,s);});}},[e].concat(function(e){if(Array.isArray(e))return a(e);}(n=i.SceneEventList.map(function(e){return t[e];}))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e);}(n)||function(e,t){if(e){if("string"==typeof e)return a(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,void 0);}}(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}())),(0,r.useUnmount)(function(){e&&i.SceneEventList.forEach(function(n){var r=i.SceneEventMap[n],a=t[n];r&&a&&e.off(r,a);});});};},"948c20b5":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe")._(n("731b2a36")),i="object"==typeof t&&t&&!t.nodeType&&t,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,o=a&&a.exports===i?r.default.Buffer:void 0,s=o?o.allocUnsafe:void 0,l=function(e,t){if(t)return e.slice();var n=e.length,r=s?s(n):new e.constructor(n);return e.copy(r),r;};},"9499af61":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return a;}});var r=function(e,t){return e===t;},i=function(){function e(e,t){void 0===t&&(t=null),this.value=e,this.next=t;}return e.prototype.toString=function(e){return e?e(this.value):"".concat(this.value);},e;}(),a=function(){function e(e){void 0===e&&(e=r),this.head=null,this.tail=null,this.compare=e;}return e.prototype.prepend=function(e){var t=new i(e,this.head);return this.head=t,this.tail||(this.tail=t),this;},e.prototype.append=function(e){var t=new i(e);return this.head?this.tail.next=t:this.head=t,this.tail=t,this;},e.prototype.delete=function(e){if(!this.head)return null;for(var t=null;this.head&&this.compare(this.head.value,e);)t=this.head,this.head=this.head.next;var n=this.head;if(null!==n)for(;n.next;)this.compare(n.next.value,e)?(t=n.next,n.next=n.next.next):n=n.next;return this.compare(this.tail.value,e)&&(this.tail=n),t;},e.prototype.find=function(e){var t=e.value,n=void 0===t?void 0:t,r=e.callback,i=void 0===r?void 0:r;if(!this.head)return null;for(var a=this.head;a;){if(i&&i(a.value)||void 0!==n&&this.compare(a.value,n))return a;a=a.next;}return null;},e.prototype.deleteTail=function(){var e=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,e;for(var t=this.head;t.next;)t.next.next?t=t.next:t.next=null;return this.tail=t,e;},e.prototype.deleteHead=function(){if(!this.head)return null;var e=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),e;},e.prototype.fromArray=function(e){var t=this;return e.forEach(function(e){return t.append(e);}),this;},e.prototype.toArray=function(){for(var e=[],t=this.head;t;)e.push(t),t=t.next;return e;},e.prototype.reverse=function(){for(var e=this.head,t=null,n=null;e;)n=e.next,e.next=t,t=e,e=n;this.tail=this.head,this.head=t;},e.prototype.toString=function(e){return void 0===e&&(e=void 0),this.toArray().map(function(t){return t.toString(e);}).toString();},e;}();},"94c768e4":function(e,t,n){var r=n("9ec718eb");e.exports=function(e){try{r(e);}catch(e){if(e instanceof r.CycleException)return!1;throw e;}return!0;};},"950ddc7d":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return g;}});var r=n("777fffbe"),i=n("852bbaa9"),a=i._(n("a4d2d296")),o=r._(n("396c85ce")),s=r._(n("ad8fd27a")),l=r._(n("b5970efe")),u=r._(n("59935ee7")),c=i._(n("da378b41")),d=r._(n("b08e946c")),f=r._(n("2fc3731c")),h=r._(n("4610f244")),p=r._(n("61ae7b88")),v=i._(n("2d0197c2"));function g(e,t){var n=new m(null==t?v.defaultX:t,NaN,NaN);return null==e?n:n.addAll(e);}function m(e,t,n){this._x=e,this._x0=t,this._x1=n,this._root=void 0;}function y(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t;}var b=g.prototype=m.prototype;b.copy=function(){var e,t,n=new m(this._x,this._x0,this._x1),r=this._root;if(!r)return n;if(!r.length)return n._root=y(r),n;for(e=[{source:r,target:n._root=[,,]}];r=e.pop();)for(var i=0;i<2;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=[,,]}):r.target[i]=y(t));return n;},b.add=a.default,b.addAll=a.addAll,b.cover=o.default,b.data=s.default,b.extent=l.default,b.find=u.default,b.remove=c.default,b.removeAll=c.removeAll,b.root=d.default,b.size=f.default,b.visit=h.default,b.visitAfter=p.default,b.x=v.default;},"95189ca1":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("1ae5fa66");},95795444:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("b77730ab")),a=r._(n("6ebbe753")),o=r._(n("96ab26b2")),s=function(){this.size=0,this.__data__={hash:new i.default,map:new(o.default||a.default),string:new i.default};};},"95baa305":function(e,t,n){var r=n("ed2bf8a3");function i(){this._arr=[],this._keyIndices={};}e.exports=i,i.prototype.size=function(){return this._arr.length;},i.prototype.keys=function(){return this._arr.map(function(e){return e.key;});},i.prototype.has=function(e){return r.has(this._keyIndices,e);},i.prototype.priority=function(e){var t=this._keyIndices[e];if(void 0!==t)return this._arr[t].priority;},i.prototype.min=function(){if(0===this.size())throw Error("Queue underflow");return this._arr[0].key;},i.prototype.add=function(e,t){var n=this._keyIndices;if(e=String(e),!r.has(n,e)){var i=this._arr,a=i.length;return n[e]=a,i.push({key:e,priority:t}),this._decrease(a),!0;}return!1;},i.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key;},i.prototype.decrease=function(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n);},i.prototype._heapify=function(e){var t=this._arr,n=2*e,r=n+1,i=e;n<t.length&&(i=t[n].priority<t[i].priority?n:i,r<t.length&&(i=t[r].priority<t[i].priority?r:i),i!==e&&(this._swap(e,i),this._heapify(i)));},i.prototype._decrease=function(e){for(var t,n=this._arr,r=n[e].priority;0!==e&&!(n[t=e>>1].priority<r);)this._swap(e,t),e=t;},i.prototype._swap=function(e,t){var n=this._arr,r=this._keyIndices,i=n[e],a=n[t];n[e]=a,n[t]=i,r[a.key]=e,r[i.key]=t;};},"95d364ba":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("75a81265"));function i(){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=(0,r.default)(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(arguments.length<3?e:n):a.value;}}).apply(null,arguments);}},"95fb21b4":function(e,t,n){let r=n("7b266b54");var i="object"==typeof r&&r&&r.Object===Object&&r;e.exports=i;},"964e43bc":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("d1751d7c")._(n("d75116b0"),t);},"966a4071":function(e,t,n){Array.prototype.splice;},"966b1c37":function(e,t,n){"use strict";function r(e,t,n){var r,i=1;function a(){var a,o,s=r.length,l=0,u=0,c=0;for(a=0;a<s;++a)l+=(o=r[a]).x||0,u+=o.y||0,c+=o.z||0;for(l=(l/s-e)*i,u=(u/s-t)*i,c=(c/s-n)*i,a=0;a<s;++a)o=r[a],l&&(o.x-=l),u&&(o.y-=u),c&&(o.z-=c);}return null==e&&(e=0),null==t&&(t=0),null==n&&(n=0),a.initialize=function(e){r=e;},a.x=function(t){return arguments.length?(e=+t,a):e;},a.y=function(e){return arguments.length?(t=+e,a):t;},a.z=function(e){return arguments.length?(n=+e,a):n;},a.strength=function(e){return arguments.length?(i=+e,a):i;},a;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"9677a0f2":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return v;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("b131ee44")),o=r._(n("f89fb776")),s=r._(n("d812e418")),l=n("71293cfd"),u=r._(n("0e3a9206")),c=r._(n("4f2bad25")),d=r._(n("80dad29a"));let f=["id","attributionControl","style","token","rotation","mapInstance"];!function(e,t){var n="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,r="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram);if(!n&&!r&&(t||(t=document),t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i);}var o=t.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o);}}(".mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E\")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{flex-direction:column-reverse}.mapboxgl-popup-anchor-left{flex-direction:row}.mapboxgl-popup-anchor-right{flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:\"\";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:\"\";height:19px;left:-2px;position:absolute;top:-2px;width:19px;box-sizing:border-box;box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}"),window.mapboxgl=u.default;let h=0,p="101MlGsZ2AmmA&access_token=pk.eyJ1IjoiZXhhbXBsZXMiLCJhIjoiY2p0MG01MXRqMW45cjQzb2R6b2ptc3J4MSJ9.zA2W0IkI0c6KaAhJfk9bWg";class v extends d.default{constructor(...e){super(...e),(0,s.default)(this,"version","MAPBOX"),(0,s.default)(this,"viewport",void 0);}getType(){return"mapbox";}lngLatToCoord(e,t={x:0,y:0,z:0}){let{x:n,y:r}=this.lngLatToMercator(e,0);return[n-t.x,r-t.y];}lngLatToMercator(e,t){let{x:n=0,y:r=0,z:i=0}=window.mapboxgl.MercatorCoordinate.fromLngLat(e,t);return{x:n,y:r,z:i};}getModelMatrix(e,t,n,r=[1,1,1],i={x:0,y:0,z:0}){let a=window.mapboxgl.MercatorCoordinate.fromLngLat(e,t),o=a.meterInMercatorCoordinateUnits(),s=l.mat4.create();return l.mat4.translate(s,s,l.vec3.fromValues(a.x-i.x,a.y-i.y,a.z||0-i.z)),l.mat4.scale(s,s,l.vec3.fromValues(o*r[0],-o*r[1],o*r[2])),l.mat4.rotateX(s,s,n[0]),l.mat4.rotateY(s,s,n[1]),l.mat4.rotateZ(s,s,n[2]),s;}init(){var e=this;return(0,o.default)(function*(){let t=e.config,{id:n="map",attributionControl:r=!1,style:o="light",token:s=p,rotation:l=0,mapInstance:u}=t,d=(0,a.default)(t,f);e.viewport=new c.default,u||window.mapboxgl||console.error(e.configService.getSceneWarninfo("SDK")),s!==p||"blank"===o||window.mapboxgl.accessToken||u||console.warn(e.configService.getSceneWarninfo("MapToken")),u||window.mapboxgl.accessToken||(window.mapboxgl.accessToken=s),u?(e.map=u,e.$mapContainer=e.map.getContainer()):(e.$mapContainer=e.creatMapContainer(n),e.map=new window.mapboxgl.Map((0,i.default)({container:e.$mapContainer,style:e.getMapStyleValue(o),attributionControl:r,bearing:l},d))),e.map.on("load",()=>{e.handleCameraChanged();}),e.map.on("move",e.handleCameraChanged),e.handleCameraChanged();})();}destroy(){var e;null===(e=this.$mapContainer)||void 0===e||null===(e=e.parentNode)||void 0===e||e.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null);}emit(e,...t){this.eventEmitter.emit(e,...t);}once(e,...t){this.eventEmitter.once(e,...t);}getMapContainer(){return this.$mapContainer;}getCanvasOverlays(){var e;return null===(e=this.getMapContainer())||void 0===e?void 0:e.querySelector(".mapboxgl-canvas-container");}meterToCoord(e,t){let n=new u.default.LngLat(e[0],e[1]),r=new u.default.LngLat(t[0],t[1]),i=n.distanceTo(r),a=u.default.MercatorCoordinate.fromLngLat({lng:e[0],lat:e[1]}),o=u.default.MercatorCoordinate.fromLngLat({lng:t[0],lat:t[1]}),{x:s,y:l}=a,{x:c,y:d}=o;return 8388608*Math.sqrt(Math.pow(s-c,2)+Math.pow(l-d,2))/i;}exportMap(e){let t=this.map.getCanvas();return"jpg"===e?null==t?void 0:t.toDataURL("image/jpeg"):null==t?void 0:t.toDataURL("image/png");}creatMapContainer(e){let t=e;"string"==typeof e&&(t=document.getElementById(e));let n=document.createElement("div");return n.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,n.id="l7_mapbox_div"+h++,t.appendChild(n),n;}}},"96ab26b2":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("a8be75a3")),a=r._(n("731b2a36")),o=(0,i.default)(a.default,"Map");},"96b4b0c5":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{ExportImage:function(){return u;},default:function(){return u;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("f89fb776")),o=r._(n("d812e418")),s=n("631fd3ae"),l=r._(n("3198c185"));class u extends l.default{constructor(...e){var t;super(...e),t=this,(0,o.default)(this,"onClick",(0,a.default)(function*(){let{onExport:e}=t.controlOption;null==e||e((yield t.getImage()));})),(0,o.default)(this,"mergeImage",(0,a.default)(function*(...e){var n,r;let{imageType:i}=t.controlOption,{width:a=0,height:o=0}=null!==(n=null===(r=t.mapsService.getContainer())||void 0===r?void 0:r.getBoundingClientRect())&&void 0!==n?n:{},s=document.createElement("canvas");s.width=a,s.height=o;let l=s.getContext("2d");return(yield Promise.all(e.map(e=>new Promise(t=>{let n=new Image;n.onload=()=>{t(n);},n.src=e;})))).forEach(e=>{null==l||l.drawImage(e,0,0,a,o);}),s.toDataURL(`image/${i}`);}));}onAdd(){let e=super.onAdd();return e.addEventListener("click",this.onClick),e;}getDefault(e){return(0,i.default)((0,i.default)({},super.getDefault(e)),{},{title:"\u5BFC\u51FA\u56FE\u7247",btnIcon:(0,s.createL7Icon)("l7-icon-export-picture"),imageType:"png"});}getImage(){var e=this;return(0,a.default)(function*(){let t=yield e.mapsService.exportMap("png"),n=yield e.scene.exportPng("png");return e.mergeImage(...[t,n].filter(e=>e));})();}}},"96fd0d51":function(e,t,n){e.exports=function(e,t,n,r){for(var i=n-1,a=e.length;++i<a;)if(r(e[i],t))return i;return -1;};},"9716b304":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=n("d2dabb01"),a=r._(n("ecda7e01")),o=r._(n("63bbd163"));function s(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,i.isAnyArray)(e)){if(0===e.length)throw TypeError("input must not be empty");}else throw TypeError("input must be an array");if(void 0!==n.output){if(!(0,i.isAnyArray)(n.output))throw TypeError("output option must be an array if specified");t=n.output;}else t=Array(e.length);var r=(0,o.default)(e),s=(0,a.default)(e);if(r===s)throw RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var l=n.min,u=void 0===l?n.autoMinMax?r:0:l,c=n.max,d=void 0===c?n.autoMinMax?s:1:c;if(u>=d)throw RangeError("min option must be smaller than max option");for(var f=(d-u)/(s-r),h=0;h<e.length;h++)t[h]=(e[h]-r)*f+u;return t;}},"979aa57d":function(e,t,n){var r=n("3e5a5661"),i=n("ec3e7c7c"),a=n("7cf732b3"),o=n("a2265026"),s=n("f16c44d2");e.exports=function(e,t,n){var l=e.constructor;switch(t){case"[object ArrayBuffer]":return r(e);case"[object Boolean]":case"[object Date]":return new l(+e);case"[object DataView]":return i(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(e,n);case"[object Map]":case"[object Set]":return new l;case"[object Number]":case"[object String]":return new l(e);case"[object RegExp]":return a(e);case"[object Symbol]":return o(e);}};},"97c31b1e":function(e,t,n){"use strict";function r(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},"97d98753":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("441fab0c"));function i(e,t,n){var i,a,o,s,l,u,c,d=this._x0,f=this._y0,h=this._x1,p=this._y1,v=[],g=this._root;for(g&&v.push(new r.default(g,d,f,h,p)),null==n?n=1/0:(d=e-n,f=t-n,h=e+n,p=t+n,n*=n);u=v.pop();)if((g=u.node)&&!((a=u.x0)>h)&&!((o=u.y0)>p)&&!((s=u.x1)<d)&&!((l=u.y1)<f)){if(g.length){var m=(a+s)/2,y=(o+l)/2;v.push(new r.default(g[3],m,y,s,l),new r.default(g[2],a,y,m,l),new r.default(g[1],m,o,s,y),new r.default(g[0],a,o,m,y)),(c=(t>=y)<<1|e>=m)&&(u=v[v.length-1],v[v.length-1]=v[v.length-1-c],v[v.length-1-c]=u);}else{var b=e-+this._x.call(null,g.data),_=t-+this._y.call(null,g.data),x=b*b+_*_;if(x<n){var w=Math.sqrt(n=x);d=e-w,f=t-w,h=e+w,p=t+w,i=g.data;}}}return i;}},"9821a98c":function(e,t,n){e.exports=function(e){return this.__data__.has(e);};},"98710e85":function(e,t,n){var r=n("f10a19cc");e.exports=function(e,t,n){var i=null==e?void 0:r(e,t);return void 0===i?n:i;};},"98ccb8b6":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("4086b076")),a=r._(n("3e4beef3")),o=function(e){if(!(0,a.default)(e))return!1;var t=(0,i.default)(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t;};},"98fd032f":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return f;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=n("fb1ec05a"),s=n("08453f9e"),l=n("efd9d035"),u=n("666a0e6f"),c=n("936c3082");let{debounce:d}=o.lodashUtil;class f{constructor(e){(0,a.default)(this,"parent",void 0),(0,a.default)(this,"tileLayerService",void 0),(0,a.default)(this,"mapService",void 0),(0,a.default)(this,"layerService",void 0),(0,a.default)(this,"rendererService",void 0),(0,a.default)(this,"pickingService",void 0),(0,a.default)(this,"tilePickService",void 0),(0,a.default)(this,"tilesetManager",void 0),(0,a.default)(this,"initedTileset",!1),(0,a.default)(this,"lastViewStates",void 0),(0,a.default)(this,"mapchange",()=>{var e;if(!1===this.parent.isVisible())return;let{latLonBounds:t,zoom:n}=this.getCurrentView();this.lastViewStates&&this.lastViewStates.zoom===n&&this.lastViewStates.latLonBounds.toString()===t.toString()||(this.lastViewStates={zoom:n,latLonBounds:t},null===(e=this.tilesetManager)||void 0===e||e.throttleUpdate(n,t));}),(0,a.default)(this,"viewchange",d(this.mapchange,24)),this.parent=e;let t=this.parent.getContainer();this.rendererService=t.rendererService,this.layerService=t.layerService,this.mapService=t.mapService,this.pickingService=t.pickingService,this.tileLayerService=new s.TileLayerService({rendererService:this.rendererService,layerService:this.layerService,parent:e}),this.tilePickService=new l.TilePickService({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:e}),this.parent.setLayerPickService(this.tilePickService),this.proxy(e),this.initTileSetManager();}initTileSetManager(){var e;let t=this.parent.getSource();if(this.tilesetManager=t.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0),!1===this.parent.isVisible())return;let{latLonBounds:n,zoom:r}=this.getCurrentView();null===(e=this.tilesetManager)||void 0===e||e.update(r,n);}getCurrentView(){let e=this.mapService.getBounds();return{latLonBounds:[e[0][0],e[0][1],e[1][0],e[1][1]],zoom:this.mapService.getZoom()};}bindTilesetEvent(){this.tilesetManager.on("tile-loaded",e=>{}),this.tilesetManager.on("tile-unload",e=>{this.tileUnLoad(e);}),this.tilesetManager.on("tile-error",(e,t)=>{this.tileError(e);}),this.tilesetManager.on("tile-update",()=>{this.tileUpdate();}),this.mapService.on("zoomend",this.mapchange),this.mapService.on("moveend",this.viewchange);}render(){this.tileLayerService.render();}getLayers(){return this.tileLayerService.getLayers();}getTiles(){return this.tileLayerService.getTiles();}getTile(e){return this.tileLayerService.getTile(e);}tileLoaded(e){}tileError(e){console.warn("error:",e);}destroy(){var e;this.mapService.off("zoomend",this.mapchange),this.mapService.off("moveend",this.viewchange),null===(e=this.tilesetManager)||void 0===e||e.destroy(),this.tileLayerService.destroy();}reload(){var e;this.tilesetManager.clear();let{latLonBounds:t,zoom:n}=this.getCurrentView();null===(e=this.tilesetManager)||void 0===e||e.update(n,t);}tileUnLoad(e){this.tileLayerService.removeTile(e.key);}tileUpdate(){var e=this;return(0,i.default)(function*(){var t;if(!e.tilesetManager)return;let n=e.parent.getMinZoom(),r=e.parent.getMaxZoom(),a=e.tilesetManager.tiles.filter(e=>e.isLoaded).filter(e=>e.isVisibleChange).filter(e=>e.data).filter(e=>e.z>=n&&e.z<r);yield Promise.all(a.map((t=(0,i.default)(function*(t){if(e.tileLayerService.hasTile(t.key))e.tileLayerService.updateTileVisible(t),e.tilePickService.setPickState(),e.layerService.reRender();else{let n=new((0,u.getTileFactory)(e.parent))(t,e.parent);yield n.initTileLayer(),e.tilePickService.setPickState(),0!==n.getLayers().length&&(e.tileLayerService.addTile(n),e.tileLayerService.updateTileVisible(t),e.layerService.reRender());}}),function(e){return t.apply(this,arguments);}))),e.tilesetManager.isLoaded&&e.parent.emit("tiles-loaded",e.tilesetManager.currentTiles);})();}setPickState(e){}pickRender(e){this.tilePickService.pickRender(e);}selectFeature(e){this.tilePickService.selectFeature(e);}highlightPickedFeature(e){this.tilePickService.highlightPickedFeature(e);}proxy(e){c.ProxyFuncs.forEach(t=>{let n=e[t].bind(e);e[t]=(...r)=>(n(...r),this.getLayers().map(e=>{e[t](...r);}),"style"===t&&this.getTiles().forEach(e=>e.styleUpdate(...r)),e);});}}},"99400a9e":function(e,t,n){e.exports=function(e){return this.__data__.has(e);};},"9999b369":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{getEdgesByNodeId:function(){return a;},getNeighbors:function(){return r;},getOutEdgesNodeId:function(){return i;}});var r=function(e,t,n){void 0===t&&(t=[]);var r=t.filter(function(t){return t.source===e||t.target===e;});return"target"===n?r.filter(function(t){return t.source===e;}).map(function(e){return e.target;}):"source"===n?r.filter(function(t){return t.target===e;}).map(function(e){return e.source;}):r.map(function(t){return t.source===e?t.target:t.source;});},i=function(e,t){return t.filter(function(t){return t.source===e;});},a=function(e,t){return t.filter(function(t){return t.source===e||t.target===e;});};},"99d99dd5":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("a9c461d6")),i=function(e){return(0,r.default)(this,e).get(e);};},"99ff515c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){return null!==e&&"function"!=typeof e&&isFinite(e.length);};},"9a05af2a":function(e,t,n){e.exports=function(e){return e!=e;};},"9a0f9519":function(e,t,n){var r=n("df7a0006"),i=n("2dde1176"),a=n("9821a98c");function o(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t]);}o.prototype.add=o.prototype.push=i,o.prototype.has=a,e.exports=o;},"9a4a5c5c":function(e,t,n){var r=n("1a8a13fa"),i=n("32f27622"),a=n("3cfdc073"),o=Math.max;e.exports=function(e,t,n){var s=null==e?0:e.length;if(!s)return -1;var l=null==n?0:a(n);return l<0&&(l=o(s+l,0)),r(e,i(t,3),l);};},"9b584275":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("89326327")),i=function(e,t){return(0,r.default)(e,t);};},"9bb662e6":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"finalizeSegment",{enumerable:!0,get:function(){return i;}});var r=n("383ce26f");function i(e){for(var t=e.pathValue[e.segmentStart],n=t.toLowerCase(),i=e.data;i.length>=r.paramsCount[n]&&("m"===n&&i.length>2?(e.segments.push([t].concat(i.splice(0,2))),n="l",t="m"===t?"l":"L"):e.segments.push([t].concat(i.splice(0,r.paramsCount[n]))),r.paramsCount[n]););}},"9bb80662":function(e,t,n){var r=n("f10a19cc");e.exports=function(e){return function(t){return r(t,e);};};},"9c676843":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return d;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=n("d9b661b3"),s=n("fb1ec05a"),l=r._(n("755bc4f8")),u=n("909eb2d3"),c=n("f717bab4");class d extends l.default{constructor(...e){super(...e),(0,a.default)(this,"textureEventFlag",!1),(0,a.default)(this,"texture",this.createTexture2D({data:new Uint8Array([0,0,0,0]),width:1,height:1})),(0,a.default)(this,"updateTexture",()=>{let{createTexture2D:e}=this.rendererService;if(0===this.textures.length&&(this.textures=[this.texture]),this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return;}this.texture=e({data:this.iconService.getCanvas(),mag:o.gl.NEAREST,min:o.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128});});}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,DISTANCE_INDEX:10,NORMAL:11,UV:12});}getCommonUniformsInfo(){let{sourceColor:e,targetColor:t,textureBlend:n="normal",lineType:r="solid",dashArray:i=[10,5,0,0],lineTexture:a=!1,iconStep:o=100,vertexHeightScale:l=20,strokeWidth:c=0,raisingHeight:d=0,heightfixed:f=!1,linearDir:h=u.LinearDir.VERTICAL,blur:p=[1,1,1,0]}=this.layer.getLayerConfig(),v=i;if("dash"!==r&&(v=[0,0,0,0]),2===v.length&&v.push(0,0),this.rendererService.getDirty()&&this.texture){var g;null===(g=this.texture)||void 0===g||g.bind();}let{animateOption:m}=this.layer.getLayerConfig(),y=0,b=[0,0,0,0],_=[0,0,0,0];e&&t&&(b=(0,s.rgb2arr)(e),_=(0,s.rgb2arr)(t),y=1);let x={u_animate:this.animateOption2Array(m),u_dash_array:v,u_blur:p,u_sourceColor:b,u_targetColor:_,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:o,u_heightfixed:Number(f),u_vertexScale:l,u_raisingHeight:Number(d),u_strokeWidth:c,u_textureBlend:n===u.TextureBlend.NORMAL?0:1,u_line_texture:a?1:0,u_linearDir:h===u.LinearDir.VERTICAL?1:0,u_linearColor:y,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(x);}initModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),e.textureEventFlag||(e.textureEventFlag=!0,e.updateTexture(),e.iconService.on("imageUpdate",e.updateTexture)),e.buildModels();})();}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture);}buildModels(){var e=this;return(0,i.default)(function*(){let{depth:t=!1}=e.layer.getLayerConfig(),{frag:n,vert:r,type:i}=e.getShaders();return e.layer.triangulation=c.LineTriangulation,[(yield e.layer.buildLayerModel({moduleName:"line"+i,vertexShader:r,fragmentShader:n,triangulation:c.LineTriangulation,defines:e.getDefines(),inject:e.getInject(),depth:{enable:t}}))];})();}getShaders(){return{frag:'// #extension GL_OES_standard_derivatives : enable\n#define Animate 0.0\n#define LineTexture 1.0\n\nuniform sampler2D u_texture;\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_dash_array;\n  vec4 u_blur;\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float u_icon_step: 100;\n  float u_heightfixed: 0.0;\n  float u_vertexScale: 1.0;\n  float u_raisingHeight: 0.0;\n  float u_strokeWidth: 0.0;\n  float u_textureBlend;\n  float u_line_texture;\n  float u_linearDir: 1.0;\n  float u_linearColor: 0;\n  float u_time;\n};\n\nin vec4 v_color;\nin vec4 v_stroke;\n// dash\nin vec4 v_dash_array;\nin float v_d_distance_ratio;\nin vec2 v_iconMapUV;\nin vec4 v_texture_data;\n\nout vec4 outputColor;\n#pragma include "picking"\n\n// [animate, duration, interval, trailLength],\nvoid main() {\n  if(u_dash_array!=vec4(0.0)){\n    float dashLength = mod(v_d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {\n      // \u865A\u7EBF\u90E8\u5206\n      discard;\n    };\n  }\n  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6\n  float d_distance_ratio = v_texture_data.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B\n  if(u_linearDir < 1.0) {\n    d_distance_ratio = v_texture_data.a;\n  }\n  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272\n    outputColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);\n    outputColor.a *= v_color.a;\n  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272\n     outputColor = v_color;\n  }\n  // anti-alias\n  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));\n  if(u_animate.x == Animate) {\n      animateSpeed = u_time / u_animate.y;\n       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);\n      alpha = (alpha + u_animate.w -1.0) / u_animate.w;\n      alpha = smoothstep(0., 1., alpha);\n      outputColor.a *= alpha;\n  }\n\n  if(u_line_texture == LineTexture) { // while load texture\n    float aDistance = v_texture_data.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB\n    float d_texPixelLen = v_texture_data.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E\n    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);\n    float v = v_texture_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C\n\n    // v = max(smoothstep(0.95, 1.0, v), v);\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n     vec4 pattern = texture(SAMPLER_2D(u_texture), uv);\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      outputColor += pattern;\n    } else { // replace\n        pattern.a *= v_color.a;\n        if(outputColor.a <= 0.0) {\n          pattern.a = 0.0;\n        }\n        outputColor = pattern;\n    }\n  } \n\n  float v = v_texture_data.a;\n  float strokeWidth = min(0.5, u_strokeWidth);\n  // \u7ED8\u5236 border\n  if(strokeWidth > 0.01) {\n    float borderOuterWidth = strokeWidth / 2.0;\n\n\n    if(v >= 1.0 - strokeWidth || v <= strokeWidth) {\n      if(v > strokeWidth) { // \u5916\u4FA7\n        float linear = smoothstep(0.0, 1.0, (v - (1.0 - strokeWidth))/strokeWidth);\n        //  float linear = step(0.0, (v - (1.0 - borderWidth))/borderWidth);\n        outputColor.rgb = mix(outputColor.rgb, v_stroke.rgb, linear);\n      } else if(v <= strokeWidth) {\n        float linear = smoothstep(0.0, 1.0, v/strokeWidth);\n        outputColor.rgb = mix(v_stroke.rgb, outputColor.rgb, linear);\n      }\n    }\n\n    if(v < borderOuterWidth) {\n      outputColor.a = mix(0.0, outputColor.a, v/borderOuterWidth);\n    } else if(v > 1.0 - borderOuterWidth) {\n      outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);\n    }\n  }\n\n  // blur\n  float blurV = v_texture_data.a;\n  if(blurV < 0.5) {\n    outputColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);\n  } else {\n    outputColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);\n  }\n  \n  outputColor = filterColor(outputColor);\n}\n',vert:'#define Animate (0.0)\n\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;\nlayout(location = ATTRIBUTE_LOCATION_DISTANCE_INDEX) in vec3 a_DistanceAndIndexAndMiter;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec4 a_Normal_Total_Distance;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;\n\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_dash_array;\n  vec4 u_blur;\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float u_icon_step: 100;\n  float u_heightfixed: 0.0;\n  float u_vertexScale: 1.0;\n  float u_raisingHeight: 0.0;\n  float u_strokeWidth: 0.0;\n  float u_textureBlend;\n  float u_line_texture;\n  float u_linearDir: 1.0;\n  float u_linearColor: 0;\n  float u_time;\n};\n\nout vec4 v_color;\nout vec4 v_stroke;\n//dash\nout vec4 v_dash_array;\nout float v_d_distance_ratio;\n// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09\nout vec2 v_iconMapUV;\nout vec4 v_texture_data;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  vec2 a_DistanceAndIndex = a_DistanceAndIndexAndMiter.xy;\n  float a_Miter = a_DistanceAndIndexAndMiter.z;\n  vec3 a_Normal = a_Normal_Total_Distance.xyz;\n  float a_Total_Distance = a_Normal_Total_Distance.w;\n  //dash\u8F93\u51FA\n  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;\n  v_d_distance_ratio = a_DistanceAndIndex.x / a_Total_Distance;\n\n  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97\n  float d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E\n  v_iconMapUV = a_iconMapUV;\n  d_texPixelLen = project_float_pixel(u_icon_step);\n\n  v_color = a_Color;\n  v_color.a *= opacity;\n  v_stroke = stroke;\n\n  vec3 size = a_Miter * setPickingSize(a_Size.x) * a_Normal;\n\n  vec2 offset = project_pixel(size.xy);\n\n  float lineDistance = a_DistanceAndIndex.x;\n  float currentLinePointRatio = lineDistance / a_Total_Distance;\n\n  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09\n  float linePixelSize = project_pixel(a_Size.x) * 2.0; // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2\n  float texV = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C\n\n  v_texture_data = vec4(currentLinePointRatio, lineDistance, d_texPixelLen, texV);\n  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);\n\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));\n\n  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height\n  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]\n\n  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4\n  if (\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n  ) {\n    // mapbox\n    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8\n    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);\n    h *= mapboxZoomScale;\n    h += u_raisingHeight * mapboxZoomScale;\n    if (u_heightfixed > 0.0) {\n      lineHeight *= mapboxZoomScale;\n    }\n  }\n\n  gl_Position = project_common_position_to_clipspace(\n    vec4(project_pos.xy + offset, lineHeight + h, 1.0)\n  );\n\n  setPickingColor(a_PickingColor);\n}\n',type:""};}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:o.AttributeType.Attribute,descriptor:{name:"a_DistanceAndIndexAndMiter",shaderLocation:this.attributeLocation.DISTANCE_INDEX,buffer:{usage:o.gl.STATIC_DRAW,data:[],type:o.gl.FLOAT},size:3,update:(e,t,n,r,i,a)=>void 0===a?[n[3],10,n[4]]:[n[3],a,n[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:o.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:2,update:e=>{let{size:t=1}=e;return Array.isArray(t)?[t[0],t[1]]:[t,0];}}}),this.styleAttributeService.registerStyleAttribute({name:"normal_total_distance",type:o.AttributeType.Attribute,descriptor:{name:"a_Normal_Total_Distance",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:o.gl.STATIC_DRAW,data:[],type:o.gl.FLOAT},size:4,update:(e,t,n,r,i)=>[...i,n[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:o.AttributeType.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:2,update:e=>{let t=this.iconService.getIconMap(),{texture:n}=e,{x:r,y:i}=t[n]||{x:0,y:0};return[r,i];}}});}}},"9c6e7c32":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("daaa1548")),o=r._(n("d812e418")),s=n("d9b661b3"),l=r._(n("755bc4f8")),u=n("f717bab4");class c extends l.default{constructor(...e){super(...e),(0,o.default)(this,"texture",void 0),(0,o.default)(this,"updateTexture",()=>{let{createTexture2D:e}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(()=>{this.layerService.throttleRenderLayers();});return;}this.texture=e({data:this.iconService.getCanvas(),mag:s.gl.LINEAR,min:s.gl.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0});});}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,UV:10});}getUninforms(){if(this.rendererService.getDirty()){var e;null===(e=this.texture)||void 0===e||e.bind();}let t=this.getCommonUniformsInfo(),n=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,a.default)((0,a.default)({},t.uniformsOption),n.uniformsOption);}getCommonUniformsInfo(){let{raisingHeight:e=0,heightfixed:t=!1}=this.layer.getLayerConfig(),n={u_textSize:[1024,this.iconService.canvasHeight||128],u_raisingHeight:Number(e),u_heightfixed:Number(t),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(n);}initModels(){var e=this;return(0,i.default)(function*(){return e.iconService.on("imageUpdate",e.updateTexture),e.updateTexture(),e.buildModels();})();}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture);}buildModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"pointImage",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\nlayout(std140) uniform commonUniforms {\n  vec2 u_textSize;\n  float u_raisingHeight;\n  float u_heightfixed;\n};\n\nout vec4 v_color;\nout vec2 v_uv;\nout float v_opacity;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97\n  v_color = a_Color;\n  v_opacity = opacity;\n  v_uv = a_Uv;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\n\n  vec2 offset = project_pixel(offsets);\n\n  float raisingHeight = u_raisingHeight;\n  if (u_heightfixed < 1.0) {\n    // false\n    raisingHeight = project_pixel(u_raisingHeight);\n  } else {\n    if (\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n    ) {\n      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);\n      raisingHeight = u_raisingHeight * mapboxZoomScale;\n    }\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));\n\n  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'layout(std140) uniform commonUniforms {\n  vec2 u_textSize;\n  float u_raisingHeight;\n  float u_heightfixed;\n};\n\nuniform sampler2D u_texture;\n\nin vec4 v_color;\nin vec2 v_uv;\nin float v_opacity;\n\n#pragma include "picking"\n\nout vec4 outputColor;\n\nvoid main(){\n  vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;\n  vec4 textureColor;\n\n  // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6\n  \n  textureColor = texture(SAMPLER_2D(u_texture), pos);\n\n  // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697\n  float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);\n  if(fragmengTocenter >= 0.5) {\n        float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;\n        textureColor.a *= luma;\n  }\n  \n  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){\n        outputColor= textureColor;\n  }else {\n        outputColor= step(0.01, textureColor.z) * v_color;\n  }\n  outputColor.a *= v_opacity;\n  if (outputColor.a < 0.01) {\n      discard;\n  }\n  outputColor = filterColor(outputColor);\n}\n',triangulation:u.PointImageTriangulation,defines:e.getDefines(),inject:e.getInject(),depth:{enable:!1},primitive:s.gl.POINTS}))];})();}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:s.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:s.gl.DYNAMIC_DRAW,data:[],type:s.gl.FLOAT},size:1,update:e=>{let{size:t=5}=e;return Array.isArray(t)?[t[0]]:[t];}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:s.AttributeType.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:s.gl.DYNAMIC_DRAW,data:[],type:s.gl.FLOAT},size:2,update:e=>{let t=this.iconService.getIconMap(),{shape:n}=e,{x:r,y:i}=t[n]||{x:-64,y:-64};return[r,i];}}});}}},"9d431275":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{ButtonControl:function(){return r.ButtonControl;},Control:function(){return i.Control;},PopperControl:function(){return a.PopperControl;},PositionType:function(){return i.PositionType;},SelectControl:function(){return o.SelectControl;}});var r=n("3198c185"),i=n("9e4ac071"),a=n("8e0f3f05"),o=n("8e397f88");},"9d85763c":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("e6d4594c"));function i(e){var t,n,i,a,o,s,l,u,c=[],d=this._root;for(d&&c.push(new r.default(d,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=c.pop();)if(!e(d=t.node,i=t.x0,a=t.y0,o=t.z0,s=t.x1,l=t.y1,u=t.z1)&&d.length){var f=(i+s)/2,h=(a+l)/2,p=(o+u)/2;(n=d[7])&&c.push(new r.default(n,f,h,p,s,l,u)),(n=d[6])&&c.push(new r.default(n,i,h,p,f,l,u)),(n=d[5])&&c.push(new r.default(n,f,a,p,s,h,u)),(n=d[4])&&c.push(new r.default(n,i,a,p,f,h,u)),(n=d[3])&&c.push(new r.default(n,f,h,o,s,l,p)),(n=d[2])&&c.push(new r.default(n,i,h,o,f,l,p)),(n=d[1])&&c.push(new r.default(n,f,a,o,s,h,p)),(n=d[0])&&c.push(new r.default(n,i,a,o,f,h,p));}return this;}},"9da356db":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("0b7aa9a0")),a=r._(n("8bcb4c2b")),o=r._(n("cac9bafa")),s={raster:i.default,rasterRgb:a.default,raster3d:i.default,rasterTerrainRgb:o.default};},"9dd898ab":function(e,t,n){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2]);}return e.apply(t,n);};},"9deed87f":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("d812e418")),a=n("71293cfd"),o=r._(n("49ebc2f1"));class s{constructor(e,t){(0,i.default)(this,"width",void 0),(0,i.default)(this,"height",void 0),(0,i.default)(this,"grid",void 0),(0,i.default)(this,"viewportPadding",100),(0,i.default)(this,"screenRightBoundary",void 0),(0,i.default)(this,"screenBottomBoundary",void 0),(0,i.default)(this,"gridRightBoundary",void 0),(0,i.default)(this,"gridBottomBoundary",void 0),this.width=e,this.height=t,this.viewportPadding=Math.max(e,t),this.grid=new o.default(e+this.viewportPadding,t+this.viewportPadding,25),this.screenRightBoundary=e+this.viewportPadding,this.screenBottomBoundary=t+this.viewportPadding,this.gridRightBoundary=e+2*this.viewportPadding,this.gridBottomBoundary=t+2*this.viewportPadding;}placeCollisionBox(e){let t=e.x1+e.anchorPointX+this.viewportPadding,n=e.y1+e.anchorPointY+this.viewportPadding,r=e.x2+e.anchorPointX+this.viewportPadding,i=e.y2+e.anchorPointY+this.viewportPadding;return!this.isInsideGrid(t,n,r,i)||this.grid.hitTest(t,n,r,i)?{box:[]}:{box:[t,n,r,i]};}insertCollisionBox(e,t){this.grid.insert({featureIndex:t},e[0],e[1],e[2],e[3]);}project(e,t,n){let r=a.vec4.fromValues(t,n,0,1),i=a.vec4.create(),o=a.mat4.fromValues(...e);return a.vec4.transformMat4(i,r,o),{x:(i[0]/i[3]+1)/2*this.width+this.viewportPadding,y:(-i[1]/i[3]+1)/2*this.height+this.viewportPadding};}isInsideGrid(e,t,n,r){return n>=0&&e<this.gridRightBoundary&&r>=0&&t<this.gridBottomBoundary;}}},"9e4ac071":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{Control:function(){return u;},PositionType:function(){return o.PositionType;},default:function(){return u;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("d812e418")),o=n("d9b661b3"),s=n("fb1ec05a"),l=r._(n("f86d399e"));class u extends l.default{constructor(e){super(),(0,a.default)(this,"controlOption",void 0),(0,a.default)(this,"container",void 0),(0,a.default)(this,"isShow",void 0),(0,a.default)(this,"sceneContainer",void 0),(0,a.default)(this,"scene",void 0),(0,a.default)(this,"mapsService",void 0),(0,a.default)(this,"renderService",void 0),(0,a.default)(this,"layerService",void 0),(0,a.default)(this,"controlService",void 0),(0,a.default)(this,"configService",void 0),u.controlCount++,this.controlOption=(0,i.default)((0,i.default)({},this.getDefault(e)),e||{});}getOptions(){return this.controlOption;}setOptions(e){let t=this.getDefault(e);Object.entries(e).forEach(([n,r])=>{void 0===r&&(e[n]=t[n]);}),"position"in e&&this.setPosition(e.position),"className"in e&&this.setClassName(e.className),"style"in e&&this.setStyle(e.style),this.controlOption=(0,i.default)((0,i.default)({},this.controlOption),e);}addTo(e){this.mapsService=e.mapService,this.renderService=e.rendererService,this.layerService=e.layerService,this.controlService=e.controlService,this.configService=e.globalConfigService,this.scene=e.sceneService,this.sceneContainer=e,this.isShow=!0,this.container=this.onAdd(),s.DOM.addClass(this.container,"l7-control");let{className:t,style:n}=this.controlOption;return t&&this.setClassName(t),n&&this.setStyle(n),this.insertContainer(),this.emit("add",this),this;}remove(){if(!this.mapsService)return this;s.DOM.remove(this.container),this.onRemove(),this.emit("remove",this);}onAdd(){return s.DOM.create("div");}onRemove(){}show(){let e=this.container;s.DOM.removeClass(e,"l7-control--hide"),this.isShow=!0,this.emit("show",this);}hide(){let e=this.container;s.DOM.addClass(e,"l7-control--hide"),this.isShow=!1,this.emit("hide",this);}getDefault(e){return{position:o.PositionType.TOPRIGHT,name:`${u.controlCount}`};}getContainer(){return this.container;}getIsShow(){return this.isShow;}_refocusOnMap(e){if(this.mapsService&&e&&e.screenX>0&&e.screenY>0){let e=this.mapsService.getContainer();null!==e&&e.focus();}}setPosition(e=o.PositionType.TOPLEFT){let t=this.controlService;return t&&t.removeControl(this),this.controlOption.position=e,t&&t.addControl(this,this.sceneContainer),this;}setClassName(e){let t=this.container,{className:n}=this.controlOption;n&&s.DOM.removeClass(t,n),e&&s.DOM.addClass(t,e);}setStyle(e){let t=this.container;e?t.setAttribute("style",e):t.removeAttribute("style");}insertContainer(){let e=this.controlOption.position,t=this.container;if(e instanceof Element)e.appendChild(t);else{let n=this.controlService.controlCorners[e];["bottomleft","bottomright","righttop","rightbottom"].includes(e)?n.insertBefore(t,n.firstChild):n.appendChild(t);}}checkUpdateOption(e,t){return t.some(t=>t in e);}}(0,a.default)(u,"controlCount",0);},"9ec718eb":function(e,t,n){var r=n("ed2bf8a3");function i(e){var t={},n={},i=[];if(r.each(e.sinks(),function o(s){if(r.has(n,s))throw new a;r.has(t,s)||(n[s]=!0,t[s]=!0,r.each(e.predecessors(s),o),delete n[s],i.push(s));}),r.size(t)!==e.nodeCount())throw new a;return i;}function a(){}e.exports=i,i.CycleException=a,a.prototype=Error();},"9f537f33":function(e,t,n){var r=n("a59bcc62"),i=n("c34357ca")(function(e,t,n){r(e,t,n);});e.exports=i;},"9f6ac7d7":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"segmentToCubic",{enumerable:!0,get:function(){return o;}});var r=n("2abedd64"),i=n("395d808c"),a=n("b8bb490c");function o(e,t){var n,o=e[0],s=e.slice(1).map(Number),l=s[0],u=s[1],c=t.x1,d=t.y1,f=t.x,h=t.y;switch("TQ".includes(o)||(t.qx=null,t.qy=null),o){case"M":t.x=l,t.y=u;break;case"A":return n=[c,d].concat(s),["C"].concat((0,r.arcToCubic)(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9]));case"Q":return t.qx=l,t.qy=u,n=[c,d].concat(s),["C"].concat((0,i.quadToCubic)(n[0],n[1],n[2],n[3],n[4],n[5]));case"L":return["C"].concat((0,a.lineToCubic)(c,d,l,u));case"Z":if(c===f&&d===h)return["C",c,d,f,h,f,h];return["C"].concat((0,a.lineToCubic)(c,d,f,h));}return e;}},"9f6f6314":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=n("d9b661b3"),o=r._(n("755bc4f8")),s=n("f717bab4"),l=n("909eb2d3");class u extends o.default{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11});}getCommonUniformsInfo(){let{strokeOpacity:e=1,strokeWidth:t=0,blend:n,blur:r=0,raisingHeight:i=0,heightfixed:a=!1,unit:o="pixel"}=this.layer.getLayerConfig(),s=this.getAnimateUniforms().u_time;isNaN(s)&&(s=-1);let u={u_blur_height_fixed:[r,Number(i),Number(a)],u_stroke_width:t,u_additive:"additive"===n?1:0,u_stroke_opacity:e,u_size_unit:l.SizeUnitType[o],u_time:s,u_animate:this.getAnimateUniforms().u_animate};return this.getUniformsBufferInfo(u);}getAnimateUniforms(){let{animateOption:e={enable:!1}}=this.layer.getLayerConfig();return{u_animate:this.animateOption2Array(e),u_time:this.layer.getLayerAnimateTime()};}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),s.PointFillTriangulation);}initModels(){var e=this;return(0,i.default)(function*(){return e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){let{frag:t,vert:n,type:r}=e.getShaders();return e.layer.triangulation=s.PointFillTriangulation,e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:r,vertexShader:n,fragmentShader:t,defines:e.getDefines(),inject:e.getInject(),triangulation:s.PointFillTriangulation,depth:{enable:!1}}))];})();}getShaders(){return{frag:"\nlayout(std140) uniform commonUniforms {\n  vec3 u_blur_height_fixed;\n  float u_stroke_width;\n  float u_additive;\n  float u_stroke_opacity;\n  float u_size_unit;\n  float u_time;\n  vec4 u_animate;\n};\n\nin vec4 v_color;\nin vec4 v_stroke;\nin vec4 v_data;\nin float v_radius;\n\n#pragma include \"scene_uniforms\"\n#pragma include \"sdf_2d\"\n#pragma include \"picking\"\n\nout vec4 outputColor;\n\nvoid main() {\n  int shape = int(floor(v_data.w + 0.5));\n  lowp float antialiasblur = v_data.z;\n  float r = v_radius / (v_radius + u_stroke_width);\n\n  float outer_df;\n  float inner_df;\n  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'\n  if (shape == 0) {\n    outer_df = sdCircle(v_data.xy, 1.0);\n    inner_df = sdCircle(v_data.xy, r);\n  } else if (shape == 1) {\n    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);\n    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);\n  } else if (shape == 2) {\n    outer_df = sdBox(v_data.xy, vec2(1.));\n    inner_df = sdBox(v_data.xy, vec2(r));\n  } else if (shape == 3) {\n    outer_df = sdPentagon(v_data.xy, 0.8);\n    inner_df = sdPentagon(v_data.xy, r * 0.8);\n  } else if (shape == 4) {\n    outer_df = sdHexagon(v_data.xy, 0.8);\n    inner_df = sdHexagon(v_data.xy, r * 0.8);\n  } else if (shape == 5) {\n    outer_df = sdOctogon(v_data.xy, 1.0);\n    inner_df = sdOctogon(v_data.xy, r);\n  } else if (shape == 6) {\n    outer_df = sdHexagram(v_data.xy, 0.52);\n    inner_df = sdHexagram(v_data.xy, r * 0.52);\n  } else if (shape == 7) {\n    outer_df = sdRhombus(v_data.xy, vec2(1.0));\n    inner_df = sdRhombus(v_data.xy, vec2(r));\n  } else if (shape == 8) {\n    outer_df = sdVesica(v_data.xy, 1.1, 0.8);\n    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);\n  }\n\n  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);\n\n  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(\n    antialiasblur,\n    0.0,\n    inner_df\n  );\n\n  float PI = 3.14159;\n  float N_RINGS = 3.0;\n  float FREQ = 1.0;\n\n  if(u_stroke_width < 0.01) {\n    outputColor = v_color;\n  } else {\n    outputColor = mix(v_color, v_stroke * u_stroke_opacity, color_t);\n  }\n  float intensity = 1.0;\n  if(u_time!=-1.0){\n    //wave\u76F8\u5173\u903B\u8F91\n    float d = length(v_data.xy);\n    if(d > 0.5) {\n      discard;\n    }\n    intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);\n  }\n\n  if(u_additive > 0.0) {\n    outputColor *= opacity_t;\n    outputColor *= intensity;//wave\n    outputColor = filterColorAlpha(outputColor, outputColor.a);\n  } else {\n    outputColor.a *= opacity_t;\n    outputColor.a *= intensity;//wave \n    outputColor = filterColor(outputColor);\n  }\n   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20\n  if(outputColor.a < 0.01) {\n    discard;\n  } \n}\n",vert:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;\nlayout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;\n\nlayout(std140) uniform commonUniforms {\n  vec3 u_blur_height_fixed;\n  float u_stroke_width;\n  float u_additive;\n  float u_stroke_opacity;\n  float u_size_unit;\n  float u_time;\n  vec4 u_animate;\n};\n\nout vec4 v_color;\nout vec4 v_stroke;\nout vec4 v_data;\nout float v_radius;\n\n#pragma include "projection"\n#pragma include "picking"\n#pragma include "rotation_2d"\n\nvoid main() {\n  // \u900F\u660E\u5EA6\u8BA1\u7B97\n   v_stroke = stroke;\n  vec3 extrude = a_Extrude;\n  float shape_type = a_Shape;\n  /*\n  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F\n  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D\n  */\n  float newSize = setPickingSize(a_Size);\n  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;\n\n\n\n  // unpack color(vec2)\n  v_color = vec4(a_Color.xyz, a_Color.w * opacity);\n\n  if(u_size_unit == 1.0) {\n    newSize = newSize  * u_PixelsPerMeter.z;\n  }\n\n   v_radius = newSize;\n\n  // anti-alias\n  //  float antialiased_blur = -max(u_blur, antialiasblur);\n  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur_height_fixed.x);\n\n  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + u_offsets);\n\n  offset = project_pixel(offset);\n  offset = rotate_matrix(offset,rotation);\n\n  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F\n  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));\n\n  float raisingHeight = u_blur_height_fixed.y;\n\n  if(u_blur_height_fixed.z < 1.0) { // false\n    raisingHeight = project_pixel(u_blur_height_fixed.y);\n  } else {\n     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);\n      raisingHeight = u_blur_height_fixed.y * mapboxZoomScale;\n    }\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',type:"pointFill"};}animateOption2Array(e){return[e.enable?0:1,e.speed||1,e.rings||3,0];}registerBuiltinAttributes(){let e=this.layer.getLayerConfig().shape2d;this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:a.AttributeType.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:a.gl.DYNAMIC_DRAW,data:[],type:a.gl.FLOAT},size:3,update:(e,t,n,r)=>{let i=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],a=r%4*3;return[i[a],i[a+1],i[a+2]];}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:a.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:a.gl.DYNAMIC_DRAW,data:[],type:a.gl.FLOAT},size:1,update:e=>{let{size:t=5}=e;return Array.isArray(t)?[t[0]]:[t];}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:a.AttributeType.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:a.gl.DYNAMIC_DRAW,data:[],type:a.gl.FLOAT},size:1,update:t=>{let{shape:n=2}=t;return[e.indexOf(n)];}}});}}},"9fb0e475":function(e,t,n){var r=n("9dd898ab"),i=Math.max;e.exports=function(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var a=arguments,o=-1,s=i(a.length-t,0),l=Array(s);++o<s;)l[o]=a[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=a[o];return u[t]=n(l),r(e,this,u);};};},a056a353:function(e,t,n){var r=n("cc74f26d"),i=n("cdf1a659"),a=n("c0051812"),o=n("e3d5f8e1"),s=1/0,l=r?r.prototype:void 0,u=l?l.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(a(t))return i(t,e)+"";if(o(t))return u?u.call(t):"";var n=t+"";return"0"==n&&1/t==-s?"-0":n;};},a0767c5f:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"ScrollZoomHandler",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe")._(n("d812e418")),i=n("e31a659c"),a=n("5c93f055"),o=n("262c4dce"),s=n("f9562c3c"),l=n("42fc1d72");let u=1/450;class c{constructor(e,t){(0,r.default)(this,"_map",void 0),(0,r.default)(this,"_tr",void 0),(0,r.default)(this,"_enabled",void 0),(0,r.default)(this,"_active",void 0),(0,r.default)(this,"_zooming",void 0),(0,r.default)(this,"_aroundCenter",void 0),(0,r.default)(this,"_around",void 0),(0,r.default)(this,"_aroundPoint",void 0),(0,r.default)(this,"_type",void 0),(0,r.default)(this,"_lastValue",void 0),(0,r.default)(this,"_timeout",void 0),(0,r.default)(this,"_finishTimeout",void 0),(0,r.default)(this,"_lastWheelEvent",void 0),(0,r.default)(this,"_lastWheelEventTime",void 0),(0,r.default)(this,"_startZoom",void 0),(0,r.default)(this,"_targetZoom",void 0),(0,r.default)(this,"_delta",void 0),(0,r.default)(this,"_easing",void 0),(0,r.default)(this,"_prevEase",void 0),(0,r.default)(this,"_frameId",void 0),(0,r.default)(this,"_triggerRenderFrame",void 0),(0,r.default)(this,"_defaultZoomRate",void 0),(0,r.default)(this,"_wheelZoomRate",void 0),(0,r.default)(this,"_onTimeout",e=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e);}),this._map=e,this._tr=new l.TransformProvider(e),this._triggerRenderFrame=t,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=u;}setZoomRate(e){this._defaultZoomRate=e;}setWheelZoomRate(e){this._wheelZoomRate=e;}isEnabled(){return!!this._enabled;}isActive(){return!!this._active||void 0!==this._finishTimeout;}isZooming(){return!!this._zooming;}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around);}disable(){this.isEnabled()&&(this._enabled=!1);}wheel(e){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!e[this._map.cooperativeGestures._bypassKey])return;let t=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,n=o.browser.now(),r=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==t&&t%4.000244140625==0?this._type="wheel":0!==t&&4>Math.abs(t)?this._type="trackpad":r>400?(this._type=null,this._lastValue=t,this._timeout=setTimeout(this._onTimeout,40,e)):!this._type&&(this._type=200>Math.abs(r*t)?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,t+=this._lastValue)),e.shiftKey&&t&&(t/=4),this._type&&(this._lastWheelEvent=e,this._delta-=t,this._active||this._start(e)),e.preventDefault();}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let t=i.DOM.mousePos(this._map.getCanvasContainer(),e),n=this._tr;t.y>n.transform.height/2-n.transform.getHorizon()?this._around=a.LngLat.convert(this._aroundCenter?n.center:n.unproject(t)):this._around=a.LngLat.convert(n.center),this._aroundPoint=n.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame());}renderFrame(){let e;if(!this._frameId||(this._frameId=null,!this.isActive()))return;let t=this._tr.transform;if(0!==this._delta){let e="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,n=2/(1+Math.exp(-Math.abs(this._delta*e)));this._delta<0&&0!==n&&(n=1/n);let r="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(r*n))),"wheel"===this._type&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0;}let n="number"==typeof this._targetZoom?this._targetZoom:t.zoom,r=this._startZoom,i=this._easing,a=!1;if("wheel"===this._type&&r&&i){let t=Math.min((o.browser.now()-this._lastWheelEventTime)/200,1),l=i(t);e=s.interpolates.number(r,n,l),t<1?this._frameId||(this._frameId=!0):a=!0;}else e=n,a=!0;return this._active=!0,a&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout;},200)),{noInertia:!0,needsRenderFrame:!a,zoomDelta:e-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent};}_smoothOutEasing(e){let t=s.defaultEasing;if(this._prevEase){let e=this._prevEase,n=(o.browser.now()-e.start)/e.duration,r=e.easing(n+.01)-e.easing(n),i=.27/Math.sqrt(r*r+1e-4)*.01,a=Math.sqrt(.0729-i*i);t=(0,s.bezier)(i,a,.25,1);}return this._prevEase={start:o.browser.now(),duration:e,easing:t},t;}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);}}},a0845b89:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"Wind",{enumerable:!0,get:function(){return d;}});var r=n("777fffbe"),i=n("852bbaa9"),a=r._(n("d812e418")),o=i._(n("052092d4")),s=n("90197723");function l(e){let t=document.createElement("canvas"),n=t.getContext("2d");t.width=256,t.height=1;let r=n.createLinearGradient(0,0,256,0);for(let t of Object.keys(e))r.addColorStop(+t,e[+t]);return n.fillStyle=r,n.fillRect(0,0,256,1),t=null,new Uint8Array(n.getImageData(0,0,256,1).data);}function u(e,t,n,r){e.bindBuffer(e.ARRAY_BUFFER,t),e.enableVertexAttribArray(n),e.vertexAttribPointer(n,r,e.FLOAT,!1,0,0);}function c(e,t,n){e.bindFramebuffer(e.FRAMEBUFFER,t),n&&e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);}class d{constructor(e){(0,a.default)(this,"width",512),(0,a.default)(this,"height",512),(0,a.default)(this,"pixels",void 0),(0,a.default)(this,"fadeOpacity",void 0),(0,a.default)(this,"speedFactor",void 0),(0,a.default)(this,"dropRate",void 0),(0,a.default)(this,"dropRateBump",void 0),(0,a.default)(this,"gl",void 0),(0,a.default)(this,"drawProgram",void 0),(0,a.default)(this,"fullScreenProgram",void 0),(0,a.default)(this,"updateProgram",void 0),(0,a.default)(this,"rampColors",void 0),(0,a.default)(this,"numParticles",65536),(0,a.default)(this,"numParticlesSize",void 0),(0,a.default)(this,"particleStateResolution",void 0),(0,a.default)(this,"quadBuffer",void 0),(0,a.default)(this,"particleIndexBuffer",void 0),(0,a.default)(this,"framebuffer",void 0),(0,a.default)(this,"colorRampTexture",void 0),(0,a.default)(this,"backgroundTexture",void 0),(0,a.default)(this,"screenTexture",void 0),(0,a.default)(this,"particleStateTexture0",void 0),(0,a.default)(this,"particleStateTexture1",void 0),(0,a.default)(this,"windTexture",void 0),(0,a.default)(this,"windData",void 0),this.gl=e.glContext,this.width=e.imageWidth,this.height=e.imageHeight,this.fadeOpacity=e.fadeOpacity,this.speedFactor=e.speedFactor,this.dropRate=e.dropRate,this.dropRateBump=e.dropRateBump,this.rampColors=e.rampColors,this.init();}init(){let e=this.gl;this.fadeOpacity=.996,this.speedFactor=.25,this.dropRate=.003,this.dropRateBump=.01,this.drawProgram=o.createProgram(e,s.drawVert,s.drawFrag),this.fullScreenProgram=o.createProgram(e,s.fullScreenVert,s.fullScreenFrag),this.updateProgram=o.createProgram(e,s.updateVert,s.updateFrag),this.quadBuffer=o.createBuffer(e,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1])),this.framebuffer=e.createFramebuffer(),this.colorRampTexture=o.createTexture(this.gl,this.gl.LINEAR,l(this.rampColors),16,16);let t=new Uint8Array(this.width*this.height*4);this.backgroundTexture=o.createTexture(e,e.NEAREST,t,this.width,this.height),this.screenTexture=o.createTexture(e,e.NEAREST,t,this.width,this.height);let n=this.particleStateResolution=Math.ceil(Math.sqrt(this.numParticles));this.numParticlesSize=n*n;let r=new Uint8Array(4*this.numParticlesSize);for(let e=0;e<r.length;e++)r[e]=Math.floor(256*Math.random());this.particleStateTexture0=o.createTexture(e,e.NEAREST,r,n,n),this.particleStateTexture1=o.createTexture(e,e.NEAREST,r,n,n);let i=new Float32Array(this.numParticlesSize);for(let e=0;e<this.numParticlesSize;e++)i[e]=e;this.particleIndexBuffer=o.createBuffer(e,i);}setWind(e){this.windData=e,this.windTexture=o.createDataTexture(this.gl,this.gl.LINEAR,e.image);}updateParticelNum(e){let t=this.gl;if(e!==this.numParticles){this.numParticles=e;let n=this.particleStateResolution=Math.ceil(Math.sqrt(this.numParticles));this.numParticlesSize=n*n;let r=new Uint8Array(4*this.numParticlesSize);for(let e=0;e<r.length;e++)r[e]=Math.floor(256*Math.random());this.particleStateTexture0=o.createTexture(t,t.NEAREST,r,n,n),this.particleStateTexture1=o.createTexture(t,t.NEAREST,r,n,n);let i=new Float32Array(this.numParticlesSize);for(let e=0;e<this.numParticlesSize;e++)i[e]=e;this.particleIndexBuffer=o.createBuffer(t,i);}}updateWindDir(e,t,n,r){this.windData.uMin=e,this.windData.uMax=t,this.windData.vMin=n,this.windData.vMax=r;}updateColorRampTexture(e){if(this.isColorChanged(e)){this.rampColors=e;let t=this.gl;t.deleteTexture(this.colorRampTexture),this.colorRampTexture=o.createTexture(t,t.LINEAR,l(e),16,16);}}isColorChanged(e){for(let t of Object.keys(e)){let n=Number(t);if(!this.rampColors[n]||this.rampColors[n]&&this.rampColors[n]!==e[n])return!0;}return!1;}reSize(e,t){if(e!==this.width||t!==this.height){let n=this.gl;n.deleteTexture(this.backgroundTexture),n.deleteTexture(this.screenTexture),this.width=e,this.height=t;let r=new Uint8Array(e*t*4);this.backgroundTexture=o.createTexture(n,n.NEAREST,r,e,t),this.screenTexture=o.createTexture(n,n.NEAREST,r,e,t);}}draw(){var e;if(null===(e=this.windData)||void 0===e||!e.image)return{d:new Uint8Array([0,0,0,0]),w:1,h:1};{let e=this.gl;return o.bindTexture(e,this.windTexture,0),o.bindTexture(e,this.particleStateTexture0,1),this.drawScreen(),this.updateParticles(),{d:this.pixels,w:this.width,h:this.height};}}drawScreen(){let e=this.gl;c(e,this.framebuffer,this.screenTexture),e.viewport(0,0,this.width,this.height),e.disable(e.BLEND),this.drawFullTexture(this.backgroundTexture,this.fadeOpacity),this.drawParticles(),this.pixels=new Uint8Array(4*this.width*this.height),e.readPixels(0,0,this.width,this.height,e.RGBA,e.UNSIGNED_BYTE,this.pixels),c(e,null,null),e.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);let t=this.backgroundTexture;this.backgroundTexture=this.screenTexture,this.screenTexture=t;}drawFullTexture(e,t){let n=this.gl,r=this.fullScreenProgram;n.useProgram(r),n.bindBuffer(n.ARRAY_BUFFER,this.quadBuffer),n.vertexAttribPointer(r.a_pos,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(r.a_pos),n.bindBuffer(n.ARRAY_BUFFER,null),o.bindTexture(n,e,2),n.uniform1i(r.u_screen,2),n.uniform1f(r.u_opacity,t),n.drawArrays(n.TRIANGLES,0,6);}drawParticles(){let e=this.gl,t=this.drawProgram;e.useProgram(t),u(e,this.particleIndexBuffer,t.a_index,1),o.bindTexture(e,this.colorRampTexture,2),e.uniform1i(t.u_wind,0),e.uniform1i(t.u_particles,1),e.uniform1i(t.u_color_ramp,2),e.uniform1f(t.u_particles_res,this.particleStateResolution),e.uniform2f(t.u_wind_min,this.windData.uMin,this.windData.vMin),e.uniform2f(t.u_wind_max,this.windData.uMax,this.windData.vMax),e.drawArrays(e.POINTS,0,this.numParticlesSize);}updateParticles(){let e=this.gl;c(e,this.framebuffer,this.particleStateTexture1),e.viewport(0,0,this.particleStateResolution,this.particleStateResolution);let t=this.updateProgram;e.useProgram(t),u(e,this.quadBuffer,t.a_pos,2),e.uniform1i(t.u_wind,0),e.uniform1i(t.u_particles,1),e.uniform1f(t.u_rand_seed,Math.random()),e.uniform2f(t.u_wind_res,2*this.windData.image.width,2*this.windData.image.height),e.uniform2f(t.u_wind_min,this.windData.uMin,this.windData.vMin),e.uniform2f(t.u_wind_max,this.windData.uMax,this.windData.vMax),e.uniform1f(t.u_speed_factor,this.speedFactor),e.uniform1f(t.u_drop_rate,this.dropRate),e.uniform1f(t.u_drop_rate_bump,this.dropRateBump),e.drawArrays(e.TRIANGLES,0,6);let n=this.particleStateTexture0;this.particleStateTexture0=this.particleStateTexture1,this.particleStateTexture1=n,c(e,null,null);}destroy(){this.gl.deleteBuffer(this.quadBuffer),this.gl.deleteBuffer(this.particleIndexBuffer),this.gl.deleteFramebuffer(this.framebuffer),this.gl.deleteShader(this.drawProgram.vertexShader),this.gl.deleteShader(this.drawProgram.fragmentShader),this.gl.deleteProgram(this.drawProgram),this.gl.deleteShader(this.fullScreenProgram.vertexShader),this.gl.deleteShader(this.fullScreenProgram.fragmentShader),this.gl.deleteProgram(this.fullScreenProgram),this.gl.deleteShader(this.updateProgram.vertexShader),this.gl.deleteShader(this.updateProgram.fragmentShader),this.gl.deleteProgram(this.updateProgram),this.gl.deleteTexture(this.colorRampTexture),this.gl.deleteTexture(this.backgroundTexture),this.gl.deleteTexture(this.screenTexture),this.gl.deleteTexture(this.particleStateTexture0),this.gl.deleteTexture(this.particleStateTexture1),this.gl.deleteTexture(this.windTexture);}}},a0ccf4b6:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("2546cc51")),a=r._(n("bf81ff5c")),o=r._(n("e6577566"));function s(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new i.default;++t<n;)this.add(e[t]);}s.prototype.add=s.prototype.push=a.default,s.prototype.has=o.default;var l=s;},a12bb5bb:function(e,t,n){"use strict";function r(e){return Array.isArray(e);}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},a15d3715:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=n("d9b661b3"),s=n("fb1ec05a"),l=r._(n("755bc4f8")),u=n("f717bab4");class c extends l.default{constructor(...e){super(...e),(0,a.default)(this,"cityCenter",void 0),(0,a.default)(this,"cityMinSize",void 0);}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,UV:11});}getCommonUniformsInfo(){let{opacity:e=1,baseColor:t="rgb(16,16,16)",brightColor:n="rgb(255,176,38)",windowColor:r="rgb(30,60,89)",time:i=0,sweep:a={enable:!1,sweepRadius:1,sweepColor:"rgb(255, 255, 255)",sweepSpeed:.4,sweepCenter:this.cityCenter}}=this.layer.getLayerConfig(),o={u_baseColor:(0,s.rgb2arr)(t),u_brightColor:(0,s.rgb2arr)(n),u_windowColor:(0,s.rgb2arr)(r),u_circleSweepColor:[...(0,s.rgb2arr)(a.sweepColor).slice(0,3),1],u_cityCenter:a.sweepCenter||this.cityCenter,u_circleSweep:a.enable?1:0,u_cityMinSize:this.cityMinSize*a.sweepRadius,u_circleSweepSpeed:a.sweepSpeed,u_opacity:e,u_near:0,u_far:1,u_time:this.layer.getLayerAnimateTime()||i};return this.getUniformsBufferInfo(o);}calCityGeo(){let[e,t,n,r]=this.layer.getSource().extent;this.cityCenter=[(n+e)/2,(r+t)/2],this.cityMinSize=Math.sqrt(Math.pow(n-e,2)+Math.pow(r-t,2))/4;}initModels(){var e=this;return(0,i.default)(function*(){return e.calCityGeo(),e.initUniformsBuffer(),e.startModelAnimate(),e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){return[(yield e.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:'precision highp float;\n\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\nout vec2 v_texCoord;\nout vec4 v_Color;\nout float v_worldDis;\n\nlayout(std140) uniform commonUniforms {\n  vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];\n  vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];\n  vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];\n  vec4 u_circleSweepColor;\n  vec2 u_cityCenter;\n  float u_circleSweep;\n  float u_cityMinSize;\n  float u_circleSweepSpeed;\n  float u_opacity: 1.0;\n  float u_near : 0;\n  float u_far : 1;\n  float u_time;\n};\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\n\nvoid main() {\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);\n  vec4 project_pos = project_position(pos);\n\n   v_texCoord = a_Uv;\n\n  if(u_circleSweep > 0.0) {\n     vec2 lnglatscale = vec2(0.0);\n    lnglatscale = (a_Position.xy - u_cityCenter) * vec2(0.0, 0.135);\n    v_worldDis = length(a_Position.xy + lnglatscale - u_cityCenter);\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  float lightWeight = calc_lighting(pos);\n  // v_Color = a_Color;\n  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'precision highp float;\nlayout(std140) uniform commonUniforms {\n  vec4 u_baseColor: [ 1.0, 0, 0, 1.0 ];\n  vec4 u_brightColor: [ 1.0, 0, 0, 1.0 ];\n  vec4 u_windowColor: [ 1.0, 0, 0, 1.0 ];\n  vec4 u_circleSweepColor;\n  vec2 u_cityCenter;\n  float u_circleSweep;\n  float u_cityMinSize;\n  float u_circleSweepSpeed;\n  float u_opacity: 1.0;\n  float u_near: 0;\n  float u_far: 1;\n  float u_time;\n};\nin vec4 v_Color;\nin vec2 v_texCoord;\nin float v_worldDis;\nout vec4 outputColor;\n\n#pragma include "picking"\n#pragma include "scene_uniforms"\n\nvec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {\n    float s = step(hot, n);\n    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);\n\n    return mix(darkColor, color, s);\n}\nfloat random (vec2 st) {\n    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);\n}\n\nfloat LinearizeDepth()\n{\n    float z = gl_FragCoord.z * 2.0 - 1.0;\n    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));\n}\n\nvec3 fog(vec3 color, vec3 fogColor, float depth){\n    float fogFactor=clamp(depth,0.0,1.0);\n    vec3 output_color=mix(fogColor,color,fogFactor);\n    return output_color;\n}\n\nfloat sdRect(vec2 p, vec2 sz) {\n  vec2 d = abs(p) - sz;\n  float outside = length(max(d, 0.));\n  float inside = min(max(d.x, d.y), 0.);\n  return outside + inside;\n}\n\nvoid main() {\n  outputColor = v_Color;\n  vec3 baseColor = u_baseColor.xyz;\n  vec3 brightColor = u_brightColor.xyz;\n  vec3 windowColor = u_windowColor.xyz;\n  float targetColId = 5.;\n  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;\n  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);\n  if(v_texCoord.x < 0.) { //\u9876\u90E8\u989C\u8272\n       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);\n       outputColor = vec4( foggedColor, v_Color.w);\n  }else { // \u4FA7\u9762\u989C\u8272\n        vec2 st = v_texCoord;\n        vec2  UvScale = v_texCoord;\n        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));\n        float tStart = 0.25 * tStep;\n        float tEnd = 0.75 * tStep;\n        float u = mod(UvScale.x, tStep);\n        float v = mod(UvScale.y, tStep);\n        float ux = floor(UvScale.x/tStep);\n        float uy = floor(UvScale.y/tStep);\n        float n = random(vec2(ux,uy));\n        float lightP = u_time;\n        float head = 1.0- step(0.005,st.y);\n        /*step3*/\n        // \u5C06\u7A97\u6237\u989C\u8272\u548C\u5899\u9762\u989C\u8272\u533A\u522B\u5F00\u6765\n        float sU = step(tStart, u) - step(tEnd, u);\n        float sV = step(tStart, v) - step(tEnd, v);\n        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));\n        float dist = sdRect(vec2(u,v), windowSize);\n        float s = sU * sV;\n\n        float curColId = floor(UvScale.x / tStep);\n        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);\n\n        float mLightP = mod(lightP, 2.);\n        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);\n        if(ux == targetColId){\n            n =0.;\n        }\n        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );\n        float hot = smoothstep(1.0,0.0,timeP);\n        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);\n        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);\n        float sFinal = s * sCol * sRow;\n        color += mix(baseColor, brightColor, sFinal*n);\n        if (st.y<0.01){\n        color = baseColor;\n         }\n        if(head ==1.0) { // \u9876\u90E8\u4EAE\u7EBF\n            color = brightColor;\n        }\n        color = color * v_Color.rgb;\n\n        vec3 foggedColor = fog(color,fogColor,depth);\n\n        outputColor = vec4(foggedColor,1.0);\n  }\n\n\n  if(u_circleSweep > 0.0 && v_worldDis < u_cityMinSize) {\n    float r = fract(((v_worldDis/u_cityMinSize) - u_time * u_circleSweepSpeed) * 2.0);\n    outputColor.rgb += r * r * u_circleSweepColor.rgb;\n  }\n\n  outputColor.a *= u_opacity;\n  outputColor = filterColor(outputColor);\n}\n',triangulation:u.PolygonExtrudeTriangulation,depth:{enable:!0},defines:e.getDefines(),inject:e.getInject(),cull:{enable:!0,face:o.gl.BACK}}))];})();}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:o.AttributeType.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:o.gl.STATIC_DRAW,data:[],type:o.gl.FLOAT},size:3,update:(e,t,n,r,i)=>i}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:o.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:1,update:e=>{let{size:t=10}=e;return Array.isArray(t)?[t[0]]:[t];}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:o.AttributeType.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:2,update:(e,t,n)=>[n[3],n[4]]}});}}},a164e3cf:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("a12bb5bb")),a=r._(n("10576492")),o=function(e,t){if((0,i.default)(e)){for(var n,r=1/0,o=0;o<e.length;o++){var s=e[o],l=(0,a.default)(t)?t(s):s[t];l<r&&(n=s,r=l);}return n;}};},a1904b18:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("daaa1548"));class i{apply(e){e.hooks.beforeRender.tap("LayerAnimateStylePlugin",()=>{e.animateStatus&&e.models.forEach(t=>{t.addUniforms((0,r.default)({},e.layerModel.getAnimateUniforms()));});});}}},a2265026:function(e,t,n){var r=n("cc74f26d"),i=r?r.prototype:void 0,a=i?i.valueOf:void 0;e.exports=function(e){return a?Object(a.call(e)):{};};},a23dcf43:function(e,t,n){var r=n("8d15a3f4"),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n;}return i.call(t,e)?t[e]:void 0;};},a24d4a8c:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{clone:function(){return f.default;},isArray:function(){return i.default;},isBoolean:function(){return a.default;},isEqual:function(){return h.default;},isFunction:function(){return o.default;},isNumber:function(){return s.default;},isObject:function(){return l.default;},isPlainObject:function(){return u.default;},isString:function(){return c.default;},isUndefined:function(){return d.default;},omit:function(){return p.default;},uniqueId:function(){return v.default;}});var r=n("777fffbe");n("1ca82f45"),n("91904a29"),n("966a4071"),n("2c8d9d54"),n("d5fb2cc8"),n("1a978c65"),n("0c1d8df4"),n("45716cfa"),n("e791d475"),n("1ae5fa66"),n("95189ca1"),n("80e60ee8");var i=r._(n("318fb8cd")),a=r._(n("dd879316")),o=r._(n("cf7441db")),s=r._(n("296a0a99")),l=r._(n("ccff5790")),u=r._(n("6c35bac1"));n("89eaa0ba");var c=r._(n("b5d377d5")),d=r._(n("d3ed11ba")),f=r._(n("76cd0fdf"));n("fd305af2");var h=r._(n("b9b0b89a"));n("10ffe1f0");var p=r._(n("62396a98")),v=r._(n("2da13b12"));n("2942ce4b"),n("4faea429"),n("32c3612d");},a2981759:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("99ff515c"));function i(e){if((0,r.default)(e))return e[e.length-1];}},a2a19376:function(e,t,n){var r=n("ef51a61d"),i=n("f28dfa76");e.exports=function(e){return i(e)&&"[object Map]"==r(e);};},a2fd0fbe:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("f89fb776")),o=r._(n("bec2d0e3")),s=n("462c8966");class l extends o.default{initTileLayer(){var e=this;return(0,a.default)(function*(){let t=e.parent.getLayerAttributeConfig(),n=e.getLayerOptions(),r=(0,s.getTileLayer)(e.parent.type),a=e.getSourceOption();if(!a){e.isLoaded=!0,e.emit("loaded");return;}let o=new r((0,i.default)({},n)).source(a.data,a.options);Object.keys(t).forEach(e=>{var n,r;o[e](null===(n=t[e])||void 0===n?void 0:n.field,null===(r=t[e])||void 0===r?void 0:r.values);}),yield e.addLayer(o),n.tileMask&&(yield e.addTileMask()),e.setLayerMinMaxZoom(o),e.isLoaded=!0,e.emit("loaded");})();}getSourceOption(){let e=this.parent.getSource(),{sourceLayer:t="defaultLayer",featureId:n="id"}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(t)},options:{parser:{type:"geojson",featureId:n},transforms:e.transforms}};}setLayerMinMaxZoom(e){"text"===e.getModelType()&&e.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1});}getFeatures(e){return this.sourceTile.data.getTileData(e);}getFeatureById(e){let t=this.getMainLayer();return t?t.getSource().data.dataArray.filter(t=>t._id===e):[];}}},a32673e9:function(e,t,n){"use strict";function r(e){return e instanceof Date;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},a326d8ee:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"GraphView",{enumerable:!0,get:function(){return a;}});var r=n("083a713c");let i=()=>!0;class a{graph;nodeFilter;edgeFilter;cacheEnabled;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;allNodesMap=new Map;allEdgesMap=new Map;constructor(e){this.graph=e.graph;let t=e.nodeFilter||i,n=e.edgeFilter||i;this.nodeFilter=t,this.edgeFilter=e=>{let{source:r,target:i}=this.graph.getEdgeDetail(e.id);return!!(t(r)&&t(i))&&n(e,r,i);},"auto"===e.cache?(this.cacheEnabled=!0,this.startAutoCache()):"manual"===e.cache?this.cacheEnabled=!0:this.cacheEnabled=!1;}clearCache=()=>{this.inEdgesMap.clear(),this.outEdgesMap.clear(),this.bothEdgesMap.clear(),this.allNodesMap.clear(),this.allEdgesMap.clear();};refreshCache=()=>{this.clearCache(),this.updateCache(this.graph.getAllNodes().map(e=>e.id));};updateCache=e=>{let t=new Set;e.forEach(e=>{let n=this.bothEdgesMap.get(e);if(n&&n.forEach(e=>t.add(e.id)),this.hasNode(e)){let n=this.graph.getRelatedEdges(e,"in").filter(this.edgeFilter),r=this.graph.getRelatedEdges(e,"out").filter(this.edgeFilter),i=Array.from(new Set([...n,...r]));i.forEach(e=>t.add(e.id)),this.inEdgesMap.set(e,n),this.outEdgesMap.set(e,r),this.bothEdgesMap.set(e,i),this.allNodesMap.set(e,this.graph.getNode(e));}else this.inEdgesMap.delete(e),this.outEdgesMap.delete(e),this.bothEdgesMap.delete(e),this.allNodesMap.delete(e);}),t.forEach(e=>{this.hasEdge(e)?this.allEdgesMap.set(e,this.graph.getEdge(e)):this.allEdgesMap.delete(e);});};startAutoCache(){this.refreshCache(),this.graph.on("changed",this.handleGraphChanged);}stopAutoCache(){this.graph.off("changed",this.handleGraphChanged);}handleGraphChanged=e=>{let t=new Set;e.changes.forEach(n=>{switch(n.type){case"NodeAdded":case"NodeRemoved":t.add(n.value.id);break;case"NodeDataUpdated":t.add(n.id);break;case"EdgeAdded":case"EdgeRemoved":t.add(n.value.source),t.add(n.value.target);break;case"EdgeUpdated":("source"===n.propertyName||"target"===n.propertyName)&&(t.add(n.oldValue),t.add(n.newValue));break;case"EdgeDataUpdated":if(e.graph.hasEdge(n.id)){let r=e.graph.getEdge(n.id);t.add(r.source),t.add(r.target);}}}),this.updateCache(t);};checkNodeExistence(e){this.getNode(e);}hasNode(e){if(!this.graph.hasNode(e))return!1;let t=this.graph.getNode(e);return this.nodeFilter(t);}areNeighbors(e,t){return this.checkNodeExistence(e),this.getNeighbors(t).some(t=>t.id===e);}getNode(e){let t=this.graph.getNode(e);if(!this.nodeFilter(t))throw Error("Node not found for id: "+e);return t;}getRelatedEdges(e,t){return(this.checkNodeExistence(e),this.cacheEnabled)?"in"===t?this.inEdgesMap.get(e):"out"===t?this.outEdgesMap.get(e):this.bothEdgesMap.get(e):this.graph.getRelatedEdges(e,t).filter(this.edgeFilter);}getDegree(e,t){return this.getRelatedEdges(e,t).length;}getSuccessors(e){return Array.from(new Set(this.getRelatedEdges(e,"out").map(e=>this.getNode(e.target))));}getPredecessors(e){return Array.from(new Set(this.getRelatedEdges(e,"in").map(e=>this.getNode(e.source))));}getNeighbors(e){return Array.from(new Set([...this.getPredecessors(e),...this.getSuccessors(e)]));}hasEdge(e){if(!this.graph.hasEdge(e))return!1;let t=this.graph.getEdge(e);return this.edgeFilter(t);}getEdge(e){let t=this.graph.getEdge(e);if(!this.edgeFilter(t))throw Error("Edge not found for id: "+e);return t;}getEdgeDetail(e){let t=this.getEdge(e);return{edge:t,source:this.getNode(t.source),target:this.getNode(t.target)};}hasTreeStructure(e){return this.graph.hasTreeStructure(e);}getRoots(e){return this.graph.getRoots(e).filter(this.nodeFilter);}getChildren(e,t){return this.checkNodeExistence(e),this.graph.getChildren(e,t).filter(this.nodeFilter);}getParent(e,t){this.checkNodeExistence(e);let n=this.graph.getParent(e,t);return n&&this.nodeFilter(n)?n:null;}getAllNodes(){return this.cacheEnabled?Array.from(this.allNodesMap.values()):this.graph.getAllNodes().filter(this.nodeFilter);}getAllEdges(){return this.cacheEnabled?Array.from(this.allEdgesMap.values()):this.graph.getAllEdges().filter(this.edgeFilter);}bfs(e,t,n="out"){let i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];(0,r.doBFS)([this.getNode(e)],new Set,t,i);}dfs(e,t,n="out"){let i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];(0,r.doDFS)(this.getNode(e),new Set,t,i);}}},a3290df2:function(e,t,n){var r=n("d26a46d3");e.exports=function(){this.__data__=new r,this.size=0;};},a3cf44d4:function(e,t,n){"use strict";function r(e){if(!Array.isArray(e))return-1/0;var t=e.length;if(!t)return-1/0;for(var n=e[0],r=1;r<t;r++)n=Math.max(n,e[r]);return n;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},a3dd5781:function(e,t,n){var r=n("7bc08ef6")(n("d9782b0d"));e.exports=r;},a40f740e:function(e,t,n){var r=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;e.exports=function(e){return e.match(r)||[];};},a420544c:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("6f26c977")),a=r._(n("0a498565")),o=function(e,t,n,r){var o=!n;n||(n={});for(var s=-1,l=t.length;++s<l;){var u=t[s],c=r?r(n[u],e[u],u,n,e):void 0;void 0===c&&(c=e[u]),o?(0,a.default)(n,u,c):(0,i.default)(n,u,c);}return n;};},a429c6c2:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"createPlugins",{enumerable:!0,get:function(){return y;}});var r=n("777fffbe"),i=r._(n("bb876d30")),a=r._(n("4310d456")),o=r._(n("ef3d4035")),s=r._(n("a1904b18")),l=r._(n("add2c496")),u=r._(n("8bacc570")),c=r._(n("452b1871")),d=r._(n("21e77288")),f=r._(n("b420e563")),h=r._(n("7c60386d")),p=r._(n("6e5d3338")),v=r._(n("6bec070f")),g=r._(n("02f1c5d2")),m=r._(n("72c06be7"));function y(){return[new a.default,new p.default,new o.default,new i.default,new c.default,new l.default,new m.default,new g.default,new f.default,new v.default,new s.default,new d.default,new h.default,new u.default];}},a483b73f:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){var t=typeof e;return null!==e&&"object"===t||"function"===t;};},a4875846:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"DragPanHandler",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("d812e418"));class i{constructor(e,t,n){(0,r.default)(this,"_el",void 0),(0,r.default)(this,"_mousePan",void 0),(0,r.default)(this,"_touchPan",void 0),(0,r.default)(this,"_inertiaOptions",void 0),this._el=e,this._mousePan=t,this._touchPan=n;}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("l7-touch-drag-pan");}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("l7-touch-drag-pan");}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled();}isActive(){return this._mousePan.isActive()||this._touchPan.isActive();}}},a4d2d296:function(e,t,n){"use strict";function r(e){let t=+this._x.call(null,e);return i(this.cover(t),t,e);}function i(e,t,n){if(isNaN(t))return e;var r,i,a,o,s,l,u=e._root,c={data:n},d=e._x0,f=e._x1;if(!u)return e._root=c,e;for(;u.length;)if((o=t>=(i=(d+f)/2))?d=i:f=i,r=u,!(u=u[s=+o]))return r[s]=c,e;if(t===(a=+e._x.call(null,u.data)))return c.next=u,r?r[s]=c:e._root=c,e;do r=r?r[s]=[,,]:e._root=[,,],(o=t>=(i=(d+f)/2))?d=i:f=i;while((s=+o)==(l=+(a>=i)))return r[l]=u,r[s]=c,e;}function a(e){Array.isArray(e)||(e=Array.from(e));let t=e.length,n=new Float64Array(t),r=1/0,a=-1/0;for(let i=0,o;i<t;++i)!isNaN(o=+this._x.call(null,e[i]))&&(n[i]=o,o<r&&(r=o),o>a&&(a=o));if(r>a)return this;this.cover(r).cover(a);for(let r=0;r<t;++r)i(this,n[r],e[r]);return this;}n.d(t,"__esModule",{value:!0}),n.e(t,{addAll:function(){return a;},default:function(){return r;}});},a5305083:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("6cd126a9")),i=function(e,t,n){for(var i=0,a=(0,r.default)(t)?t.split("."):t;e&&i<a.length;)e=e[a[i++]];return void 0===e||i<a.length?n:e;};},a556cf14:function(e,t,n){"use strict";function r(e){return function(){return e;};}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},a56c16a1:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("a24d4a8c"),n("56792f9b"),n("90d6521d"),n("fcdc9f66");},a59bcc62:function(e,t,n){var r=n("860e2ef1"),i=n("c1797885"),a=n("ddf11daa"),o=n("f86eb389"),s=n("7c1db5f7"),l=n("baa3a209"),u=n("decf5ea9");e.exports=function e(t,n,c,d,f){t!==n&&a(n,function(a,l){if(f||(f=new r),s(a))o(t,n,l,c,e,d,f);else{var h=d?d(u(t,l),a,l+"",t,n,f):void 0;void 0===h&&(h=a),i(t,l,h);}},l);};},a5ba8ec1:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("daaa1548")),o=r._(n("d812e418")),s=n("d9b661b3"),l=r._(n("755bc4f8")),u=n("f717bab4");class c extends l.default{constructor(...e){super(...e),(0,o.default)(this,"texture",void 0);}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,EXTRUSION_BASE:11});}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,a.default)((0,a.default)({},e.uniformsOption),t.uniformsOption);}getCommonUniformsInfo(){return this.getUniformsBufferInfo({});}initModels(){var e=this;return(0,i.default)(function*(){return e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){let{frag:t,vert:n,type:r}=e.getShaders();return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:r,vertexShader:n,fragmentShader:t,defines:e.getDefines(),inject:e.getInject(),triangulation:u.PolygonExtrudeTriangulation,depth:{enable:!0}}))];})();}getShaders(){return{frag:'\nin vec4 v_Color;\n#pragma include "scene_uniforms"\n#pragma include "picking"\nout vec4 outputColor;\nvoid main() {\n\n  outputColor = v_Color;\n  outputColor = filterColor(outputColor);\n}\n',vert:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\n\nout vec4 v_Color;\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size + (1.0 - a_Position.z) * extrusionBase, 1.0);\n\n  vec4 project_pos = project_position(pos, a_Position64Low);\n  float lightWeight = calc_lighting(project_pos);\n  v_Color = a_Color;\n  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',type:"polygonExtrude"};}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy();}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"normal",type:s.AttributeType.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:s.gl.STATIC_DRAW,data:[],type:s.gl.FLOAT},size:3,update:(e,t,n,r,i)=>i}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:s.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:s.gl.DYNAMIC_DRAW,data:[],type:s.gl.FLOAT},size:1,update:e=>{let{size:t=10}=e;return Array.isArray(t)?[t[0]]:[t];}}}),this.styleAttributeService.registerStyleAttribute({name:"extrusionBase",type:s.AttributeType.Attribute,descriptor:{name:"a_ExtrusionBase",shaderLocation:this.attributeLocation.EXTRUSION_BASE,buffer:{usage:s.gl.STATIC_DRAW,data:[],type:s.gl.FLOAT},size:1,update:e=>{let{extrusionBase:t=0}=e;return[t];}}});}}},a6000239:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0});var r=n("777fffbe")._(n("9499af61"));!function(){function e(e){void 0===e&&(e=10),this.linkedList=new r.default,this.maxStep=e;}Object.defineProperty(e.prototype,"length",{get:function(){return this.linkedList.toArray().length;},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return!this.linkedList.head;},e.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep;},e.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value;},e.prototype.push=function(e){this.linkedList.prepend(e),this.length>this.maxStep&&this.linkedList.deleteTail();},e.prototype.pop=function(){var e=this.linkedList.deleteHead();return e?e.value:null;},e.prototype.toArray=function(){return this.linkedList.toArray().map(function(e){return e.value;});},e.prototype.clear=function(){for(;!this.isEmpty();)this.pop();};}();},a60993e0:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return f;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=r._(n("4ce96d25")),s=r._(n("126c0ad9")),l=r._(n("d3006e59")),u=r._(n("19783d72"));let c={base:l.default,atomSphere:s.default,bloomSphere:u.default},d=["base","atomSphere","bloomSphere"];class f extends o.default{constructor(...e){super(...e),(0,a.default)(this,"type","EarthLayer"),(0,a.default)(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}});}buildModels(){var e=this;return(0,i.default)(function*(){let t=e.getModelType();e.layerModel=new c[t](e),yield e.initLayerModels();})();}setEarthTime(e){this.layerModel&&this.layerModel.setEarthTime?this.layerModel.setEarthTime(e):console.warn("\u8BF7\u5728 scene loaded \u4E4B\u540E\u6267\u884C\u8BE5\u65B9\u6CD5\uFF01");}getModelType(){var e;let t=this.styleAttributeService.getLayerStyleAttribute("shape"),n=(null==t||null===(e=t.scale)||void 0===e?void 0:e.field)||"base";return 0>d.indexOf(n)&&(n="base"),n;}}},a6555055:function(e,t,n){var r=n("e777c749"),i=n("10e0f52e");e.exports=function(e,t){return null!=e&&i(e,t,r);};},a660bda5:function(e,t,n){var r,i=n("268fe8f9"),a=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!a&&a in e;};},a665ba30:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=n("d9b661b3"),o=n("fb1ec05a"),s=r._(n("755bc4f8")),l=n("f717bab4");class u extends s.default{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9});}getCommonUniformsInfo(){let{sourceColor:e,targetColor:t,lineType:n="solid",dashArray:r=[10,5,0,0],vertexHeightScale:i=20}=this.layer.getLayerConfig(),a=r;"dash"!==n&&(a=[0,0,0,0]),2===a.length&&a.push(0,0);let s=0,l=[0,0,0,0],u=[0,0,0,0];e&&t&&(l=(0,o.rgb2arr)(e),u=(0,o.rgb2arr)(t),s=1);let c={u_sourceColor:l,u_targetColor:u,u_dash_array:a,u_vertexScale:i,u_linearColor:s};return this.getUniformsBufferInfo(c);}initModels(){var e=this;return(0,i.default)(function*(){return e.buildModels();})();}getShaders(){return{frag:"\nlayout(std140) uniform commonUniorm {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec4 u_dash_array;\n  float u_vertexScale: 1.0;\n  float u_linearColor: 0;\n};\nin float v_distanceScale;\nin vec4 v_color;\n//dash\nin vec4 v_dash_array;\n\nout vec4 outputColor;\nvoid main() {\n  if(u_dash_array!=vec4(0.0)){\n    float dashLength = mod(v_distanceScale, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {\n      // \u865A\u7EBF\u90E8\u5206\n      discard;\n    };\n  }\n  if(u_linearColor==1.0){\n    outputColor = mix(u_sourceColor, u_targetColor, v_distanceScale);\n    outputColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6\n  }\n  else{\n    outputColor = v_color;\n  }\n}\n",vert:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in vec4 a_SizeDistanceAndTotalDistance;\n\nlayout(std140) uniform commonUniorm {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec4 u_dash_array;\n  float u_vertexScale: 1.0;\n  float u_linearColor: 0;\n};\n\n#pragma include "projection"\n#pragma include "picking"\n\nout vec4 v_color;\nout float v_distanceScale;\nout vec4 v_dash_array;\n\nvoid main() {\n  //dash\u8F93\u51FA\n  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_SizeDistanceAndTotalDistance.a;\n\n  v_color = a_Color;\n  v_distanceScale = a_SizeDistanceAndTotalDistance.b / a_SizeDistanceAndTotalDistance.a;\n  v_color.a = v_color.a * opacity;\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);\n\n  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5\n\n  float lineHeight = a_SizeDistanceAndTotalDistance.y;\n  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4\n  if (\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n  ) {\n    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8\n    h *= 2.0 / pow(2.0, 20.0 - u_Zoom);\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));\n  gl_PointSize = 10.0;\n\n}\n',type:"lineSimpleNormal"};}buildModels(){var e=this;return(0,i.default)(function*(){e.initUniformsBuffer();let{frag:t,vert:n,type:r}=e.getShaders();return[(yield e.layer.buildLayerModel({moduleName:r,vertexShader:n,fragmentShader:t,triangulation:l.SimpleLineTriangulation,defines:e.getDefines(),inject:e.getInject(),primitive:a.gl.LINES,depth:{enable:!1},pick:!1}))];})();}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"sizeDistanceAndTotalDistance",type:a.AttributeType.Attribute,descriptor:{name:"a_SizeDistanceAndTotalDistance",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:a.gl.STATIC_DRAW,data:[],type:a.gl.FLOAT},size:4,update:(e,t,n)=>{let{size:r=1}=e,i=Array.isArray(r)?[r[0],r[1]]:[r,0];return[i[0],i[1],n[3],n[5]];}}});}}},a684d625:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("fe2236de")),a=r._(n("416bfed3")),o=function(e,t,n){var r=t(e);return(0,a.default)(e)?r:(0,i.default)(r,n(e));};},a68aa674:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("d812e418")),i=n("71293cfd");class a{constructor(){(0,r.default)(this,"xzReg",-(.6*Math.PI)),(0,r.default)(this,"yReg",.2*Math.PI),(0,r.default)(this,"earthCameraRadius",200),(0,r.default)(this,"earthCameraZoom",1),(0,r.default)(this,"cameraPosition",i.vec3.create()),(0,r.default)(this,"viewport",void 0),(0,r.default)(this,"projectionMatrix",i.mat4.create()),(0,r.default)(this,"modelMatrix",i.mat4.create()),(0,r.default)(this,"viewMatrix",i.mat4.create()),(0,r.default)(this,"viewProjectionMatrix",i.mat4.create()),(0,r.default)(this,"ViewProjectionMatrixUncentered",i.mat4.create()),(0,r.default)(this,"viewUncenteredMatrix",i.mat4.create());}syncWithMapCamera(e){let{viewportHeight:t=1,viewportWidth:n=1}=e;i.mat4.perspective(this.projectionMatrix,20,n/t,.1,1e4);let r=this.earthCameraRadius*Math.cos(this.xzReg),a=this.earthCameraRadius*Math.sin(this.xzReg),o=this.earthCameraRadius*Math.sin(this.yReg);this.cameraPosition=i.vec3.fromValues(r,o,a),i.vec3.normalize(this.cameraPosition,this.cameraPosition),i.vec3.multiply(this.cameraPosition,this.cameraPosition,i.vec3.fromValues(this.earthCameraRadius,this.earthCameraRadius,this.earthCameraRadius)),i.vec3.scale(this.cameraPosition,this.cameraPosition,this.earthCameraZoom);let s=i.vec3.create();i.vec3.cross(s,this.cameraPosition,i.vec3.fromValues(0,1,0));let l=i.vec3.fromValues(0,1,0);i.vec3.cross(l,s,this.cameraPosition);let u=i.vec3.fromValues(0,0,0);i.mat4.lookAt(this.viewMatrix,this.cameraPosition,u,l),this.viewUncenteredMatrix=i.mat4.clone(this.viewMatrix),i.mat4.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),i.mat4.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix);}rotateY(e){this.xzReg+=e*Math.min(this.earthCameraZoom*this.earthCameraZoom,1);}rotateX(e){this.yReg+=e*Math.min(this.earthCameraZoom*this.earthCameraZoom,1);}scaleZoom(e){this.earthCameraZoom+=e,this.earthCameraZoom=Math.max(this.earthCameraZoom,.6);}getZoom(){return 4;}getZoomScale(){return Math.pow(2,this.getZoom());}getCenter(){return[0,0];}getProjectionMatrix(){return this.projectionMatrix;}getModelMatrix(){return this.modelMatrix;}getViewMatrix(){return this.viewMatrix;}getViewMatrixUncentered(){return this.viewMatrix;}getViewProjectionMatrix(){return this.viewProjectionMatrix;}getViewProjectionMatrixUncentered(){return this.viewProjectionMatrix;}getFocalDistance(){return 1;}projectFlat(e,t){return this.viewport.projectFlat(e,t);}}},a69098c0:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return g;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("b131ee44")),o=r._(n("f89fb776")),s=r._(n("d812e418")),l=n("71293cfd"),u=r._(n("6918a40e")),c=n("aab06fd5"),d=r._(n("4f2bad25")),f=n("0e8eb136"),h=r._(n("80dad29a"));let p=["id","attributionControl","style","rotation","mapInstance"];!function(e,t){var n="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,r="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram);if(!n&&!r&&(t||(t=document),t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i);}var o=t.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o);}}(".maplibregl-map{-webkit-tap-highlight-color:rgb(0 0 0/0);font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative}.maplibregl-canvas{left:0;position:absolute;top:0}.maplibregl-map:-moz-full-screen{height:100%;width:100%}.maplibregl-map:-ms-fullscreen{height:100%;width:100%}.maplibregl-map:fullscreen{height:100%;width:100%}.maplibregl-ctrl-group button.maplibregl-ctrl-compass{touch-action:none}.maplibregl-canvas-container.maplibregl-interactive,.maplibregl-ctrl-group button.maplibregl-ctrl-compass{cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.maplibregl-canvas-container.maplibregl-interactive.maplibregl-track-pointer{cursor:pointer}.maplibregl-canvas-container.maplibregl-interactive:active,.maplibregl-ctrl-group button.maplibregl-ctrl-compass:active{cursor:grabbing}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-canvas-container.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:pinch-zoom}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:none}.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures,.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-ctrl-bottom-left,.maplibregl-ctrl-bottom-right,.maplibregl-ctrl-top-left,.maplibregl-ctrl-top-right{pointer-events:none;position:absolute;z-index:2}.maplibregl-ctrl-top-left{left:0;top:0}.maplibregl-ctrl-top-right{right:0;top:0}.maplibregl-ctrl-bottom-left{bottom:0;left:0}.maplibregl-ctrl-bottom-right{bottom:0;right:0}.maplibregl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.maplibregl-ctrl-top-left .maplibregl-ctrl{float:left;margin:10px 0 0 10px}.maplibregl-ctrl-top-right .maplibregl-ctrl{float:right;margin:10px 10px 0 0}.maplibregl-ctrl-bottom-left .maplibregl-ctrl{float:left;margin:0 0 10px 10px}.maplibregl-ctrl-bottom-right .maplibregl-ctrl{float:right;margin:0 10px 10px 0}.maplibregl-ctrl-group{background:#fff;border-radius:4px}.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.maplibregl-ctrl-group button{background-color:transparent;border:0;box-sizing:border-box;cursor:pointer;display:block;height:29px;outline:none;padding:0;width:29px}.maplibregl-ctrl-group button+button{border-top:1px solid #ddd}.maplibregl-ctrl button .maplibregl-ctrl-icon{background-position:50%;background-repeat:no-repeat;display:block;height:100%;width:100%}@media (-ms-high-contrast:active){.maplibregl-ctrl-icon{background-color:transparent}.maplibregl-ctrl-group button+button{border-top:1px solid ButtonText}}.maplibregl-ctrl button::-moz-focus-inner{border:0;padding:0}.maplibregl-ctrl-attrib-button:focus,.maplibregl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl button:disabled{cursor:not-allowed}.maplibregl-ctrl button:disabled .maplibregl-ctrl-icon{opacity:.25}.maplibregl-ctrl button:not(:disabled):hover{background-color:rgb(0 0 0/5%)}.maplibregl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.maplibregl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.maplibregl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.maplibregl-ctrl-group button:focus:only-child{border-radius:inherit}.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8h-8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8h-8z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8h-8z'/%3E%3Cpath fill='%23999' d='m10.5 16 4 8 4-8h-8z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8h-8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8h-8z'/%3E%3C/svg%3E\")}}.maplibregl-ctrl button.maplibregl-ctrl-terrain .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='%23333' viewBox='0 0 22 22'%3E%3Cpath d='m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-terrain-enabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='%2333b5e5' viewBox='0 0 22 22'%3E%3Cpath d='m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23aaa' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1 9-9z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e58978' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e54e33' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-waiting .maplibregl-ctrl-icon{-webkit-animation:maplibregl-spin 2s linear infinite;animation:maplibregl-spin 2s linear infinite}@media (-ms-high-contrast:active){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23999' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1 9-9z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e58978' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e54e33' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23666' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1 9-9z'/%3E%3C/svg%3E\")}}@-webkit-keyframes maplibregl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes maplibregl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.maplibregl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.255 1.255 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.255 1.255 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5.11 5.11 0 0 1 .314-.787l.009-.016a4.623 4.623 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.548 4.548 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4.314.319.566.676.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.416 2.416 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.448 2.448 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675c.211.2.381.43.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.76 4.76 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.407 3.407 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.255 1.255 0 0 1 .689 1.004 4.73 4.73 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528 0 .343-.02.694-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.815 5.815 0 0 1-.548-2.512c0-.286.017-.567.053-.843a1.255 1.255 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.778 4.778 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.47 4.47 0 0 1-1.935-.424 1.252 1.252 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.402 2.402 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.703 4.703 0 0 1-1.782 1.884 4.767 4.767 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.47 4.47 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a4.983 4.983 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.255 1.255 0 0 1-1.115.676h-.098a1.255 1.255 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15c.329-.237.574-.499.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267c-.088-.22-.264-.438-.526-.658l-.032-.028a3.16 3.16 0 0 0-.668-.428l-.27-.12a3.293 3.293 0 0 0-1.235-.23c-.757 0-1.415.163-1.974.493a3.36 3.36 0 0 0-1.3 1.382c-.297.593-.444 1.284-.444 2.074 0 .8.17 1.503.51 2.107a3.795 3.795 0 0 0 1.382 1.381 3.883 3.883 0 0 0 1.893.477c.53 0 1.015-.11 1.455-.33zm-2.789-5.38c-.384.45-.575 1.038-.575 1.762 0 .735.186 1.332.559 1.794.384.45.933.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.17 2.17 0 0 0 .468-.29l.178-.161a2.163 2.163 0 0 0 .397-.561c.163-.333.244-.717.244-1.15v-.115c0-.472-.098-.894-.296-1.267l-.043-.077a2.211 2.211 0 0 0-.633-.709l-.13-.086-.047-.028a2.099 2.099 0 0 0-1.073-.285c-.702 0-1.244.231-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.958.958 0 0 0-.353-.389.851.851 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.626 2.626 0 0 0 .331.423c.213.22.464.402.755.548l.173.074c.433.17.93.255 1.49.255.68 0 1.295-.165 1.844-.493a3.447 3.447 0 0 0 1.316-1.4c.329-.603.493-1.299.493-2.089 0-1.273-.33-2.243-.988-2.913-.658-.68-1.52-1.02-2.584-1.02-.598 0-1.124.115-1.575.347a2.807 2.807 0 0 0-.415.262l-.199.166a3.35 3.35 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138c.137.193.297.36.48.5l.155.11.053.034c.34.197.713.297 1.119.297.714 0 1.262-.225 1.645-.675.385-.46.576-1.048.576-1.762 0-.746-.192-1.338-.576-1.777-.372-.45-.92-.675-1.645-.675-.29 0-.569.053-.835.16a2.366 2.366 0 0 0-.284.136 1.99 1.99 0 0 0-.363.254 2.237 2.237 0 0 0-.46.569l-.082.162a2.56 2.56 0 0 0-.213 1.072v.115c0 .471.098.894.296 1.267l.135.211zm.964-.818a1.11 1.11 0 0 0 .367.385.937.937 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a.995.995 0 0 0-.503.135l-.012.007a.859.859 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.43 1.43 0 0 0 .14.66zm15.7-6.222c.232-.23.346-.516.346-.856a1.053 1.053 0 0 0-.345-.79 1.175 1.175 0 0 0-.84-.329c-.34 0-.625.11-.855.33a1.053 1.053 0 0 0-.346.79c0 .34.115.625.346.855.23.23.516.346.856.346.34 0 .62-.115.839-.346zm4.337 9.314.033-1.332c.128.269.324.518.59.747l.098.081a3.727 3.727 0 0 0 .316.224l.223.122a3.21 3.21 0 0 0 1.44.322 3.785 3.785 0 0 0 1.875-.477 3.52 3.52 0 0 0 1.382-1.366c.352-.593.526-1.29.526-2.09 0-.79-.147-1.48-.444-2.073a3.235 3.235 0 0 0-1.283-1.399c-.549-.34-1.195-.51-1.942-.51a3.476 3.476 0 0 0-1.527.344l-.086.043-.165.09a3.412 3.412 0 0 0-.33.214c-.288.21-.507.446-.656.707a1.893 1.893 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.482 2.482 0 0 0 .566.7c.078.065.159.125.245.18l.144.08a2.105 2.105 0 0 0 .975.232c.713 0 1.262-.225 1.645-.675.384-.46.576-1.053.576-1.778 0-.734-.192-1.327-.576-1.777-.373-.46-.921-.692-1.645-.692a2.18 2.18 0 0 0-1.015.235c-.147.075-.285.17-.415.282l-.15.142a2.086 2.086 0 0 0-.42.594c-.149.32-.223.685-.223 1.1v.115c0 .47.097.89.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.868.868 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.13 1.13 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013c.23-.087.472-.134.724-.14l.069-.002c.329 0 .542.033.642.099l.247-1.794c-.13-.066-.37-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2.086 2.086 0 0 0-.411.148 2.18 2.18 0 0 0-.4.249 2.482 2.482 0 0 0-.485.499 2.659 2.659 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884c0-.364.053-.678.159-.943a1.49 1.49 0 0 1 .466-.636 2.52 2.52 0 0 1 .399-.253 2.19 2.19 0 0 1 .224-.099zm9.784 2.656.05-.922c0-1.162-.285-2.062-.856-2.698-.559-.647-1.42-.97-2.584-.97-.746 0-1.415.163-2.007.493a3.462 3.462 0 0 0-1.4 1.382c-.329.604-.493 1.306-.493 2.106 0 .714.143 1.371.428 1.975.285.593.73 1.07 1.332 1.432.604.351 1.355.526 2.255.526.649 0 1.204-.062 1.668-.185l.044-.012.135-.04c.409-.122.736-.263.984-.421l-.542-1.267c-.2.108-.415.199-.642.274l-.297.087c-.34.088-.773.131-1.3.131-.636 0-1.135-.147-1.497-.444a1.573 1.573 0 0 1-.192-.193c-.244-.294-.415-.705-.512-1.234l-.004-.021h5.43zm-5.427-1.256-.003.022h3.752v-.138c-.007-.485-.104-.857-.288-1.118a1.056 1.056 0 0 0-.156-.176c-.307-.285-.746-.428-1.316-.428-.657 0-1.155.202-1.494.604-.253.3-.417.712-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81c-.68 0-1.311-.16-1.893-.478a3.795 3.795 0 0 1-1.381-1.382c-.34-.604-.51-1.306-.51-2.106 0-.79.147-1.482.444-2.074a3.364 3.364 0 0 1 1.3-1.382c.559-.33 1.217-.494 1.974-.494a3.293 3.293 0 0 1 1.234.231 3.341 3.341 0 0 1 .97.575c.264.22.44.439.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332c-.186.395-.526.746-1.02 1.053a3.167 3.167 0 0 1-1.662.444zm.296-1.482c.626 0 1.152-.214 1.58-.642.428-.44.642-1.01.642-1.711v-.115c0-.472-.098-.894-.296-1.267a2.211 2.211 0 0 0-.807-.872 2.098 2.098 0 0 0-1.119-.313c-.702 0-1.245.231-1.629.692-.384.45-.575 1.037-.575 1.76 0 .736.186 1.333.559 1.795.384.45.933.675 1.645.675zm6.521-6.237h1.711v1.4c.604-1.065 1.547-1.597 2.83-1.597 1.064 0 1.926.34 2.584 1.02.659.67.988 1.641.988 2.914 0 .79-.164 1.487-.493 2.09a3.456 3.456 0 0 1-1.316 1.399 3.51 3.51 0 0 1-1.844.493c-.636 0-1.19-.11-1.662-.329a2.665 2.665 0 0 1-1.086-.97l.017 5.134h-1.728V9.242zm4.048 6.22c.714 0 1.262-.224 1.645-.674.385-.46.576-1.048.576-1.762 0-.746-.192-1.338-.576-1.777-.372-.45-.92-.675-1.645-.675-.395 0-.768.098-1.12.296-.34.187-.613.46-.822.823-.197.351-.296.763-.296 1.234v.115c0 .472.098.894.296 1.267.209.362.483.647.823.855.34.197.713.297 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.159 1.159 0 0 1-.856-.346 1.165 1.165 0 0 1-.346-.856 1.053 1.053 0 0 1 .346-.79c.23-.219.516-.329.856-.329.329 0 .609.11.839.33a1.053 1.053 0 0 1 .345.79 1.159 1.159 0 0 1-.345.855c-.22.23-.5.346-.84.346zm7.875 9.133a3.167 3.167 0 0 1-1.662-.444c-.482-.307-.817-.658-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283c.186-.438.548-.812 1.086-1.119a3.486 3.486 0 0 1 1.778-.477c.746 0 1.393.17 1.942.51a3.235 3.235 0 0 1 1.283 1.4c.297.592.444 1.282.444 2.072 0 .8-.175 1.498-.526 2.09a3.52 3.52 0 0 1-1.382 1.366 3.785 3.785 0 0 1-1.876.477zm-.296-1.481c.713 0 1.26-.225 1.645-.675.384-.46.577-1.053.577-1.778 0-.734-.193-1.327-.577-1.776-.373-.46-.921-.692-1.645-.692a2.115 2.115 0 0 0-1.58.659c-.428.428-.642.992-.642 1.694v.115c0 .473.098.895.296 1.267a2.385 2.385 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481c.176-.505.46-.91.856-1.217a2.14 2.14 0 0 1 1.349-.46c.351 0 .593.032.724.098l-.247 1.794c-.099-.066-.313-.099-.642-.099-.516 0-.988.164-1.416.494-.417.329-.626.855-.626 1.58v3.883h-1.777V9.242zm9.534 7.718c-.9 0-1.651-.175-2.255-.526-.603-.362-1.047-.84-1.332-1.432a4.567 4.567 0 0 1-.428-1.975c0-.8.164-1.502.493-2.106a3.462 3.462 0 0 1 1.4-1.382c.592-.33 1.262-.494 2.007-.494 1.163 0 2.024.324 2.584.97.57.637.856 1.537.856 2.7 0 .296-.017.603-.05.92h-5.43c.12.67.356 1.153.708 1.45.362.296.86.443 1.497.443.526 0 .96-.044 1.3-.131a4.123 4.123 0 0 0 .938-.362l.542 1.267c-.274.175-.647.329-1.119.46-.472.132-1.042.197-1.711.197zm1.596-4.558c.01-.68-.137-1.158-.444-1.432-.307-.285-.746-.428-1.316-.428-1.152 0-1.815.62-1.991 1.86h3.752z'/%3E%3Cg fill-rule='evenodd' stroke-width='1.036'%3E%3Cpath fill='%23000' fill-opacity='.4' d='m8.166 16.146-.002.002a1.54 1.54 0 0 1-2.009 0l-.002-.002-.043-.034-.002-.002-.199-.162H4.377a.657.657 0 0 0-.659.659v1.84a.657.657 0 0 0 .659.659h5.565a.657.657 0 0 0 .659-.659v-1.84a.657.657 0 0 0-.659-.659H8.411l-.202.164zm-1.121-.905a.29.29 0 0 0 .113.023.286.286 0 0 0 .189-.07l.077-.063c.634-.508 4.672-3.743 4.672-7.575 0-2.55-2.215-4.625-4.938-4.625S2.221 5.006 2.221 7.556c0 3.225 2.86 6.027 4.144 7.137h.004l.04.038.484.4.077.063a.628.628 0 0 0 .074.047zm-2.52-.548a16.898 16.898 0 0 1-1.183-1.315C2.187 11.942.967 9.897.967 7.555c0-3.319 2.855-5.88 6.192-5.88 3.338 0 6.193 2.561 6.193 5.881 0 2.34-1.22 4.387-2.376 5.822a16.898 16.898 0 0 1-1.182 1.315h.15a1.912 1.912 0 0 1 1.914 1.914v1.84a1.912 1.912 0 0 1-1.914 1.914H4.377a1.912 1.912 0 0 1-1.914-1.914v-1.84a1.912 1.912 0 0 1 1.914-1.914zm3.82-6.935c0 .692-.55 1.222-1.187 1.222s-1.185-.529-1.185-1.222.548-1.222 1.185-1.222c.638 0 1.186.529 1.186 1.222zm-1.186 2.477c1.348 0 2.442-1.11 2.442-2.478S8.507 5.28 7.159 5.28 4.72 6.39 4.72 7.758s1.092 2.477 2.44 2.477zm2.048 7.71H5.114v-.838h4.093z'/%3E%3Cpath fill='%23e1e3e9' d='M2.222 7.555c0-2.55 2.214-4.625 4.937-4.625 2.723 0 4.938 2.075 4.938 4.625 0 3.832-4.038 7.068-4.672 7.575l-.077.063a.286.286 0 0 1-.189.07.286.286 0 0 1-.188-.07l-.077-.063c-.634-.507-4.672-3.743-4.672-7.575zm4.937 2.68c1.348 0 2.442-1.11 2.442-2.478S8.507 5.28 7.159 5.28 4.72 6.39 4.72 7.758s1.092 2.477 2.44 2.477z'/%3E%3Cpath fill='%23fff' d='M4.377 15.948a.657.657 0 0 0-.659.659v1.84a.657.657 0 0 0 .659.659h5.565a.657.657 0 0 0 .659-.659v-1.84a.657.657 0 0 0-.659-.659zm4.83 1.16H5.114v.838h4.093z'/%3E%3C/g%3E%3C/svg%3E\");background-repeat:no-repeat;cursor:pointer;display:block;height:23px;margin:0 0 -4px -4px;overflow:hidden;width:88px}a.maplibregl-ctrl-logo.maplibregl-compact{width:14px}@media (-ms-high-contrast:active){a.maplibregl-ctrl-logo{background-color:transparent;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.255 1.255 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.255 1.255 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5.11 5.11 0 0 1 .314-.787l.009-.016a4.623 4.623 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.548 4.548 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4.314.319.566.676.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.416 2.416 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.448 2.448 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675c.211.2.381.43.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.76 4.76 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.407 3.407 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.255 1.255 0 0 1 .689 1.004 4.73 4.73 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528 0 .343-.02.694-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.815 5.815 0 0 1-.548-2.512c0-.286.017-.567.053-.843a1.255 1.255 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.778 4.778 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.47 4.47 0 0 1-1.935-.424 1.252 1.252 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.402 2.402 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.703 4.703 0 0 1-1.782 1.884 4.767 4.767 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.47 4.47 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a4.983 4.983 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.255 1.255 0 0 1-1.115.676h-.098a1.255 1.255 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15c.329-.237.574-.499.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267c-.088-.22-.264-.438-.526-.658l-.032-.028a3.16 3.16 0 0 0-.668-.428l-.27-.12a3.293 3.293 0 0 0-1.235-.23c-.757 0-1.415.163-1.974.493a3.36 3.36 0 0 0-1.3 1.382c-.297.593-.444 1.284-.444 2.074 0 .8.17 1.503.51 2.107a3.795 3.795 0 0 0 1.382 1.381 3.883 3.883 0 0 0 1.893.477c.53 0 1.015-.11 1.455-.33zm-2.789-5.38c-.384.45-.575 1.038-.575 1.762 0 .735.186 1.332.559 1.794.384.45.933.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.17 2.17 0 0 0 .468-.29l.178-.161a2.163 2.163 0 0 0 .397-.561c.163-.333.244-.717.244-1.15v-.115c0-.472-.098-.894-.296-1.267l-.043-.077a2.211 2.211 0 0 0-.633-.709l-.13-.086-.047-.028a2.099 2.099 0 0 0-1.073-.285c-.702 0-1.244.231-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.958.958 0 0 0-.353-.389.851.851 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.626 2.626 0 0 0 .331.423c.213.22.464.402.755.548l.173.074c.433.17.93.255 1.49.255.68 0 1.295-.165 1.844-.493a3.447 3.447 0 0 0 1.316-1.4c.329-.603.493-1.299.493-2.089 0-1.273-.33-2.243-.988-2.913-.658-.68-1.52-1.02-2.584-1.02-.598 0-1.124.115-1.575.347a2.807 2.807 0 0 0-.415.262l-.199.166a3.35 3.35 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138c.137.193.297.36.48.5l.155.11.053.034c.34.197.713.297 1.119.297.714 0 1.262-.225 1.645-.675.385-.46.576-1.048.576-1.762 0-.746-.192-1.338-.576-1.777-.372-.45-.92-.675-1.645-.675-.29 0-.569.053-.835.16a2.366 2.366 0 0 0-.284.136 1.99 1.99 0 0 0-.363.254 2.237 2.237 0 0 0-.46.569l-.082.162a2.56 2.56 0 0 0-.213 1.072v.115c0 .471.098.894.296 1.267l.135.211zm.964-.818a1.11 1.11 0 0 0 .367.385.937.937 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a.995.995 0 0 0-.503.135l-.012.007a.859.859 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.43 1.43 0 0 0 .14.66zm15.7-6.222c.232-.23.346-.516.346-.856a1.053 1.053 0 0 0-.345-.79 1.175 1.175 0 0 0-.84-.329c-.34 0-.625.11-.855.33a1.053 1.053 0 0 0-.346.79c0 .34.115.625.346.855.23.23.516.346.856.346.34 0 .62-.115.839-.346zm4.337 9.314.033-1.332c.128.269.324.518.59.747l.098.081a3.727 3.727 0 0 0 .316.224l.223.122a3.21 3.21 0 0 0 1.44.322 3.785 3.785 0 0 0 1.875-.477 3.52 3.52 0 0 0 1.382-1.366c.352-.593.526-1.29.526-2.09 0-.79-.147-1.48-.444-2.073a3.235 3.235 0 0 0-1.283-1.399c-.549-.34-1.195-.51-1.942-.51a3.476 3.476 0 0 0-1.527.344l-.086.043-.165.09a3.412 3.412 0 0 0-.33.214c-.288.21-.507.446-.656.707a1.893 1.893 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.482 2.482 0 0 0 .566.7c.078.065.159.125.245.18l.144.08a2.105 2.105 0 0 0 .975.232c.713 0 1.262-.225 1.645-.675.384-.46.576-1.053.576-1.778 0-.734-.192-1.327-.576-1.777-.373-.46-.921-.692-1.645-.692a2.18 2.18 0 0 0-1.015.235c-.147.075-.285.17-.415.282l-.15.142a2.086 2.086 0 0 0-.42.594c-.149.32-.223.685-.223 1.1v.115c0 .47.097.89.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.868.868 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.13 1.13 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013c.23-.087.472-.134.724-.14l.069-.002c.329 0 .542.033.642.099l.247-1.794c-.13-.066-.37-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2.086 2.086 0 0 0-.411.148 2.18 2.18 0 0 0-.4.249 2.482 2.482 0 0 0-.485.499 2.659 2.659 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884c0-.364.053-.678.159-.943a1.49 1.49 0 0 1 .466-.636 2.52 2.52 0 0 1 .399-.253 2.19 2.19 0 0 1 .224-.099zm9.784 2.656.05-.922c0-1.162-.285-2.062-.856-2.698-.559-.647-1.42-.97-2.584-.97-.746 0-1.415.163-2.007.493a3.462 3.462 0 0 0-1.4 1.382c-.329.604-.493 1.306-.493 2.106 0 .714.143 1.371.428 1.975.285.593.73 1.07 1.332 1.432.604.351 1.355.526 2.255.526.649 0 1.204-.062 1.668-.185l.044-.012.135-.04c.409-.122.736-.263.984-.421l-.542-1.267c-.2.108-.415.199-.642.274l-.297.087c-.34.088-.773.131-1.3.131-.636 0-1.135-.147-1.497-.444a1.573 1.573 0 0 1-.192-.193c-.244-.294-.415-.705-.512-1.234l-.004-.021h5.43zm-5.427-1.256-.003.022h3.752v-.138c-.007-.485-.104-.857-.288-1.118a1.056 1.056 0 0 0-.156-.176c-.307-.285-.746-.428-1.316-.428-.657 0-1.155.202-1.494.604-.253.3-.417.712-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81c-.68 0-1.311-.16-1.893-.478a3.795 3.795 0 0 1-1.381-1.382c-.34-.604-.51-1.306-.51-2.106 0-.79.147-1.482.444-2.074a3.364 3.364 0 0 1 1.3-1.382c.559-.33 1.217-.494 1.974-.494a3.293 3.293 0 0 1 1.234.231 3.341 3.341 0 0 1 .97.575c.264.22.44.439.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332c-.186.395-.526.746-1.02 1.053a3.167 3.167 0 0 1-1.662.444zm.296-1.482c.626 0 1.152-.214 1.58-.642.428-.44.642-1.01.642-1.711v-.115c0-.472-.098-.894-.296-1.267a2.211 2.211 0 0 0-.807-.872 2.098 2.098 0 0 0-1.119-.313c-.702 0-1.245.231-1.629.692-.384.45-.575 1.037-.575 1.76 0 .736.186 1.333.559 1.795.384.45.933.675 1.645.675zm6.521-6.237h1.711v1.4c.604-1.065 1.547-1.597 2.83-1.597 1.064 0 1.926.34 2.584 1.02.659.67.988 1.641.988 2.914 0 .79-.164 1.487-.493 2.09a3.456 3.456 0 0 1-1.316 1.399 3.51 3.51 0 0 1-1.844.493c-.636 0-1.19-.11-1.662-.329a2.665 2.665 0 0 1-1.086-.97l.017 5.134h-1.728V9.242zm4.048 6.22c.714 0 1.262-.224 1.645-.674.385-.46.576-1.048.576-1.762 0-.746-.192-1.338-.576-1.777-.372-.45-.92-.675-1.645-.675-.395 0-.768.098-1.12.296-.34.187-.613.46-.822.823-.197.351-.296.763-.296 1.234v.115c0 .472.098.894.296 1.267.209.362.483.647.823.855.34.197.713.297 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.159 1.159 0 0 1-.856-.346 1.165 1.165 0 0 1-.346-.856 1.053 1.053 0 0 1 .346-.79c.23-.219.516-.329.856-.329.329 0 .609.11.839.33a1.053 1.053 0 0 1 .345.79 1.159 1.159 0 0 1-.345.855c-.22.23-.5.346-.84.346zm7.875 9.133a3.167 3.167 0 0 1-1.662-.444c-.482-.307-.817-.658-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283c.186-.438.548-.812 1.086-1.119a3.486 3.486 0 0 1 1.778-.477c.746 0 1.393.17 1.942.51a3.235 3.235 0 0 1 1.283 1.4c.297.592.444 1.282.444 2.072 0 .8-.175 1.498-.526 2.09a3.52 3.52 0 0 1-1.382 1.366 3.785 3.785 0 0 1-1.876.477zm-.296-1.481c.713 0 1.26-.225 1.645-.675.384-.46.577-1.053.577-1.778 0-.734-.193-1.327-.577-1.776-.373-.46-.921-.692-1.645-.692a2.115 2.115 0 0 0-1.58.659c-.428.428-.642.992-.642 1.694v.115c0 .473.098.895.296 1.267a2.385 2.385 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481c.176-.505.46-.91.856-1.217a2.14 2.14 0 0 1 1.349-.46c.351 0 .593.032.724.098l-.247 1.794c-.099-.066-.313-.099-.642-.099-.516 0-.988.164-1.416.494-.417.329-.626.855-.626 1.58v3.883h-1.777V9.242zm9.534 7.718c-.9 0-1.651-.175-2.255-.526-.603-.362-1.047-.84-1.332-1.432a4.567 4.567 0 0 1-.428-1.975c0-.8.164-1.502.493-2.106a3.462 3.462 0 0 1 1.4-1.382c.592-.33 1.262-.494 2.007-.494 1.163 0 2.024.324 2.584.97.57.637.856 1.537.856 2.7 0 .296-.017.603-.05.92h-5.43c.12.67.356 1.153.708 1.45.362.296.86.443 1.497.443.526 0 .96-.044 1.3-.131a4.123 4.123 0 0 0 .938-.362l.542 1.267c-.274.175-.647.329-1.119.46-.472.132-1.042.197-1.711.197zm1.596-4.558c.01-.68-.137-1.158-.444-1.432-.307-.285-.746-.428-1.316-.428-1.152 0-1.815.62-1.991 1.86h3.752z'/%3E%3Cg fill-rule='evenodd' stroke-width='1.036'%3E%3Cpath fill='%23000' fill-opacity='.4' d='m8.166 16.146-.002.002a1.54 1.54 0 0 1-2.009 0l-.002-.002-.043-.034-.002-.002-.199-.162H4.377a.657.657 0 0 0-.659.659v1.84a.657.657 0 0 0 .659.659h5.565a.657.657 0 0 0 .659-.659v-1.84a.657.657 0 0 0-.659-.659H8.411l-.202.164zm-1.121-.905a.29.29 0 0 0 .113.023.286.286 0 0 0 .189-.07l.077-.063c.634-.508 4.672-3.743 4.672-7.575 0-2.55-2.215-4.625-4.938-4.625S2.221 5.006 2.221 7.556c0 3.225 2.86 6.027 4.144 7.137h.004l.04.038.484.4.077.063a.628.628 0 0 0 .074.047zm-2.52-.548a16.898 16.898 0 0 1-1.183-1.315C2.187 11.942.967 9.897.967 7.555c0-3.319 2.855-5.88 6.192-5.88 3.338 0 6.193 2.561 6.193 5.881 0 2.34-1.22 4.387-2.376 5.822a16.898 16.898 0 0 1-1.182 1.315h.15a1.912 1.912 0 0 1 1.914 1.914v1.84a1.912 1.912 0 0 1-1.914 1.914H4.377a1.912 1.912 0 0 1-1.914-1.914v-1.84a1.912 1.912 0 0 1 1.914-1.914zm3.82-6.935c0 .692-.55 1.222-1.187 1.222s-1.185-.529-1.185-1.222.548-1.222 1.185-1.222c.638 0 1.186.529 1.186 1.222zm-1.186 2.477c1.348 0 2.442-1.11 2.442-2.478S8.507 5.28 7.159 5.28 4.72 6.39 4.72 7.758s1.092 2.477 2.44 2.477zm2.048 7.71H5.114v-.838h4.093z'/%3E%3Cpath fill='%23e1e3e9' d='M2.222 7.555c0-2.55 2.214-4.625 4.937-4.625 2.723 0 4.938 2.075 4.938 4.625 0 3.832-4.038 7.068-4.672 7.575l-.077.063a.286.286 0 0 1-.189.07.286.286 0 0 1-.188-.07l-.077-.063c-.634-.507-4.672-3.743-4.672-7.575zm4.937 2.68c1.348 0 2.442-1.11 2.442-2.478S8.507 5.28 7.159 5.28 4.72 6.39 4.72 7.758s1.092 2.477 2.44 2.477z'/%3E%3Cpath fill='%23fff' d='M4.377 15.948a.657.657 0 0 0-.659.659v1.84a.657.657 0 0 0 .659.659h5.565a.657.657 0 0 0 .659-.659v-1.84a.657.657 0 0 0-.659-.659zm4.83 1.16H5.114v.838h4.093z'/%3E%3C/g%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){a.maplibregl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.255 1.255 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.255 1.255 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5.11 5.11 0 0 1 .314-.787l.009-.016a4.623 4.623 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.548 4.548 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4.314.319.566.676.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.416 2.416 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.448 2.448 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675c.211.2.381.43.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.76 4.76 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.407 3.407 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.255 1.255 0 0 1 .689 1.004 4.73 4.73 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528 0 .343-.02.694-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.815 5.815 0 0 1-.548-2.512c0-.286.017-.567.053-.843a1.255 1.255 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.778 4.778 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.47 4.47 0 0 1-1.935-.424 1.252 1.252 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.402 2.402 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.703 4.703 0 0 1-1.782 1.884 4.767 4.767 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.47 4.47 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a4.983 4.983 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.255 1.255 0 0 1-1.115.676h-.098a1.255 1.255 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15c.329-.237.574-.499.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267c-.088-.22-.264-.438-.526-.658l-.032-.028a3.16 3.16 0 0 0-.668-.428l-.27-.12a3.293 3.293 0 0 0-1.235-.23c-.757 0-1.415.163-1.974.493a3.36 3.36 0 0 0-1.3 1.382c-.297.593-.444 1.284-.444 2.074 0 .8.17 1.503.51 2.107a3.795 3.795 0 0 0 1.382 1.381 3.883 3.883 0 0 0 1.893.477c.53 0 1.015-.11 1.455-.33zm-2.789-5.38c-.384.45-.575 1.038-.575 1.762 0 .735.186 1.332.559 1.794.384.45.933.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.17 2.17 0 0 0 .468-.29l.178-.161a2.163 2.163 0 0 0 .397-.561c.163-.333.244-.717.244-1.15v-.115c0-.472-.098-.894-.296-1.267l-.043-.077a2.211 2.211 0 0 0-.633-.709l-.13-.086-.047-.028a2.099 2.099 0 0 0-1.073-.285c-.702 0-1.244.231-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.958.958 0 0 0-.353-.389.851.851 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.626 2.626 0 0 0 .331.423c.213.22.464.402.755.548l.173.074c.433.17.93.255 1.49.255.68 0 1.295-.165 1.844-.493a3.447 3.447 0 0 0 1.316-1.4c.329-.603.493-1.299.493-2.089 0-1.273-.33-2.243-.988-2.913-.658-.68-1.52-1.02-2.584-1.02-.598 0-1.124.115-1.575.347a2.807 2.807 0 0 0-.415.262l-.199.166a3.35 3.35 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138c.137.193.297.36.48.5l.155.11.053.034c.34.197.713.297 1.119.297.714 0 1.262-.225 1.645-.675.385-.46.576-1.048.576-1.762 0-.746-.192-1.338-.576-1.777-.372-.45-.92-.675-1.645-.675-.29 0-.569.053-.835.16a2.366 2.366 0 0 0-.284.136 1.99 1.99 0 0 0-.363.254 2.237 2.237 0 0 0-.46.569l-.082.162a2.56 2.56 0 0 0-.213 1.072v.115c0 .471.098.894.296 1.267l.135.211zm.964-.818a1.11 1.11 0 0 0 .367.385.937.937 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a.995.995 0 0 0-.503.135l-.012.007a.859.859 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.43 1.43 0 0 0 .14.66zm15.7-6.222c.232-.23.346-.516.346-.856a1.053 1.053 0 0 0-.345-.79 1.175 1.175 0 0 0-.84-.329c-.34 0-.625.11-.855.33a1.053 1.053 0 0 0-.346.79c0 .34.115.625.346.855.23.23.516.346.856.346.34 0 .62-.115.839-.346zm4.337 9.314.033-1.332c.128.269.324.518.59.747l.098.081a3.727 3.727 0 0 0 .316.224l.223.122a3.21 3.21 0 0 0 1.44.322 3.785 3.785 0 0 0 1.875-.477 3.52 3.52 0 0 0 1.382-1.366c.352-.593.526-1.29.526-2.09 0-.79-.147-1.48-.444-2.073a3.235 3.235 0 0 0-1.283-1.399c-.549-.34-1.195-.51-1.942-.51a3.476 3.476 0 0 0-1.527.344l-.086.043-.165.09a3.412 3.412 0 0 0-.33.214c-.288.21-.507.446-.656.707a1.893 1.893 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.482 2.482 0 0 0 .566.7c.078.065.159.125.245.18l.144.08a2.105 2.105 0 0 0 .975.232c.713 0 1.262-.225 1.645-.675.384-.46.576-1.053.576-1.778 0-.734-.192-1.327-.576-1.777-.373-.46-.921-.692-1.645-.692a2.18 2.18 0 0 0-1.015.235c-.147.075-.285.17-.415.282l-.15.142a2.086 2.086 0 0 0-.42.594c-.149.32-.223.685-.223 1.1v.115c0 .47.097.89.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.868.868 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.13 1.13 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013c.23-.087.472-.134.724-.14l.069-.002c.329 0 .542.033.642.099l.247-1.794c-.13-.066-.37-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2.086 2.086 0 0 0-.411.148 2.18 2.18 0 0 0-.4.249 2.482 2.482 0 0 0-.485.499 2.659 2.659 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884c0-.364.053-.678.159-.943a1.49 1.49 0 0 1 .466-.636 2.52 2.52 0 0 1 .399-.253 2.19 2.19 0 0 1 .224-.099zm9.784 2.656.05-.922c0-1.162-.285-2.062-.856-2.698-.559-.647-1.42-.97-2.584-.97-.746 0-1.415.163-2.007.493a3.462 3.462 0 0 0-1.4 1.382c-.329.604-.493 1.306-.493 2.106 0 .714.143 1.371.428 1.975.285.593.73 1.07 1.332 1.432.604.351 1.355.526 2.255.526.649 0 1.204-.062 1.668-.185l.044-.012.135-.04c.409-.122.736-.263.984-.421l-.542-1.267c-.2.108-.415.199-.642.274l-.297.087c-.34.088-.773.131-1.3.131-.636 0-1.135-.147-1.497-.444a1.573 1.573 0 0 1-.192-.193c-.244-.294-.415-.705-.512-1.234l-.004-.021h5.43zm-5.427-1.256-.003.022h3.752v-.138c-.007-.485-.104-.857-.288-1.118a1.056 1.056 0 0 0-.156-.176c-.307-.285-.746-.428-1.316-.428-.657 0-1.155.202-1.494.604-.253.3-.417.712-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81c-.68 0-1.311-.16-1.893-.478a3.795 3.795 0 0 1-1.381-1.382c-.34-.604-.51-1.306-.51-2.106 0-.79.147-1.482.444-2.074a3.364 3.364 0 0 1 1.3-1.382c.559-.33 1.217-.494 1.974-.494a3.293 3.293 0 0 1 1.234.231 3.341 3.341 0 0 1 .97.575c.264.22.44.439.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332c-.186.395-.526.746-1.02 1.053a3.167 3.167 0 0 1-1.662.444zm.296-1.482c.626 0 1.152-.214 1.58-.642.428-.44.642-1.01.642-1.711v-.115c0-.472-.098-.894-.296-1.267a2.211 2.211 0 0 0-.807-.872 2.098 2.098 0 0 0-1.119-.313c-.702 0-1.245.231-1.629.692-.384.45-.575 1.037-.575 1.76 0 .736.186 1.333.559 1.795.384.45.933.675 1.645.675zm6.521-6.237h1.711v1.4c.604-1.065 1.547-1.597 2.83-1.597 1.064 0 1.926.34 2.584 1.02.659.67.988 1.641.988 2.914 0 .79-.164 1.487-.493 2.09a3.456 3.456 0 0 1-1.316 1.399 3.51 3.51 0 0 1-1.844.493c-.636 0-1.19-.11-1.662-.329a2.665 2.665 0 0 1-1.086-.97l.017 5.134h-1.728V9.242zm4.048 6.22c.714 0 1.262-.224 1.645-.674.385-.46.576-1.048.576-1.762 0-.746-.192-1.338-.576-1.777-.372-.45-.92-.675-1.645-.675-.395 0-.768.098-1.12.296-.34.187-.613.46-.822.823-.197.351-.296.763-.296 1.234v.115c0 .472.098.894.296 1.267.209.362.483.647.823.855.34.197.713.297 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.159 1.159 0 0 1-.856-.346 1.165 1.165 0 0 1-.346-.856 1.053 1.053 0 0 1 .346-.79c.23-.219.516-.329.856-.329.329 0 .609.11.839.33a1.053 1.053 0 0 1 .345.79 1.159 1.159 0 0 1-.345.855c-.22.23-.5.346-.84.346zm7.875 9.133a3.167 3.167 0 0 1-1.662-.444c-.482-.307-.817-.658-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283c.186-.438.548-.812 1.086-1.119a3.486 3.486 0 0 1 1.778-.477c.746 0 1.393.17 1.942.51a3.235 3.235 0 0 1 1.283 1.4c.297.592.444 1.282.444 2.072 0 .8-.175 1.498-.526 2.09a3.52 3.52 0 0 1-1.382 1.366 3.785 3.785 0 0 1-1.876.477zm-.296-1.481c.713 0 1.26-.225 1.645-.675.384-.46.577-1.053.577-1.778 0-.734-.193-1.327-.577-1.776-.373-.46-.921-.692-1.645-.692a2.115 2.115 0 0 0-1.58.659c-.428.428-.642.992-.642 1.694v.115c0 .473.098.895.296 1.267a2.385 2.385 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481c.176-.505.46-.91.856-1.217a2.14 2.14 0 0 1 1.349-.46c.351 0 .593.032.724.098l-.247 1.794c-.099-.066-.313-.099-.642-.099-.516 0-.988.164-1.416.494-.417.329-.626.855-.626 1.58v3.883h-1.777V9.242zm9.534 7.718c-.9 0-1.651-.175-2.255-.526-.603-.362-1.047-.84-1.332-1.432a4.567 4.567 0 0 1-.428-1.975c0-.8.164-1.502.493-2.106a3.462 3.462 0 0 1 1.4-1.382c.592-.33 1.262-.494 2.007-.494 1.163 0 2.024.324 2.584.97.57.637.856 1.537.856 2.7 0 .296-.017.603-.05.92h-5.43c.12.67.356 1.153.708 1.45.362.296.86.443 1.497.443.526 0 .96-.044 1.3-.131a4.123 4.123 0 0 0 .938-.362l.542 1.267c-.274.175-.647.329-1.119.46-.472.132-1.042.197-1.711.197zm1.596-4.558c.01-.68-.137-1.158-.444-1.432-.307-.285-.746-.428-1.316-.428-1.152 0-1.815.62-1.991 1.86h3.752z'/%3E%3Cg fill-rule='evenodd' stroke-width='1.036'%3E%3Cpath fill='%23000' fill-opacity='.4' d='m8.166 16.146-.002.002a1.54 1.54 0 0 1-2.009 0l-.002-.002-.043-.034-.002-.002-.199-.162H4.377a.657.657 0 0 0-.659.659v1.84a.657.657 0 0 0 .659.659h5.565a.657.657 0 0 0 .659-.659v-1.84a.657.657 0 0 0-.659-.659H8.411l-.202.164zm-1.121-.905a.29.29 0 0 0 .113.023.286.286 0 0 0 .189-.07l.077-.063c.634-.508 4.672-3.743 4.672-7.575 0-2.55-2.215-4.625-4.938-4.625S2.221 5.006 2.221 7.556c0 3.225 2.86 6.027 4.144 7.137h.004l.04.038.484.4.077.063a.628.628 0 0 0 .074.047zm-2.52-.548a16.898 16.898 0 0 1-1.183-1.315C2.187 11.942.967 9.897.967 7.555c0-3.319 2.855-5.88 6.192-5.88 3.338 0 6.193 2.561 6.193 5.881 0 2.34-1.22 4.387-2.376 5.822a16.898 16.898 0 0 1-1.182 1.315h.15a1.912 1.912 0 0 1 1.914 1.914v1.84a1.912 1.912 0 0 1-1.914 1.914H4.377a1.912 1.912 0 0 1-1.914-1.914v-1.84a1.912 1.912 0 0 1 1.914-1.914zm3.82-6.935c0 .692-.55 1.222-1.187 1.222s-1.185-.529-1.185-1.222.548-1.222 1.185-1.222c.638 0 1.186.529 1.186 1.222zm-1.186 2.477c1.348 0 2.442-1.11 2.442-2.478S8.507 5.28 7.159 5.28 4.72 6.39 4.72 7.758s1.092 2.477 2.44 2.477zm2.048 7.71H5.114v-.838h4.093z'/%3E%3Cpath fill='%23e1e3e9' d='M2.222 7.555c0-2.55 2.214-4.625 4.937-4.625 2.723 0 4.938 2.075 4.938 4.625 0 3.832-4.038 7.068-4.672 7.575l-.077.063a.286.286 0 0 1-.189.07.286.286 0 0 1-.188-.07l-.077-.063c-.634-.507-4.672-3.743-4.672-7.575zm4.937 2.68c1.348 0 2.442-1.11 2.442-2.478S8.507 5.28 7.159 5.28 4.72 6.39 4.72 7.758s1.092 2.477 2.44 2.477z'/%3E%3Cpath fill='%23fff' d='M4.377 15.948a.657.657 0 0 0-.659.659v1.84a.657.657 0 0 0 .659.659h5.565a.657.657 0 0 0 .659-.659v-1.84a.657.657 0 0 0-.659-.659zm4.83 1.16H5.114v.838h4.093z'/%3E%3C/g%3E%3C/svg%3E\")}}.maplibregl-ctrl.maplibregl-ctrl-attrib{background-color:hsla(0,0%,100%,.5);margin:0;padding:0 5px}@media screen{.maplibregl-ctrl-attrib.maplibregl-compact{background-color:#fff;border-radius:12px;box-sizing:content-box;margin:10px;min-height:20px;padding:2px 24px 2px 0;position:relative}.maplibregl-ctrl-attrib.maplibregl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact-show,.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact-show{border-radius:12px;padding:2px 8px 2px 28px}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-inner{display:none}.maplibregl-ctrl-attrib-button{background-color:hsla(0,0%,100%,.5);background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\");border:0;border-radius:12px;box-sizing:border-box;cursor:pointer;display:none;height:24px;outline:none;position:absolute;right:0;top:0;width:24px}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;list-style:none}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button::-webkit-details-marker{display:none}.maplibregl-ctrl-bottom-left .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-top-left .maplibregl-ctrl-attrib-button{left:0}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-inner{display:block}.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-button{background-color:rgb(0 0 0/5%)}.maplibregl-ctrl-bottom-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;right:0}.maplibregl-ctrl-top-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{right:0;top:0}.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{left:0;top:0}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='%23fff' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\")}}@media screen and (-ms-high-contrast:black-on-white){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\")}}.maplibregl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.maplibregl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.maplibregl-attrib-empty{display:none}.maplibregl-ctrl-scale{background-color:hsla(0,0%,100%,.75);border:2px solid #333;border-top:#333;box-sizing:border-box;color:#333;font-size:10px;padding:0 5px}.maplibregl-popup{display:flex;left:0;pointer-events:none;position:absolute;top:0;will-change:transform}.maplibregl-popup-anchor-top,.maplibregl-popup-anchor-top-left,.maplibregl-popup-anchor-top-right{flex-direction:column}.maplibregl-popup-anchor-bottom,.maplibregl-popup-anchor-bottom-left,.maplibregl-popup-anchor-bottom-right{flex-direction:column-reverse}.maplibregl-popup-anchor-left{flex-direction:row}.maplibregl-popup-anchor-right{flex-direction:row-reverse}.maplibregl-popup-tip{border:10px solid transparent;height:0;width:0;z-index:1}.maplibregl-popup-anchor-top .maplibregl-popup-tip{align-self:center;border-bottom-color:#fff;border-top:none}.maplibregl-popup-anchor-top-left .maplibregl-popup-tip{align-self:flex-start;border-bottom-color:#fff;border-left:none;border-top:none}.maplibregl-popup-anchor-top-right .maplibregl-popup-tip{align-self:flex-end;border-bottom-color:#fff;border-right:none;border-top:none}.maplibregl-popup-anchor-bottom .maplibregl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.maplibregl-popup-anchor-left .maplibregl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.maplibregl-popup-anchor-right .maplibregl-popup-tip{align-self:center;border-left-color:#fff;border-right:none}.maplibregl-popup-close-button{background-color:transparent;border:0;border-radius:0 3px 0 0;cursor:pointer;position:absolute;right:0;top:0}.maplibregl-popup-close-button:hover{background-color:rgb(0 0 0/5%)}.maplibregl-popup-content{background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:15px 10px;pointer-events:auto;position:relative}.maplibregl-popup-anchor-top-left .maplibregl-popup-content{border-top-left-radius:0}.maplibregl-popup-anchor-top-right .maplibregl-popup-content{border-top-right-radius:0}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-content{border-bottom-left-radius:0}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-content{border-bottom-right-radius:0}.maplibregl-popup-track-pointer{display:none}.maplibregl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.maplibregl-map:hover .maplibregl-popup-track-pointer{display:flex}.maplibregl-map:active .maplibregl-popup-track-pointer{display:none}.maplibregl-marker{left:0;position:absolute;top:0;will-change:transform}.maplibregl-user-location-dot,.maplibregl-user-location-dot:before{background-color:#1da1f2;border-radius:50%;height:15px;width:15px}.maplibregl-user-location-dot:before{-webkit-animation:maplibregl-user-location-dot-pulse 2s infinite;animation:maplibregl-user-location-dot-pulse 2s infinite;content:\"\";position:absolute}.maplibregl-user-location-dot:after{border:2px solid #fff;border-radius:50%;box-shadow:0 0 3px rgba(0,0,0,.35);box-sizing:border-box;content:\"\";height:19px;left:-2px;position:absolute;top:-2px;width:19px}@-webkit-keyframes maplibregl-user-location-dot-pulse{0%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}70%{opacity:0;-webkit-transform:scale(3);transform:scale(3)}to{opacity:0;-webkit-transform:scale(1);transform:scale(1)}}@keyframes maplibregl-user-location-dot-pulse{0%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}70%{opacity:0;-webkit-transform:scale(3);transform:scale(3)}to{opacity:0;-webkit-transform:scale(1);transform:scale(1)}}.maplibregl-user-location-dot-stale{background-color:#aaa}.maplibregl-user-location-dot-stale:after{display:none}.maplibregl-user-location-accuracy-circle{background-color:#1da1f233;border-radius:100%;height:1px;width:1px}.maplibregl-crosshair,.maplibregl-crosshair .maplibregl-interactive,.maplibregl-crosshair .maplibregl-interactive:active{cursor:crosshair}.maplibregl-boxzoom{background:#fff;border:2px dotted #202020;height:0;left:0;opacity:.5;position:absolute;top:0;width:0}.maplibregl-cooperative-gesture-screen{align-items:center;background:rgba(0,0,0,.4);color:#fff;display:flex;font-size:1.4em;inset:0;justify-content:center;line-height:1.2;opacity:0;padding:1rem;pointer-events:none;position:absolute;transition:opacity 1s ease 1s;z-index:99999}.maplibregl-cooperative-gesture-screen.maplibregl-show{opacity:1;transition:opacity .05s}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:none}@media (hover:none),(width <= 480px){.maplibregl-cooperative-gesture-screen .maplibregl-desktop-message{display:none}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:block}}.maplibregl-pseudo-fullscreen{height:100%!important;left:0!important;position:fixed!important;top:0!important;width:100%!important;z-index:99999}"),window.maplibregl=u.default;let v=0;class g extends h.default{constructor(...e){super(...e),(0,s.default)(this,"version",f.MapType.MAPBOX),(0,s.default)(this,"viewport",void 0);}getType(){return"mapbox";}lngLatToCoord(e,t={x:0,y:0,z:0}){let{x:n,y:r}=this.lngLatToMercator(e,0);return[n-t.x,r-t.y];}lngLatToMercator(e,t){let{x:n=0,y:r=0,z:i=0}=window.maplibregl.MercatorCoordinate.fromLngLat(e,t);return{x:n,y:r,z:i};}getModelMatrix(e,t,n,r=[1,1,1],i={x:0,y:0,z:0}){let a=window.maplibregl.MercatorCoordinate.fromLngLat(e,t),o=a.meterInMercatorCoordinateUnits(),s=l.mat4.create();return l.mat4.translate(s,s,l.vec3.fromValues(a.x-i.x,a.y-i.y,a.z||0-i.z)),l.mat4.scale(s,s,l.vec3.fromValues(o*r[0],-o*r[1],o*r[2])),l.mat4.rotateX(s,s,n[0]),l.mat4.rotateY(s,s,n[1]),l.mat4.rotateZ(s,s,n[2]),s;}init(){var e=this;return(0,o.default)(function*(){let t=e.config,{id:n="map",attributionControl:r=!1,style:o="light",rotation:s=0,mapInstance:l}=t,u=(0,a.default)(t,p);e.viewport=new d.default,l||window.maplibregl||console.error(e.configService.getSceneWarninfo("SDK")),l?(e.map=l,e.$mapContainer=e.map.getContainer()):(e.$mapContainer=e.creatMapContainer(n),"string"!=typeof o&&e.addProtocol(),e.map=new window.maplibregl.Map((0,i.default)({container:e.$mapContainer,style:e.getMapStyleValue(o),attributionControl:r,bearing:s},u))),e.map.on("load",()=>{e.handleCameraChanged();}),e.map.on("move",e.handleCameraChanged),e.handleCameraChanged();})();}addProtocol(){let e=new c.Protocol;u.default.addProtocol("pmtiles",e.tile);}destroy(){var e;null===(e=this.$mapContainer)||void 0===e||null===(e=e.parentNode)||void 0===e||e.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null);}emit(e,...t){this.eventEmitter.emit(e,...t);}once(e,...t){this.eventEmitter.once(e,...t);}getMapContainer(){return this.$mapContainer;}getCanvasOverlays(){var e;return null===(e=this.getMapContainer())||void 0===e?void 0:e.querySelector(".maplibregl-canvas-container");}meterToCoord(e,t){let n=new u.default.LngLat(e[0],e[1]),r=new u.default.LngLat(t[0],t[1]),i=n.distanceTo(r),a=u.default.MercatorCoordinate.fromLngLat({lng:e[0],lat:e[1]}),o=u.default.MercatorCoordinate.fromLngLat({lng:t[0],lat:t[1]}),{x:s,y:l}=a,{x:c,y:d}=o;return 8388608*Math.sqrt(Math.pow(s-c,2)+Math.pow(l-d,2))/i;}exportMap(e){let t=this.map.getCanvas();return"jpg"===e?null==t?void 0:t.toDataURL("image/jpeg"):null==t?void 0:t.toDataURL("image/png");}creatMapContainer(e){let t=e;"string"==typeof e&&(t=document.getElementById(e));let n=document.createElement("div");return n.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,n.id="l7_mapbox_div"+v++,t.appendChild(n),n;}}},a6933970:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e,t,n){var r;return function(){var i=this,a=arguments,o=n&&!r;clearTimeout(r),r=setTimeout(function(){r=null,n||e.apply(i,a);},t),o&&e.apply(i,a);};};},a6bc6c74:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t;};},a6d08c6a:function(e,t,n){var r=n("379470e1"),i=n("689596c4"),a=n("bab17bc9"),o=a&&a.isSet,s=o?i(o):r;e.exports=s;},a807b8b1:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{MercatorCoordinate:function(){return p;},altitudeFromMercatorZ:function(){return f;},latFromMercatorY:function(){return d;},lngFromMercatorX:function(){return c;},mercatorScale:function(){return h;},mercatorXfromLng:function(){return s;},mercatorYfromLat:function(){return l;},mercatorZfromAltitude:function(){return u;}});var r=n("777fffbe")._(n("d812e418")),i=n("5c93f055");let a=2*Math.PI*i.earthRadius;function o(e){return a*Math.cos(e*Math.PI/180);}function s(e){return(180+e)/360;}function l(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360;}function u(e,t){return e/o(t);}function c(e){return 360*e-180;}function d(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90;}function f(e,t){return e*o(d(t));}function h(e){return 1/Math.cos(e*Math.PI/180);}class p{constructor(e,t,n=0){(0,r.default)(this,"x",void 0),(0,r.default)(this,"y",void 0),(0,r.default)(this,"z",void 0),this.x=+e,this.y=+t,this.z=+n;}static fromLngLat(e,t=0){let n=i.LngLat.convert(e);return new p(s(n.lng),l(n.lat),t/o(n.lat));}toLngLat(){return new i.LngLat(c(this.x),d(this.y));}toAltitude(){return f(this.z,this.y);}meterInMercatorCoordinateUnits(){return 1/a*h(d(this.y));}}},a843c57c:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=n("d9b661b3"),o=r._(n("755bc4f8")),s=n("909eb2d3"),l=n("f717bab4");class u extends o.default{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10});}getCommonUniformsInfo(){let{blend:e,speed:t=1,unit:n="pixel"}=this.layer.getLayerConfig(),r={u_additive:"additive"===e?1:0,u_size_unit:s.SizeUnitType[n],u_speed:t,u_time:this.layer.getLayerAnimateTime()};return this.getUniformsBufferInfo(r);}getAnimateUniforms(){return{};}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),l.PointFillTriangulation);}initModels(){var e=this;return(0,i.default)(function*(){return e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;\n\nlayout(std140) uniform commonUniorm {\n  float u_additive;\n  float u_size_unit;\n  float u_speed: 1.0;\n  float u_time;\n};\n\nout vec4 v_data;\nout vec4 v_color;\nout float v_radius;\nout vec2 v_extrude;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  float newSize = setPickingSize(a_Size);\n\n  float time = u_time * u_speed;\n  mat2 rotateMatrix = mat2(\n    cos(time), sin(time),\n    -sin(time), cos(time)\n  );\n  v_extrude = rotateMatrix * a_Extrude.xy;\n\n  v_color = a_Color;\n  v_color.a *= opacity;\n\n  float blur = 0.0;\n  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);\n\n  if(u_size_unit == 1.) {\n    newSize = newSize  * u_PixelsPerMeter.z;\n  }\n  v_radius = newSize;\n\n  vec2 offset = (a_Extrude.xy * (newSize));\n\n  offset = project_pixel(offset);\n\n  v_data = vec4(a_Extrude.x, a_Extrude.y, antialiasblur, -1.0);\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'\nlayout(std140) uniform commonUniorm{\n  float u_additive;\n  float u_size_unit;\n  float u_speed: 1.0;\n  float u_time;\n};\nin vec4 v_data;\nin vec4 v_color;\nin float v_radius;\nin vec2 v_extrude;\n#pragma include "sdf_2d"\n#pragma include "picking"\n\nout vec4 outputColor;\n\nvoid main() {\n\n  lowp float antialiasblur = v_data.z;\n  float r = v_radius / (v_radius);\n\n  float outer_df = sdCircle(v_data.xy, 1.0);\n  float inner_df = sdCircle(v_data.xy, r);\n\n  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);\n\n  outputColor = vec4(v_color.rgb, v_color.a);\n\n  if(u_additive > 0.0) {\n    outputColor *= opacity_t;\n  } else {\n    outputColor.a *= opacity_t;\n  }\n\n  if(outputColor.a > 0.0) {\n    outputColor = filterColor(outputColor);\n  }\n\n  vec2 extrude =  v_extrude;\n  vec2 dir = normalize(extrude);\n  vec2 baseDir = vec2(1.0, 0.0);\n  float pi = 3.14159265359;\n  float flag = sign(dir.y);\n  float rades = dot(dir, baseDir);\n  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;\n  // simple AA\n  if(radar_v > 0.99) {\n    radar_v = 1.0 - (radar_v - 0.99)/0.01;\n  }\n\n  outputColor.a *= radar_v;\n}\n',triangulation:l.PointFillTriangulation,defines:e.getDefines(),inject:e.getInject(),depth:{enable:!1}}))];})();}animateOption2Array(e){return[e.enable?0:1,e.speed||1,e.rings||3,0];}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:a.AttributeType.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:a.gl.DYNAMIC_DRAW,data:[],type:a.gl.FLOAT},size:3,update:(e,t,n,r)=>{let i=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],a=r%4*3;return[i[a],i[a+1],i[a+2]];}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:a.AttributeType.Attribute,descriptor:{shaderLocation:this.attributeLocation.SIZE,name:"a_Size",buffer:{usage:a.gl.DYNAMIC_DRAW,data:[],type:a.gl.FLOAT},size:1,update:e=>{let{size:t=5}=e;return Array.isArray(t)?[t[0]]:[t];}}});}}},a8505623:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=r._(n("4ce96d25"));class s extends o.default{constructor(...e){super(...e),(0,a.default)(this,"type","TileDebugLayer"),(0,a.default)(this,"zIndex",1e4),(0,a.default)(this,"defaultSourceConfig",{data:[],options:{parser:{type:"testTile"}}});}buildModels(){return(0,i.default)(function*(){})();}}},a8a8fe9d:function(e,t,n){var r=n("d59953b5"),i=n("a660bda5"),a=n("7c1db5f7"),o=n("d2230a39"),s=/^\[object .+?Constructor\]$/,l=Object.prototype,u=Function.prototype.toString,c=l.hasOwnProperty,d=RegExp("^"+u.call(c).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!a(e)||i(e))&&(r(e)?d:s).test(o(e));};},a8be75a3:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("3dab17b9")),a=r._(n("03d93d57")),o=function(e,t){var n=(0,a.default)(e,t);return(0,i.default)(n)?n:void 0;};},a917243b:function(e,t,n){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1;};},a97b4ee8:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{ExportImage:function(){return s.ExportImage;},Fullscreen:function(){return l.Fullscreen;},GeoLocate:function(){return u.GeoLocate;},LayerPopup:function(){return m.LayerPopup;},LayerSwitch:function(){return c.LayerSwitch;},Logo:function(){return d.Logo;},MapTheme:function(){return f.MapTheme;},Marker:function(){return a.default;},MarkerLayer:function(){return o.default;},MouseLocation:function(){return h.MouseLocation;},Popup:function(){return y.Popup;},Scale:function(){return p.Scale;},Swipe:function(){return v.Swipe;},Zoom:function(){return g.Zoom;}});var r=n("d1751d7c"),i=n("777fffbe"),a=i._(n("d72829b5")),o=i._(n("f0c4f7d7"));n("2c226e10"),r._(n("9d431275"),t);var s=n("96b4b0c5"),l=n("90fbbd39"),u=n("612663f6"),c=n("001e0431"),d=n("486a3722"),f=n("8af5aa53"),h=n("c75ed7e1"),p=n("1ecef0ca"),v=n("0d5f117c"),g=n("082ade53");r._(n("d85ce7f8"),t);var m=n("1cbbcd12"),y=n("2eabba1c");!function(e,t){var n="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,r="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram);if(!n&&!r&&(t||(t=document),t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i);}var o=t.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o);}}(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font:
    12px 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 999;
  box-sizing: border-box;
}
.l7-control-container {
  font:
    12px/1.5 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 999;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: flex;
  justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  align-items: flex-end;
}
.l7-control-container .l7-column {
  flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0 6px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  align-items: flex-start;
}
.l7-popper.l7-popper-end {
  align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  display: flex;
  align-items: center;
  height: 24px;
  padding: 0 16px;
  font-size: 12px;
  line-height: 24px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  width: 14px;
  height: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  display: flex;
  flex-wrap: wrap;
  align-items: flex-start;
  box-sizing: content-box;
  max-width: 460px;
  max-height: 400px;
  margin: 12px 0 0 12px;
  overflow-x: hidden;
  overflow-y: auto;
}
.l7-select-control--image .l7-select-control-item {
  position: relative;
  display: flex;
  flex: 0 0 calc((100% - (12px + 9px) * 2) / 3);
  flex-direction: column;
  justify-content: center;
  box-sizing: content-box;
  margin-right: 12px;
  margin-bottom: 12px;
  overflow: hidden;
  font-size: 12px;
  border: 1px solid #fff;
  border-radius: 2px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 100%;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  top: 0;
  right: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  overflow: hidden;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-control-zoom .l7-button-control {
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  border-radius: 0;
  box-shadow: 0 0 0;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:last-child {
  border-bottom: 0;
}
.l7-control-zoom .l7-control-zoom__number {
  color: #595959;
  padding: 0;
}
.l7-control-zoom .l7-control-zoom__number:hover {
  background-color: #fff;
}
.l7-control-scale {
  display: flex;
  flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: flex;
  align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
.l7-control-swipe {
  position: absolute;
  top: 50%;
  left: 50%;
  z-index: 6;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  touch-action: none;
}
.l7-control-swipe_hide {
  display: none;
}
.l7-control-swipe:before {
  position: absolute;
  top: -5000px;
  bottom: -5000px;
  left: 50%;
  z-index: -1;
  width: 4px;
  background: #fff;
  -webkit-transform: translate(-2px, 0);
          transform: translate(-2px, 0);
  content: '';
}
.l7-control-swipe.horizontal:before {
  top: 50%;
  right: -5000px;
  bottom: auto;
  left: -5000px;
  width: auto;
  height: 4px;
}
.l7-control-swipe__button {
  display: block;
  width: 28px;
  height: 28px;
  margin: 0;
  padding: 0;
  color: #595959;
  font-weight: bold;
  font-size: inherit;
  text-align: center;
  text-decoration: none;
  background-color: #fff;
  border: none;
  border-radius: 2px;
  outline: none;
}
.l7-control-swipe,
.l7-control-swipe__button {
  cursor: ew-resize;
}
.l7-control-swipe.horizontal,
.l7-control-swipe.horizontal button {
  cursor: ns-resize;
}
.l7-control-swipe:after,
.l7-control-swipe__button:before,
.l7-control-swipe__button:after {
  position: absolute;
  top: 25%;
  bottom: 25%;
  left: 50%;
  width: 2px;
  background: currentColor;
  -webkit-transform: translate(-1px, 0);
          transform: translate(-1px, 0);
  content: '';
}
.l7-control-swipe__button:after {
  -webkit-transform: translateX(4px);
          transform: translateX(4px);
}
.l7-control-swipe__button:before {
  -webkit-transform: translateX(-6px);
          transform: translateX(-6px);
}
`);},a985b25e:function(e,t,n){var r=n("011deb24"),i=n("6b3683f9");e.exports=function(e,t,n,a){var o=!n;n||(n={});for(var s=-1,l=t.length;++s<l;){var u=t[s],c=a?a(n[u],e[u],u,n,e):void 0;void 0===c&&(c=e[u]),o?i(n,u,c):r(n,u,c);}return n;};},a9c461d6:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("45557e8b")),i=function(e,t){var n=e.__data__;return(0,r.default)(t)?n["string"==typeof t?"string":"hash"]:n.map;};},aa15234a:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e,t){return e===t||e!=e&&t!=t;};},aa587738:function(e,t,n){"use strict";function r(e,t){let n=[],r=[],i=[],a=e+1,o=t+1,s=e/2,l=t/2;for(let n=0;n<o;n++){let o=n-l;for(let u=0;u<a;u++){let a=u-s;r.push(a/s,-o/l,0),i.push(u/e),i.push(1-n/t);}}for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=t+a*r,i=t+a*(r+1),o=t+1+a*(r+1),s=t+1+a*r;n.push(e,i,s),n.push(i,o,s);}return{vertices:r,indices:n,uvs:i};}n.d(t,"__esModule",{value:!0}),n.d(t,"heatMap3DTriangulation",{enumerable:!0,get:function(){return r;}});},aab06fd5:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"Protocol",{enumerable:!0,get:function(){return J;}});var r,i,a,o,s=(e,t,n)=>new Promise((r,i)=>{var a=e=>{try{s(n.next(e));}catch(e){i(e);}},o=e=>{try{s(n.throw(e));}catch(e){i(e);}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(a,o);s((n=n.apply(e,t)).next());}),l=Uint8Array,u=Uint16Array,c=Int32Array,d=new l([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),f=new l([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),h=new l([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),p=function(e,t){for(var n=new u(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var i=new c(n[30]),r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)i[a]=a-n[r]<<5|r;return{b:n,r:i};},v=p(d,2),g=v.b,m=v.r;g[28]=258,m[258]=28;var y=p(f,0),b=y.b;y.r;var _=new u(32768);for(o=0;o<32768;++o)a=(61680&(a=(52428&(a=(43690&o)>>1|(21845&o)<<1))>>2|(13107&a)<<2))>>4|(3855&a)<<4,_[o]=((65280&a)>>8|(255&a)<<8)>>1;var x=function(e,t,n){for(var r,i=e.length,a=0,o=new u(t);a<i;++a)e[a]&&++o[e[a]-1];var s=new u(t);for(a=1;a<t;++a)s[a]=s[a-1]+o[a-1]<<1;if(n){r=new u(1<<t);var l=15-t;for(a=0;a<i;++a)if(e[a])for(var c=a<<4|e[a],d=t-e[a],f=s[e[a]-1]++<<d,h=f|(1<<d)-1;f<=h;++f)r[_[f]>>l]=c;}else for(a=0,r=new u(i);a<i;++a)e[a]&&(r[a]=_[s[e[a]-1]++]>>15-e[a]);return r;},w=new l(288);for(o=0;o<144;++o)w[o]=8;for(o=144;o<256;++o)w[o]=9;for(o=256;o<280;++o)w[o]=7;for(o=280;o<288;++o)w[o]=8;var E=new l(32);for(o=0;o<32;++o)E[o]=5;var M=x(w,9,1),S=x(E,5,1),k=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t;},C=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n;},A=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t);},L=function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var r=new l(n-t);return r.set(e.subarray(t,n)),r;},P=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],N=function(e,t,n){var r=Error(t||P[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,N),!n)throw r;return r;},O=function(e,t,n,r){var i=e.length,a=r?r.length:0;if(!i||t.f&&!t.l)return n||new l(0);var o=!n||2!=t.i,s=t.i;n||(n=new l(3*i));var u=function(e){var t=n.length;if(e>t){var r=new l(Math.max(2*t,e));r.set(n),n=r;}},c=t.f||0,p=t.p||0,v=t.b||0,m=t.l,y=t.d,_=t.m,w=t.n,E=8*i;do{if(!m){c=C(e,p,1);var P=C(e,p+1,3);if(p+=3,P){if(1==P)m=M,y=S,_=9,w=5;else if(2==P){var O=C(e,p,31)+257,I=C(e,p+10,15)+4,R=O+C(e,p+5,31)+1;p+=14;for(var D=new l(R),z=new l(19),B=0;B<I;++B)z[h[B]]=C(e,p+3*B,7);p+=3*I;for(var U=k(z),F=(1<<U)-1,j=x(z,U,1),B=0;B<R;){var V=j[C(e,p,F)];p+=15&V;var G=V>>4;if(G<16)D[B++]=G;else{var H=0,W=0;for(16==G?(W=3+C(e,p,3),p+=2,H=D[B-1]):17==G?(W=3+C(e,p,7),p+=3):18==G&&(W=11+C(e,p,127),p+=7);W--;)D[B++]=H;}}var Z=D.subarray(0,O),q=D.subarray(O);_=k(Z),w=k(q),m=x(Z,_,1),y=x(q,w,1);}else N(1);}else{var G=((p+7)/8|0)+4,Y=e[G-4]|e[G-3]<<8,X=G+Y;if(X>i){s&&N(0);break;}o&&u(v+Y),n.set(e.subarray(G,X),v),t.b=v+=Y,t.p=p=8*X,t.f=c;continue;}if(p>E){s&&N(0);break;}}o&&u(v+131072);for(var $=(1<<_)-1,K=(1<<w)-1,Q=p;;Q=p){var H=m[A(e,p)&$],J=H>>4;if((p+=15&H)>E){s&&N(0);break;}if(H||N(2),J<256)n[v++]=J;else if(256==J){Q=p,m=null;break;}else{var ee=J-254;if(J>264){var B=J-257,et=d[B];ee=C(e,p,(1<<et)-1)+g[B],p+=et;}var en=y[A(e,p)&K],er=en>>4;en||N(3),p+=15&en;var q=b[er];if(er>3){var et=f[er];q+=A(e,p)&(1<<et)-1,p+=et;}if(p>E){s&&N(0);break;}o&&u(v+131072);var ei=v+ee;if(v<q){var ea=a-q,eo=Math.min(q,ei);for(ea+v<0&&N(3);v<eo;++v)n[v]=r[ea+v];}for(;v<ei;v+=4)n[v]=n[v-q],n[v+1]=n[v+1-q],n[v+2]=n[v+2-q],n[v+3]=n[v+3-q];v=ei;}}t.l=m,t.p=Q,t.b=v,t.f=c,m&&(c=1,t.m=_,t.d=y,t.n=w);}while(!c)return v==n.length?n:L(n,0,v);},I=new l(0),R=function(e){(31!=e[0]||139!=e[1]||8!=e[2])&&N(6,"invalid gzip data");var t=e[3],n=10;4&t&&(n+=(e[10]|e[11]<<8)+2);for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(2&t);},D=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0;};function z(e,t){var n,r;return 31==e[0]&&139==e[1]&&8==e[2]?((n=R(e))+8>e.length&&N(6,"invalid gzip data"),O(e.subarray(n,-8),{i:2},t&&t.out||new l(D(e)),t&&t.dictionary)):(15&e[0])!=8||e[0]>>4>7||(e[0]<<8|e[1])%31?O(e,{i:2},t&&t.out,t&&t.dictionary):O(e.subarray((r=t&&t.dictionary,((15&e[0])!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&N(6,"invalid zlib data"),(e[1]>>5&1)==+!r&&N(6,"invalid zlib data: "+(32&e[1]?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2),-4),{i:2},t&&t.out,t&&t.dictionary);}var B="undefined"!=typeof TextDecoder&&new TextDecoder;try{B.decode(I,{stream:!0});}catch(e){}var U=(e,t)=>e*Math.pow(2,t),F=(e,t)=>Math.floor(e/Math.pow(2,t)),j=(e,t)=>U(e.getUint16(t+1,!0),8)+e.getUint8(t),V=(e,t)=>U(e.getUint32(t+2,!0),16)+e.getUint16(t,!0),G=(e,t,n,r,i)=>{if(e!=r.getUint8(i))return e-r.getUint8(i);let a=j(r,i+1);if(t!=a)return t-a;let o=j(r,i+4);return n!=o?n-o:0;},H=(e,t,n,r)=>{let i=Z(e,128|t,n,r);return i?{z:t,x:n,y:r,offset:i[0],length:i[1],is_dir:!0}:null;},W=(e,t,n,r)=>{let i=Z(e,t,n,r);return i?{z:t,x:n,y:r,offset:i[0],length:i[1],is_dir:!1}:null;},Z=(e,t,n,r)=>{let i=0,a=e.byteLength/17-1;for(;i<=a;){let o=a+i>>1,s=G(t,n,r,e,17*o);if(s>0)i=o+1;else{if(!(s<0))return[V(e,17*o+7),e.getUint32(17*o+13,!0)];a=o-1;}}return null;},q=(e,t)=>e.is_dir&&!t.is_dir?1:!e.is_dir&&t.is_dir?-1:e.z!==t.z?e.z-t.z:e.x!==t.x?e.x-t.x:e.y-t.y,Y=(e,t)=>{let n=e.getUint8(17*t);return{z:127&n,x:j(e,17*t+1),y:j(e,17*t+4),offset:V(e,17*t+7),length:e.getUint32(17*t+13,!0),is_dir:n>>7==1};},X=e=>{let t=[],n=new DataView(e);for(let e=0;e<n.byteLength/17;e++)t.push(Y(n,e));return $(t);},$=e=>{e.sort(q);let t=new ArrayBuffer(17*e.length),n=new Uint8Array(t);for(let t=0;t<e.length;t++){let r=e[t],i=r.z;r.is_dir&&(i|=128),n[17*t]=i,n[17*t+1]=255&r.x,n[17*t+2]=r.x>>8&255,n[17*t+3]=r.x>>16&255,n[17*t+4]=255&r.y,n[17*t+5]=r.y>>8&255,n[17*t+6]=r.y>>16&255,n[17*t+7]=255&r.offset,n[17*t+8]=255&F(r.offset,8),n[17*t+9]=255&F(r.offset,16),n[17*t+10]=255&F(r.offset,24),n[17*t+11]=255&F(r.offset,32),n[17*t+12]=255&F(r.offset,48),n[17*t+13]=255&r.length,n[17*t+14]=r.length>>8&255,n[17*t+15]=r.length>>16&255,n[17*t+16]=r.length>>24&255;}return t;},K=(e,t)=>{if(e.byteLength<17)return null;let n=e.byteLength/17,r=Y(e,n-1);if(r.is_dir){let e=r.z,n=t.z-e;return{z:e,x:Math.trunc(t.x/(1<<n)),y:Math.trunc(t.y/(1<<n))};}return null;},Q={getHeader:function(e){return s(this,null,function*(){let t=yield e.getBytes(0,512e3),n=new DataView(t.data),r=n.getUint32(4,!0),i=n.getUint16(8,!0),a=JSON.parse(new TextDecoder("utf-8").decode(new DataView(t.data,10,r))),o=0;"gzip"===a.compression&&(o=2);let s=0;"minzoom"in a&&(s=+a.minzoom);let l=0;"maxzoom"in a&&(l=+a.maxzoom);let u=0,c=0,d=0,f=-180,h=-85,p=180,v=85;if(a.bounds){let e=a.bounds.split(",");f=+e[0],h=+e[1],p=+e[2],v=+e[3];}if(a.center){let e=a.center.split(",");u=+e[0],c=+e[1],d=+e[2];}return{specVersion:n.getUint16(2,!0),rootDirectoryOffset:10+r,rootDirectoryLength:17*i,jsonMetadataOffset:10,jsonMetadataLength:r,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:o,tileType:1,minZoom:s,maxZoom:l,minLon:f,minLat:h,maxLon:p,maxLat:v,centerZoom:d,centerLon:u,centerLat:c,etag:t.etag};});},getZxy:function(e,t,n,r,i,a,o){return s(this,null,function*(){let s=yield n.getArrayBuffer(t,e.rootDirectoryOffset,e.rootDirectoryLength,e);1===e.specVersion&&(s=X(s));let l=W(new DataView(s),r,i,a);if(l){let e=(yield t.getBytes(l.offset,l.length,o)).data,n=new DataView(e);return 31==n.getUint8(0)&&139==n.getUint8(1)&&(e=z(new Uint8Array(e))),{data:e};}let u=K(new DataView(s),{z:r,x:i,y:a});if(u){let l=H(new DataView(s),u.z,u.x,u.y);if(l){let s=yield n.getArrayBuffer(t,l.offset,l.length,e);1===e.specVersion&&(s=X(s));let u=W(new DataView(s),r,i,a);if(u){let e=(yield t.getBytes(u.offset,u.length,o)).data,n=new DataView(e);return 31==n.getUint8(0)&&139==n.getUint8(1)&&(e=z(new Uint8Array(e))),{data:e};}}}});}},J=class{constructor(){this.tile=(e,t)=>{if("json"==e.type){let n=e.url.substr(10),r=this.tiles.get(n);return r||(r=new ec(n),this.tiles.set(n,r)),r.getHeader().then(n=>{t(null,{tiles:[e.url+"/{z}/{x}/{y}"],minzoom:n.minZoom,maxzoom:n.maxZoom,bounds:[n.minLon,n.minLat,n.maxLon,n.maxLat]},null,null);}).catch(e=>{t(e,null,null,null);}),{cancel:()=>{}};}{let n=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),r=e.url.match(n);if(!r)throw Error("Invalid PMTiles protocol URL");let i=r[1],a=this.tiles.get(i);a||(a=new ec(i),this.tiles.set(i,a));let o=r[2],s=r[3],l=r[4],u=new AbortController,c=u.signal;return a.getHeader().then(e=>{a.getZxy(+o,+s,+l,c).then(n=>{n?t(null,new Uint8Array(n.data),n.cacheControl,n.expires):1==e.tileType?t(null,new Uint8Array,null,null):t(null,null,null,null);}).catch(e=>{"AbortError"!==e.name&&t(e,null,null,null);});}),{cancel:()=>{u.abort();}};}},this.tiles=new Map;}add(e){this.tiles.set(e.source.getKey(),e);}get(e){return this.tiles.get(e);}};function ee(e){let t,n;let r=e.buf;return(t=127&(n=r[e.pos++]),n<128)?t:(t|=(127&(n=r[e.pos++]))<<7,n<128)?t:(t|=(127&(n=r[e.pos++]))<<14,n<128)?t:(t|=(127&(n=r[e.pos++]))<<21,n<128)?t:function(e,t){let n,r;let i=t.buf;if(n=(112&(r=i[t.pos++]))>>4,r<128||(n|=(127&(r=i[t.pos++]))<<3,r<128)||(n|=(127&(r=i[t.pos++]))<<10,r<128)||(n|=(127&(r=i[t.pos++]))<<17,r<128)||(n|=(127&(r=i[t.pos++]))<<24,r<128)||(n|=(1&(r=i[t.pos++]))<<31,r<128))return(n>>>0)*4294967296+(e>>>0);throw Error("Expected varint not more than 10 bytes");}(t|=(15&(n=r[e.pos]))<<28,e);}var et=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555],en=((r=en||{})[r.Unknown=0]="Unknown",r[r.None=1]="None",r[r.Gzip=2]="Gzip",r[r.Brotli=3]="Brotli",r[r.Zstd=4]="Zstd",r);function er(e,t){return s(this,null,function*(){if(1===t||0===t)return e;if(2===t){if(void 0===globalThis.DecompressionStream)return z(new Uint8Array(e));{let t=new Response(e).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(t).arrayBuffer();}}throw Error("Compression method not supported");});}var ei=((i=ei||{})[i.Unknown=0]="Unknown",i[i.Mvt=1]="Mvt",i[i.Png=2]="Png",i[i.Jpeg=3]="Jpeg",i[i.Webp=4]="Webp",i[i.Avif=5]="Avif",i),ea=class{constructor(e,t=new Headers){this.url=e,this.customHeaders=t;}getKey(){return this.url;}setHeaders(e){this.customHeaders=e;}getBytes(e,t,n){return s(this,null,function*(){let r;n||(n=(r=new AbortController).signal);let i=new Headers(this.customHeaders);i.set("Range","bytes="+e+"-"+(e+t-1));let a=yield fetch(this.url,{signal:n,headers:i});if(416===a.status&&0===e){let e=a.headers.get("Content-Range");if(!e||!e.startsWith("bytes */"))throw Error("Missing content-length on 416 response");let t=+e.substr(8);a=yield fetch(this.url,{signal:n,headers:{Range:"bytes=0-"+(t-1)}});}if(a.status>=300)throw Error("Bad response code: "+a.status);let o=a.headers.get("Content-Length");if(200===a.status&&(!o||+o>t))throw r&&r.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield a.arrayBuffer(),etag:a.headers.get("ETag")||void 0,cacheControl:a.headers.get("Cache-Control")||void 0,expires:a.headers.get("Expires")||void 0};});}};function eo(e,t){return 4294967296*e.getUint32(t+4,!0)+e.getUint32(t+0,!0);}function es(e){let t={buf:new Uint8Array(e),pos:0},n=ee(t),r=[],i=0;for(let e=0;e<n;e++){let e=ee(t);r.push({tileId:i+e,offset:0,length:0,runLength:1}),i+=e;}for(let e=0;e<n;e++)r[e].runLength=ee(t);for(let e=0;e<n;e++)r[e].length=ee(t);for(let e=0;e<n;e++){let n=ee(t);0===n&&e>0?r[e].offset=r[e-1].offset+r[e-1].length:r[e].offset=n-1;}return r;}var el=class extends Error{},eu=class{constructor(e=100,t=!0,n=er){this.cache=new Map,this.maxCacheEntries=e,this.counter=1,this.prefetch=t,this.decompress=n;}getHeader(e,t){return s(this,null,function*(){let n=e.getKey();if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;let r=new Promise((n,r)=>{(function(e,t,n,r){return s(this,null,function*(){let i=yield e.getBytes(0,16384);if(19792!==new DataView(i.data).getUint16(0,!0))throw Error("Wrong magic number for PMTiles archive");if(3>function(e){let t=new DataView(e);return 2===t.getUint16(2,!0)?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):1===t.getUint16(2,!0)?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3;}(i.data))return[(yield Q.getHeader(e))];let a=i.data.slice(0,127),o=i.etag;r&&i.etag!=r&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+e.getKey()),o=void 0);let s=function(e,t){let n=new DataView(e),r=n.getUint8(7);if(r>3)throw Error(`Archive is spec version ${r} but this library supports up to spec version 3`);return{specVersion:r,rootDirectoryOffset:eo(n,8),rootDirectoryLength:eo(n,16),jsonMetadataOffset:eo(n,24),jsonMetadataLength:eo(n,32),leafDirectoryOffset:eo(n,40),leafDirectoryLength:eo(n,48),tileDataOffset:eo(n,56),tileDataLength:eo(n,64),numAddressedTiles:eo(n,72),numTileEntries:eo(n,80),numTileContents:eo(n,88),clustered:1===n.getUint8(96),internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:t};}(a,o);if(n){let n=i.data.slice(s.rootDirectoryOffset,s.rootDirectoryOffset+s.rootDirectoryLength),r=e.getKey()+"|"+(s.etag||"")+"|"+s.rootDirectoryOffset+"|"+s.rootDirectoryLength,a=es((yield t(n,s.internalCompression)));return[s,[r,a.length,a]];}return[s,void 0];});})(e,this.decompress,this.prefetch,t).then(e=>{e[1]&&this.cache.set(e[1][0],{lastUsed:this.counter++,data:Promise.resolve(e[1][2])}),n(e[0]),this.prune();}).catch(e=>{r(e);});});return this.cache.set(n,{lastUsed:this.counter++,data:r}),r;});}getDirectory(e,t,n,r){return s(this,null,function*(){let i=e.getKey()+"|"+(r.etag||"")+"|"+t+"|"+n;if(this.cache.has(i))return this.cache.get(i).lastUsed=this.counter++,yield this.cache.get(i).data;let a=new Promise((i,a)=>{(function(e,t,n,r,i){return s(this,null,function*(){let a=yield e.getBytes(n,r);if(i.etag&&i.etag!==a.etag)throw new el(a.etag);let o=es((yield t(a.data,i.internalCompression)));if(0===o.length)throw Error("Empty directory is invalid");return o;});})(e,this.decompress,t,n,r).then(e=>{i(e),this.prune();}).catch(e=>{a(e);});});return this.cache.set(i,{lastUsed:this.counter++,data:a}),a;});}getArrayBuffer(e,t,n,r){return s(this,null,function*(){let i=e.getKey()+"|"+(r.etag||"")+"|"+t+"|"+n;if(this.cache.has(i))return this.cache.get(i).lastUsed=this.counter++,yield this.cache.get(i).data;let a=new Promise((a,o)=>{e.getBytes(t,n).then(e=>{if(r.etag&&r.etag!==e.etag)throw new el(e.etag);a(e.data),this.cache.has(i),this.prune();}).catch(e=>{o(e);});});return this.cache.set(i,{lastUsed:this.counter++,data:a}),a;});}prune(){if(this.cache.size>=this.maxCacheEntries){let e,t=1/0;this.cache.forEach((n,r)=>{n.lastUsed<t&&(t=n.lastUsed,e=r);}),e&&this.cache.delete(e);}}invalidate(e,t){return s(this,null,function*(){this.cache.delete(e.getKey()),yield this.getHeader(e,t);});}},ec=class{constructor(e,t,n){"string"==typeof e?this.source=new ea(e):this.source=e,n?this.decompress=n:this.decompress=er,t?this.cache=t:this.cache=new eu;}getHeader(){return s(this,null,function*(){return yield this.cache.getHeader(this.source);});}getZxyAttempt(e,t,n,r){return s(this,null,function*(){let i=function(e,t,n){if(e>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(t>Math.pow(2,e)-1||n>Math.pow(2,e)-1)throw Error("tile x/y outside zoom level bounds");let r=et[e],i=0,a=0,o=0,s=[t,n],l=Math.pow(2,e)/2;for(;l>0;)i=(s[0]&l)>0?1:0,a=(s[1]&l)>0?1:0,o+=l*l*(3*i^a),function(e,t,n,r){if(0==r){1==n&&(t[0]=e-1-t[0],t[1]=e-1-t[1]);let r=t[0];t[0]=t[1],t[1]=r;}}(l,s,i,a),l/=2;return r+o;}(e,t,n),a=yield this.cache.getHeader(this.source);if(a.specVersion<3)return Q.getZxy(a,this.source,this.cache,e,t,n,r);if(e<a.minZoom||e>a.maxZoom)return;let o=a.rootDirectoryOffset,s=a.rootDirectoryLength;for(let e=0;e<=3;e++){let e=function(e,t){let n=0,r=e.length-1;for(;n<=r;){let i=r+n>>1,a=t-e[i].tileId;if(a>0)n=i+1;else{if(!(a<0))return e[i];r=i-1;}}return r>=0&&(0===e[r].runLength||t-e[r].tileId<e[r].runLength)?e[r]:null;}((yield this.cache.getDirectory(this.source,o,s,a)),i);if(!e)return;if(e.runLength>0){let t=yield this.source.getBytes(a.tileDataOffset+e.offset,e.length,r);if(a.etag&&a.etag!==t.etag)throw new el(t.etag);return{data:yield this.decompress(t.data,a.tileCompression),cacheControl:t.cacheControl,expires:t.expires};}o=a.leafDirectoryOffset+e.offset,s=e.length;}throw Error("Maximum directory depth exceeded");});}getZxy(e,t,n,r){return s(this,null,function*(){try{return yield this.getZxyAttempt(e,t,n,r);}catch(i){if(i instanceof el)return this.cache.invalidate(this.source,i.message),yield this.getZxyAttempt(e,t,n,r);throw i;}});}getMetadataAttempt(){return s(this,null,function*(){let e=yield this.cache.getHeader(this.source),t=yield this.source.getBytes(e.jsonMetadataOffset,e.jsonMetadataLength);if(e.etag&&e.etag!==t.etag)throw new el(t.etag);let n=yield this.decompress(t.data,e.internalCompression);return JSON.parse(new TextDecoder("utf-8").decode(n));});}getMetadata(){return s(this,null,function*(){try{return yield this.getMetadataAttempt();}catch(e){if(e instanceof el)return this.cache.invalidate(this.source,e.message),yield this.getMetadataAttempt();throw e;}});}};},aabd5101:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("391a4293");},aaf3e953:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("dbd10968")),a=r._(n("3552f5f3"));class o extends i.default{getServiceConstructor(){return a.default;}}},ab7074ef:function(e,t,n){e.exports=function(e,t,n,r){var i=-1,a=null==e?0:e.length;for(r&&a&&(n=e[++i]);++i<a;)n=t(n,e[i],i,e);return n;};},abc78c0a:function(e,t,n){"use strict";function r(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},acd36e4a:function(e,t,n){var r=n("afa9632d"),i=n("7bc08ef6"),a=n("1b287fd2"),o=n("1cfebee7"),s=i(function(e){return a(r(e,1,o,!0));});e.exports=s;},ace6cca6:function(e,t,n){var r=n("09bf3f04");e.exports=function(e,t){return r(e,t,"pre");};},acec17a3:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0});var r=n("d1751d7c");r._(n("b76da610"),t),r._(n("7d058635"),t);},ad32fc63:function(e,t,n){var r=n("13056af7"),i=n("fe190914");e.exports=function(e){return i(r(e).toLowerCase());};},ad8315ce:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(){};},ad8fd27a:function(e,t,n){"use strict";function r(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},ad9c2b8c:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"path2Absolute",{enumerable:!0,get:function(){return a;}});var r=n("c80c7fe3"),i=n("e2594fe6");function a(e){if((0,r.isAbsoluteArray)(e))return[].concat(e);var t=(0,i.parsePathString)(e),n=0,a=0,o=0,s=0;return t.map(function(e){var t,r=e.slice(1).map(Number),i=e[0],l=i.toUpperCase();if("M"===i)return n=r[0],a=r[1],o=n,s=a,["M",n,a];if(i!==l)switch(l){case"A":t=[l,r[0],r[1],r[2],r[3],r[4],r[5]+n,r[6]+a];break;case"V":t=[l,r[0]+a];break;case"H":t=[l,r[0]+n];break;default:t=[l].concat(r.map(function(e,t){return e+(t%2?a:n);}));}else t=[l].concat(r);var u=t.length;switch(l){case"Z":n=o,a=s;break;case"H":n=t[1];break;case"V":a=t[1];break;default:n=t[u-2],a=t[u-1],"M"===l&&(o=n,s=a);}return t;});}},adc931d0:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){return e;};},add2c496:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});class r{apply(e){e.hooks.afterInit.tap("LayerMaskPlugin",()=>{let{maskLayers:t,enableMask:n}=e.getLayerConfig();!e.tileLayer&&t&&t.length>0&&e.updateLayerConfig({mask:n});});}}},adda482a:function(e,t,n){var r=n("a985b25e"),i=n("16ec8ed6");e.exports=function(e,t){return e&&r(t,i(t),e);};},ae14e70c:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=n("777fffbe")._(n("731b2a36")).default.Uint8Array;},ae336fe3:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){return"object"==typeof e&&null!==e;};},ae6890f9:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{LarkMap:function(){return b;},LarkMapContext:function(){return y;}});var r=n("777fffbe"),i=n("852bbaa9"),a=n("c1f97feb"),o=n("af467690"),s=r._(n("6d9bd3c4")),l=n("86aaa5a5"),u=i._(n("9d065c04")),c=n("b4217dd0"),d=n("50923b47"),f=n("93d9af53");function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;})(e);}var p=["id","style","className","map","mapType","mapOptions","onLayerManagerCreated","onSceneLoaded","children"];function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable;})),n.push.apply(n,r);}return n;}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach(function(t){var r,i;r=t,i=n[t],(r=function(e){var t=function(e,t){if("object"!=h(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=h(r))return r;throw TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}(e,"string");return"symbol"==h(t)?t:String(t);}(r))in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i;}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t));});}return e;}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r;}var y=u.default.createContext(null),b=(0,u.memo)((0,u.forwardRef)(function(e,t){var n,r=e.id,i=e.style,h=e.className,v=e.map,b=e.mapType,_=void 0===b?"Gaode":b,x=e.mapOptions,w=void 0===x?{}:x,E=e.onLayerManagerCreated,M=e.onSceneLoaded,S=e.children,k=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i;}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n]);}return i;}(e,p),C=(0,u.useRef)(),A=function(e){if(Array.isArray(e))return e;}(n=(0,u.useState)(null))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],l=!0,u=!1;try{for(a=(n=n.call(e)).next;!(l=(r=a.call(n)).done)&&(s.push(r.value),2!==s.length);l=!0);}catch(e){u=!0,i=e;}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return;}finally{if(u)throw i;}}return s;}}(n,2)||function(e,t){if(e){if("string"==typeof e)return m(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,2);}}(n,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}(),L=A[0],P=A[1],N=(0,u.useRef)({scene:null,layerManager:null}).current;(0,u.useEffect)(function(){var e,t=!0;return Promise.resolve((0,l.isUndefined)(v)?(0,d.createMap)(_,w):"function"==typeof v?v():v).then(function(n){if(t){e=new a.Scene(g(g({},k),{},{id:C.current,map:n}));var r=new c.LayerManager({scene:e});N.scene=e,N.layerManager=r,e.once("loaded",function(){M&&M(e),E&&E(r),P(e);});}}).catch(function(e){console.error(e);}),function(){t=!1,e&&(N.scene=null,N.layerManager=null,e.destroy());};},[]),(0,f.useSceneEvent)(L,e),(0,u.useImperativeHandle)(t,function(){return{getScene:function(){return L;},getMap:function(){return L.map;}};},[L]),(0,u.useEffect)(function(){L&&w.style&&L.setMapStyle(w.style);},[w.style]),(0,o.useDeepCompareEffect)(function(){!(0,l.isNull)(L)&&(w.center&&(0,l.isNumber)(w.zoom)?L.setZoomAndCenter(w.zoom,w.center):(0,l.isNumber)(w.zoom)?L.setZoom(w.zoom):w.center&&L.setCenter(w.center));},[w.zoom,w.center]),(0,u.useEffect)(function(){L&&(0,l.isNumber)(w.pitch)&&L.setPitch(w.pitch);},[w.pitch]),(0,u.useEffect)(function(){L&&(0,l.isNumber)(w.rotation)&&L.setRotation(w.rotation);},[w.rotation]);var O=(0,u.useMemo)(function(){return g({position:"relative"},i);},[i]);return u.default.createElement("div",{id:r,ref:C,style:O,className:(0,s.default)("larkmap",h)},L&&u.default.createElement(y.Provider,{value:N},S));}));},ae7833e7:function(e,t,n){var r=n("0f21b56b");e.exports=function(e){return r(e,4);};},aece0d56:function(e,t,n){var r=n("b5b57ddc"),i=n("2339bf2f"),a=n("f08fe8a7"),o=n("13056af7");e.exports=function(e){return function(t){var n=i(t=o(t))?a(t):void 0,s=n?n[0]:t.charAt(0),l=n?r(n,1).join(""):t.slice(1);return s[e]()+l;};};},aed3bcd2:function(e,t,n){"use strict";var r=n("ce906886");e.exports=function(e,t){var n={};return r.forEach(e,function(e,t){var i=n[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:t};r.isUndefined(e.barycenter)||(i.barycenter=e.barycenter,i.weight=e.weight);}),r.forEach(t.edges(),function(e){var t=n[e.v],i=n[e.w];r.isUndefined(t)||r.isUndefined(i)||(i.indegree++,t.out.push(n[e.w]));}),function(e){for(var t=[];e.length;){var n=e.pop();t.push(n),r.forEach(n.in.reverse(),function(e){return function(t){!t.merged&&(r.isUndefined(t.barycenter)||r.isUndefined(e.barycenter)||t.barycenter>=e.barycenter)&&function(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0;}(e,t);};}(n)),r.forEach(n.out,function(t){return function(n){n.in.push(t),0==--n.indegree&&e.push(n);};}(n));}return r.map(r.filter(t,function(e){return!e.merged;}),function(e){return r.pick(e,["vs","i","barycenter","weight"]);});}(r.filter(n,function(e){return!e.indegree;}));};},af11c929:function(e,t,n){"use strict";function r(e){return e>=48&&e<=57||43===e||45===e||46===e;}function i(e){return e>=48&&e<=57;}n.d(t,"__esModule",{value:!0}),n.e(t,{isDigit:function(){return i;},isDigitStart:function(){return r;}});},af247a07:function(e,t,n){var r=n("6b3683f9"),i=n("c692a276"),a=n("32f27622");e.exports=function(e,t){var n={};return t=a(t,3),i(e,function(e,i,a){r(n,i,t(e,i,a));}),n;};},af467690:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{useDeepCompareEffect:function(){return i.default;},useTrackedEffect:function(){return a.default;},useUnmount:function(){return o.default;},useUpdateEffect:function(){return s.default;}});var r=n("777fffbe"),i=r._(n("84cff855")),a=r._(n("d4fd229c")),o=r._(n("8ad38dd4")),s=r._(n("0de27c0d"));},afa361e1:function(e,t,n){"use strict";var r=n("ce906886");e.exports={longestPath:function(e){var t={};r.forEach(e.sources(),function n(i){var a=e.node(i);if(r.has(t,i))return a.rank;t[i]=!0;var o=r.min(r.map(e.outEdges(i),function(t){return n(t.w)-e.edge(t).minlen;}));return(o===Number.POSITIVE_INFINITY||null==o)&&(o=0),a.rank=o;});},slack:function(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen;}};},afa4dabd:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){return"object"==typeof e&&null!==e;};},afa9632d:function(e,t,n){var r=n("1911a24b"),i=n("33ba83b5");e.exports=function e(t,n,a,o,s){var l=-1,u=t.length;for(a||(a=i),s||(s=[]);++l<u;){var c=t[l];n>0&&a(c)?n>1?e(c,n-1,a,o,s):r(s,c):o||(s[s.length]=c);}return s;};},afba4989:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return p;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("b131ee44")),o=r._(n("f89fb776")),s=r._(n("d812e418")),l=n("3aa02964"),u=n("71293cfd"),c=r._(n("4f2bad25")),d=n("0e8eb136"),f=r._(n("80dad29a"));let h=["id","style","rotation","mapInstance","version","mapSize","interactive"];class p extends f.default{constructor(...e){super(...e),(0,s.default)(this,"version",d.MapType.DEFAULT),(0,s.default)(this,"viewport",void 0);}lngLatToCoord(e,t={x:0,y:0,z:0}){let{x:n,y:r}=this.lngLatToMercator(e,0);return[n-t.x,r-t.y];}lngLatToMercator(e,t){let{x:n=0,y:r=0,z:i=0}=l.MercatorCoordinate.fromLngLat(e,t);return{x:n,y:r,z:i};}getModelMatrix(e,t,n,r=[1,1,1],i={x:0,y:0,z:0}){let a=l.MercatorCoordinate.fromLngLat(e,t),o=a.meterInMercatorCoordinateUnits(),s=u.mat4.create();return u.mat4.translate(s,s,u.vec3.fromValues(a.x-i.x,a.y-i.y,a.z||0-i.z)),u.mat4.scale(s,s,u.vec3.fromValues(o*r[0],-o*r[1],o*r[2])),u.mat4.rotateX(s,s,n[0]),u.mat4.rotateY(s,s,n[1]),u.mat4.rotateZ(s,s,n[2]),s;}init(){var e=this;return(0,o.default)(function*(){let t=e.config,{id:n="map",style:r="light",rotation:o=0,mapInstance:s,version:u="DEFAULTMAP",mapSize:d=1e4,interactive:f=!0}=t,p=(0,a.default)(t,h);e.viewport=new c.default,e.version=u,e.simpleMapCoord.setSize(d),"SIMPLE"===u&&p.center&&(p.center=e.simpleMapCoord.unproject(p.center)),s?(e.map=s,e.$mapContainer=e.map.getContainer()):(e.$mapContainer=e.creatMapContainer(n),e.map=new l.Map((0,i.default)({container:e.$mapContainer,bearing:o,version:u,mapSize:d},p))),e.map.on("load",()=>{e.handleCameraChanged();}),f&&e.map.on("move",e.handleCameraChanged),setTimeout(()=>{e.handleCameraChanged();},100),e.handleCameraChanged();})();}creatMapContainer(e){let t=e;"string"==typeof e&&(t=document.getElementById(e));let n=document.createElement("div");return n.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,t.appendChild(n),n;}exportMap(e){return"";}setMapStyle(e){}getCanvasOverlays(){return this.getContainer();}}},afe81a74:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{default:function(){return c;},x:function(){return s;},y:function(){return l;}});var r=n("777fffbe"),i=n("b0d099be"),a=n("382eef13"),o=r._(n("32a7b72b"));function s(e){return e.x;}function l(e){return e.y;}var u=Math.PI*(3-Math.sqrt(5));function c(e){var t,n=1,r=.001,s=1-Math.pow(.001,1/300),l=0,c=.6,d=new Map,f=(0,a.timer)(v),h=(0,i.dispatch)("tick","end"),p=(0,o.default)();function v(){g(),h.call("tick",t),n<r&&(f.stop(),h.call("end",t));}function g(r){var i,a,o=e.length;void 0===r&&(r=1);for(var u=0;u<r;++u)for(n+=(l-n)*s,d.forEach(function(e){e(n);}),i=0;i<o;++i)null==(a=e[i]).fx?a.x+=a.vx*=c:(a.x=a.fx,a.vx=0),null==a.fy?a.y+=a.vy*=c:(a.y=a.fy,a.vy=0);return t;}function m(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var i=10*Math.sqrt(.5+n),a=n*u;t.x=i*Math.cos(a),t.y=i*Math.sin(a);}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0);}}function y(t){return t.initialize&&t.initialize(e,p),t;}return null==e&&(e=[]),m(),t={tick:g,restart:function(){return f.restart(v),t;},stop:function(){return f.stop(),t;},nodes:function(n){return arguments.length?(e=n,m(),d.forEach(y),t):e;},alpha:function(e){return arguments.length?(n=+e,t):n;},alphaMin:function(e){return arguments.length?(r=+e,t):r;},alphaDecay:function(e){return arguments.length?(s=+e,t):+s;},alphaTarget:function(e){return arguments.length?(l=+e,t):l;},velocityDecay:function(e){return arguments.length?(c=1-e,t):1-c;},randomSource:function(e){return arguments.length?(p=e,d.forEach(y),t):p;},force:function(e,n){return arguments.length>1?(null==n?d.delete(e):d.set(e,y(n)),t):d.get(e);},find:function(t,n,r){var i,a,o,s,l,u=0,c=e.length;for(null==r?r=1/0:r*=r,u=0;u<c;++u)(o=(i=t-(s=e[u]).x)*i+(a=n-s.y)*a)<r&&(l=s,r=o);return l;},on:function(e,n){return arguments.length>1?(h.on(e,n),t):h.on(e);}};}},b00d7788:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("a12bb5bb")),i=function(e){if((0,r.default)(e))return e.reduce(function(e,t){return Math.min(e,t);},e[0]);};},b01c35d8:function(e,t,n){e.exports=function(){};},b08e946c:function(e,t,n){"use strict";function r(){return this._root;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},b0c50986:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("ae336fe3")),a=r._(n("3d56238c")),o=function(e){if(!(0,i.default)(e)||!(0,a.default)(e,"Object"))return!1;if(null===Object.getPrototypeOf(e))return!0;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t;};},b0d099be:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"dispatch",{enumerable:!0,get:function(){return r.default;}});var r=n("777fffbe")._(n("6ea58a25"));},b0de094c:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=n("d9b661b3"),o=r._(n("755bc4f8")),s=n("f717bab4"),l=n("71293cfd");class u extends o.default{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11});}getCommonUniformsInfo(){let{strokeOpacity:e=1,strokeWidth:t=0,blend:n,blur:r=0}=this.layer.getLayerConfig();return this.layer.getLayerConfig(),this.getUniformsBufferInfo({u_additive:"additive"===n?1:0,u_stroke_opacity:e,u_stroke_width:t,u_blur:r});}initModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){return e.layer.triangulation=s.GlobelPointFillTriangulation,[(yield e.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;\nlayout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;\n\nlayout(std140) uniform commonUniform {\n  float u_additive;\n  float u_stroke_opacity : 1;\n  float u_stroke_width : 2;\n  float u_blur : 0.0;\n};\nout vec4 v_data;\nout vec4 v_color;\nout float v_radius;\n\n#pragma include "projection"\n#pragma include "picking"\n\n\nvoid main() {\n  vec3 extrude = a_Extrude;\n  float shape_type = a_Shape;\n  /*\n  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F\n  */\n  float newSize = setPickingSize(a_Size);\n  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;\n\n  // unpack color(vec2)\n  v_color = a_Color;\n\n  // radius(16-bit)\n  v_radius = newSize;\n\n  // anti-alias\n  //  float antialiased_blur = -max(u_blur, antialiasblur);\n  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);\n\n  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F\n  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);\n\n  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1 + vec3(u_offsets,0.0), 1.0);\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:"in vec4 v_data;\nin vec4 v_color;\nin float v_radius;\n\nlayout(std140) uniform commonUniform {\n  float u_additive;\n  float u_stroke_opacity : 1;\n  float u_stroke_width : 2;\n  float u_blur : 0.0;\n};\n#pragma include \"sdf_2d\"\n#pragma include \"picking\"\n\nout vec4 outputColor;\n\nvoid main() {\n  int shape = int(floor(v_data.w + 0.5));\n\n  vec4 strokeColor = u_stroke == vec4(0.0) ? v_color : u_stroke;\n\n  lowp float antialiasblur = v_data.z;\n  float r = v_radius / (v_radius + u_stroke_width);\n\n  float outer_df;\n  float inner_df;\n  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'\n  if (shape == 0) {\n    outer_df = sdCircle(v_data.xy, 1.0);\n    inner_df = sdCircle(v_data.xy, r);\n  } else if (shape == 1) {\n    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);\n    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);\n  } else if (shape == 2) {\n    outer_df = sdBox(v_data.xy, vec2(1.));\n    inner_df = sdBox(v_data.xy, vec2(r));\n  } else if (shape == 3) {\n    outer_df = sdPentagon(v_data.xy, 0.8);\n    inner_df = sdPentagon(v_data.xy, r * 0.8);\n  } else if (shape == 4) {\n    outer_df = sdHexagon(v_data.xy, 0.8);\n    inner_df = sdHexagon(v_data.xy, r * 0.8);\n  } else if (shape == 5) {\n    outer_df = sdOctogon(v_data.xy, 1.0);\n    inner_df = sdOctogon(v_data.xy, r);\n  } else if (shape == 6) {\n    outer_df = sdHexagram(v_data.xy, 0.52);\n    inner_df = sdHexagram(v_data.xy, r * 0.52);\n  } else if (shape == 7) {\n    outer_df = sdRhombus(v_data.xy, vec2(1.0));\n    inner_df = sdRhombus(v_data.xy, vec2(r));\n  } else if (shape == 8) {\n    outer_df = sdVesica(v_data.xy, 1.1, 0.8);\n    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);\n  }\n\n  if(outer_df > antialiasblur + 0.018) discard;\n\n  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);\n\n  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(\n    antialiasblur,\n    0.0,\n    inner_df\n  );\n\n  if(u_stroke_width < 0.01) {\n    outputColor = vec4(v_color.rgb, v_color.a * u_opacity);\n  } else {\n    outputColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);\n  }\n\n  if(u_additive > 0.0) {\n    outputColor *= opacity_t;\n    outputColor = filterColorAlpha(outputColor, outputColor.a);\n  } else {\n    outputColor.a *= opacity_t;\n    outputColor = filterColor(outputColor);\n  }\n}\n",triangulation:s.GlobelPointFillTriangulation,defines:e.getDefines(),inject:e.getInject(),depth:{enable:!0},blend:e.getBlend()}))];})();}animateOption2Array(e){return[e.enable?0:1,e.speed||1,e.rings||3,0];}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:a.AttributeType.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:a.gl.DYNAMIC_DRAW,data:[],type:a.gl.FLOAT},size:3,update:(e,t,n,r)=>{let[i,a,o]=n,s=l.vec3.fromValues(0,0,1),u=l.vec3.fromValues(i,0,o),c=i>=0?l.vec3.angle(s,u):2*Math.PI-l.vec3.angle(s,u),d=2*Math.PI-Math.asin(a/100),f=l.mat4.create();l.mat4.rotateY(f,f,c),l.mat4.rotateX(f,f,d);let h=l.vec3.fromValues(1,1,0);l.vec3.transformMat4(h,h,f),l.vec3.normalize(h,h);let p=l.vec3.fromValues(-1,1,0);l.vec3.transformMat4(p,p,f),l.vec3.normalize(p,p);let v=l.vec3.fromValues(-1,-1,0);l.vec3.transformMat4(v,v,f),l.vec3.normalize(v,v);let g=l.vec3.fromValues(1,-1,0);l.vec3.transformMat4(g,g,f),l.vec3.normalize(g,g);let m=[...h,...p,...v,...g],y=r%4*3;return[m[y],m[y+1],m[y+2]];}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:a.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:a.gl.DYNAMIC_DRAW,data:[],type:a.gl.FLOAT},size:1,update:e=>{let{size:t=5}=e;return Array.isArray(t)?[t[0]]:[t];}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:a.AttributeType.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:a.gl.DYNAMIC_DRAW,data:[],type:a.gl.FLOAT},size:1,update:e=>{let{shape:t=2}=e;return[this.layer.getLayerConfig().shape2d.indexOf(t)];}}});}}},b0ea6077:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe")._(n("6cfccf4b")),i="object"==typeof t&&t&&!t.nodeType&&t,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,o=a&&a.exports===i&&r.default.process,s=function(){try{var e=a&&a.require&&a.require("util").types;if(e)return e;return o&&o.binding&&o.binding("util");}catch(e){}}();},b1667d5e:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("e6d4594c"));function i(e){var t,n=[],i=[];for(this._root&&n.push(new r.default(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=n.pop();){var a=t.node;if(a.length){var o,s=t.x0,l=t.y0,u=t.z0,c=t.x1,d=t.y1,f=t.z1,h=(s+c)/2,p=(l+d)/2,v=(u+f)/2;(o=a[0])&&n.push(new r.default(o,s,l,u,h,p,v)),(o=a[1])&&n.push(new r.default(o,h,l,u,c,p,v)),(o=a[2])&&n.push(new r.default(o,s,p,u,h,d,v)),(o=a[3])&&n.push(new r.default(o,h,p,u,c,d,v)),(o=a[4])&&n.push(new r.default(o,s,l,v,h,p,f)),(o=a[5])&&n.push(new r.default(o,h,l,v,c,p,f)),(o=a[6])&&n.push(new r.default(o,s,p,v,h,d,f)),(o=a[7])&&n.push(new r.default(o,h,p,v,c,d,f));}i.push(t);}for(;t=i.pop();)e(t.node,t.x0,t.y0,t.z0,t.x1,t.y1,t.z1);return this;}},b17de636:function(e,t,n){"use strict";function r(e){let t=+this._x.call(null,e),n=+this._y.call(null,e);return i(this.cover(t,n),t,n,e);}function i(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,a,o,s,l,u,c,d,f,h=e._root,p={data:r},v=e._x0,g=e._y0,m=e._x1,y=e._y1;if(!h)return e._root=p,e;for(;h.length;)if((u=t>=(a=(v+m)/2))?v=a:m=a,(c=n>=(o=(g+y)/2))?g=o:y=o,i=h,!(h=h[d=c<<1|u]))return i[d]=p,e;if(s=+e._x.call(null,h.data),l=+e._y.call(null,h.data),t===s&&n===l)return p.next=h,i?i[d]=p:e._root=p,e;do i=i?i[d]=[,,,,]:e._root=[,,,,],(u=t>=(a=(v+m)/2))?v=a:m=a,(c=n>=(o=(g+y)/2))?g=o:y=o;while((d=c<<1|u)==(f=(l>=o)<<1|s>=a))return i[f]=h,i[d]=p,e;}function a(e){var t,n,r,a,o=e.length,s=Array(o),l=Array(o),u=1/0,c=1/0,d=-1/0,f=-1/0;for(n=0;n<o;++n)!(isNaN(r=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t)))&&(s[n]=r,l[n]=a,r<u&&(u=r),r>d&&(d=r),a<c&&(c=a),a>f&&(f=a));if(u>d||c>f)return this;for(this.cover(u,c).cover(d,f),n=0;n<o;++n)i(this,s[n],l[n],e[n]);return this;}n.d(t,"__esModule",{value:!0}),n.e(t,{addAll:function(){return a;},default:function(){return r;}});},b192169f:function(e,t,n){"use strict";var r=n("ce906886"),i=n("5bf20808").Graph;function a(e,t,n,i){var a;do a=r.uniqueId(i);while(e.hasNode(a))return n.dummy=t,e.setNode(a,n),a;}function o(e){return r.max(r.map(e.nodes(),function(t){var n=e.node(t).rank;if(!r.isUndefined(n))return n;}));}e.exports={addDummyNode:a,simplify:function(e){var t=new i().setGraph(e.graph());return r.forEach(e.nodes(),function(n){t.setNode(n,e.node(n));}),r.forEach(e.edges(),function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)});}),t;},asNonCompoundGraph:function(e){var t=new i({multigraph:e.isMultigraph()}).setGraph(e.graph());return r.forEach(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n));}),r.forEach(e.edges(),function(n){t.setEdge(n,e.edge(n));}),t;},successorWeights:function(e){var t=r.map(e.nodes(),function(t){var n={};return r.forEach(e.outEdges(t),function(t){n[t.w]=(n[t.w]||0)+e.edge(t).weight;}),n;});return r.zipObject(e.nodes(),t);},predecessorWeights:function(e){var t=r.map(e.nodes(),function(t){var n={};return r.forEach(e.inEdges(t),function(t){n[t.v]=(n[t.v]||0)+e.edge(t).weight;}),n;});return r.zipObject(e.nodes(),t);},intersectRect:function(e,t){var n,r,i=e.x,a=e.y,o=t.x-i,s=t.y-a,l=e.width/2,u=e.height/2;if(!o&&!s)throw Error("Not possible to find intersection inside of the rectangle");return Math.abs(s)*l>Math.abs(o)*u?(s<0&&(u=-u),n=u*o/s,r=u):(o<0&&(l=-l),n=l,r=l*s/o),{x:i+n,y:a+r};},buildLayerMatrix:function(e){var t=r.map(r.range(o(e)+1),function(){return[];});return r.forEach(e.nodes(),function(n){var i=e.node(n),a=i.rank;r.isUndefined(a)||(t[a][i.order]=n);}),t;},normalizeRanks:function(e){var t=r.min(r.map(e.nodes(),function(t){return e.node(t).rank;}));r.forEach(e.nodes(),function(n){var i=e.node(n);r.has(i,"rank")&&(i.rank-=t);});},removeEmptyRanks:function(e){var t=r.min(r.map(e.nodes(),function(t){return e.node(t).rank;})),n=[];r.forEach(e.nodes(),function(r){var i=e.node(r).rank-t;n[i]||(n[i]=[]),n[i].push(r);});var i=0,a=e.graph().nodeRankFactor;r.forEach(n,function(t,n){r.isUndefined(t)&&n%a!=0?--i:i&&r.forEach(t,function(t){e.node(t).rank+=i;});});},addBorderNode:function(e,t,n,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=n,i.order=r),a(e,"border",i,t);},maxRank:o,partition:function(e,t){var n={lhs:[],rhs:[]};return r.forEach(e,function(e){t(e)?n.lhs.push(e):n.rhs.push(e);}),n;},time:function(e,t){var n=r.now();try{return t();}finally{console.log(e+" time: "+(r.now()-n)+"ms");}},notime:function(e,t){return t();}};},b194b4a1:function(e,t,n){"use strict";function r(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},b1a0b97a:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"segmentLineFactory",{enumerable:!0,get:function(){return a;}});var r=n("04cc7448"),i=n("d1adb660");function a(e,t,n,a,o){var s=(0,i.distanceSquareRoot)([e,t],[n,a]),l={x:0,y:0};if("number"==typeof o){if(o<=0)l={x:e,y:t};else if(o>=s)l={x:n,y:a};else{var u=(0,r.midPoint)([e,t],[n,a],o/s);l={x:u[0],y:u[1]};}}return{length:s,point:l,min:{x:Math.min(e,n),y:Math.min(t,a)},max:{x:Math.max(e,n),y:Math.max(t,a)}};}},b1b86e3e:function(e,t,n){var r=n("2c2fd53f");e.exports=function(e){return r(this,e).get(e);};},b1c21490:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(){return[];};},b1e98c38:function(e,t,n){var r=n("ef666486");e.exports=function(e){return r(this.__data__,e)>-1;};},b2dd89c0:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=r._(n("4ce96d25")),s=r._(n("a15d3715"));class l extends o.default{constructor(...e){super(...e),(0,a.default)(this,"type","CityBuildingLayer");}buildModels(){var e=this;return(0,i.default)(function*(){e.layerModel=new s.default(e),yield e.initLayerModels();})();}setLight(e){this.updateLayerConfig({time:e});}getModelType(){return"citybuilding";}}},b3f83c26:function(e,t,n){"use strict";function r(e){return(32|e)==97;}n.d(t,"__esModule",{value:!0}),n.d(t,"isArcCommand",{enumerable:!0,get:function(){return r;}});},b4039cbe:function(e,t,n){"use strict";function r(e,t){if(!e)throw Error(t||"viewport-mercator-project: assertion failed.");}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},b420e563:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("d812e418")),i=n("183d4520");class a{constructor(){(0,r.default)(this,"enabled",void 0);}apply(e,{rendererService:t,postProcessingPassFactory:n,normalPassFactory:r}){e.hooks.init.tapPromise("MultiPassRendererPlugin",()=>{let{enableMultiPassRenderer:t,passes:a=[]}=e.getLayerConfig();this.enabled=!!t&&!1!==e.getLayerConfig().enableMultiPassRenderer,this.enabled&&(e.multiPassRenderer=(0,i.createMultiPassRenderer)(e,a,n,r),e.multiPassRenderer.setRenderFlag(!0));}),e.hooks.beforeRender.tap("MultiPassRendererPlugin",()=>{if(this.enabled){let{width:n,height:r}=t.getViewportSize();e.multiPassRenderer.resize(n,r);}});}}},b4217dd0:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("d1751d7c")._(n("b6756bd1"),t);},b448a57d:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{ErrorEvent:function(){return l;},Event:function(){return s;},Evented:function(){return u;}});var r=n("777fffbe")._(n("d812e418")),i=n("f9562c3c");function a(e,t,n){n[e]&&-1!==n[e].indexOf(t)||(n[e]=n[e]||[],n[e].push(t));}function o(e,t,n){if(n&&n[e]){let r=n[e].indexOf(t);-1!==r&&n[e].splice(r,1);}}class s{constructor(e,t={}){(0,r.default)(this,"type",void 0),(0,i.extend)(this,t),this.type=e;}}class l extends s{constructor(e,t={}){super("error",t),(0,r.default)(this,"error",void 0),this.error=e;}}class u{constructor(){(0,r.default)(this,"_listeners",void 0),(0,r.default)(this,"_oneTimeListeners",void 0),(0,r.default)(this,"_eventedParent",void 0),(0,r.default)(this,"_eventedParentData",void 0);}on(e,t){return this._listeners=this._listeners||{},a(e,t,this._listeners),this;}off(e,t){return o(e,t,this._listeners),o(e,t,this._oneTimeListeners),this;}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},a(e,t,this._oneTimeListeners),this):new Promise(t=>this.once(e,t));}fire(e,t){"string"==typeof e&&(e=new s(e,t||{}));let n=e.type;if(this.listens(n)){for(let t of(e.target=this,this._listeners&&this._listeners[n]?this._listeners[n].slice():[]))t.call(this,e);for(let t of this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[])o(n,t,this._oneTimeListeners),t.call(this,e);let t=this._eventedParent;t&&((0,i.extend)(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),t.fire(e));}else e instanceof l&&console.error(e.error);return this;}emit(e,t){return this.fire(e,t);}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e);}setEventedParent(e,t){return e&&(this._eventedParent=e),this._eventedParentData=t,this;}}},b5607998:function(e,t,n){"use strict";if(n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}}),!window)throw Error("BMapGL JSAPI can only be used in Browser.");var r,i=((r=i||{}).notload="notload",r.loading="loading",r.loaded="loaded",r.failed="failed",r);let a={key:"",BMapGL:{version:"1.0"}},o={BMapGL:i.notload},s=[],l=e=>{if("function"==typeof e){if(o.BMapGL===i.loaded){e(window.BMapGL);return;}s.push(e);}};var u={load:e=>new Promise((t,n)=>{if(o.BMapGL===i.failed)n("");else if(o.BMapGL===i.notload){let{key:r,version:u}=e;if(!r){n("\u8BF7\u586B\u5199key");return;}a.key=r,a.BMapGL.version=u||a.BMapGL.version,o.BMapGL=i.loading;let c=document.body||document.head;window.___onBMapGLAPILoaded=e=>{if(delete window.___onBMapGLAPILoaded,e)o.BMapGL=i.failed,n(e);else for(o.BMapGL=i.loaded;s.length;)s.splice(0,1)[0](window.BMapGL);};let d=document.createElement("script");d.type="text/javascript",d.src=`https://api.map.baidu.com/api?type=webgl&v=${a.BMapGL.version}&ak=${a.key}&callback=___onBMapGLAPILoaded`,d.onerror=e=>{o.BMapGL=i.failed,n(e);},c.appendChild(d),l(t);}else if(o.BMapGL===i.loaded){if(e.key&&e.key!==a.key){n("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");return;}if(e.version&&e.version!==a.BMapGL.version){n("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");return;}t(window.BMapGL);}else{if(e.key&&e.key!==a.key){n("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");return;}if(e.version&&e.version!==a.BMapGL.version){n("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");return;}l(t);}}),reset:()=>{delete window.BMapGL,a={key:"",BMapGL:{version:"1.0"}},o={BMapGL:i.notload};}};},b570c735:function(e,t,n){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e;};},b5881774:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r={}.toString,i=function(e){return r.call(e).replace(/^\[object /,"").replace(/]$/,"");};},b5970efe:function(e,t,n){"use strict";function r(e){return arguments.length?this.cover(+e[0][0]).cover(+e[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]];}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},b59c4694:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"depsEqual",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("845940ba")),i=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=[]),(0,r.default)(e,t);};},b5b57ddc:function(e,t,n){var r=n("e9eb317a");e.exports=function(e,t,n){var i=e.length;return n=void 0===n?i:n,!t&&n>=i?e:r(e,t,n);};},b5d377d5:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("b6081162")),i=function(e){return(0,r.default)(e,"String");};},b5e7b78f:function(e,t,n){var r=n("701e250e")(n("9a4a5c5c"));e.exports=r;},b6081162:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r={}.toString,i=function(e,t){return r.call(e)==="[object "+t+"]";};},b63470f3:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){var t={},n=e.nodes,r=e.edges;return(void 0===n?[]:n).forEach(function(e){t[e.id]={degree:0,inDegree:0,outDegree:0};}),(void 0===r?[]:r).forEach(function(e){t[e.source].degree++,t[e.source].outDegree++,t[e.target].degree++,t[e.target].inDegree++;}),t;};},b6756bd1:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"LayerManager",{enumerable:!0,get:function(){return f;}});var r=n("777fffbe")._(n("6e60059a"));function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;})(e);}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r;}function o(e,t){return(o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;})(e,t);}function s(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);})(e);}function u(e,t,n){return(t=c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e;}function c(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=i(r))return r;throw TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}(e,"string");return"symbol"==i(t)?t:String(t);}var d=0,f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t);}(f,e);var t,n,r=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return!1;}}(),function(){var e,n=l(f);return e=t?Reflect.construct(n,arguments,l(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return s(e);}(this,e);});function f(e){var t;return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function");}(this,f),u(s(t=r.call(this)),"scene",void 0),u(s(t),"options",void 0),u(s(t),"layerMap",new Map),t.scene=e.scene,t.options=e,t;}return n=[{key:"hasLayer",value:function(e){return this.layerMap.has(e);}},{key:"addLayer",value:function(e){var t=this.getLayerId(e);this.layerMap.set(t,e),e.addTo(this.scene),this.emit("add",e);}},{key:"addLayers",value:function(e){var t=this;e.forEach(function(e){t.addLayer(e);});}},{key:"removeLayer",value:function(e){var t="string"==typeof e?e:this.getLayerId(e),n=this.layerMap.get(t);return!!n&&(this.layerMap.delete(t),n.remove(),this.emit("remove",t),!0);}},{key:"getLayers",value:function(){return Array.from(this.layerMap.values());}},{key:"getLayerById",value:function(e){return this.layerMap.get(e);}},{key:"getLayer",value:function(e){return this.getLayerById(e);}},{key:"removeAllLayer",value:function(){var e,t=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,void 0);}}(e))){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]};},e:function(e){throw e;},f:i};}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var o,s=!0,l=!1;return{s:function(){n=n.call(e);},n:function(){var e=n.next();return s=e.done,e;},e:function(e){l=!0,o=e;},f:function(){try{s||null==n.return||n.return();}finally{if(l)throw o;}}};}(this.layerMap.values());try{for(t.s();!(e=t.n()).done;)e.value.remove();}catch(e){t.e(e);}finally{t.f();}this.layerMap.clear();}},{key:"isEmpty",value:function(){return 0===this.layerMap.size;}},{key:"getLayerId",value:function(e){return"id"in e?e.id:"".concat(d++);}},{key:"destroy",value:function(){this.removeAllLayer();}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r);}}(f.prototype,n),Object.defineProperty(f,"prototype",{writable:!1}),f;}(r.default);},b684c672:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"HandlerInertia",{enumerable:!0,get:function(){return h;}});var r=n("777fffbe"),i=r._(n("d812e418")),a=r._(n("be334174")),o=n("262c4dce"),s=n("f9562c3c");let l={linearity:.3,easing:(0,s.bezier)(0,0,.3,1)},u=(0,s.extend)({deceleration:2500,maxSpeed:1400},l),c=(0,s.extend)({deceleration:20,maxSpeed:1400},l),d=(0,s.extend)({deceleration:1e3,maxSpeed:360},l),f=(0,s.extend)({deceleration:1e3,maxSpeed:90},l);class h{constructor(e){(0,i.default)(this,"_map",void 0),(0,i.default)(this,"_inertiaBuffer",void 0),this._map=e,this.clear();}clear(){this._inertiaBuffer=[];}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.browser.now(),settings:e});}_drainInertiaBuffer(){let e=this._inertiaBuffer,t=o.browser.now();for(;e.length>0&&t-e[0].time>160;)e.shift();}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let t={zoom:0,bearing:0,pitch:0,pan:new a.default(0,0),pinchAround:void 0,around:void 0};for(let{settings:e}of this._inertiaBuffer)t.zoom+=e.zoomDelta||0,t.bearing+=e.bearingDelta||0,t.pitch+=e.pitchDelta||0,e.panDelta&&t.pan._add(e.panDelta),e.around&&(t.around=e.around),e.pinchAround&&(t.pinchAround=e.pinchAround);let n=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,r={};if(t.pan.mag()){let i=v(t.pan.mag(),n,(0,s.extend)({},u,e||{}));r.offset=t.pan.mult(i.amount/t.pan.mag()),r.center=this._map.transform.center,p(r,i);}if(t.zoom){let e=v(t.zoom,n,c);r.zoom=this._map.transform.zoom+e.amount,p(r,e);}if(t.bearing){let e=v(t.bearing,n,d);r.bearing=this._map.transform.bearing+(0,s.clamp)(e.amount,-179,179),p(r,e);}if(t.pitch){let e=v(t.pitch,n,f);r.pitch=this._map.transform.pitch+e.amount,p(r,e);}if(r.zoom||r.bearing){let e=void 0===t.pinchAround?t.around:t.pinchAround;r.around=e?this._map.unproject(e):this._map.getCenter();}return this.clear(),(0,s.extend)(r,{noMoveStart:!0});}}function p(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing);}function v(e,t,n){let{maxSpeed:r,linearity:i,deceleration:a}=n,o=(0,s.clamp)(e*i/(t/1e3),-r,r),l=Math.abs(o)/(a*i);return{easing:n.easing,duration:1e3*l,amount:l/2*o};}},b6ae0420:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=r._(n("4ce96d25")),s=r._(n("5cac9775"));class l extends o.default{constructor(...e){super(...e),(0,a.default)(this,"type","PolygonLayer"),(0,a.default)(this,"enableShaderEncodeStyles",["opacity","extrusionBase","rotation","offsets","stroke"]);}buildModels(){var e=this;return(0,i.default)(function*(){let t=e.getModelType();e.layerModel=new s.default[t](e),yield e.initLayerModels();})();}getModelType(){var e;let t=this.styleAttributeService.getLayerStyleAttribute("shape"),n=null==t||null===(e=t.scale)||void 0===e?void 0:e.field;return"fill"!==n&&n?"extrude"===n?"extrude":"extrusion"===n?"extrusion":"water"===n?"water":"ocean"===n?"ocean":"line"===n?"line":this.getPointModelType():"fill";}getPointModelType(){let e=this.getEncodedData(),{shape2d:t,shape3d:n}=this.getLayerConfig(),r=this.iconService.getIconMap(),i=e.find(e=>e.hasOwnProperty("shape"));if(!i)return"fill";{let e=i.shape;return"dot"===e?"point_normal":(null==t?void 0:t.indexOf(e))!==-1?"point_fill":(null==n?void 0:n.indexOf(e))!==-1?"point_extrude":r.hasOwnProperty(e)?"point_image":"text";}}}},b6c9e4f0:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{default:function(){return l;},extrude_PolygonNormal:function(){return c;},fillPolygon:function(){return u;}});var r=n("777fffbe"),i=n("fb1ec05a"),a=r._(n("20d317f9")),o=n("71293cfd"),s=n("36c59252");function l(e){let t=e[0][0],n=e[0][e[0].length-1];t[0]===n[0]&&t[1]===n[1]&&(e[0]=e[0].slice(0,e[0].length-1));let r=e[0].length,i=a.default.flatten(e),{vertices:o,dimensions:s}=i,l=[],u=[];for(let e=0;e<o.length/s;e++)2===s?l.push(o[2*e],o[2*e+1],1):l.push(o[3*e],o[3*e+1],1);let c=(0,a.default)(i.vertices,i.holes,i.dimensions);u.push(...c);for(let e=0;e<r;e++){let t=i.vertices.slice(e*s,(e+1)*s),n=i.vertices.slice((e+1)*s,(e+2)*s);0===n.length&&(n=i.vertices.slice(0,s));let r=l.length/3;l.push(t[0],t[1],1,n[0],n[1],1,t[0],t[1],0,n[0],n[1],0),u.push(...[0,2,1,2,3,1].map(e=>e+r));}return{positions:l,index:u};}function u(e){let t=a.default.flatten(e),n=(0,a.default)(t.vertices,t.holes,t.dimensions);return{positions:t.vertices,index:n};}function c(e,t=!1){let n=e[0][0],r=e[0][e[0].length-1];n[0]===r[0]&&n[1]===r[1]&&(e[0]=e[0].slice(0,e[0].length-1));let l=e[0].length,u=a.default.flatten(e),{vertices:d,dimensions:f,holes:h}=u,p=[],v=[],g=[];for(let e=0;e<d.length/f;e++)p.push(d[e*f],d[e*f+1],1,-1,-1),g.push(0,0,1);let m=(0,s.getPolygonSurfaceIndices)(d,h,f,t);v.push(...m);for(let e=0;e<l;e++){let n=u.vertices.slice(e*f,(e+1)*f),r=u.vertices.slice((e+1)*f,(e+2)*f);0===r.length&&(r=u.vertices.slice(0,f));let a=p.length/5;p.push(n[0],n[1],1,0,0,r[0],r[1],1,.1,0,n[0],n[1],0,0,.8,r[0],r[1],0,.1,.8);let s=function(e,t,n,r=!1){let a=o.vec3.create(),s=o.vec3.create(),l=o.vec3.create();r&&(e=(0,i.lngLatToMeters)(e),t=(0,i.lngLatToMeters)(t),n=(0,i.lngLatToMeters)(n));let u=o.vec3.fromValues(...e),c=o.vec3.fromValues(...t),d=o.vec3.fromValues(...n);o.vec3.sub(a,d,c),o.vec3.sub(s,u,c),o.vec3.cross(l,a,s);let f=o.vec3.create();return o.vec3.normalize(f,l),f;}([r[0],r[1],1],[n[0],n[1],0],[n[0],n[1],1],t);g.push(...s,...s,...s,...s),v.push(...[1,2,0,3,2,1].map(e=>e+a));}return{positions:p,index:v,normals:g};}},b6d05ee2:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("f89fb776")),o=r._(n("d812e418")),s=n("fb1ec05a");class l{constructor(e){(0,o.default)(this,"layer",void 0),this.layer=e;}pickRender(e){let t=this.layer.getContainer().layerService,n=this.layer;if(n.tileLayer)return n.tileLayer.pickRender(e);n.hooks.beforePickingEncode.call(),t.renderTileLayerMask(n),n.renderModels({ispick:!0}),n.hooks.afterPickingEncode.call();}pick(e,t){var n=this;return(0,a.default)(function*(){let r=n.layer.getContainer().pickingService;return"RasterLayer"===e.type?n.pickRasterLayer(e,t):(n.pickRender(t),r.pickFromPickingFBO(e,t));})();}pickRasterLayer(e,t,n){let r=this.layer.getContainer(),a=r.pickingService,o=r.mapService,l=this.layer.getSource().extent,u=(0,s.lngLatInExtent)(t.lngLat,l),c={x:t.x,y:t.y,type:t.type,lngLat:t.lngLat,target:t,rasterValue:null},d=n||e;if(!u)return c.type="mousemove"===t.type?"mouseout":"un"+t.type,a.triggerHoverOnLayer(d,(0,i.default)((0,i.default)({},c),{},{type:"unpick"})),a.triggerHoverOnLayer(d,c),!1;{let n=this.readRasterValue(e,l,o,t.x,t.y);return c.rasterValue=n,a.triggerHoverOnLayer(d,c),!0;}}readRasterValue(e,t,n,r,i){let a=e.getSource().data.dataArray[0],[o=0,s=0,l=10,u=-10]=t,c=n.lngLatToContainer([o,s]),d=n.lngLatToContainer([l,u]),f=d.x-c.x,h=c.y-d.y,p=[(r-c.x)/f,(i-d.y)/h],v=a.width||1,g=a.height||1,m=Math.floor(p[0]*v),y=Math.max(0,Math.floor(p[1]*g)-1)*v+m;return a.data[y];}selectFeature(e){let t=this.layer,[n,r,i]=e;t.hooks.beforeSelect.call([n,r,i]);}highlightPickedFeature(e){let[t,n,r]=e;this.layer.hooks.beforeHighlight.call([t,n,r]);}getFeatureById(e){return this.layer.getSource().getFeatureById(e);}}},b72baeac:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("e489f84a")),i=function(e){var t=(0,r.default)(e);return t.charAt(0).toUpperCase()+t.substring(1);};},b733ff0a:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("441fab0c"));function i(e){var t,n,i,a,o,s,l=[],u=this._root;for(u&&l.push(new r.default(u,this._x0,this._y0,this._x1,this._y1));t=l.pop();)if(!e(u=t.node,i=t.x0,a=t.y0,o=t.x1,s=t.y1)&&u.length){var c=(i+o)/2,d=(a+s)/2;(n=u[3])&&l.push(new r.default(n,c,d,o,s)),(n=u[2])&&l.push(new r.default(n,i,d,c,s)),(n=u[1])&&l.push(new r.default(n,c,a,o,d)),(n=u[0])&&l.push(new r.default(n,i,a,c,d));}return this;}},b76da610:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"useCreateLayer",{enumerable:!0,get:function(){return h;}});var r=n("af467690"),i=n("86aaa5a5"),a=n("9d065c04"),o=n("bea685b2");function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;})(e);}var l=["onCreated","source"],u=["data"],c=["data"];function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable;})),n.push.apply(n,r);}return n;}function f(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i;}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n]);}return i;}var h=function(e,t){var n=t.onCreated,h=t.source,p=f(t,l),v=(0,o.useLayerManager)(),g=(0,a.useRef)(),m=(0,a.useRef)(p),y=(0,a.useRef)(h);return g.current||(g.current=new e(t),n&&g.current.once("inited",function(){return n(g.current);}),v.addLayer(g.current)),(0,r.useUpdateEffect)(function(){g.current&&!(0,i.isEqual)(m.current,p)&&(g.current.update(p),m.current=(0,i.cloneDeep)(p));},[p]),(0,r.useUpdateEffect)(function(){if(g.current){var e=h.data,t=f(h,u),n=y.current,r=n.data,a=f(n,c);e===r&&(0,i.isEqual)(t,a)||(g.current.changeData(h),y.current=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach(function(t){var r,i;r=t,i=n[t],(r=function(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=s(r))return r;throw TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}(e,"string");return"symbol"==s(t)?t:String(t);}(r))in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i;}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t));});}return e;}({},h));}},[h]),(0,a.useEffect)(function(){return function(){g.current&&(v.removeLayer(g.current),g.current=null);};},[]),g;};},b77730ab:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe"),i=r._(n("7c424190")),a=r._(n("a6bc6c74")),o=r._(n("666963cd")),s=r._(n("cb53e56d")),l=r._(n("efc6bc29"));function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1]);}}u.prototype.clear=i.default,u.prototype.delete=a.default,u.prototype.get=o.default,u.prototype.has=s.default,u.prototype.set=l.default;var c=u;},b81723ce:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e,t,n){return e<t?t:e>n?n:e;};},b8bb490c:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"lineToCubic",{enumerable:!0,get:function(){return a;}});var r=n("b594a703"),i=n("04cc7448"),a=function(e,t,n,a){var o=(0,i.midPoint)([e,t],[n,a],.5);return(0,r.__spreadArray)((0,r.__spreadArray)([],o,!0),[n,a,n,a],!1);};},b9363c23:function(e,t,n){var r=n("7af463cb"),i=n("3656a04e"),a=n("3d3bd3f9");e.exports=function(e){return"function"!=typeof e.constructor||a(e)?{}:r(i(e));};},b9427af2:function(e,t,n){var r=n("860e2ef1"),i=n("13060ce4");e.exports=function(e,t,n,a){var o=n.length,s=o,l=!a;if(null==e)return!s;for(e=Object(e);o--;){var u=n[o];if(l&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1;}for(;++o<s;){var c=(u=n[o])[0],d=e[c],f=u[1];if(l&&u[2]){if(void 0===d&&!(c in e))return!1;}else{var h=new r;if(a)var p=a(d,f,c,e,t,h);if(!(void 0===p?i(f,d,3,a,h):p))return!1;}}return!0;};},b9a6b588:function(e,t,n){var r=n("a985b25e"),i=n("baa3a209");e.exports=function(e){return r(e,i(e));};},b9b0b89a:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("afa4dabd")),a=r._(n("2ba5f788")),o=r._(n("b5d377d5")),s=function(e,t){if(e===t)return!0;if(!e||!t||(0,o.default)(e)||(0,o.default)(t))return!1;if((0,a.default)(e)||(0,a.default)(t)){if(e.length!==t.length)return!1;for(var n=!0,r=0;r<e.length&&(n=s(e[r],t[r]));r++);return n;}if((0,i.default)(e)||(0,i.default)(t)){var l=Object.keys(e),u=Object.keys(t);if(l.length!==u.length)return!1;for(var n=!0,r=0;r<l.length&&(n=s(e[l[r]],t[l[r]]));r++);return n;}return!1;},l=s;},ba4200d0:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("a420544c")),a=r._(n("beff956c")),o=function(e,t){return(0,i.default)(e,(0,a.default)(e),t);};},ba644deb:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("3d56238c")),i=function(e){return(0,r.default)(e,"Boolean");};},ba9a3e2b:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e];}),n;};},ba9d7bc5:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"isNormalizedArray",{enumerable:!0,get:function(){return i;}});var r=n("c80c7fe3");function i(e){return(0,r.isAbsoluteArray)(e)&&e.every(function(e){var t=e[0];return"ACLMQZ".includes(t);});}},baa3a209:function(e,t,n){var r=n("69f7008f"),i=n("81e4157d"),a=n("481b6514");e.exports=function(e){return a(e)?r(e,!0):i(e);};},bab17bc9:function(e,t,n){var r=n("95fb21b4"),i="object"==typeof t&&t&&!t.nodeType&&t,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,o=a&&a.exports===i&&r.process,s=function(){try{var e=a&&a.require&&a.require("util").types;if(e)return e;return o&&o.binding&&o.binding("util");}catch(e){}}();e.exports=s;},bb876d30:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("f89fb776")),o=r._(n("d812e418")),s=n("d9b661b3"),l=n("fb1ec05a");class u{constructor(){(0,o.default)(this,"mapService",void 0),(0,o.default)(this,"fontService",void 0);}apply(e,{styleAttributeService:t,mapService:n,fontService:r}){var i,o=this;this.mapService=n,this.fontService=r,e.hooks.init.tapPromise("DataMappingPlugin",(0,a.default)(function*(){e.log(s.IDebugLog.MappingStart,s.ILayerStage.INIT),o.generateMaping(e,{styleAttributeService:t}),e.log(s.IDebugLog.MappingEnd,s.ILayerStage.INIT);})),e.hooks.beforeRenderData.tapPromise("DataMappingPlugin",(i=(0,a.default)(function*(n){if(!n)return n;e.dataState.dataMappingNeedUpdate=!1,e.log(s.IDebugLog.MappingStart,s.ILayerStage.UPDATE);let r=o.generateMaping(e,{styleAttributeService:t});return e.log(s.IDebugLog.MappingEnd,s.ILayerStage.UPDATE),r;}),function(e){return i.apply(this,arguments);})),e.hooks.beforeRender.tap("DataMappingPlugin",()=>{let n=e.getSource();if(e.layerModelNeedUpdate||!n||!n.inited)return;let r=t.getLayerStyleAttributes()||[],i=t.getLayerStyleAttribute("filter"),{dataArray:a}=n.data;if(Array.isArray(a)&&0===a.length)return;let o=r.filter(e=>e.needRemapping),s=a;if(null!=i&&i.needRemapping&&null!=i&&i.scale&&(s=a.filter(e=>this.applyAttributeMapping(i,e)[0])),o.length){let t=this.mapping(e,o,s,e.getEncodedData());e.setEncodedData(t);}});}generateMaping(e,{styleAttributeService:t}){let n=t.getLayerStyleAttributes()||[],r=t.getLayerStyleAttribute("filter"),{dataArray:i}=e.getSource().data,a=i;null!=r&&r.scale&&(a=i.filter(e=>this.applyAttributeMapping(r,e)[0])),a=e.processData(a);let o=this.mapping(e,n,a,void 0);return e.setEncodedData(o),e.emit("dataUpdate",null),!0;}mapping(e,t,n,r){let a=t.filter(e=>void 0!==e.scale).filter(e=>"filter"!==e.name),o=n.map((e,t)=>{let n=r?r[t]:{},o=(0,i.default)({id:e._id,coordinates:e.coordinates},n);return a.forEach(t=>{let n=this.applyAttributeMapping(t,e);("color"===t.name||"stroke"===t.name)&&(n=n.map(e=>(0,l.rgb2arr)(e))),o[t.name]=Array.isArray(n)&&1===n.length?n[0]:n,"shape"===t.name&&(o.shape=this.fontService.getIconFontKey(o[t.name]));}),o;});return t.forEach(e=>{e.needRemapping=!1;}),this.adjustData2SimpleCoordinates(o),o;}adjustData2SimpleCoordinates(e){e.length>0&&"SIMPLE"===this.mapService.version&&e.map(e=>{e.simpleCoordinate||(e.coordinates=this.unProjectCoordinates(e.coordinates),e.simpleCoordinate=!0);});}unProjectCoordinates(e){if("number"==typeof e[0])return this.mapService.simpleMapCoord.unproject(e);if(e[0]&&e[0][0]instanceof Array){let t=[];return e.map(e=>{let n=[];e.map(e=>{n.push(this.mapService.simpleMapCoord.unproject(e));}),t.push(n);}),t;}{let t=[];return e.map(e=>{t.push(this.mapService.simpleMapCoord.unproject(e));}),t;}}applyAttributeMapping(e,t){var n;if(!e.scale)return[];let r=(null==e||null===(n=e.scale)||void 0===n?void 0:n.scalers)||[],i=[];return r.forEach(({field:n})=>{var r;(t.hasOwnProperty(n)||(null===(r=e.scale)||void 0===r?void 0:r.type)==="variable")&&i.push(t[n]);}),e.mapping?e.mapping(i):[];}getArrowPoints(e,t){let n=[t[0]-e[0],t[1]-e[1]],r=(0,l.normalize)(n);return[e[0]+1e-4*r[0],e[1]+1e-4*r[1]];}}},bb92c4ce:function(e,t,n){"use strict";function r(e){if(isNaN(a=+this._x.call(null,e))||isNaN(o=+this._y.call(null,e)))return this;var t,n,r,i,a,o,s,l,u,c,d,f,h=this._root,p=this._x0,v=this._y0,g=this._x1,m=this._y1;if(!h)return this;if(h.length)for(;;){if((u=a>=(s=(p+g)/2))?p=s:g=s,(c=o>=(l=(v+m)/2))?v=l:m=l,t=h,!(h=h[d=c<<1|u]))return this;if(!h.length)break;(t[d+1&3]||t[d+2&3]||t[d+3&3])&&(n=t,f=d);}for(;h.data!==e;)if(r=h,!(h=h.next))return this;return((i=h.next)&&delete h.next,r)?i?r.next=i:delete r.next:t?(i?t[d]=i:delete t[d],(h=t[0]||t[1]||t[2]||t[3])&&h===(t[3]||t[2]||t[1]||t[0])&&!h.length&&(n?n[f]=h:this._root=h)):this._root=i,this;}function i(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this;}n.d(t,"__esModule",{value:!0}),n.e(t,{default:function(){return r;},removeAll:function(){return i;}});},bbae2951:function(e,t,n){var r=n("ed2bf8a3");e.exports=function(e,t,n){var r,a,o,s;return r=t||i,a=n||function(t){return e.outEdges(t);},o={},(s=e.nodes()).forEach(function(e){o[e]={},o[e][e]={distance:0},s.forEach(function(t){e!==t&&(o[e][t]={distance:Number.POSITIVE_INFINITY});}),a(e).forEach(function(t){var n=t.v===e?t.w:t.v,i=r(t);o[e][n]={distance:i,predecessor:e};});}),s.forEach(function(e){var t=o[e];s.forEach(function(n){var r=o[n];s.forEach(function(n){var i=r[e],a=t[n],o=r[n],s=i.distance+a.distance;s<o.distance&&(o.distance=s,o.predecessor=a.predecessor);});});}),o;};var i=r.constant(1);},bc3399ee:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e;};},bc4ab95d:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=(0,n("777fffbe")._(n("d465a478")).default)(Object.keys,Object);},bcaa694c:function(e,t,n){e.exports=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return -1;};},bd36140e:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return p;}});var r=n("777fffbe"),i=r._(n("e729dbbb")),a=r._(n("799ce237")),o=r._(n("b0de094c")),s=r._(n("6ddc54e8")),l=r._(n("9f6f6314")),u=r._(n("0f03385d")),c=r._(n("9c6e7c32")),d=r._(n("871ff507")),f=r._(n("a843c57c")),h=r._(n("e3f531bc")),p={fillImage:u.default,fill:l.default,radar:f.default,image:c.default,normal:d.default,simplePoint:i.default,extrude:s.default,text:h.default,earthFill:o.default,earthExtrude:a.default};},bd478e5d:function(e,t,n){var r=n("ed2bf8a3");e.exports=function(e){var t=0,n=[],i={},a=[];return e.nodes().forEach(function(o){r.has(i,o)||function o(s){var l=i[s]={onStack:!0,lowlink:t,index:t++};if(n.push(s),e.successors(s).forEach(function(e){r.has(i,e)?i[e].onStack&&(l.lowlink=Math.min(l.lowlink,i[e].index)):(o(e),l.lowlink=Math.min(l.lowlink,i[e].lowlink));}),l.lowlink===l.index){var u,c=[];do i[u=n.pop()].onStack=!1,c.push(u);while(s!==u)a.push(c);}}(o);}),a;};},be524c36:function(e,t,n){var r=n("13056af7"),i=0;e.exports=function(e){var t=++i;return r(e)+t;};},be56823a:function(e,t,n){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991;};},bea685b2:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0});var r=n("d1751d7c");r._(n("092be86a"),t),r._(n("0f0d54c3"),t);},bebef26b:function(e,t,n){var r=n("271c9ad5"),i=n("f24cd761"),a=n("81d598f3");e.exports=function(e){return e&&e.length?r(e,a,i):void 0;};},bec2d0e3:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return d;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("daaa1548")),o=r._(n("d812e418")),s=n("d9b661b3"),l=n("f86d399e"),u=r._(n("b6ae0420")),c=n("462c8966");class d extends l.EventEmitter{constructor(e,t){super(),(0,o.default)(this,"x",void 0),(0,o.default)(this,"y",void 0),(0,o.default)(this,"z",void 0),(0,o.default)(this,"key",void 0),(0,o.default)(this,"parent",void 0),(0,o.default)(this,"sourceTile",void 0),(0,o.default)(this,"visible",!0),(0,o.default)(this,"layers",[]),(0,o.default)(this,"isLoaded",!1),(0,o.default)(this,"tileMaskLayers",[]),(0,o.default)(this,"tileMask",void 0),this.parent=t,this.sourceTile=e,this.x=e.x,this.y=e.y,this.z=e.z,this.key=`${this.x}_${this.y}_${this.z}`;}getLayers(){return this.layers;}styleUpdate(...e){}lnglatInBounds(e){let[t,n,r,i]=this.sourceTile.bounds,{lng:a,lat:o}=e;return a>=t&&a<=r&&o>=n&&o<=i;}getLayerOptions(){var e;let t=this.parent.getLayerConfig();return(0,a.default)((0,a.default)({},t),{},{textAllowOverlap:!0,autoFit:!1,maskLayers:this.getMaskLayer(),tileMask:(0,c.isNeedMask)(this.parent.type),mask:t.mask||(null===(e=t.maskLayers)||void 0===e?void 0:e.length)!==0&&t.enableMask});}getMaskLayer(){let{maskLayers:e}=this.parent.getLayerConfig(),t=[];return null==e||e.forEach(e=>{if(!e.tileLayer)return t.push(e),e;let n=e.tileLayer.getTile(this.sourceTile.key),r=null==n?void 0:n.getLayers()[0];r&&t.push(r);}),t;}addTileMask(){var e=this;return(0,i.default)(function*(){let t=new u.default({name:"mask",visible:!0,enablePicking:!1}).source({type:"FeatureCollection",features:[e.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}).shape("fill").color("#0f0").style({opacity:.5}),n=(0,s.createLayerContainer)(e.parent.container);t.setContainer(n),yield t.init(),e.tileMask=t;let r=e.getMainLayer();return void 0!==r&&(r.tileMask=t),t;})();}addMask(e,t){var n=this;return(0,i.default)(function*(){let r=(0,s.createLayerContainer)(n.parent.container);t.setContainer(r),yield t.init(),e.addMask(t),n.tileMaskLayers.push(t);})();}addLayer(e){var t=this;return(0,i.default)(function*(){e.isTileLayer=!0;let n=(0,s.createLayerContainer)(t.parent.container);e.setContainer(n),t.layers.push(e),yield e.init();})();}updateVisible(e){this.visible=e,this.updateOptions("visible",e);}updateOptions(e,t){this.layers.forEach(n=>{n.updateLayerConfig({[e]:t});});}getMainLayer(){return this.layers[0];}getFeatures(e){return[];}getFeatureById(e){return[];}destroy(){var e;null===(e=this.tileMask)||void 0===e||e.destroy(),this.layers.forEach(e=>e.destroy());}}},bee223a7:function(e,t,n){let r=n("7b266b54");(function(){var n,i="Expected a function",a="__lodash_hash_undefined__",o="__lodash_placeholder__",s=1/0,l=0/0,u=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],c="[object Arguments]",d="[object Array]",f="[object Boolean]",h="[object Date]",p="[object Error]",v="[object Function]",g="[object GeneratorFunction]",m="[object Map]",y="[object Number]",b="[object Object]",_="[object Promise]",x="[object RegExp]",w="[object Set]",E="[object String]",M="[object Symbol]",S="[object WeakMap]",k="[object ArrayBuffer]",C="[object DataView]",A="[object Float32Array]",L="[object Float64Array]",P="[object Int8Array]",N="[object Int16Array]",O="[object Int32Array]",I="[object Uint8Array]",R="[object Uint8ClampedArray]",D="[object Uint16Array]",z="[object Uint32Array]",B=/\b__p \+= '';/g,U=/\b(__p \+=) '' \+/g,F=/(__e\(.*?\)|\b__t\)) \+\n'';/g,j=/&(?:amp|lt|gt|quot|#39);/g,V=/[&<>"']/g,G=RegExp(j.source),H=RegExp(V.source),W=/<%-([\s\S]+?)%>/g,Z=/<%([\s\S]+?)%>/g,q=/<%=([\s\S]+?)%>/g,Y=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,X=/^\w*$/,$=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,K=/[\\^$.*+?()[\]{}|]/g,Q=RegExp(K.source),J=/^\s+/,ee=/\s/,et=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,en=/\{\n\/\* \[wrapped with (.+)\] \*/,er=/,? & /,ei=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ea=/[()=,{}\[\]\/\s]/,eo=/\\(\\)?/g,es=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,el=/\w*$/,eu=/^[-+]0x[0-9a-f]+$/i,ec=/^0b[01]+$/i,ed=/^\[object .+?Constructor\]$/,ef=/^0o[0-7]+$/i,eh=/^(?:0|[1-9]\d*)$/,ep=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ev=/($^)/,eg=/['\n\r\u2028\u2029\\]/g,em="\ud800-\udfff",ey="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",eb="\\u2700-\\u27bf",e_="a-z\\xdf-\\xf6\\xf8-\\xff",ex="A-Z\\xc0-\\xd6\\xd8-\\xde",ew="\\ufe0e\\ufe0f",eE="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",eM="['\u2019]",eT="["+eE+"]",eS="["+ey+"]",ek="["+e_+"]",eC="[^"+em+eE+"\\d+"+eb+e_+ex+"]",eA="\ud83c[\udffb-\udfff]",eL="[^"+em+"]",eP="(?:\ud83c[\udde6-\uddff]){2}",eN="[\ud800-\udbff][\udc00-\udfff]",eO="["+ex+"]",eI="\\u200d",eR="(?:"+ek+"|"+eC+")",eD="(?:"+eO+"|"+eC+")",ez="(?:"+eM+"(?:d|ll|m|re|s|t|ve))?",eB="(?:"+eM+"(?:D|LL|M|RE|S|T|VE))?",eU="(?:"+eS+"|"+eA+")?",eF="["+ew+"]?",ej="(?:"+eI+"(?:"+[eL,eP,eN].join("|")+")"+eF+eU+")*",eV=eF+eU+ej,eG="(?:"+["["+eb+"]",eP,eN].join("|")+")"+eV,eH="(?:"+[eL+eS+"?",eS,eP,eN,"["+em+"]"].join("|")+")",eW=RegExp(eM,"g"),eZ=RegExp(eS,"g"),eq=RegExp(eA+"(?="+eA+")|"+eH+eV,"g"),eY=RegExp([eO+"?"+ek+"+"+ez+"(?="+[eT,eO,"$"].join("|")+")",eD+"+"+eB+"(?="+[eT,eO+eR,"$"].join("|")+")",eO+"?"+eR+"+"+ez,eO+"+"+eB,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",eG].join("|"),"g"),eX=RegExp("["+eI+em+ey+ew+"]"),e$=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,eK=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],eQ=-1,eJ={};eJ[A]=eJ[L]=eJ[P]=eJ[N]=eJ[O]=eJ[I]=eJ[R]=eJ[D]=eJ[z]=!0,eJ[c]=eJ[d]=eJ[k]=eJ[f]=eJ[C]=eJ[h]=eJ[p]=eJ[v]=eJ[m]=eJ[y]=eJ[b]=eJ[x]=eJ[w]=eJ[E]=eJ[S]=!1;var e0={};e0[c]=e0[d]=e0[k]=e0[C]=e0[f]=e0[h]=e0[A]=e0[L]=e0[P]=e0[N]=e0[O]=e0[m]=e0[y]=e0[b]=e0[x]=e0[w]=e0[E]=e0[M]=e0[I]=e0[R]=e0[D]=e0[z]=!0,e0[p]=e0[v]=e0[S]=!1;var e1={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},e2=parseFloat,e3=parseInt,e5="object"==typeof r&&r&&r.Object===Object&&r,e4="object"==typeof self&&self&&self.Object===Object&&self,e7=e5||e4||Function("return this")(),e6="object"==typeof t&&t&&!t.nodeType&&t,e8=e6&&"object"==typeof e&&e&&!e.nodeType&&e,e9=e8&&e8.exports===e6,te=e9&&e5.process,tt=function(){try{var e=e8&&e8.require&&e8.require("util").types;if(e)return e;return te&&te.binding&&te.binding("util");}catch(e){}}(),tn=tt&&tt.isArrayBuffer,tr=tt&&tt.isDate,ti=tt&&tt.isMap,ta=tt&&tt.isRegExp,to=tt&&tt.isSet,ts=tt&&tt.isTypedArray;function tl(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2]);}return e.apply(t,n);}function tu(e,t,n,r){for(var i=-1,a=null==e?0:e.length;++i<a;){var o=e[i];t(r,o,n(o),e);}return r;}function tc(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e;}function td(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0;}function tf(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o);}return a;}function th(e,t){return!!(null==e?0:e.length)&&tE(e,t,0)>-1;}function tp(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1;}function tv(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i;}function tg(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e;}function tm(e,t,n,r){var i=-1,a=null==e?0:e.length;for(r&&a&&(n=e[++i]);++i<a;)n=t(n,e[i],i,e);return n;}function ty(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n;}function tb(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1;}var t_=tk("length");function tx(e,t,n){var r;return n(e,function(e,n,i){if(t(e,n,i))return r=n,!1;}),r;}function tw(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return -1;}function tE(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return -1;}(e,t,n):tw(e,tT,n);}function tM(e,t,n,r){for(var i=n-1,a=e.length;++i<a;)if(r(e[i],t))return i;return -1;}function tT(e){return e!=e;}function tS(e,t){var n=null==e?0:e.length;return n?tL(e,t)/n:l;}function tk(e){return function(t){return null==t?n:t[e];};}function tC(e){return function(t){return null==e?n:e[t];};}function tA(e,t,n,r,i){return i(e,function(e,i,a){n=r?(r=!1,e):t(n,e,i,a);}),n;}function tL(e,t){for(var r,i=-1,a=e.length;++i<a;){var o=t(e[i]);n!==o&&(r=n===r?o:r+o);}return r;}function tP(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r;}function tN(e){return e?e.slice(0,tY(e)+1).replace(J,""):e;}function tO(e){return function(t){return e(t);};}function tI(e,t){return tv(t,function(t){return e[t];});}function tR(e,t){return e.has(t);}function tD(e,t){for(var n=-1,r=e.length;++n<r&&tE(t,e[n],0)>-1;);return n;}function tz(e,t){for(var n=e.length;n--&&tE(t,e[n],0)>-1;);return n;}var tB=tC({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"}),tU=tC({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function tF(e){return"\\"+e1[e];}function tj(e){return eX.test(e);}function tV(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e];}),n;}function tG(e,t){return function(n){return e(t(n));};}function tH(e,t){for(var n=-1,r=e.length,i=0,a=[];++n<r;){var s=e[n];(s===t||s===o)&&(e[n]=o,a[i++]=n);}return a;}function tW(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e;}),n;}function tZ(e){return tj(e)?function(e){for(var t=eq.lastIndex=0;eq.test(e);)++t;return t;}(e):t_(e);}function tq(e){return tj(e)?e.match(eq)||[]:e.split("");}function tY(e){for(var t=e.length;t--&&ee.test(e.charAt(t)););return t;}var tX=tC({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),t$=function e(t){var r,ee,em,ey,eb=(t=null==t?e7:t$.defaults(e7.Object(),t,t$.pick(e7,eK))).Array,e_=t.Date,ex=t.Error,ew=t.Function,eE=t.Math,eM=t.Object,eT=t.RegExp,eS=t.String,ek=t.TypeError,eC=eb.prototype,eA=ew.prototype,eL=eM.prototype,eP=t["__core-js_shared__"],eN=eA.toString,eO=eL.hasOwnProperty,eI=0,eR=(r=/[^.]+$/.exec(eP&&eP.keys&&eP.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",eD=eL.toString,ez=eN.call(eM),eB=e7._,eU=eT("^"+eN.call(eO).replace(K,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),eF=e9?t.Buffer:n,ej=t.Symbol,eV=t.Uint8Array,eG=eF?eF.allocUnsafe:n,eH=tG(eM.getPrototypeOf,eM),eq=eM.create,eX=eL.propertyIsEnumerable,e1=eC.splice,e5=ej?ej.isConcatSpreadable:n,e4=ej?ej.iterator:n,e6=ej?ej.toStringTag:n,e8=function(){try{var e=iv(eM,"defineProperty");return e({},"",{}),e;}catch(e){}}(),te=t.clearTimeout!==e7.clearTimeout&&t.clearTimeout,tt=e_&&e_.now!==e7.Date.now&&e_.now,t_=t.setTimeout!==e7.setTimeout&&t.setTimeout,tC=eE.ceil,tK=eE.floor,tQ=eM.getOwnPropertySymbols,tJ=eF?eF.isBuffer:n,t0=t.isFinite,t1=eC.join,t2=tG(eM.keys,eM),t3=eE.max,t5=eE.min,t4=e_.now,t7=t.parseInt,t6=eE.random,t8=eC.reverse,t9=iv(t,"DataView"),ne=iv(t,"Map"),nt=iv(t,"Promise"),nn=iv(t,"Set"),nr=iv(t,"WeakMap"),ni=iv(eM,"create"),na=nr&&new nr,no={},ns=iF(t9),nl=iF(ne),nu=iF(nt),nc=iF(nn),nd=iF(nr),nf=ej?ej.prototype:n,nh=nf?nf.valueOf:n,np=nf?nf.toString:n;function nv(e){if(aq(e)&&!aD(e)&&!(e instanceof nb)){if(e instanceof ny)return e;if(eO.call(e,"__wrapped__"))return ij(e);}return new ny(e);}var ng=function(){function e(){}return function(t){if(!aZ(t))return{};if(eq)return eq(t);e.prototype=t;var r=new e;return e.prototype=n,r;};}();function nm(){}function ny(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=n;}function nb(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[];}function n_(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1]);}}function nx(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1]);}}function nw(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1]);}}function nE(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new nw;++t<n;)this.add(e[t]);}function nM(e){var t=this.__data__=new nx(e);this.size=t.size;}function nT(e,t){var n=aD(e),r=!n&&aR(e),i=!n&&!r&&aF(e),a=!n&&!r&&!i&&a1(e),o=n||r||i||a,s=o?tP(e.length,eS):[],l=s.length;for(var u in e)(t||eO.call(e,u))&&!(o&&("length"==u||i&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||iw(u,l)))&&s.push(u);return s;}function nS(e){var t=e.length;return t?e[rc(0,t-1)]:n;}function nk(e,t,r){(n===r||aN(e[t],r))&&(n!==r||t in e)||nN(e,t,r);}function nC(e,t,r){var i=e[t];eO.call(e,t)&&aN(i,r)&&(n!==r||t in e)||nN(e,t,r);}function nA(e,t){for(var n=e.length;n--;)if(aN(e[n][0],t))return n;return -1;}function nL(e,t,n,r){return nU(e,function(e,i,a){t(r,e,n(e),a);}),r;}function nP(e,t){return e&&rV(t,oh(t),e);}function nN(e,t,n){"__proto__"==t&&e8?e8(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n;}function nO(e,t){for(var r=-1,i=t.length,a=eb(i),o=null==e;++r<i;)a[r]=o?n:ol(e,t[r]);return a;}function nI(e,t,r){return e==e&&(n!==r&&(e=e<=r?e:r),n!==t&&(e=e>=t?e:t)),e;}function nR(e,t,r,i,a,o){var s,l=1&t,u=2&t,d=4&t;if(r&&(s=a?r(e,i,a,o):r(e)),n!==s)return s;if(!aZ(e))return e;var p=aD(e);if(p){if(_=e.length,S=new e.constructor(_),_&&"string"==typeof e[0]&&eO.call(e,"index")&&(S.index=e.index,S.input=e.input),s=S,!l)return rj(e,s);}else{var _,S,B,U,F,j=iy(e),V=j==v||j==g;if(aF(e))return rR(e,l);if(j==b||j==c||V&&!a){if(s=u||V?{}:i_(e),!l)return u?(B=(F=s)&&rV(e,op(e),F),rV(e,im(e),B)):(U=nP(s,e),rV(e,ig(e),U));}else{if(!e0[j])return a?e:{};s=function(e,t,n){var r,i,a=e.constructor;switch(t){case k:return rD(e);case f:case h:return new a(+e);case C:return r=n?rD(e.buffer):e.buffer,new e.constructor(r,e.byteOffset,e.byteLength);case A:case L:case P:case N:case O:case I:case R:case D:case z:return rz(e,n);case m:return new a;case y:case E:return new a(e);case x:return(i=new e.constructor(e.source,el.exec(e))).lastIndex=e.lastIndex,i;case w:return new a;case M:return nh?eM(nh.call(e)):{};}}(e,j,l);}}o||(o=new nM);var G=o.get(e);if(G)return G;o.set(e,s),aQ(e)?e.forEach(function(n){s.add(nR(n,t,r,n,e,o));}):aY(e)&&e.forEach(function(n,i){s.set(i,nR(n,t,r,i,e,o));});var H=d?u?is:io:u?op:oh,W=p?n:H(e);return tc(W||e,function(n,i){W&&(n=e[i=n]),nC(s,i,nR(n,t,r,i,e,o));}),s;}function nD(e,t,r){var i=r.length;if(null==e)return!i;for(e=eM(e);i--;){var a=r[i],o=t[a],s=e[a];if(n===s&&!(a in e)||!o(s))return!1;}return!0;}function nz(e,t,r){if("function"!=typeof e)throw new ek(i);return iO(function(){e.apply(n,r);},t);}function nB(e,t,n,r){var i=-1,a=th,o=!0,s=e.length,l=[],u=t.length;if(!s)return l;n&&(t=tv(t,tO(n))),r?(a=tp,o=!1):t.length>=200&&(a=tR,o=!1,t=new nE(t));e:for(;++i<s;){var c=e[i],d=null==n?c:n(c);if(c=r||0!==c?c:0,o&&d==d){for(var f=u;f--;)if(t[f]===d)continue e;l.push(c);}else a(t,d,r)||l.push(c);}return l;}nv.templateSettings={escape:W,evaluate:Z,interpolate:q,variable:"",imports:{_:nv}},nv.prototype=nm.prototype,nv.prototype.constructor=nv,ny.prototype=ng(nm.prototype),ny.prototype.constructor=ny,nb.prototype=ng(nm.prototype),nb.prototype.constructor=nb,n_.prototype.clear=function(){this.__data__=ni?ni(null):{},this.size=0;},n_.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t;},n_.prototype.get=function(e){var t=this.__data__;if(ni){var r=t[e];return r===a?n:r;}return eO.call(t,e)?t[e]:n;},n_.prototype.has=function(e){var t=this.__data__;return ni?t[e]!==n:eO.call(t,e);},n_.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=ni&&n===t?a:t,this;},nx.prototype.clear=function(){this.__data__=[],this.size=0;},nx.prototype.delete=function(e){var t=this.__data__,n=nA(t,e);return!(n<0)&&(n==t.length-1?t.pop():e1.call(t,n,1),--this.size,!0);},nx.prototype.get=function(e){var t=this.__data__,r=nA(t,e);return r<0?n:t[r][1];},nx.prototype.has=function(e){return nA(this.__data__,e)>-1;},nx.prototype.set=function(e,t){var n=this.__data__,r=nA(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this;},nw.prototype.clear=function(){this.size=0,this.__data__={hash:new n_,map:new(ne||nx),string:new n_};},nw.prototype.delete=function(e){var t=ih(this,e).delete(e);return this.size-=t?1:0,t;},nw.prototype.get=function(e){return ih(this,e).get(e);},nw.prototype.has=function(e){return ih(this,e).has(e);},nw.prototype.set=function(e,t){var n=ih(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this;},nE.prototype.add=nE.prototype.push=function(e){return this.__data__.set(e,a),this;},nE.prototype.has=function(e){return this.__data__.has(e);},nM.prototype.clear=function(){this.__data__=new nx,this.size=0;},nM.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n;},nM.prototype.get=function(e){return this.__data__.get(e);},nM.prototype.has=function(e){return this.__data__.has(e);},nM.prototype.set=function(e,t){var n=this.__data__;if(n instanceof nx){var r=n.__data__;if(!ne||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new nw(r);}return n.set(e,t),this.size=n.size,this;};var nU=rW(nq),nF=rW(nY,!0);function nj(e,t){var n=!0;return nU(e,function(e,r,i){return n=!!t(e,r,i);}),n;}function nV(e,t,r){for(var i=-1,a=e.length;++i<a;){var o=e[i],s=t(o);if(null!=s&&(n===l?s==s&&!a0(s):r(s,l)))var l=s,u=o;}return u;}function nG(e,t){var n=[];return nU(e,function(e,r,i){t(e,r,i)&&n.push(e);}),n;}function nH(e,t,n,r,i){var a=-1,o=e.length;for(n||(n=ix),i||(i=[]);++a<o;){var s=e[a];t>0&&n(s)?t>1?nH(s,t-1,n,r,i):tg(i,s):r||(i[i.length]=s);}return i;}var nW=rZ(),nZ=rZ(!0);function nq(e,t){return e&&nW(e,t,oh);}function nY(e,t){return e&&nZ(e,t,oh);}function nX(e,t){return tf(t,function(t){return aG(e[t]);});}function n$(e,t){t=rN(t,e);for(var r=0,i=t.length;null!=e&&r<i;)e=e[iU(t[r++])];return r&&r==i?e:n;}function nK(e,t,n){var r=t(e);return aD(e)?r:tg(r,n(e));}function nQ(e){return null==e?n===e?"[object Undefined]":"[object Null]":e6&&e6 in eM(e)?function(e){var t=eO.call(e,e6),r=e[e6];try{e[e6]=n;var i=!0;}catch(e){}var a=eD.call(e);return i&&(t?e[e6]=r:delete e[e6]),a;}(e):eD.call(e);}function nJ(e,t){return e>t;}function n0(e,t){return null!=e&&eO.call(e,t);}function n1(e,t){return null!=e&&t in eM(e);}function n2(e,t,r){for(var i=r?tp:th,a=e[0].length,o=e.length,s=o,l=eb(o),u=1/0,c=[];s--;){var d=e[s];s&&t&&(d=tv(d,tO(t))),u=t5(d.length,u),l[s]=!r&&(t||a>=120&&d.length>=120)?new nE(s&&d):n;}d=e[0];var f=-1,h=l[0];e:for(;++f<a&&c.length<u;){var p=d[f],v=t?t(p):p;if(p=r||0!==p?p:0,!(h?tR(h,v):i(c,v,r))){for(s=o;--s;){var g=l[s];if(!(g?tR(g,v):i(e[s],v,r)))continue e;}h&&h.push(v),c.push(p);}}return c;}function n3(e,t,r){t=rN(t,e);var i=null==(e=iL(e,t))?e:e[iU(iQ(t))];return null==i?n:tl(i,e,r);}function n5(e){return aq(e)&&nQ(e)==c;}function n4(e,t,r,i,a){return e===t||(null!=e&&null!=t&&(aq(e)||aq(t))?function(e,t,r,i,a,o){var s=aD(e),l=aD(t),u=s?d:iy(e),v=l?d:iy(t);u=u==c?b:u,v=v==c?b:v;var g=u==b,_=v==b,S=u==v;if(S&&aF(e)){if(!aF(t))return!1;s=!0,g=!1;}if(S&&!g)return o||(o=new nM),s||a1(e)?ii(e,t,r,i,a,o):function(e,t,n,r,i,a,o){switch(n){case C:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case k:if(e.byteLength!=t.byteLength||!a(new eV(e),new eV(t)))break;return!0;case f:case h:case y:return aN(+e,+t);case p:return e.name==t.name&&e.message==t.message;case x:case E:return e==t+"";case m:var s=tV;case w:var l=1&r;if(s||(s=tW),e.size!=t.size&&!l)break;var u=o.get(e);if(u)return u==t;r|=2,o.set(e,t);var c=ii(s(e),s(t),r,i,a,o);return o.delete(e),c;case M:if(nh)return nh.call(e)==nh.call(t);}return!1;}(e,t,u,r,i,a,o);if(!(1&r)){var A=g&&eO.call(e,"__wrapped__"),L=_&&eO.call(t,"__wrapped__");if(A||L){var P=A?e.value():e,N=L?t.value():t;return o||(o=new nM),a(P,N,r,i,o);}}return!!S&&(o||(o=new nM),function(e,t,r,i,a,o){var s=1&r,l=io(e),u=l.length;if(u!=io(t).length&&!s)return!1;for(var c=u;c--;){var d=l[c];if(!(s?d in t:eO.call(t,d)))return!1;}var f=o.get(e),h=o.get(t);if(f&&h)return f==t&&h==e;var p=!0;o.set(e,t),o.set(t,e);for(var v=s;++c<u;){var g=e[d=l[c]],m=t[d];if(i)var y=s?i(m,g,d,t,e,o):i(g,m,d,e,t,o);if(!(n===y?g===m||a(g,m,r,i,o):y)){p=!1;break;}v||(v="constructor"==d);}if(p&&!v){var b=e.constructor,_=t.constructor;b!=_&&"constructor"in e&&"constructor"in t&&!("function"==typeof b&&b instanceof b&&"function"==typeof _&&_ instanceof _)&&(p=!1);}return o.delete(e),o.delete(t),p;}(e,t,r,i,a,o));}(e,t,r,i,n4,a):e!=e&&t!=t);}function n7(e,t,r,i){var a=r.length,o=a,s=!i;if(null==e)return!o;for(e=eM(e);a--;){var l=r[a];if(s&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1;}for(;++a<o;){var u=(l=r[a])[0],c=e[u],d=l[1];if(s&&l[2]){if(n===c&&!(u in e))return!1;}else{var f=new nM;if(i)var h=i(c,d,u,e,t,f);if(!(n===h?n4(d,c,3,i,f):h))return!1;}}return!0;}function n6(e){return!(!aZ(e)||eR&&eR in e)&&(aG(e)?eU:ed).test(iF(e));}function n8(e){return"function"==typeof e?e:null==e?oU:"object"==typeof e?aD(e)?rr(e[0],e[1]):rn(e):oY(e);}function n9(e){if(!ik(e))return t2(e);var t=[];for(var n in eM(e))eO.call(e,n)&&"constructor"!=n&&t.push(n);return t;}function re(e,t){return e<t;}function rt(e,t){var n=-1,r=aB(e)?eb(e.length):[];return nU(e,function(e,i,a){r[++n]=t(e,i,a);}),r;}function rn(e){var t=ip(e);return 1==t.length&&t[0][2]?iC(t[0][0],t[0][1]):function(n){return n===e||n7(n,e,t);};}function rr(e,t){var r;return iM(e)&&(r=t)==r&&!aZ(r)?iC(iU(e),t):function(r){var i=ol(r,e);return n===i&&i===t?ou(r,e):n4(t,i,3);};}function ri(e,t,r,i,a){e!==t&&nW(t,function(o,s){if(a||(a=new nM),aZ(o))!function(e,t,r,i,a,o,s){var l=iP(e,r),u=iP(t,r),c=s.get(u);if(c){nk(e,r,c);return;}var d=o?o(l,u,r+"",e,t,s):n,f=n===d;if(f){var h=aD(u),p=!h&&aF(u),v=!h&&!p&&a1(u);d=u,h||p||v?aD(l)?d=l:aU(l)?d=rj(l):p?(f=!1,d=rR(u,!0)):v?(f=!1,d=rz(u,!0)):d=[]:a$(u)||aR(u)?(d=l,aR(l)?d=a9(l):(!aZ(l)||aG(l))&&(d=i_(u))):f=!1;}f&&(s.set(u,d),a(d,u,i,o,s),s.delete(u)),nk(e,r,d);}(e,t,s,r,ri,i,a);else{var l=i?i(iP(e,s),o,s+"",e,t,a):n;n===l&&(l=o),nk(e,s,l);}},op);}function ra(e,t){var r=e.length;if(r)return iw(t+=t<0?r:0,r)?e[t]:n;}function ro(e,t,n){t=t.length?tv(t,function(e){return aD(e)?function(t){return n$(t,1===e.length?e[0]:e);}:e;}):[oU];var r=-1;return t=tv(t,tO(id())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e;}(rt(e,function(e,n,i){return{criteria:tv(t,function(t){return t(e);}),index:++r,value:e};}),function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,a=t.criteria,o=i.length,s=n.length;++r<o;){var l=rB(i[r],a[r]);if(l){if(r>=s)return l;return l*("desc"==n[r]?-1:1);}}return e.index-t.index;}(e,t,n);});}function rs(e,t,n){for(var r=-1,i=t.length,a={};++r<i;){var o=t[r],s=n$(e,o);n(s,o)&&rh(a,rN(o,e),s);}return a;}function rl(e,t,n,r){var i=r?tM:tE,a=-1,o=t.length,s=e;for(e===t&&(t=rj(t)),n&&(s=tv(e,tO(n)));++a<o;)for(var l=0,u=t[a],c=n?n(u):u;(l=i(s,c,l,r))>-1;)s!==e&&e1.call(s,l,1),e1.call(e,l,1);return e;}function ru(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==a){var a=i;iw(i)?e1.call(e,i,1):rM(e,i);}}return e;}function rc(e,t){return e+tK(t6()*(t-e+1));}function rd(e,t){var n="";if(!e||t<1||t>9007199254740991)return n;do t%2&&(n+=e),(t=tK(t/2))&&(e+=e);while(t)return n;}function rf(e,t){return iI(iA(e,t,oU),e+"");}function rh(e,t,r,i){if(!aZ(e))return e;t=rN(t,e);for(var a=-1,o=t.length,s=o-1,l=e;null!=l&&++a<o;){var u=iU(t[a]),c=r;if("__proto__"===u||"constructor"===u||"prototype"===u)break;if(a!=s){var d=l[u];c=i?i(d,u,l):n,n===c&&(c=aZ(d)?d:iw(t[a+1])?[]:{});}nC(l,u,c),l=l[u];}return e;}var rp=na?function(e,t){return na.set(e,t),e;}:oU,rv=e8?function(e,t){return e8(e,"toString",{configurable:!0,enumerable:!1,value:oD(t),writable:!0});}:oU;function rg(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var a=eb(i);++r<i;)a[r]=e[r+t];return a;}function rm(e,t){var n;return nU(e,function(e,r,i){return!(n=t(e,r,i));}),!!n;}function ry(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var a=r+i>>>1,o=e[a];null!==o&&!a0(o)&&(n?o<=t:o<t)?r=a+1:i=a;}return i;}return rb(e,t,oU,n);}function rb(e,t,r,i){var a=0,o=null==e?0:e.length;if(0===o)return 0;for(var s=(t=r(t))!=t,l=null===t,u=a0(t),c=n===t;a<o;){var d=tK((a+o)/2),f=r(e[d]),h=n!==f,p=null===f,v=f==f,g=a0(f);if(s)var m=i||v;else m=c?v&&(i||h):l?v&&h&&(i||!p):u?v&&h&&!p&&(i||!g):!p&&!g&&(i?f<=t:f<t);m?a=d+1:o=d;}return t5(o,4294967294);}function r_(e,t){for(var n=-1,r=e.length,i=0,a=[];++n<r;){var o=e[n],s=t?t(o):o;if(!n||!aN(s,l)){var l=s;a[i++]=0===o?0:o;}}return a;}function rx(e){return"number"==typeof e?e:a0(e)?l:+e;}function rw(e){if("string"==typeof e)return e;if(aD(e))return tv(e,rw)+"";if(a0(e))return np?np.call(e):"";var t=e+"";return"0"==t&&1/e==-s?"-0":t;}function rE(e,t,n){var r=-1,i=th,a=e.length,o=!0,s=[],l=s;if(n)o=!1,i=tp;else if(a>=200){var u=t?null:r6(e);if(u)return tW(u);o=!1,i=tR,l=new nE;}else l=t?[]:s;e:for(;++r<a;){var c=e[r],d=t?t(c):c;if(c=n||0!==c?c:0,o&&d==d){for(var f=l.length;f--;)if(l[f]===d)continue e;t&&l.push(d),s.push(c);}else i(l,d,n)||(l!==s&&l.push(d),s.push(c));}return s;}function rM(e,t){return t=rN(t,e),null==(e=iL(e,t))||delete e[iU(iQ(t))];}function rT(e,t,n,r){return rh(e,t,n(n$(e,t)),r);}function rS(e,t,n,r){for(var i=e.length,a=r?i:-1;(r?a--:++a<i)&&t(e[a],a,e););return n?rg(e,r?0:a,r?a+1:i):rg(e,r?a+1:0,r?i:a);}function rk(e,t){var n=e;return n instanceof nb&&(n=n.value()),tm(t,function(e,t){return t.func.apply(t.thisArg,tg([e],t.args));},n);}function rC(e,t,n){var r=e.length;if(r<2)return r?rE(e[0]):[];for(var i=-1,a=eb(r);++i<r;)for(var o=e[i],s=-1;++s<r;)s!=i&&(a[i]=nB(a[i]||o,e[s],t,n));return rE(nH(a,1),t,n);}function rA(e,t,r){for(var i=-1,a=e.length,o=t.length,s={};++i<a;){var l=i<o?t[i]:n;r(s,e[i],l);}return s;}function rL(e){return aU(e)?e:[];}function rP(e){return"function"==typeof e?e:oU;}function rN(e,t){return aD(e)?e:iM(e,t)?[e]:iB(oe(e));}function rO(e,t,r){var i=e.length;return r=n===r?i:r,!t&&r>=i?e:rg(e,t,r);}var rI=te||function(e){return e7.clearTimeout(e);};function rR(e,t){if(t)return e.slice();var n=e.length,r=eG?eG(n):new e.constructor(n);return e.copy(r),r;}function rD(e){var t=new e.constructor(e.byteLength);return new eV(t).set(new eV(e)),t;}function rz(e,t){var n=t?rD(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length);}function rB(e,t){if(e!==t){var r=n!==e,i=null===e,a=e==e,o=a0(e),s=n!==t,l=null===t,u=t==t,c=a0(t);if(!l&&!c&&!o&&e>t||o&&s&&u&&!l&&!c||i&&s&&u||!r&&u||!a)return 1;if(!i&&!o&&!c&&e<t||c&&r&&a&&!i&&!o||l&&r&&a||!s&&a||!u)return -1;}return 0;}function rU(e,t,n,r){for(var i=-1,a=e.length,o=n.length,s=-1,l=t.length,u=t3(a-o,0),c=eb(l+u),d=!r;++s<l;)c[s]=t[s];for(;++i<o;)(d||i<a)&&(c[n[i]]=e[i]);for(;u--;)c[s++]=e[i++];return c;}function rF(e,t,n,r){for(var i=-1,a=e.length,o=-1,s=n.length,l=-1,u=t.length,c=t3(a-s,0),d=eb(c+u),f=!r;++i<c;)d[i]=e[i];for(var h=i;++l<u;)d[h+l]=t[l];for(;++o<s;)(f||i<a)&&(d[h+n[o]]=e[i++]);return d;}function rj(e,t){var n=-1,r=e.length;for(t||(t=eb(r));++n<r;)t[n]=e[n];return t;}function rV(e,t,r,i){var a=!r;r||(r={});for(var o=-1,s=t.length;++o<s;){var l=t[o],u=i?i(r[l],e[l],l,r,e):n;n===u&&(u=e[l]),a?nN(r,l,u):nC(r,l,u);}return r;}function rG(e,t){return function(n,r){var i=aD(n)?tu:nL,a=t?t():{};return i(n,e,id(r,2),a);};}function rH(e){return rf(function(t,r){var i=-1,a=r.length,o=a>1?r[a-1]:n,s=a>2?r[2]:n;for(o=e.length>3&&"function"==typeof o?(a--,o):n,s&&iE(r[0],r[1],s)&&(o=a<3?n:o,a=1),t=eM(t);++i<a;){var l=r[i];l&&e(t,l,i,o);}return t;});}function rW(e,t){return function(n,r){if(null==n)return n;if(!aB(n))return e(n,r);for(var i=n.length,a=t?i:-1,o=eM(n);(t?a--:++a<i)&&!1!==r(o[a],a,o););return n;};}function rZ(e){return function(t,n,r){for(var i=-1,a=eM(t),o=r(t),s=o.length;s--;){var l=o[e?s:++i];if(!1===n(a[l],l,a))break;}return t;};}function rq(e){return function(t){var r=tj(t=oe(t))?tq(t):n,i=r?r[0]:t.charAt(0),a=r?rO(r,1).join(""):t.slice(1);return i[e]()+a;};}function rY(e){return function(t){return tm(oO(oT(t).replace(eW,"")),e,"");};}function rX(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6]);}var n=ng(e.prototype),r=e.apply(n,t);return aZ(r)?r:n;};}function r$(e){return function(t,r,i){var a=eM(t);if(!aB(t)){var o=id(r,3);t=oh(t),r=function(e){return o(a[e],e,a);};}var s=e(t,r,i);return s>-1?a[o?t[s]:s]:n;};}function rK(e){return ia(function(t){var r=t.length,a=r,o=ny.prototype.thru;for(e&&t.reverse();a--;){var s=t[a];if("function"!=typeof s)throw new ek(i);if(o&&!l&&"wrapper"==iu(s))var l=new ny([],!0);}for(a=l?a:r;++a<r;){var u=iu(s=t[a]),c="wrapper"==u?il(s):n;l=c&&iT(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?l[iu(c[0])].apply(l,c[3]):1==s.length&&iT(s)?l[u]():l.thru(s);}return function(){var e=arguments,n=e[0];if(l&&1==e.length&&aD(n))return l.plant(n).value();for(var i=0,a=r?t[i].apply(this,e):n;++i<r;)a=t[i].call(this,a);return a;};});}function rQ(e,t,r,i,a,o,s,l,u,c){var d=128&t,f=1&t,h=2&t,p=24&t,v=512&t,g=h?n:rX(e);return function m(){for(var y=arguments.length,b=eb(y),_=y;_--;)b[_]=arguments[_];if(p)var x=ic(m),w=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r;}(b,x);if(i&&(b=rU(b,i,a,p)),o&&(b=rF(b,o,s,p)),y-=w,p&&y<c){var E=tH(b,x);return r4(e,t,rQ,m.placeholder,r,b,E,l,u,c-y);}var M=f?r:this,S=h?M[e]:e;return y=b.length,l?b=function(e,t){for(var r=e.length,i=t5(t.length,r),a=rj(e);i--;){var o=t[i];e[i]=iw(o,r)?a[o]:n;}return e;}(b,l):v&&y>1&&b.reverse(),d&&u<y&&(b.length=u),this&&this!==e7&&this instanceof m&&(S=g||rX(S)),S.apply(M,b);};}function rJ(e,t){return function(n,r){var i,a;return i=t(r),a={},nq(n,function(t,n,r){e(a,i(t),n,r);}),a;};}function r0(e,t){return function(r,i){var a;if(n===r&&n===i)return t;if(n!==r&&(a=r),n!==i){if(n===a)return i;"string"==typeof r||"string"==typeof i?(r=rw(r),i=rw(i)):(r=rx(r),i=rx(i)),a=e(r,i);}return a;};}function r1(e){return ia(function(t){return t=tv(t,tO(id())),rf(function(n){var r=this;return e(t,function(e){return tl(e,r,n);});});});}function r2(e,t){var r=(t=n===t?" ":rw(t)).length;if(r<2)return r?rd(t,e):t;var i=rd(t,tC(e/tZ(t)));return tj(t)?rO(tq(i),0,e).join(""):i.slice(0,e);}function r3(e){return function(t,r,i){return i&&"number"!=typeof i&&iE(t,r,i)&&(r=i=n),t=a4(t),n===r?(r=t,t=0):r=a4(r),i=n===i?t<r?1:-1:a4(i),function(e,t,n,r){for(var i=-1,a=t3(tC((t-e)/(n||1)),0),o=eb(a);a--;)o[r?a:++i]=e,e+=n;return o;}(t,r,i,e);};}function r5(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=a8(t),n=a8(n)),e(t,n);};}function r4(e,t,r,i,a,o,s,l,u,c){var d=8&t,f=d?s:n,h=d?n:s,p=d?o:n,v=d?n:o;t|=d?32:64,4&(t&=~(d?64:32))||(t&=-4);var g=[e,t,a,p,f,v,h,l,u,c],m=r.apply(n,g);return iT(e)&&iN(m,g),m.placeholder=i,iR(m,e,t);}function r7(e){var t=eE[e];return function(e,n){if(e=a8(e),(n=null==n?0:t5(a7(n),292))&&t0(e)){var r=(oe(e)+"e").split("e");return+((r=(oe(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n));}return t(e);};}var r6=nn&&1/tW(new nn([,-0]))[1]==s?function(e){return new nn(e);}:oH;function r8(e){return function(t){var n,r,i=iy(t);return i==m?tV(t):i==w?(n=-1,r=Array(t.size),t.forEach(function(e){r[++n]=[e,e];}),r):tv(e(t),function(e){return[e,t[e]];});};}function r9(e,t,r,a,s,l,u,c){var d=2&t;if(!d&&"function"!=typeof e)throw new ek(i);var f=a?a.length:0;if(f||(t&=-97,a=s=n),u=n===u?u:t3(a7(u),0),c=n===c?c:a7(c),f-=s?s.length:0,64&t){var h=a,p=s;a=s=n;}var v=d?n:il(e),g=[e,t,r,a,s,h,p,l,u,c];if(v&&function(e,t){var n=e[1],r=t[1],i=n|r,a=i<131,s=128==r&&8==n||128==r&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(a||s){1&r&&(e[2]=t[2],i|=1&n?0:4);var l=t[3];if(l){var u=e[3];e[3]=u?rU(u,l,t[4]):l,e[4]=u?tH(e[3],o):t[4];}(l=t[5])&&(u=e[5],e[5]=u?rF(u,l,t[6]):l,e[6]=u?tH(e[5],o):t[6]),(l=t[7])&&(e[7]=l),128&r&&(e[8]=null==e[8]?t[8]:t5(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i;}}(g,v),e=g[0],t=g[1],r=g[2],a=g[3],s=g[4],(c=g[9]=g[9]===n?d?0:e.length:t3(g[9]-f,0))||!(24&t)||(t&=-25),t&&1!=t)8==t||16==t?(m=e,y=t,b=c,_=rX(m),O=function e(){for(var t=arguments.length,r=eb(t),i=t,a=ic(e);i--;)r[i]=arguments[i];var o=t<3&&r[0]!==a&&r[t-1]!==a?[]:tH(r,a);return(t-=o.length)<b?r4(m,y,rQ,e.placeholder,n,r,o,n,n,b-t):tl(this&&this!==e7&&this instanceof e?_:m,this,r);}):32!=t&&33!=t||s.length?O=rQ.apply(n,g):(x=e,w=t,E=r,M=a,S=1&w,k=rX(x),O=function e(){for(var t=-1,n=arguments.length,r=-1,i=M.length,a=eb(i+n),o=this&&this!==e7&&this instanceof e?k:x;++r<i;)a[r]=M[r];for(;n--;)a[r++]=arguments[++t];return tl(o,S?E:this,a);});else var m,y,b,_,x,w,E,M,S,k,C,A,L,P,N,O=(C=e,A=t,L=r,P=1&A,N=rX(C),function e(){return(this&&this!==e7&&this instanceof e?N:C).apply(P?L:this,arguments);});return iR((v?rp:iN)(O,g),e,t);}function ie(e,t,r,i){return n===e||aN(e,eL[r])&&!eO.call(i,r)?t:e;}function it(e,t,r,i,a,o){return aZ(e)&&aZ(t)&&(o.set(t,e),ri(e,t,n,it,o),o.delete(t)),e;}function ir(e){return a$(e)?n:e;}function ii(e,t,r,i,a,o){var s=1&r,l=e.length,u=t.length;if(l!=u&&!(s&&u>l))return!1;var c=o.get(e),d=o.get(t);if(c&&d)return c==t&&d==e;var f=-1,h=!0,p=2&r?new nE:n;for(o.set(e,t),o.set(t,e);++f<l;){var v=e[f],g=t[f];if(i)var m=s?i(g,v,f,t,e,o):i(v,g,f,e,t,o);if(n!==m){if(m)continue;h=!1;break;}if(p){if(!tb(t,function(e,t){if(!tR(p,t)&&(v===e||a(v,e,r,i,o)))return p.push(t);})){h=!1;break;}}else if(!(v===g||a(v,g,r,i,o))){h=!1;break;}}return o.delete(e),o.delete(t),h;}function ia(e){return iI(iA(e,n,iq),e+"");}function io(e){return nK(e,oh,ig);}function is(e){return nK(e,op,im);}var il=na?function(e){return na.get(e);}:oH;function iu(e){for(var t=e.name+"",n=no[t],r=eO.call(no,t)?n.length:0;r--;){var i=n[r],a=i.func;if(null==a||a==e)return i.name;}return t;}function ic(e){return(eO.call(nv,"placeholder")?nv:e).placeholder;}function id(){var e=nv.iteratee||oF;return e=e===oF?n8:e,arguments.length?e(arguments[0],arguments[1]):e;}function ih(e,t){var n,r=e.__data__;return("string"==(n=typeof t)||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t)?r["string"==typeof t?"string":"hash"]:r.map;}function ip(e){for(var t=oh(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,i==i&&!aZ(i)];}return t;}function iv(e,t){var r=null==e?n:e[t];return n6(r)?r:n;}var ig=tQ?function(e){return null==e?[]:tf(tQ(e=eM(e)),function(t){return eX.call(e,t);});}:oK,im=tQ?function(e){for(var t=[];e;)tg(t,ig(e)),e=eH(e);return t;}:oK,iy=nQ;function ib(e,t,n){t=rN(t,e);for(var r=-1,i=t.length,a=!1;++r<i;){var o=iU(t[r]);if(!(a=null!=e&&n(e,o)))break;e=e[o];}return a||++r!=i?a:!!(i=null==e?0:e.length)&&aW(i)&&iw(o,i)&&(aD(e)||aR(e));}function i_(e){return"function"!=typeof e.constructor||ik(e)?{}:ng(eH(e));}function ix(e){return aD(e)||aR(e)||!!(e5&&e&&e[e5]);}function iw(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&eh.test(e))&&e>-1&&e%1==0&&e<t;}function iE(e,t,n){if(!aZ(n))return!1;var r=typeof t;return("number"==r?!!(aB(n)&&iw(t,n.length)):"string"==r&&t in n)&&aN(n[t],e);}function iM(e,t){if(aD(e))return!1;var n=typeof e;return!!("number"==n||"symbol"==n||"boolean"==n||null==e||a0(e))||X.test(e)||!Y.test(e)||null!=t&&e in eM(t);}function iT(e){var t=iu(e),n=nv[t];if("function"!=typeof n||!(t in nb.prototype))return!1;if(e===n)return!0;var r=il(n);return!!r&&e===r[0];}(t9&&iy(new t9(new ArrayBuffer(1)))!=C||ne&&iy(new ne)!=m||nt&&iy(nt.resolve())!=_||nn&&iy(new nn)!=w||nr&&iy(new nr)!=S)&&(iy=function(e){var t=nQ(e),r=t==b?e.constructor:n,i=r?iF(r):"";if(i)switch(i){case ns:return C;case nl:return m;case nu:return _;case nc:return w;case nd:return S;}return t;});var iS=eP?aG:oQ;function ik(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||eL);}function iC(e,t){return function(r){return null!=r&&r[e]===t&&(n!==t||e in eM(r));};}function iA(e,t,r){return t=t3(n===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,a=t3(n.length-t,0),o=eb(a);++i<a;)o[i]=n[t+i];i=-1;for(var s=eb(t+1);++i<t;)s[i]=n[i];return s[t]=r(o),tl(e,this,s);};}function iL(e,t){return t.length<2?e:n$(e,rg(t,0,-1));}function iP(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t];}var iN=iD(rp),iO=t_||function(e,t){return e7.setTimeout(e,t);},iI=iD(rv);function iR(e,t,n){var r,i,a=t+"";return iI(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(et,"{\n/* [wrapped with "+t+"] */\n");}(a,(r=(i=a.match(en))?i[1].split(er):[],tc(u,function(e){var t="_."+e[0];n&e[1]&&!th(r,t)&&r.push(t);}),r.sort())));}function iD(e){var t=0,r=0;return function(){var i=t4(),a=16-(i-r);if(r=i,a>0){if(++t>=800)return arguments[0];}else t=0;return e.apply(n,arguments);};}function iz(e,t){var r=-1,i=e.length,a=i-1;for(t=n===t?i:t;++r<t;){var o=rc(r,a),s=e[o];e[o]=e[r],e[r]=s;}return e.length=t,e;}var iB=(em=(ee=aS(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace($,function(e,n,r,i){t.push(r?i.replace(eo,"$1"):n||e);}),t;},function(e){return 500===em.size&&em.clear(),e;})).cache,ee);function iU(e){if("string"==typeof e||a0(e))return e;var t=e+"";return"0"==t&&1/e==-s?"-0":t;}function iF(e){if(null!=e){try{return eN.call(e);}catch(e){}try{return e+"";}catch(e){}}return"";}function ij(e){if(e instanceof nb)return e.clone();var t=new ny(e.__wrapped__,e.__chain__);return t.__actions__=rj(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t;}var iV=rf(function(e,t){return aU(e)?nB(e,nH(t,1,aU,!0)):[];}),iG=rf(function(e,t){var r=iQ(t);return aU(r)&&(r=n),aU(e)?nB(e,nH(t,1,aU,!0),id(r,2)):[];}),iH=rf(function(e,t){var r=iQ(t);return aU(r)&&(r=n),aU(e)?nB(e,nH(t,1,aU,!0),n,r):[];});function iW(e,t,n){var r=null==e?0:e.length;if(!r)return -1;var i=null==n?0:a7(n);return i<0&&(i=t3(r+i,0)),tw(e,id(t,3),i);}function iZ(e,t,r){var i=null==e?0:e.length;if(!i)return -1;var a=i-1;return n!==r&&(a=a7(r),a=r<0?t3(i+a,0):t5(a,i-1)),tw(e,id(t,3),a,!0);}function iq(e){return(null==e?0:e.length)?nH(e,1):[];}function iY(e){return e&&e.length?e[0]:n;}var iX=rf(function(e){var t=tv(e,rL);return t.length&&t[0]===e[0]?n2(t):[];}),i$=rf(function(e){var t=iQ(e),r=tv(e,rL);return t===iQ(r)?t=n:r.pop(),r.length&&r[0]===e[0]?n2(r,id(t,2)):[];}),iK=rf(function(e){var t=iQ(e),r=tv(e,rL);return(t="function"==typeof t?t:n)&&r.pop(),r.length&&r[0]===e[0]?n2(r,n,t):[];});function iQ(e){var t=null==e?0:e.length;return t?e[t-1]:n;}var iJ=rf(i0);function i0(e,t){return e&&e.length&&t&&t.length?rl(e,t):e;}var i1=ia(function(e,t){var n=null==e?0:e.length,r=nO(e,t);return ru(e,tv(t,function(e){return iw(e,n)?+e:e;}).sort(rB)),r;});function i2(e){return null==e?e:t8.call(e);}var i3=rf(function(e){return rE(nH(e,1,aU,!0));}),i5=rf(function(e){var t=iQ(e);return aU(t)&&(t=n),rE(nH(e,1,aU,!0),id(t,2));}),i4=rf(function(e){var t=iQ(e);return t="function"==typeof t?t:n,rE(nH(e,1,aU,!0),n,t);});function i7(e){if(!(e&&e.length))return[];var t=0;return e=tf(e,function(e){if(aU(e))return t=t3(e.length,t),!0;}),tP(t,function(t){return tv(e,tk(t));});}function i6(e,t){if(!(e&&e.length))return[];var r=i7(e);return null==t?r:tv(r,function(e){return tl(t,n,e);});}var i8=rf(function(e,t){return aU(e)?nB(e,t):[];}),i9=rf(function(e){return rC(tf(e,aU));}),ae=rf(function(e){var t=iQ(e);return aU(t)&&(t=n),rC(tf(e,aU),id(t,2));}),at=rf(function(e){var t=iQ(e);return t="function"==typeof t?t:n,rC(tf(e,aU),n,t);}),an=rf(i7),ar=rf(function(e){var t=e.length,r=t>1?e[t-1]:n;return r="function"==typeof r?(e.pop(),r):n,i6(e,r);});function ai(e){var t=nv(e);return t.__chain__=!0,t;}function aa(e,t){return t(e);}var ao=ia(function(e){var t=e.length,r=t?e[0]:0,i=this.__wrapped__,a=function(t){return nO(t,e);};return!(t>1)&&!this.__actions__.length&&i instanceof nb&&iw(r)?((i=i.slice(r,+r+(t?1:0))).__actions__.push({func:aa,args:[a],thisArg:n}),new ny(i,this.__chain__).thru(function(e){return t&&!e.length&&e.push(n),e;})):this.thru(a);}),as=rG(function(e,t,n){eO.call(e,n)?++e[n]:nN(e,n,1);}),al=r$(iW),au=r$(iZ);function ac(e,t){return(aD(e)?tc:nU)(e,id(t,3));}function ad(e,t){return(aD(e)?function(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e;}:nF)(e,id(t,3));}var af=rG(function(e,t,n){eO.call(e,n)?e[n].push(t):nN(e,n,[t]);}),ah=rf(function(e,t,n){var r=-1,i="function"==typeof t,a=aB(e)?eb(e.length):[];return nU(e,function(e){a[++r]=i?tl(t,e,n):n3(e,t,n);}),a;}),ap=rG(function(e,t,n){nN(e,n,t);});function av(e,t){return(aD(e)?tv:rt)(e,id(t,3));}var ag=rG(function(e,t,n){e[n?0:1].push(t);},function(){return[[],[]];}),am=rf(function(e,t){if(null==e)return[];var n=t.length;return n>1&&iE(e,t[0],t[1])?t=[]:n>2&&iE(t[0],t[1],t[2])&&(t=[t[0]]),ro(e,nH(t,1),[]);}),ay=tt||function(){return e7.Date.now();};function ab(e,t,r){return t=r?n:t,t=e&&null==t?e.length:t,r9(e,128,n,n,n,n,t);}function a_(e,t){var r;if("function"!=typeof t)throw new ek(i);return e=a7(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=n),r;};}var ax=rf(function(e,t,n){var r=1;if(n.length){var i=tH(n,ic(ax));r|=32;}return r9(e,r,t,n,i);}),aw=rf(function(e,t,n){var r=3;if(n.length){var i=tH(n,ic(aw));r|=32;}return r9(t,r,e,n,i);});function aE(e,t,r){var a,o,s,l,u,c,d=0,f=!1,h=!1,p=!0;if("function"!=typeof e)throw new ek(i);function v(t){var r=a,i=o;return a=o=n,d=t,l=e.apply(i,r);}function g(e){var r=e-c,i=e-d;return n===c||r>=t||r<0||h&&i>=s;}function m(){var e,n,r,i=ay();if(g(i))return y(i);u=iO(m,(e=i-c,n=i-d,r=t-e,h?t5(r,s-n):r));}function y(e){return(u=n,p&&a)?v(e):(a=o=n,l);}function b(){var e,r=ay(),i=g(r);if(a=arguments,o=this,c=r,i){if(n===u)return d=e=c,u=iO(m,t),f?v(e):l;if(h)return rI(u),u=iO(m,t),v(c);}return n===u&&(u=iO(m,t)),l;}return t=a8(t)||0,aZ(r)&&(f=!!r.leading,s=(h="maxWait"in r)?t3(a8(r.maxWait)||0,t):s,p="trailing"in r?!!r.trailing:p),b.cancel=function(){n!==u&&rI(u),d=0,a=c=o=u=n;},b.flush=function(){return n===u?l:y(ay());},b;}var aM=rf(function(e,t){return nz(e,1,t);}),aT=rf(function(e,t,n){return nz(e,a8(t)||0,n);});function aS(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new ek(i);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=e.apply(this,r);return n.cache=a.set(i,o)||a,o;};return n.cache=new(aS.Cache||nw),n;}function ak(e){if("function"!=typeof e)throw new ek(i);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2]);}return!e.apply(this,t);};}aS.Cache=nw;var aC=rf(function(e,t){var n=(t=1==t.length&&aD(t[0])?tv(t[0],tO(id())):tv(nH(t,1),tO(id()))).length;return rf(function(r){for(var i=-1,a=t5(r.length,n);++i<a;)r[i]=t[i].call(this,r[i]);return tl(e,this,r);});}),aA=rf(function(e,t){var r=tH(t,ic(aA));return r9(e,32,n,t,r);}),aL=rf(function(e,t){var r=tH(t,ic(aL));return r9(e,64,n,t,r);}),aP=ia(function(e,t){return r9(e,256,n,n,n,t);});function aN(e,t){return e===t||e!=e&&t!=t;}var aO=r5(nJ),aI=r5(function(e,t){return e>=t;}),aR=n5(function(){return arguments;}())?n5:function(e){return aq(e)&&eO.call(e,"callee")&&!eX.call(e,"callee");},aD=eb.isArray,az=tn?tO(tn):function(e){return aq(e)&&nQ(e)==k;};function aB(e){return null!=e&&aW(e.length)&&!aG(e);}function aU(e){return aq(e)&&aB(e);}var aF=tJ||oQ,aj=tr?tO(tr):function(e){return aq(e)&&nQ(e)==h;};function aV(e){if(!aq(e))return!1;var t=nQ(e);return t==p||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!a$(e);}function aG(e){if(!aZ(e))return!1;var t=nQ(e);return t==v||t==g||"[object AsyncFunction]"==t||"[object Proxy]"==t;}function aH(e){return"number"==typeof e&&e==a7(e);}function aW(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991;}function aZ(e){var t=typeof e;return null!=e&&("object"==t||"function"==t);}function aq(e){return null!=e&&"object"==typeof e;}var aY=ti?tO(ti):function(e){return aq(e)&&iy(e)==m;};function aX(e){return"number"==typeof e||aq(e)&&nQ(e)==y;}function a$(e){if(!aq(e)||nQ(e)!=b)return!1;var t=eH(e);if(null===t)return!0;var n=eO.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&eN.call(n)==ez;}var aK=ta?tO(ta):function(e){return aq(e)&&nQ(e)==x;},aQ=to?tO(to):function(e){return aq(e)&&iy(e)==w;};function aJ(e){return"string"==typeof e||!aD(e)&&aq(e)&&nQ(e)==E;}function a0(e){return"symbol"==typeof e||aq(e)&&nQ(e)==M;}var a1=ts?tO(ts):function(e){return aq(e)&&aW(e.length)&&!!eJ[nQ(e)];},a2=r5(re),a3=r5(function(e,t){return e<=t;});function a5(e){if(!e)return[];if(aB(e))return aJ(e)?tq(e):rj(e);if(e4&&e[e4])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n;}(e[e4]());var t=iy(e);return(t==m?tV:t==w?tW:ow)(e);}function a4(e){return e?(e=a8(e))===s||e===-s?(e<0?-1:1)*17976931348623157e292:e==e?e:0:0===e?e:0;}function a7(e){var t=a4(e),n=t%1;return t==t?n?t-n:t:0;}function a6(e){return e?nI(a7(e),0,4294967295):0;}function a8(e){if("number"==typeof e)return e;if(a0(e))return l;if(aZ(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=aZ(t)?t+"":t;}if("string"!=typeof e)return 0===e?e:+e;e=tN(e);var n=ec.test(e);return n||ef.test(e)?e3(e.slice(2),n?2:8):eu.test(e)?l:+e;}function a9(e){return rV(e,op(e));}function oe(e){return null==e?"":rw(e);}var ot=rH(function(e,t){if(ik(t)||aB(t)){rV(t,oh(t),e);return;}for(var n in t)eO.call(t,n)&&nC(e,n,t[n]);}),on=rH(function(e,t){rV(t,op(t),e);}),or=rH(function(e,t,n,r){rV(t,op(t),e,r);}),oi=rH(function(e,t,n,r){rV(t,oh(t),e,r);}),oa=ia(nO),oo=rf(function(e,t){e=eM(e);var r=-1,i=t.length,a=i>2?t[2]:n;for(a&&iE(t[0],t[1],a)&&(i=1);++r<i;)for(var o=t[r],s=op(o),l=-1,u=s.length;++l<u;){var c=s[l],d=e[c];(n===d||aN(d,eL[c])&&!eO.call(e,c))&&(e[c]=o[c]);}return e;}),os=rf(function(e){return e.push(n,it),tl(og,n,e);});function ol(e,t,r){var i=null==e?n:n$(e,t);return n===i?r:i;}function ou(e,t){return null!=e&&ib(e,t,n1);}var oc=rJ(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=eD.call(t)),e[t]=n;},oD(oU)),od=rJ(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=eD.call(t)),eO.call(e,t)?e[t].push(n):e[t]=[n];},id),of=rf(n3);function oh(e){return aB(e)?nT(e):n9(e);}function op(e){return aB(e)?nT(e,!0):function(e){if(!aZ(e))return function(e){var t=[];if(null!=e)for(var n in eM(e))t.push(n);return t;}(e);var t=ik(e),n=[];for(var r in e)"constructor"==r&&(t||!eO.call(e,r))||n.push(r);return n;}(e);}var ov=rH(function(e,t,n){ri(e,t,n);}),og=rH(function(e,t,n,r){ri(e,t,n,r);}),om=ia(function(e,t){var n={};if(null==e)return n;var r=!1;t=tv(t,function(t){return t=rN(t,e),r||(r=t.length>1),t;}),rV(e,is(e),n),r&&(n=nR(n,7,ir));for(var i=t.length;i--;)rM(n,t[i]);return n;}),oy=ia(function(e,t){return null==e?{}:rs(e,t,function(t,n){return ou(e,n);});});function ob(e,t){if(null==e)return{};var n=tv(is(e),function(e){return[e];});return t=id(t),rs(e,n,function(e,n){return t(e,n[0]);});}var o_=r8(oh),ox=r8(op);function ow(e){return null==e?[]:tI(e,oh(e));}var oE=rY(function(e,t,n){return t=t.toLowerCase(),e+(n?oM(t):t);});function oM(e){return oN(oe(e).toLowerCase());}function oT(e){return(e=oe(e))&&e.replace(ep,tB).replace(eZ,"");}var oS=rY(function(e,t,n){return e+(n?"-":"")+t.toLowerCase();}),ok=rY(function(e,t,n){return e+(n?" ":"")+t.toLowerCase();}),oC=rq("toLowerCase"),oA=rY(function(e,t,n){return e+(n?"_":"")+t.toLowerCase();}),oL=rY(function(e,t,n){return e+(n?" ":"")+oN(t);}),oP=rY(function(e,t,n){return e+(n?" ":"")+t.toUpperCase();}),oN=rq("toUpperCase");function oO(e,t,r){if(e=oe(e),t=r?n:t,n===t){var i;return(i=e,e$.test(i))?e.match(eY)||[]:e.match(ei)||[];}return e.match(t)||[];}var oI=rf(function(e,t){try{return tl(e,n,t);}catch(e){return aV(e)?e:new ex(e);}}),oR=ia(function(e,t){return tc(t,function(t){nN(e,t=iU(t),ax(e[t],e));}),e;});function oD(e){return function(){return e;};}var oz=rK(),oB=rK(!0);function oU(e){return e;}function oF(e){return n8("function"==typeof e?e:nR(e,1));}var oj=rf(function(e,t){return function(n){return n3(n,e,t);};}),oV=rf(function(e,t){return function(n){return n3(e,n,t);};});function oG(e,t,n){var r=oh(t),i=nX(t,r);null!=n||aZ(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=nX(t,oh(t)));var a=!(aZ(n)&&"chain"in n)||!!n.chain,o=aG(e);return tc(i,function(n){var r=t[n];e[n]=r,o&&(e.prototype[n]=function(){var t=this.__chain__;if(a||t){var n=e(this.__wrapped__);return(n.__actions__=rj(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n;}return r.apply(e,tg([this.value()],arguments));});}),e;}function oH(){}var oW=r1(tv),oZ=r1(td),oq=r1(tb);function oY(e){return iM(e)?tk(iU(e)):function(t){return n$(t,e);};}var oX=r3(),o$=r3(!0);function oK(){return[];}function oQ(){return!1;}var oJ=r0(function(e,t){return e+t;},0),o0=r7("ceil"),o1=r0(function(e,t){return e/t;},1),o2=r7("floor"),o3=r0(function(e,t){return e*t;},1),o5=r7("round"),o4=r0(function(e,t){return e-t;},0);return nv.after=function(e,t){if("function"!=typeof t)throw new ek(i);return e=a7(e),function(){if(--e<1)return t.apply(this,arguments);};},nv.ary=ab,nv.assign=ot,nv.assignIn=on,nv.assignInWith=or,nv.assignWith=oi,nv.at=oa,nv.before=a_,nv.bind=ax,nv.bindAll=oR,nv.bindKey=aw,nv.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return aD(e)?e:[e];},nv.chain=ai,nv.chunk=function(e,t,r){t=(r?iE(e,t,r):n===t)?1:t3(a7(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var a=0,o=0,s=eb(tC(i/t));a<i;)s[o++]=rg(e,a,a+=t);return s;},nv.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var a=e[t];a&&(i[r++]=a);}return i;},nv.concat=function(){var e=arguments.length;if(!e)return[];for(var t=eb(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return tg(aD(n)?rj(n):[n],nH(t,1));},nv.cond=function(e){var t=null==e?0:e.length,n=id();return e=t?tv(e,function(e){if("function"!=typeof e[1])throw new ek(i);return[n(e[0]),e[1]];}):[],rf(function(n){for(var r=-1;++r<t;){var i=e[r];if(tl(i[0],this,n))return tl(i[1],this,n);}});},nv.conforms=function(e){var t,n;return n=oh(t=nR(e,1)),function(e){return nD(e,t,n);};},nv.constant=oD,nv.countBy=as,nv.create=function(e,t){var n=ng(e);return null==t?n:nP(n,t);},nv.curry=function e(t,r,i){r=i?n:r;var a=r9(t,8,n,n,n,n,n,r);return a.placeholder=e.placeholder,a;},nv.curryRight=function e(t,r,i){r=i?n:r;var a=r9(t,16,n,n,n,n,n,r);return a.placeholder=e.placeholder,a;},nv.debounce=aE,nv.defaults=oo,nv.defaultsDeep=os,nv.defer=aM,nv.delay=aT,nv.difference=iV,nv.differenceBy=iG,nv.differenceWith=iH,nv.drop=function(e,t,r){var i=null==e?0:e.length;return i?rg(e,(t=r||n===t?1:a7(t))<0?0:t,i):[];},nv.dropRight=function(e,t,r){var i=null==e?0:e.length;return i?rg(e,0,(t=i-(t=r||n===t?1:a7(t)))<0?0:t):[];},nv.dropRightWhile=function(e,t){return e&&e.length?rS(e,id(t,3),!0,!0):[];},nv.dropWhile=function(e,t){return e&&e.length?rS(e,id(t,3),!0):[];},nv.fill=function(e,t,r,i){var a=null==e?0:e.length;return a?(r&&"number"!=typeof r&&iE(e,t,r)&&(r=0,i=a),function(e,t,r,i){var a=e.length;for((r=a7(r))<0&&(r=-r>a?0:a+r),(i=n===i||i>a?a:a7(i))<0&&(i+=a),i=r>i?0:a6(i);r<i;)e[r++]=t;return e;}(e,t,r,i)):[];},nv.filter=function(e,t){return(aD(e)?tf:nG)(e,id(t,3));},nv.flatMap=function(e,t){return nH(av(e,t),1);},nv.flatMapDeep=function(e,t){return nH(av(e,t),s);},nv.flatMapDepth=function(e,t,r){return r=n===r?1:a7(r),nH(av(e,t),r);},nv.flatten=iq,nv.flattenDeep=function(e){return(null==e?0:e.length)?nH(e,s):[];},nv.flattenDepth=function(e,t){return(null==e?0:e.length)?nH(e,t=n===t?1:a7(t)):[];},nv.flip=function(e){return r9(e,512);},nv.flow=oz,nv.flowRight=oB,nv.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1];}return r;},nv.functions=function(e){return null==e?[]:nX(e,oh(e));},nv.functionsIn=function(e){return null==e?[]:nX(e,op(e));},nv.groupBy=af,nv.initial=function(e){return(null==e?0:e.length)?rg(e,0,-1):[];},nv.intersection=iX,nv.intersectionBy=i$,nv.intersectionWith=iK,nv.invert=oc,nv.invertBy=od,nv.invokeMap=ah,nv.iteratee=oF,nv.keyBy=ap,nv.keys=oh,nv.keysIn=op,nv.map=av,nv.mapKeys=function(e,t){var n={};return t=id(t,3),nq(e,function(e,r,i){nN(n,t(e,r,i),e);}),n;},nv.mapValues=function(e,t){var n={};return t=id(t,3),nq(e,function(e,r,i){nN(n,r,t(e,r,i));}),n;},nv.matches=function(e){return rn(nR(e,1));},nv.matchesProperty=function(e,t){return rr(e,nR(t,1));},nv.memoize=aS,nv.merge=ov,nv.mergeWith=og,nv.method=oj,nv.methodOf=oV,nv.mixin=oG,nv.negate=ak,nv.nthArg=function(e){return e=a7(e),rf(function(t){return ra(t,e);});},nv.omit=om,nv.omitBy=function(e,t){return ob(e,ak(id(t)));},nv.once=function(e){return a_(2,e);},nv.orderBy=function(e,t,r,i){return null==e?[]:(aD(t)||(t=null==t?[]:[t]),aD(r=i?n:r)||(r=null==r?[]:[r]),ro(e,t,r));},nv.over=oW,nv.overArgs=aC,nv.overEvery=oZ,nv.overSome=oq,nv.partial=aA,nv.partialRight=aL,nv.partition=ag,nv.pick=oy,nv.pickBy=ob,nv.property=oY,nv.propertyOf=function(e){return function(t){return null==e?n:n$(e,t);};},nv.pull=iJ,nv.pullAll=i0,nv.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?rl(e,t,id(n,2)):e;},nv.pullAllWith=function(e,t,r){return e&&e.length&&t&&t.length?rl(e,t,n,r):e;},nv.pullAt=i1,nv.range=oX,nv.rangeRight=o$,nv.rearg=aP,nv.reject=function(e,t){return(aD(e)?tf:nG)(e,ak(id(t,3)));},nv.remove=function(e,t){var n=[];if(!(e&&e.length))return n;var r=-1,i=[],a=e.length;for(t=id(t,3);++r<a;){var o=e[r];t(o,r,e)&&(n.push(o),i.push(r));}return ru(e,i),n;},nv.rest=function(e,t){if("function"!=typeof e)throw new ek(i);return rf(e,t=n===t?t:a7(t));},nv.reverse=i2,nv.sampleSize=function(e,t,r){return t=(r?iE(e,t,r):n===t)?1:a7(t),(aD(e)?function(e,t){return iz(rj(e),nI(t,0,e.length));}:function(e,t){var n=ow(e);return iz(n,nI(t,0,n.length));})(e,t);},nv.set=function(e,t,n){return null==e?e:rh(e,t,n);},nv.setWith=function(e,t,r,i){return i="function"==typeof i?i:n,null==e?e:rh(e,t,r,i);},nv.shuffle=function(e){return(aD(e)?function(e){return iz(rj(e));}:function(e){return iz(ow(e));})(e);},nv.slice=function(e,t,r){var i=null==e?0:e.length;return i?(r&&"number"!=typeof r&&iE(e,t,r)?(t=0,r=i):(t=null==t?0:a7(t),r=n===r?i:a7(r)),rg(e,t,r)):[];},nv.sortBy=am,nv.sortedUniq=function(e){return e&&e.length?r_(e):[];},nv.sortedUniqBy=function(e,t){return e&&e.length?r_(e,id(t,2)):[];},nv.split=function(e,t,r){return(r&&"number"!=typeof r&&iE(e,t,r)&&(t=r=n),r=n===r?4294967295:r>>>0)?(e=oe(e))&&("string"==typeof t||null!=t&&!aK(t))&&!(t=rw(t))&&tj(e)?rO(tq(e),0,r):e.split(t,r):[];},nv.spread=function(e,t){if("function"!=typeof e)throw new ek(i);return t=null==t?0:t3(a7(t),0),rf(function(n){var r=n[t],i=rO(n,0,t);return r&&tg(i,r),tl(e,this,i);});},nv.tail=function(e){var t=null==e?0:e.length;return t?rg(e,1,t):[];},nv.take=function(e,t,r){return e&&e.length?rg(e,0,(t=r||n===t?1:a7(t))<0?0:t):[];},nv.takeRight=function(e,t,r){var i=null==e?0:e.length;return i?rg(e,(t=i-(t=r||n===t?1:a7(t)))<0?0:t,i):[];},nv.takeRightWhile=function(e,t){return e&&e.length?rS(e,id(t,3),!1,!0):[];},nv.takeWhile=function(e,t){return e&&e.length?rS(e,id(t,3)):[];},nv.tap=function(e,t){return t(e),e;},nv.throttle=function(e,t,n){var r=!0,a=!0;if("function"!=typeof e)throw new ek(i);return aZ(n)&&(r="leading"in n?!!n.leading:r,a="trailing"in n?!!n.trailing:a),aE(e,t,{leading:r,maxWait:t,trailing:a});},nv.thru=aa,nv.toArray=a5,nv.toPairs=o_,nv.toPairsIn=ox,nv.toPath=function(e){return aD(e)?tv(e,iU):a0(e)?[e]:rj(iB(oe(e)));},nv.toPlainObject=a9,nv.transform=function(e,t,n){var r=aD(e),i=r||aF(e)||a1(e);if(t=id(t,4),null==n){var a=e&&e.constructor;n=i?r?new a:[]:aZ(e)&&aG(a)?ng(eH(e)):{};}return(i?tc:nq)(e,function(e,r,i){return t(n,e,r,i);}),n;},nv.unary=function(e){return ab(e,1);},nv.union=i3,nv.unionBy=i5,nv.unionWith=i4,nv.uniq=function(e){return e&&e.length?rE(e):[];},nv.uniqBy=function(e,t){return e&&e.length?rE(e,id(t,2)):[];},nv.uniqWith=function(e,t){return t="function"==typeof t?t:n,e&&e.length?rE(e,n,t):[];},nv.unset=function(e,t){return null==e||rM(e,t);},nv.unzip=i7,nv.unzipWith=i6,nv.update=function(e,t,n){return null==e?e:rT(e,t,rP(n));},nv.updateWith=function(e,t,r,i){return i="function"==typeof i?i:n,null==e?e:rT(e,t,rP(r),i);},nv.values=ow,nv.valuesIn=function(e){return null==e?[]:tI(e,op(e));},nv.without=i8,nv.words=oO,nv.wrap=function(e,t){return aA(rP(t),e);},nv.xor=i9,nv.xorBy=ae,nv.xorWith=at,nv.zip=an,nv.zipObject=function(e,t){return rA(e||[],t||[],nC);},nv.zipObjectDeep=function(e,t){return rA(e||[],t||[],rh);},nv.zipWith=ar,nv.entries=o_,nv.entriesIn=ox,nv.extend=on,nv.extendWith=or,oG(nv,nv),nv.add=oJ,nv.attempt=oI,nv.camelCase=oE,nv.capitalize=oM,nv.ceil=o0,nv.clamp=function(e,t,r){return n===r&&(r=t,t=n),n!==r&&(r=(r=a8(r))==r?r:0),n!==t&&(t=(t=a8(t))==t?t:0),nI(a8(e),t,r);},nv.clone=function(e){return nR(e,4);},nv.cloneDeep=function(e){return nR(e,5);},nv.cloneDeepWith=function(e,t){return nR(e,5,t="function"==typeof t?t:n);},nv.cloneWith=function(e,t){return nR(e,4,t="function"==typeof t?t:n);},nv.conformsTo=function(e,t){return null==t||nD(e,t,oh(t));},nv.deburr=oT,nv.defaultTo=function(e,t){return null==e||e!=e?t:e;},nv.divide=o1,nv.endsWith=function(e,t,r){e=oe(e),t=rw(t);var i=e.length,a=r=n===r?i:nI(a7(r),0,i);return(r-=t.length)>=0&&e.slice(r,a)==t;},nv.eq=aN,nv.escape=function(e){return(e=oe(e))&&H.test(e)?e.replace(V,tU):e;},nv.escapeRegExp=function(e){return(e=oe(e))&&Q.test(e)?e.replace(K,"\\$&"):e;},nv.every=function(e,t,r){var i=aD(e)?td:nj;return r&&iE(e,t,r)&&(t=n),i(e,id(t,3));},nv.find=al,nv.findIndex=iW,nv.findKey=function(e,t){return tx(e,id(t,3),nq);},nv.findLast=au,nv.findLastIndex=iZ,nv.findLastKey=function(e,t){return tx(e,id(t,3),nY);},nv.floor=o2,nv.forEach=ac,nv.forEachRight=ad,nv.forIn=function(e,t){return null==e?e:nW(e,id(t,3),op);},nv.forInRight=function(e,t){return null==e?e:nZ(e,id(t,3),op);},nv.forOwn=function(e,t){return e&&nq(e,id(t,3));},nv.forOwnRight=function(e,t){return e&&nY(e,id(t,3));},nv.get=ol,nv.gt=aO,nv.gte=aI,nv.has=function(e,t){return null!=e&&ib(e,t,n0);},nv.hasIn=ou,nv.head=iY,nv.identity=oU,nv.includes=function(e,t,n,r){e=aB(e)?e:ow(e),n=n&&!r?a7(n):0;var i=e.length;return n<0&&(n=t3(i+n,0)),aJ(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&tE(e,t,n)>-1;},nv.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return -1;var i=null==n?0:a7(n);return i<0&&(i=t3(r+i,0)),tE(e,t,i);},nv.inRange=function(e,t,r){var i,a,o;return t=a4(t),n===r?(r=t,t=0):r=a4(r),(i=e=a8(e))>=t5(a=t,o=r)&&i<t3(a,o);},nv.invoke=of,nv.isArguments=aR,nv.isArray=aD,nv.isArrayBuffer=az,nv.isArrayLike=aB,nv.isArrayLikeObject=aU,nv.isBoolean=function(e){return!0===e||!1===e||aq(e)&&nQ(e)==f;},nv.isBuffer=aF,nv.isDate=aj,nv.isElement=function(e){return aq(e)&&1===e.nodeType&&!a$(e);},nv.isEmpty=function(e){if(null==e)return!0;if(aB(e)&&(aD(e)||"string"==typeof e||"function"==typeof e.splice||aF(e)||a1(e)||aR(e)))return!e.length;var t=iy(e);if(t==m||t==w)return!e.size;if(ik(e))return!n9(e).length;for(var n in e)if(eO.call(e,n))return!1;return!0;},nv.isEqual=function(e,t){return n4(e,t);},nv.isEqualWith=function(e,t,r){var i=(r="function"==typeof r?r:n)?r(e,t):n;return n===i?n4(e,t,n,r):!!i;},nv.isError=aV,nv.isFinite=function(e){return"number"==typeof e&&t0(e);},nv.isFunction=aG,nv.isInteger=aH,nv.isLength=aW,nv.isMap=aY,nv.isMatch=function(e,t){return e===t||n7(e,t,ip(t));},nv.isMatchWith=function(e,t,r){return r="function"==typeof r?r:n,n7(e,t,ip(t),r);},nv.isNaN=function(e){return aX(e)&&e!=+e;},nv.isNative=function(e){if(iS(e))throw new ex("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return n6(e);},nv.isNil=function(e){return null==e;},nv.isNull=function(e){return null===e;},nv.isNumber=aX,nv.isObject=aZ,nv.isObjectLike=aq,nv.isPlainObject=a$,nv.isRegExp=aK,nv.isSafeInteger=function(e){return aH(e)&&e>=-9007199254740991&&e<=9007199254740991;},nv.isSet=aQ,nv.isString=aJ,nv.isSymbol=a0,nv.isTypedArray=a1,nv.isUndefined=function(e){return n===e;},nv.isWeakMap=function(e){return aq(e)&&iy(e)==S;},nv.isWeakSet=function(e){return aq(e)&&"[object WeakSet]"==nQ(e);},nv.join=function(e,t){return null==e?"":t1.call(e,t);},nv.kebabCase=oS,nv.last=iQ,nv.lastIndexOf=function(e,t,r){var i=null==e?0:e.length;if(!i)return -1;var a=i;return n!==r&&(a=(a=a7(r))<0?t3(i+a,0):t5(a,i-1)),t==t?function(e,t,n){for(var r=n+1;r--&&e[r]!==t;);return r;}(e,t,a):tw(e,tT,a,!0);},nv.lowerCase=ok,nv.lowerFirst=oC,nv.lt=a2,nv.lte=a3,nv.max=function(e){return e&&e.length?nV(e,oU,nJ):n;},nv.maxBy=function(e,t){return e&&e.length?nV(e,id(t,2),nJ):n;},nv.mean=function(e){return tS(e,oU);},nv.meanBy=function(e,t){return tS(e,id(t,2));},nv.min=function(e){return e&&e.length?nV(e,oU,re):n;},nv.minBy=function(e,t){return e&&e.length?nV(e,id(t,2),re):n;},nv.stubArray=oK,nv.stubFalse=oQ,nv.stubObject=function(){return{};},nv.stubString=function(){return"";},nv.stubTrue=function(){return!0;},nv.multiply=o3,nv.nth=function(e,t){return e&&e.length?ra(e,a7(t)):n;},nv.noConflict=function(){return e7._===this&&(e7._=eB),this;},nv.noop=oH,nv.now=ay,nv.pad=function(e,t,n){e=oe(e);var r=(t=a7(t))?tZ(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return r2(tK(i),n)+e+r2(tC(i),n);},nv.padEnd=function(e,t,n){e=oe(e);var r=(t=a7(t))?tZ(e):0;return t&&r<t?e+r2(t-r,n):e;},nv.padStart=function(e,t,n){e=oe(e);var r=(t=a7(t))?tZ(e):0;return t&&r<t?r2(t-r,n)+e:e;},nv.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),t7(oe(e).replace(J,""),t||0);},nv.random=function(e,t,r){if(r&&"boolean"!=typeof r&&iE(e,t,r)&&(t=r=n),n===r&&("boolean"==typeof t?(r=t,t=n):"boolean"==typeof e&&(r=e,e=n)),n===e&&n===t?(e=0,t=1):(e=a4(e),n===t?(t=e,e=0):t=a4(t)),e>t){var i=e;e=t,t=i;}if(r||e%1||t%1){var a=t6();return t5(e+a*(t-e+e2("1e-"+((a+"").length-1))),t);}return rc(e,t);},nv.reduce=function(e,t,n){var r=aD(e)?tm:tA,i=arguments.length<3;return r(e,id(t,4),n,i,nU);},nv.reduceRight=function(e,t,n){var r=aD(e)?ty:tA,i=arguments.length<3;return r(e,id(t,4),n,i,nF);},nv.repeat=function(e,t,r){return t=(r?iE(e,t,r):n===t)?1:a7(t),rd(oe(e),t);},nv.replace=function(){var e=arguments,t=oe(e[0]);return e.length<3?t:t.replace(e[1],e[2]);},nv.result=function(e,t,r){t=rN(t,e);var i=-1,a=t.length;for(a||(a=1,e=n);++i<a;){var o=null==e?n:e[iU(t[i])];n===o&&(i=a,o=r),e=aG(o)?o.call(e):o;}return e;},nv.round=o5,nv.runInContext=e,nv.sample=function(e){return(aD(e)?nS:function(e){return nS(ow(e));})(e);},nv.size=function(e){if(null==e)return 0;if(aB(e))return aJ(e)?tZ(e):e.length;var t=iy(e);return t==m||t==w?e.size:n9(e).length;},nv.snakeCase=oA,nv.some=function(e,t,r){var i=aD(e)?tb:rm;return r&&iE(e,t,r)&&(t=n),i(e,id(t,3));},nv.sortedIndex=function(e,t){return ry(e,t);},nv.sortedIndexBy=function(e,t,n){return rb(e,t,id(n,2));},nv.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=ry(e,t);if(r<n&&aN(e[r],t))return r;}return -1;},nv.sortedLastIndex=function(e,t){return ry(e,t,!0);},nv.sortedLastIndexBy=function(e,t,n){return rb(e,t,id(n,2),!0);},nv.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=ry(e,t,!0)-1;if(aN(e[n],t))return n;}return -1;},nv.startCase=oL,nv.startsWith=function(e,t,n){return e=oe(e),n=null==n?0:nI(a7(n),0,e.length),t=rw(t),e.slice(n,n+t.length)==t;},nv.subtract=o4,nv.sum=function(e){return e&&e.length?tL(e,oU):0;},nv.sumBy=function(e,t){return e&&e.length?tL(e,id(t,2)):0;},nv.template=function(e,t,r){var i=nv.templateSettings;r&&iE(e,t,r)&&(t=n),e=oe(e),t=or({},t,i,ie);var a,o,s=or({},t.imports,i.imports,ie),l=oh(s),u=tI(s,l),c=0,d=t.interpolate||ev,f="__p += '",h=eT((t.escape||ev).source+"|"+d.source+"|"+(d===q?es:ev).source+"|"+(t.evaluate||ev).source+"|$","g"),p="//# sourceURL="+(eO.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++eQ+"]")+"\n";e.replace(h,function(t,n,r,i,s,l){return r||(r=i),f+=e.slice(c,l).replace(eg,tF),n&&(a=!0,f+="' +\n__e("+n+") +\n'"),s&&(o=!0,f+="';\n"+s+";\n__p += '"),r&&(f+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=l+t.length,t;}),f+="';\n";var v=eO.call(t,"variable")&&t.variable;if(v){if(ea.test(v))throw new ex("Invalid `variable` option passed into `_.template`");}else f="with (obj) {\n"+f+"\n}\n";f=(o?f.replace(B,""):f).replace(U,"$1").replace(F,"$1;"),f="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var g=oI(function(){return ew(l,p+"return "+f).apply(n,u);});if(g.source=f,aV(g))throw g;return g;},nv.times=function(e,t){if((e=a7(e))<1||e>9007199254740991)return[];var n=4294967295,r=t5(e,4294967295);t=id(t),e-=4294967295;for(var i=tP(r,t);++n<e;)t(n);return i;},nv.toFinite=a4,nv.toInteger=a7,nv.toLength=a6,nv.toLower=function(e){return oe(e).toLowerCase();},nv.toNumber=a8,nv.toSafeInteger=function(e){return e?nI(a7(e),-9007199254740991,9007199254740991):0===e?e:0;},nv.toString=oe,nv.toUpper=function(e){return oe(e).toUpperCase();},nv.trim=function(e,t,r){if((e=oe(e))&&(r||n===t))return tN(e);if(!e||!(t=rw(t)))return e;var i=tq(e),a=tq(t),o=tD(i,a),s=tz(i,a)+1;return rO(i,o,s).join("");},nv.trimEnd=function(e,t,r){if((e=oe(e))&&(r||n===t))return e.slice(0,tY(e)+1);if(!e||!(t=rw(t)))return e;var i=tq(e),a=tz(i,tq(t))+1;return rO(i,0,a).join("");},nv.trimStart=function(e,t,r){if((e=oe(e))&&(r||n===t))return e.replace(J,"");if(!e||!(t=rw(t)))return e;var i=tq(e),a=tD(i,tq(t));return rO(i,a).join("");},nv.truncate=function(e,t){var r=30,i="...";if(aZ(t)){var a="separator"in t?t.separator:a;r="length"in t?a7(t.length):r,i="omission"in t?rw(t.omission):i;}var o=(e=oe(e)).length;if(tj(e)){var s=tq(e);o=s.length;}if(r>=o)return e;var l=r-tZ(i);if(l<1)return i;var u=s?rO(s,0,l).join(""):e.slice(0,l);if(n===a)return u+i;if(s&&(l+=u.length-l),aK(a)){if(e.slice(l).search(a)){var c,d=u;for(a.global||(a=eT(a.source,oe(el.exec(a))+"g")),a.lastIndex=0;c=a.exec(d);)var f=c.index;u=u.slice(0,n===f?l:f);}}else if(e.indexOf(rw(a),l)!=l){var h=u.lastIndexOf(a);h>-1&&(u=u.slice(0,h));}return u+i;},nv.unescape=function(e){return(e=oe(e))&&G.test(e)?e.replace(j,tX):e;},nv.uniqueId=function(e){var t=++eI;return oe(e)+t;},nv.upperCase=oP,nv.upperFirst=oN,nv.each=ac,nv.eachRight=ad,nv.first=iY,oG(nv,(ey={},nq(nv,function(e,t){eO.call(nv.prototype,t)||(ey[t]=e);}),ey),{chain:!1}),nv.VERSION="4.17.21",tc(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){nv[e].placeholder=nv;}),tc(["drop","take"],function(e,t){nb.prototype[e]=function(r){r=n===r?1:t3(a7(r),0);var i=this.__filtered__&&!t?new nb(this):this.clone();return i.__filtered__?i.__takeCount__=t5(r,i.__takeCount__):i.__views__.push({size:t5(r,4294967295),type:e+(i.__dir__<0?"Right":"")}),i;},nb.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse();};}),tc(["filter","map","takeWhile"],function(e,t){var n=t+1,r=1==n||3==n;nb.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:id(e,3),type:n}),t.__filtered__=t.__filtered__||r,t;};}),tc(["head","last"],function(e,t){var n="take"+(t?"Right":"");nb.prototype[e]=function(){return this[n](1).value()[0];};}),tc(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");nb.prototype[e]=function(){return this.__filtered__?new nb(this):this[n](1);};}),nb.prototype.compact=function(){return this.filter(oU);},nb.prototype.find=function(e){return this.filter(e).head();},nb.prototype.findLast=function(e){return this.reverse().find(e);},nb.prototype.invokeMap=rf(function(e,t){return"function"==typeof e?new nb(this):this.map(function(n){return n3(n,e,t);});}),nb.prototype.reject=function(e){return this.filter(ak(id(e)));},nb.prototype.slice=function(e,t){e=a7(e);var r=this;return r.__filtered__&&(e>0||t<0)?new nb(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),n!==t&&(r=(t=a7(t))<0?r.dropRight(-t):r.take(t-e)),r);},nb.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse();},nb.prototype.toArray=function(){return this.take(4294967295);},nq(nb.prototype,function(e,t){var r=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),a=nv[i?"take"+("last"==t?"Right":""):t],o=i||/^find/.test(t);a&&(nv.prototype[t]=function(){var t=this.__wrapped__,s=i?[1]:arguments,l=t instanceof nb,u=s[0],c=l||aD(t),d=function(e){var t=a.apply(nv,tg([e],s));return i&&f?t[0]:t;};c&&r&&"function"==typeof u&&1!=u.length&&(l=c=!1);var f=this.__chain__,h=!!this.__actions__.length,p=o&&!f,v=l&&!h;if(!o&&c){t=v?t:new nb(this);var g=e.apply(t,s);return g.__actions__.push({func:aa,args:[d],thisArg:n}),new ny(g,f);}return p&&v?e.apply(this,s):(g=this.thru(d),p?i?g.value()[0]:g.value():g);});}),tc(["pop","push","shift","sort","splice","unshift"],function(e){var t=eC[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);nv.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(aD(i)?i:[],e);}return this[n](function(n){return t.apply(aD(n)?n:[],e);});};}),nq(nb.prototype,function(e,t){var n=nv[t];if(n){var r=n.name+"";eO.call(no,r)||(no[r]=[]),no[r].push({name:t,func:n});}}),no[rQ(n,2).name]=[{name:"wrapper",func:n}],nb.prototype.clone=function(){var e=new nb(this.__wrapped__);return e.__actions__=rj(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=rj(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=rj(this.__views__),e;},nb.prototype.reverse=function(){if(this.__filtered__){var e=new nb(this);e.__dir__=-1,e.__filtered__=!0;}else e=this.clone(),e.__dir__*=-1;return e;},nb.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=aD(e),r=t<0,i=n?e.length:0,a=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var a=n[r],o=a.size;switch(a.type){case"drop":e+=o;break;case"dropRight":t-=o;break;case"take":t=t5(t,e+o);break;case"takeRight":e=t3(e,t-o);}}return{start:e,end:t};}(0,i,this.__views__),o=a.start,s=a.end,l=s-o,u=r?s:o-1,c=this.__iteratees__,d=c.length,f=0,h=t5(l,this.__takeCount__);if(!n||!r&&i==l&&h==l)return rk(e,this.__actions__);var p=[];e:for(;l--&&f<h;){for(var v=-1,g=e[u+=t];++v<d;){var m=c[v],y=m.iteratee,b=m.type,_=y(g);if(2==b)g=_;else if(!_){if(1==b)continue e;break e;}}p[f++]=g;}return p;},nv.prototype.at=ao,nv.prototype.chain=function(){return ai(this);},nv.prototype.commit=function(){return new ny(this.value(),this.__chain__);},nv.prototype.next=function(){this.__values__===n&&(this.__values__=a5(this.value()));var e=this.__index__>=this.__values__.length,t=e?n:this.__values__[this.__index__++];return{done:e,value:t};},nv.prototype.plant=function(e){for(var t,r=this;r instanceof nm;){var i=ij(r);i.__index__=0,i.__values__=n,t?a.__wrapped__=i:t=i;var a=i;r=r.__wrapped__;}return a.__wrapped__=e,t;},nv.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof nb){var t=e;return this.__actions__.length&&(t=new nb(this)),(t=t.reverse()).__actions__.push({func:aa,args:[i2],thisArg:n}),new ny(t,this.__chain__);}return this.thru(i2);},nv.prototype.toJSON=nv.prototype.valueOf=nv.prototype.value=function(){return rk(this.__wrapped__,this.__actions__);},nv.prototype.first=nv.prototype.head,e4&&(nv.prototype[e4]=function(){return this;}),nv;}();e8?((e8.exports=t$)._=t$,e6._=t$):e7._=t$;}).call(this);},beff956c:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("cdd4ad87")),a=r._(n("b1c21490")),o=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,l=s?function(e){return null==e?[]:(e=Object(e),(0,i.default)(s(e),function(t){return o.call(e,t);}));}:a.default;},bf5cd903:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("c21c959b")),i=function(e,t){var n=t?(0,r.default)(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length);};},bf67755d:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("59975c13")),i=function(e,t){return(0,r.default)(e,function(e,n,r){return t.includes(r)||(e[r]=n),e;},{});};},bf6b8c7f:function(e,t,n){"use strict";function r(e){return arguments.length?this.cover(+e[0][0],+e[0][1],+e[0][2]).cover(+e[1][0],+e[1][1],+e[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]];}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},bf81ff5c:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this;};},bf992847:function(e,t,n){var r=n("1911a24b"),i=n("3656a04e"),a=n("d57bce82"),o=n("d18fbaa5"),s=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,a(e)),e=i(e);return t;}:o;e.exports=s;},bfb5b3db:function(e,t,n){e.exports={graphlib:n("5bf20808"),layout:n("feb50fb2"),debug:n("633ca35c"),util:{time:n("b192169f").time,notime:n("b192169f").notime},version:n("3b603d4c")};},bfd80e4b:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"getPathArea",{enumerable:!0,get:function(){return i;}});var r=n("6bbcbda8");function i(e){var t=0,n=0,i=0;return(0,r.path2Curve)(e).map(function(e){if("M"===e[0])return t=e[1],n=e[2],0;var r,a,o,s=e.slice(1),l=s[0],u=s[1],c=s[2],d=s[3],f=s[4],h=s[5];return a=t,i=3*((h-(o=n))*(l+c)-(f-a)*(u+d)+u*(a-c)-l*(o-d)+h*(c+a/3)-f*(d+o/3))/20,t=(r=e.slice(-2))[0],n=r[1],i;}).reduce(function(e,t){return e+t;},0);}},c0051812:function(e,t,n){var r=Array.isArray;e.exports=r;},c0d419e3:function(e,t,n){var r=n("87d0acba"),i=n("ed2bf8a3");e.exports=function(e,t,n){return i.transform(e.nodes(),function(i,a){i[a]=r(e,a,t,n);},{});};},c1058a90:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("4086b076")),a=r._(n("3a2d63e9")),o=r._(n("3a988df8")),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1;var l=function(e){return(0,o.default)(e)&&(0,a.default)(e.length)&&!!s[(0,i.default)(e)];};},c1797885:function(e,t,n){var r=n("6b3683f9"),i=n("31e26024");e.exports=function(e,t,n){(void 0===n||i(e[t],n))&&(void 0!==n||t in e)||r(e,t,n);};},c194dc2e:function(e,t,n){var r=n("6e3a9823"),i=n("be56823a"),a=n("f28dfa76"),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,e.exports=function(e){return a(e)&&i(e.length)&&!!o[r(e)];};},c1ba9e59:function(e,t,n){"use strict";function r(e){return e.map(function(e){return Array.isArray(e)?[].concat(e):e;});}n.d(t,"__esModule",{value:!0}),n.d(t,"clonePath",{enumerable:!0,get:function(){return r;}});},c21c959b:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("ae14e70c")),i=function(e){var t=new e.constructor(e.byteLength);return new r.default(t).set(new r.default(e)),t;};},c22ec664:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("4a8d04f1")),a=r._(n("1632ee7b"));function o(e){return e.index;}function s(e,t){var n=e.get(t);if(!n)throw Error("node not found: "+t);return n;}function l(e){var t,n,r,l,u,c,d,f=o,h=function(e){return 1/Math.min(u[e.source.index],u[e.target.index]);},p=(0,i.default)(30),v=1;function g(r){for(var i=0,o=e.length;i<v;++i)for(var s,u,f,h,p,g=0,m=0,y=0,b=0;g<o;++g)u=(s=e[g]).source,m=(f=s.target).x+f.vx-u.x-u.vx||(0,a.default)(d),l>1&&(y=f.y+f.vy-u.y-u.vy||(0,a.default)(d)),l>2&&(b=f.z+f.vz-u.z-u.vz||(0,a.default)(d)),h=((h=Math.sqrt(m*m+y*y+b*b))-n[g])/h*r*t[g],m*=h,y*=h,b*=h,f.vx-=m*(p=c[g]),l>1&&(f.vy-=y*p),l>2&&(f.vz-=b*p),u.vx+=m*(p=1-p),l>1&&(u.vy+=y*p),l>2&&(u.vz+=b*p);}function m(){if(r){var i,a,o=r.length,l=e.length,d=new Map(r.map((e,t)=>[f(e,t,r),e]));for(i=0,u=Array(o);i<l;++i)(a=e[i]).index=i,"object"!=typeof a.source&&(a.source=s(d,a.source)),"object"!=typeof a.target&&(a.target=s(d,a.target)),u[a.source.index]=(u[a.source.index]||0)+1,u[a.target.index]=(u[a.target.index]||0)+1;for(i=0,c=Array(l);i<l;++i)a=e[i],c[i]=u[a.source.index]/(u[a.source.index]+u[a.target.index]);t=Array(l),y(),n=Array(l),b();}}function y(){if(r)for(var n=0,i=e.length;n<i;++n)t[n]=+h(e[n],n,e);}function b(){if(r)for(var t=0,i=e.length;t<i;++t)n[t]=+p(e[t],t,e);}return null==e&&(e=[]),g.initialize=function(e,...t){r=e,d=t.find(e=>"function"==typeof e)||Math.random,l=t.find(e=>[1,2,3].includes(e))||2,m();},g.links=function(t){return arguments.length?(e=t,m(),g):e;},g.id=function(e){return arguments.length?(f=e,g):f;},g.iterations=function(e){return arguments.length?(v=+e,g):v;},g.strength=function(e){return arguments.length?(h="function"==typeof e?e:(0,i.default)(+e),y(),g):h;},g.distance=function(e){return arguments.length?(p="function"==typeof e?e:(0,i.default)(+e),b(),g):p;},g;}},c31b66bd:function(e,t,n){var r=n("c194dc2e"),i=n("689596c4"),a=n("bab17bc9"),o=a&&a.isTypedArray,s=o?i(o):r;e.exports=s;},c34357ca:function(e,t,n){var r=n("7bc08ef6"),i=n("ea7bb476");e.exports=function(e){return r(function(t,n){var r=-1,a=n.length,o=a>1?n[a-1]:void 0,s=a>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(a--,o):void 0,s&&i(n[0],n[1],s)&&(o=a<3?void 0:o,a=1),t=Object(t);++r<a;){var l=n[r];l&&e(t,l,r,o);}return t;});};},c37c383f:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{getDistanceScales:function(){return y;},getProjectionMatrix:function(){return x;},getProjectionParameters:function(){return _;},getViewMatrix:function(){return b;},lngLatToWorld:function(){return g;},pixelsToWorld:function(){return E;},worldToLngLat:function(){return m;},worldToPixels:function(){return w;},zoomToScale:function(){return v;}});var r=n("777fffbe"),i=n("852bbaa9"),a=r._(n("82f98358")),o=n("6801e0b3"),s=i._(n("ef68bcfd")),l=i._(n("d09e5fa2")),u=i._(n("854fa58e")),c=r._(n("b4039cbe")),d=Math.PI,f=d/4,h=d/180,p=180/d;function v(e){return Math.pow(2,e);}function g(e,t){var n=(0,a.default)(e,2),r=n[0],i=n[1];return(0,c.default)(Number.isFinite(r)&&Number.isFinite(t)),(0,c.default)(Number.isFinite(i)&&i>=-90&&i<=90,"invalid latitude"),[(t*=512)*(r*h+d)/(2*d),t*(d-Math.log(Math.tan(f+i*h*.5)))/(2*d)];}function m(e,t){var n=(0,a.default)(e,2);return[(n[0]/(t*=512)*(2*d)-d)*p,2*(Math.atan(Math.exp(d-n[1]/t*(2*d)))-f)*p];}function y(e){var t=e.latitude,n=e.longitude,r=e.zoom,i=e.scale,a=e.highPrecision;i=void 0!==i?i:v(r),(0,c.default)(Number.isFinite(t)&&Number.isFinite(n)&&Number.isFinite(i));var o={},s=512*i,l=Math.cos(t*h),u=s/360,d=u/l,f=s/4003e4/l;if(o.pixelsPerMeter=[f,-f,f],o.metersPerPixel=[1/f,-1/f,1/f],o.pixelsPerDegree=[u,-d,f],o.degreesPerPixel=[1/u,-1/d,1/f],void 0!==a&&a){var p=h*Math.tan(t*h)/l,g=u*p/2,m=s/4003e4*p,y=m/d*f;o.pixelsPerDegree2=[0,-g,m],o.pixelsPerMeter2=[y,0,y];}return o;}function b(e){var t=e.height,n=e.pitch,r=e.bearing,i=e.altitude,a=e.center,l=void 0===a?null:a,c=e.flipY,d=(0,o.createMat4)();return s.translate(d,d,[0,0,-i]),s.scale(d,d,[1,1,1/t]),s.rotateX(d,d,-n*h),s.rotateZ(d,d,r*h),void 0!==c&&c&&s.scale(d,d,[1,-1,1]),l&&s.translate(d,d,u.negate([],l)),d;}function _(e){var t=e.width,n=e.height,r=e.altitude,i=void 0===r?1.5:r,a=e.pitch,o=e.nearZMultiplier,s=e.farZMultiplier,l=(void 0===a?0:a)*h,u=Math.atan(.5/i),c=Math.sin(u)*i/Math.sin(Math.PI/2-l-u),d=Math.cos(Math.PI/2-l)*c+i;return{fov:2*Math.atan(n/2/i),aspect:t/n,focalDistance:i,near:void 0===o?1:o,far:d*(void 0===s?1:s)};}function x(e){var t=e.width,n=e.height,r=e.pitch,i=_({width:t,height:n,altitude:e.altitude,pitch:r,nearZMultiplier:e.nearZMultiplier,farZMultiplier:e.farZMultiplier}),a=i.fov,o=i.aspect,l=i.near,u=i.far;return s.perspective([],a,o,l,u);}function w(e,t){var n=(0,a.default)(e,3),r=n[0],i=n[1],s=n[2],l=void 0===s?0:s;return(0,c.default)(Number.isFinite(r)&&Number.isFinite(i)&&Number.isFinite(l)),(0,o.transformVector)(t,[r,i,l,1]);}function E(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=(0,a.default)(e,3),i=r[0],s=r[1],u=r[2];if((0,c.default)(Number.isFinite(i)&&Number.isFinite(s),"invalid pixel coordinate"),Number.isFinite(u))return(0,o.transformVector)(t,[i,s,u,1]);var d=(0,o.transformVector)(t,[i,s,0,1]),f=(0,o.transformVector)(t,[i,s,1,1]),h=d[2],p=f[2];return l.lerp([],d,f,h===p?0:((n||0)-h)/(p-h));}},c3eae33c:function(e,t,n){var r=n("a985b25e"),i=n("baa3a209");e.exports=function(e,t){return e&&r(t,i(t),e);};},c405380d:function(e,t,n){var r=n("df7a0006");function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=e.apply(this,r);return n.cache=a.set(i,o)||a,o;};return n.cache=new(i.Cache||r),n;}i.Cache=r,e.exports=i;},c4f4b481:function(e,t,n){"use strict";function r(e){var t=document.createElement("div");t.innerHTML=e;var n=t.childNodes[0];return n&&t.contains(n)&&t.removeChild(n),n;}n.d(t,"__esModule",{value:!0}),n.d(t,"createDOM",{enumerable:!0,get:function(){return r;}});},c4fa2186:function(e,t,n){"use strict";function r(e,t){if(e.length!==t.length)throw Error(`The number of touches and points are not equal - touches ${e.length}, points ${t.length}`);let n={};for(let r=0;r<e.length;r++)n[e[r].identifier]=t[r];return n;}n.d(t,"__esModule",{value:!0}),n.d(t,"indexTouches",{enumerable:!0,get:function(){return r;}});},c4fc35e5:function(e,t,n){var r=n("e3d5f8e1"),i=1/0;e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t;};},c50b12a0:function(e,t,n){var r=n("b9427af2"),i=n("70da4908"),a=n("297109c8");e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?a(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t);};};},c5fd2ecb:function(e,t,n){var r=n("46423930"),i=n("b01c35d8"),a=n("5e913e76"),o=r&&1/a(new r([,-0]))[1]==1/0?function(e){return new r(e);}:i;e.exports=o;},c6607ac6:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"KeyboardHandler",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("d812e418")),i=n("42fc1d72");class a{constructor(e){(0,r.default)(this,"_tr",void 0),(0,r.default)(this,"_enabled",void 0),(0,r.default)(this,"_active",void 0),(0,r.default)(this,"_panStep",void 0),(0,r.default)(this,"_bearingStep",void 0),(0,r.default)(this,"_pitchStep",void 0),(0,r.default)(this,"_rotationDisabled",void 0),this._tr=new i.TransformProvider(e),this._panStep=100,this._bearingStep=15,this._pitchStep=10,this._rotationDisabled=!1;}reset(){this._active=!1;}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let t=0,n=0,r=0,i=0,a=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?n=-1:(e.preventDefault(),i=-1);break;case 39:e.shiftKey?n=1:(e.preventDefault(),i=1);break;case 38:e.shiftKey?r=1:(e.preventDefault(),a=-1);break;case 40:e.shiftKey?r=-1:(e.preventDefault(),a=1);break;default:return;}return this._rotationDisabled&&(n=0,r=0),{cameraAnimation:s=>{let l=this._tr;s.easeTo({duration:300,easeId:"keyboardHandler",easing:o,zoom:t?Math.round(l.zoom)+t*(e.shiftKey?2:1):l.zoom,bearing:l.bearing+n*this._bearingStep,pitch:l.pitch+r*this._pitchStep,offset:[-i*this._panStep,-a*this._panStep],center:l.center},{originalEvent:e});}};}enable(){this._enabled=!0;}disable(){this._enabled=!1,this.reset();}isEnabled(){return this._enabled;}isActive(){return this._active;}disableRotation(){this._rotationDisabled=!0;}enableRotation(){this._rotationDisabled=!1;}}function o(e){return e*(2-e);}},c67b872d:function(e,t,n){var r=n("ce906886");e.exports=function(e){var t,n,i=(t={},n=0,r.forEach(e.children(),function i(a){var o=n;r.forEach(e.children(a),i),t[a]={low:o,lim:n++};}),t);r.forEach(e.graph().dummyChains,function(t){for(var n=e.node(t),r=n.edgeObj,a=function(e,t,n,r){var i,a,o=[],s=[],l=Math.min(t[n].low,t[r].low),u=Math.max(t[n].lim,t[r].lim);i=n;do o.push(i=e.parent(i));while(i&&(t[i].low>l||u>t[i].lim))for(a=i,i=r;(i=e.parent(i))!==a;)s.push(i);return{path:o.concat(s.reverse()),lca:a};}(e,i,r.v,r.w),o=a.path,s=a.lca,l=0,u=o[0],c=!0;t!==r.w;){if(n=e.node(t),c){for(;(u=o[l])!==s&&e.node(u).maxRank<n.rank;)l++;u===s&&(c=!1);}if(!c){for(;l<o.length-1&&e.node(u=o[l+1]).minRank<=n.rank;)l++;u=o[l];}e.setParent(t,u),t=e.successors(t)[0];}});};},c692a276:function(e,t,n){var r=n("ddf11daa"),i=n("16ec8ed6");e.exports=function(e,t){return e&&r(e,t,i);};},c6d8a485:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"Renderer",{enumerable:!0,get:function(){return w;}});var r,i=n("777fffbe"),a=n("852bbaa9"),o=i._(n("3d495adb")),s=i._(n("1316cf9d")),l=i._(n("66a06515")),u=i._(n("20defe2a")),c=n("597eee67"),d=a._(n("0489f0a4")),f=a._(n("3189a4b2")),h=a._(n("8d019a48")),p=a._(n("2071b9b5")),v=a._(n("7ca04eec")),g=a._(n("6c5ed4b1")),m=i._(n("83128d43")),y=i._(n("f89fb776")),b=n("0d884ee9"),_=(0,o.default)(function e(t){(0,s.default)(this,e),this.renderingContext=t.renderingContext,this.canvasConfig=t.config;},[{key:"init",value:function(){var e=this.canvasConfig,t=e.container,n=e.canvas;if(n)this.$canvas=n,t&&n.parentElement!==t&&t.appendChild(n),this.$container=n.parentElement,this.canvasConfig.container=this.$container;else if(t&&(this.$container=(0,b.isString)(t)?document.getElementById(t):t,this.$container)){var r=document.createElement("canvas");this.$container.appendChild(r),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=r;}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height);}},{key:"getContext",value:function(){return this.context;}},{key:"getDomElement",value:function(){return this.$canvas;}},{key:"getDPR",value:function(){return this.dpr;}},{key:"getBoundingClientRect",value:function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect();}},{key:"destroy",value:function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas);}},{key:"resize",value:function(e,t){var n=this.canvasConfig.devicePixelRatio;this.dpr=n,this.$canvas&&(this.$canvas.width=this.dpr*e,this.$canvas.height=this.dpr*t,(0,c.setDOMSize)(this.$canvas,e,t)),this.renderingContext.renderReasons.add(c.RenderReason.CAMERA_CHANGED);}},{key:"applyCursorStyle",value:function(e){this.$container&&this.$container.style&&(this.$container.style.cursor=e);}},{key:"toDataURL",value:(r=(0,y.default)((0,m.default)().mark(function e(){var t,n,r,i=arguments;return(0,m.default)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=i.length>0&&void 0!==i[0]?i[0]:{}).type,r=t.encoderOptions,e.abrupt("return",this.context.canvas.toDataURL(n,r));case 1:case"end":return e.stop();}},e,this);})),function(){return r.apply(this,arguments);})}]),x=function(e){function t(){var e;(0,s.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,l.default)(this,t,[].concat(r))).name="canvas-context-register",e;}return(0,u.default)(t,e),(0,o.default)(t,[{key:"init",value:function(){this.context.ContextService=_;}},{key:"destroy",value:function(){delete this.context.ContextService;}}]);}(c.AbstractRendererPlugin),w=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,l.default)(this,t,[e])).registerPlugin(new x),n.registerPlugin(new g.Plugin),n.registerPlugin(new d.Plugin),n.registerPlugin(new h.Plugin),n.registerPlugin(new p.Plugin),n.registerPlugin(new f.Plugin),n.registerPlugin(new v.Plugin),n;}return(0,u.default)(t,e),(0,o.default)(t);}(c.AbstractRenderer);},c75ed7e1:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{MouseLocation:function(){return u;},default:function(){return u;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("d812e418")),o=n("d9b661b3"),s=n("fb1ec05a"),l=r._(n("9e4ac071"));class u extends l.default{constructor(...e){super(...e),(0,a.default)(this,"location",[0,0]),(0,a.default)(this,"onMouseMove",e=>{let t=this.location,n=e.lngLat||e.lnglat,{transform:r}=this.controlOption;n&&(t=[n.lng,n.lat]),this.location=t,r&&(t=r(t)),this.insertLocation2HTML(t),this.emit("locationChange",t);});}getLocation(){return this.location;}getDefault(e){return(0,i.default)((0,i.default)({},super.getDefault(e)),{},{position:o.PositionType.BOTTOMLEFT,transform:([e,t])=>[+(+e).toFixed(6),+(+t).toFixed(6)]});}onAdd(){let e=s.DOM.create("div","l7-control-mouse-location");return e.innerHTML="&nbsp;",this.mapsService.on("mousemove",this.onMouseMove),e;}onRemove(){this.mapsService.off("mousemove",this.onMouseMove);}insertLocation2HTML(e){this.container.innerText=e.join(", ");}}},c7b53fd1:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("daaa1548")),o=n("d9b661b3"),s=r._(n("755bc4f8")),l=n("f717bab4");class u extends s.default{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,POS:9});}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,a.default)((0,a.default)({},e.uniformsOption),t.uniformsOption);}getCommonUniformsInfo(){let{opacity:e,coverage:t,angle:n}=this.layer.getLayerConfig(),r={u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset],u_opacity:e||1,u_coverage:t||.9,u_angle:n||0};return this.getUniformsBufferInfo(r);}initModels(){var e=this;return(0,i.default)(function*(){return e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"heatmapHexagon",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_POS) in vec3 a_Pos;\n\nlayout(std140) uniform commonUniforms {\n  vec2 u_radius;\n  float u_opacity;\n  float u_coverage;\n  float u_angle;\n};\n\nout vec4 v_color;\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nvoid main() {\n  v_color = a_Color;\n  v_color.a *= u_opacity;\n\n  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\n  vec2 offset = vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage);\n  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\n\n  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'in vec4 v_color;\n\n#pragma include "picking"\nout vec4 outputColor;\nvoid main() {\n  outputColor = v_color;\n  outputColor = filterColor(outputColor);\n}\n',defines:e.getDefines(),triangulation:l.HeatmapGridTriangulation,depth:{enable:!1},primitive:o.gl.TRIANGLES}))];})();}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:o.AttributeType.Attribute,descriptor:{name:"a_Pos",shaderLocation:this.attributeLocation.POS,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:3,update:e=>{let t=e.coordinates;return[t[0],t[1],0];}}});}}},c80c7fe3:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"isAbsoluteArray",{enumerable:!0,get:function(){return i;}});var r=n("759cce50");function i(e){return(0,r.isPathArray)(e)&&e.every(function(e){var t=e[0];return t===t.toUpperCase();});}},c86554bb:function(e,t,n){"use strict";function r(e){return e instanceof Element||e instanceof Document;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},c8a0b2e7:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("daaa1548")),o=r._(n("d812e418")),s=n("d9b661b3"),l=r._(n("755bc4f8"));class u extends l.default{constructor(...e){super(...e),(0,o.default)(this,"texture",void 0),(0,o.default)(this,"radian",0),(0,o.default)(this,"planeGeometryTriangulation",()=>{let{center:e=[120,30]}=this.layer.getLayerConfig();return{size:4,indices:[0,1,2,2,3,0],vertices:[...e,1,1,...e,0,1,...e,0,0,...e,1,0]};});}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,EXTRUDE:9,UV:10});}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,a.default)((0,a.default)({},e.uniformsOption),t.uniformsOption);}getCommonUniformsInfo(){let{opacity:e,width:t=1,height:n=1,raisingHeight:r=0}=this.layer.getLayerConfig(),i=1;"amap"===this.mapService.getType()&&(i=-1),this.radian=i*Math.PI*(this.mapService.getRotation()%360)/180;let a={u_size:[t,n],u_raisingHeight:Number(r),u_rotation:this.radian,u_opacity:e||1,u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(a);}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy();}initModels(){var e=this;return(0,i.default)(function*(){let{drawCanvas:t}=e.layer.getLayerConfig(),{createTexture2D:n}=e.rendererService;return e.texture=n({height:0,width:0}),t&&e.updateTexture(t),e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"geometryBillboard",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\nlayout(std140) uniform commonUniforms {\n  vec2 u_size;\n  float u_raisingHeight;\n  float u_rotation;\n  float u_opacity;\n};\n\nout vec2 v_uv;\n\n#pragma include "projection"\n#pragma include "picking"\n#pragma include "rotation_2d"\nvoid main() {\n  vec3 extrude = a_Extrude;\n  v_uv = a_Uv;\n  float raiseHeight = u_raisingHeight;\n  if (\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n  ) {\n    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);\n    raiseHeight = u_raisingHeight * mapboxZoomScale;\n  }\n\n  // \u8BA1\u7B97\u7ECF\u7EAC\u5EA6\u70B9\u4F4D\u5750\u6807\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));\n\n  // \u8BA1\u7B97\u7ED5 z \u8F74\u65CB\u8F6C\u540E\u7684\u504F\u79FB\n  vec2 offsetXY = project_pixel(rotate_matrix(vec2(extrude.x * u_size.x, 0.0), u_rotation));\n  // \u7ED5 z \u8F74\u65CB\u8F6C\n  float x = project_pos.x + offsetXY.x;\n  float y = project_pos.y + offsetXY.y;\n  // z \u8F74\u4E0D\u53C2\u4E0E\u65CB\u8F6C\n  float z = project_pixel(extrude.y * u_size.y + raiseHeight);\n\n  gl_Position = project_common_position_to_clipspace(vec4(x, y, z, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'layout(std140) uniform commonUniforms {\n vec2 u_size;\n float u_raisingHeight;\n float u_rotation;\n float u_opacity;\n};\n\nuniform sampler2D u_texture;\n\nin vec2 v_uv;\nout vec4 outputColor;\n\n#pragma include "picking"\nvoid main() {\n  outputColor = texture(SAMPLER_2D(u_texture), vec2(v_uv.x, 1.0 - v_uv.y));\n  outputColor.a *= u_opacity;\n  outputColor = filterColor(outputColor);\n}\n',triangulation:e.planeGeometryTriangulation,defines:e.getDefines(),inject:e.getInject(),primitive:s.gl.TRIANGLES,depth:{enable:!0}}))];})();}buildModels(){var e=this;return(0,i.default)(function*(){return e.initModels();})();}updateTexture(e){let{createTexture2D:t}=this.rendererService,{canvasWidth:n=1,canvasHeight:r=1}=this.layer.getLayerConfig(),i=document.createElement("canvas");i.width=n,i.height=r,i.getContext("2d")&&(e(i),this.texture=t({data:i,width:i.width,height:i.height,wrapS:s.gl.CLAMP_TO_EDGE,wrapT:s.gl.CLAMP_TO_EDGE}),this.layerService.reRender());}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:s.AttributeType.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:s.gl.DYNAMIC_DRAW,data:[],type:s.gl.FLOAT},size:3,update:(e,t,n,r)=>{let i=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],a=r%4*3;return[i[a],i[a+1],i[a+2]];}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:s.AttributeType.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:s.gl.DYNAMIC_DRAW,data:[],type:s.gl.FLOAT},size:2,update:(e,t,n)=>[n[2],n[3]]}});}}},c91fd173:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"DragHandler",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("d812e418")),i=n("e31a659c");class a{constructor(e){(0,r.default)(this,"contextmenu",void 0),(0,r.default)(this,"mousedown",void 0),(0,r.default)(this,"mousemoveWindow",void 0),(0,r.default)(this,"mouseup",void 0),(0,r.default)(this,"touchstart",void 0),(0,r.default)(this,"touchmoveWindow",void 0),(0,r.default)(this,"touchend",void 0),(0,r.default)(this,"_clickTolerance",void 0),(0,r.default)(this,"_moveFunction",void 0),(0,r.default)(this,"_activateOnStart",void 0),(0,r.default)(this,"_active",void 0),(0,r.default)(this,"_enabled",void 0),(0,r.default)(this,"_moved",void 0),(0,r.default)(this,"_lastPoint",void 0),(0,r.default)(this,"_moveStateManager",void 0),this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset();}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e);}_move(...e){let t=this._moveFunction(...e);if(t.bearingDelta||t.pitchDelta||t.around||t.panDelta)return this._active=!0,t;}dragStart(e,t){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=t.length?t[0]:t,this._activateOnStart&&this._lastPoint&&(this._active=!0));}dragMove(e,t){if(!this.isEnabled())return;let n=this._lastPoint;if(!n)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e)){this.reset(e);return;}let r=t.length?t[0]:t;if(!(!this._moved&&r.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=r,this._move(n,r);}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&i.DOM.suppressClick(),this.reset(e));}enable(){this._enabled=!0;}disable(){this._enabled=!1,this.reset();}isEnabled(){return this._enabled;}isActive(){return this._active;}getClickTolerance(){return this._clickTolerance;}}},c9696724:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"HeatmapLayer",{enumerable:!0,get:function(){return r.HeatmapLayer;}});var r=n("ece1ce11");},c9806a9b:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r={image:n("777fffbe")._(n("3d18b149")).default};},c9dc36b7:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("c21c959b")),i=function(e,t){var n=t?(0,r.default)(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength);};},c9ee7715:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=Object.prototype.toString,i=function(e){return r.call(e);};},cac9bafa:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=n("d9b661b3"),s=n("fb1ec05a"),l=r._(n("755bc4f8")),u=n("f717bab4");class c extends l.default{constructor(...e){super(...e),(0,a.default)(this,"texture",void 0);}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9});}getCommonUniformsInfo(){let{opacity:e,clampLow:t=!0,clampHigh:n=!0,noDataValue:r=-9999999,domain:i,rampColors:a,colorTexture:o,rScaler:l=6553.6,gScaler:u=25.6,bScaler:c=.1,offset:d=1e4}=this.layer.getLayerConfig(),f=i||(0,s.getDefaultDomain)(a),h=o;o?this.layer.textureService.setColorTexture(o,a,f):h=this.layer.textureService.getColorTexture(a,f);let p={u_unpack:[l,u,c,d],u_domain:f,u_opacity:e||1,u_noDataValue:r,u_clampLow:t,u_clampHigh:void 0!==n?n:t,u_texture:this.texture,u_colorTexture:h};return this.textures=[this.texture,h],this.getUniformsBufferInfo(p);}initModels(){var e=this;return(0,i.default)(function*(){e.initUniformsBuffer();let t=e.layer.getSource(),{createTexture2D:n}=e.rendererService,r=yield t.data.images;return e.texture=n({data:r[0],width:r[0].width,height:r[0].height,min:o.gl.LINEAR,mag:o.gl.LINEAR}),[(yield e.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\nlayout(std140) uniform commonUniforms {\n  vec4 u_unpack;\n  vec2 u_domain;\n  float u_opacity;\n  float u_noDataValue;\n  float u_clampLow;\n  float u_clampHigh;\n};\nout vec2 v_texCoord;\n#pragma include "projection"\n\nvoid main() {\n  v_texCoord = a_Uv;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));\n}\n',fragmentShader:"uniform sampler2D u_texture;\nuniform sampler2D u_colorTexture;\n\nlayout(std140) uniform commonUniforms {\n vec4 u_unpack;\n vec2 u_domain;\n float u_opacity;\n float u_noDataValue;\n float u_clampLow;\n float u_clampHigh;\n};\n\nin vec2 v_texCoord;\nout vec4 outputColor;\n\n\nfloat getElevation(vec2 coord, float bias) {\n    // Convert encoded elevation value to meters\n    vec4 data =  texture(SAMPLER_2D(u_texture), coord,bias) * 255.0;\n    data.a = -1.0;\n    return dot(data, u_unpack);\n}\n\nvec4 getColor(float value) {\n   float normalisedValue =(value- u_domain[0]) / (u_domain[1] - u_domain[0]);\n    vec2 coord = vec2(normalisedValue, 0);\n    return  texture(SAMPLER_2D(u_colorTexture), coord);\n}\n\nvoid main() {\n  float value = getElevation(v_texCoord,0.0);\n  if (value == u_noDataValue) {\n    outputColor = vec4(0.0, 0, 0, 0.0);\n  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {\n     outputColor = vec4(0.0, 0, 0, 0.0);\n  } else {\n   \n    outputColor = getColor(value);\n    outputColor.a =  outputColor.a * u_opacity ;\n      if(outputColor.a < 0.01)\n      discard;\n  }\n}\n",defines:e.getDefines(),triangulation:u.RasterImageTriangulation,primitive:o.gl.TRIANGLES,depth:{enable:!1}}))];})();}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy();}buildModels(){var e=this;return(0,i.default)(function*(){return e.initModels();})();}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:o.AttributeType.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:2,update:(e,t,n)=>[n[3],n[4]]}});}}},cad18bdf:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"MapTheme",{enumerable:!0,get:function(){return r;}});let r={normal:"amap://styles/normal",light:"amap://styles/c422f5c0cfced5be9fe3a83f05f28a68?isPublic=true",dark:"amap://styles/c9f1d10cae34f8ab05e425462c5a58d7?isPublic=true",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true",fresh:"amap://styles/fresh",grey:"amap://styles/grey",graffiti:"amap://styles/graffiti",macaron:"amap://styles/macaron",darkblue:"amap://styles/darkblue",wine:"amap://styles/wine"};},cb53e56d:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("73ff5a90")),i=Object.prototype.hasOwnProperty,a=function(e){var t=this.__data__;return r.default?void 0!==t[e]:i.call(t,e);};},cb5e6d96:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=Function.prototype.toString,i=function(e){if(null!=e){try{return r.call(e);}catch(e){}try{return e+"";}catch(e){}}return"";};},cb5f3e10:function(e,t,n){e.exports="2.1.8";},cb688f1d:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("daaa1548")),o=n("d9b661b3"),s=r._(n("755bc4f8")),l=n("f717bab4");class u extends s.default{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,LINEAR:9});}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,a.default)((0,a.default)({},e.uniformsOption),t.uniformsOption);}getCommonUniformsInfo(){let{raisingHeight:e=0,opacityLinear:t={enable:!1,dir:"in"}}=this.layer.getLayerConfig(),n={u_raisingHeight:Number(e),u_opacitylinear:Number(t.enable),u_dir:"in"===t.dir?1:0};return this.getUniformsBufferInfo(n);}initModels(){var e=this;return(0,i.default)(function*(){return e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){let{frag:t,vert:n,triangulation:r,type:i}=e.getModelParams();return e.initUniformsBuffer(),e.layer.triangulation=r,[(yield e.layer.buildLayerModel({moduleName:i,vertexShader:n,fragmentShader:t,defines:e.getDefines(),inject:e.getInject(),triangulation:r,primitive:o.gl.TRIANGLES,depth:{enable:!1}}))];})();}registerBuiltinAttributes(){this.registerPosition64LowAttribute();let{opacityLinear:e={enable:!1,dir:"in"}}=this.layer.getLayerConfig();e.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:o.AttributeType.Attribute,descriptor:{name:"a_linear",shaderLocation:this.attributeLocation.LINEAR,buffer:{usage:o.gl.STATIC_DRAW,data:[],type:o.gl.FLOAT},size:3,update:(e,t,n)=>[n[3],n[4],n[5]]}});}getModelParams(){let{opacityLinear:e={enable:!1}}=this.layer.getLayerConfig();return e.enable?{frag:'\nlayout(std140) uniform commonUniforms {\n  float u_raisingHeight;\n  float u_opacitylinear;\n  float u_dir;\n};\n\nin vec4 v_color;\nin vec3 v_linear;\nin vec2 v_pos;\nout vec4 outputColor;\n#pragma include "scene_uniforms"\n#pragma include "picking"\n\nvoid main() {\n  outputColor = v_color;\n  if (u_opacitylinear > 0.0) {\n    outputColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;\n  }\n  outputColor = filterColor(outputColor);\n}\n',vert:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_LINEAR) in vec3 a_linear;\n\nlayout(std140) uniform commonUniforms {\n  float u_raisingHeight;\n  float u_opacitylinear;\n  float u_dir;\n};\n\nout vec4 v_color;\nout vec3 v_linear;\nout vec2 v_pos;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  if (u_opacitylinear > 0.0) {\n    v_linear = a_linear;\n    v_pos = a_Position.xy;\n  }\n  v_color = vec4(a_Color.xyz, a_Color.w * opacity);\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\n  project_pos.z += u_raisingHeight;\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);\n    project_pos.z *= mapboxZoomScale;\n    project_pos.z += u_raisingHeight * mapboxZoomScale;\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  setPickingColor(a_PickingColor);\n}\n',type:"polygonLinear",triangulation:l.polygonTriangulationWithCenter}:{frag:'in vec4 v_color;\n#pragma include "scene_uniforms"\n#pragma include "picking"\nout vec4 outputColor;\nvoid main() {\n  outputColor = v_color;\n  outputColor = filterColor(outputColor);\n}\n',vert:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\n\nlayout(std140) uniform commonUniforms {\n  float u_raisingHeight;\n};\n\nout vec4 v_color;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97\n\n  v_color = vec4(a_Color.xyz, a_Color.w * opacity);\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\n\n  project_pos.z += u_raisingHeight;\n\n  if (\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n  ) {\n    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);\n    project_pos.z *= mapboxZoomScale;\n    project_pos.z += u_raisingHeight * mapboxZoomScale;\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n\n',type:"polygonFill",triangulation:l.polygonTriangulation};}}},cc20131e:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"MapTheme",{enumerable:!0,get:function(){return r;}});let r={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}};},cc74f26d:function(e,t,n){var r=n("16b3b059").Symbol;e.exports=r;},cca3484a:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{BlockableMapEventHandler:function(){return o;},MapEventHandler:function(){return a;}});var r=n("777fffbe")._(n("d812e418")),i=n("2b090ae9");class a{constructor(e,t){(0,r.default)(this,"_mousedownPos",void 0),(0,r.default)(this,"_clickTolerance",void 0),(0,r.default)(this,"_map",void 0),this._map=e,this._clickTolerance=t.clickTolerance;}reset(){delete this._mousedownPos;}wheel(e){return this._firePreventable(new i.MapWheelEvent(e.type,this._map,e));}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new i.MapMouseEvent(e.type,this._map,e));}mouseup(e){this._map.fire(new i.MapMouseEvent(e.type,this._map,e));}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||this._map.fire(new i.MapMouseEvent(e.type,this._map,e));}dblclick(e){return this._firePreventable(new i.MapMouseEvent(e.type,this._map,e));}mouseover(e){this._map.fire(new i.MapMouseEvent(e.type,this._map,e));}mouseout(e){this._map.fire(new i.MapMouseEvent(e.type,this._map,e));}touchstart(e){return this._firePreventable(new i.MapTouchEvent(e.type,this._map,e));}touchmove(e){this._map.fire(new i.MapTouchEvent(e.type,this._map,e));}touchend(e){this._map.fire(new i.MapTouchEvent(e.type,this._map,e));}touchcancel(e){this._map.fire(new i.MapTouchEvent(e.type,this._map,e));}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{};}isEnabled(){return!0;}isActive(){return!1;}enable(){}disable(){}}class o{constructor(e){(0,r.default)(this,"_map",void 0),(0,r.default)(this,"_delayContextMenu",void 0),(0,r.default)(this,"_ignoreContextMenu",void 0),(0,r.default)(this,"_contextMenuEvent",void 0),this._map=e;}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent;}mousemove(e){this._map.fire(new i.MapMouseEvent(e.type,this._map,e));}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1;}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new i.MapMouseEvent("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent);}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new i.MapMouseEvent(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault();}isEnabled(){return!0;}isActive(){return!1;}enable(){}disable(){}}},ccff5790:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){var t=typeof e;return null!==e&&"object"===t||"function"===t;};},cd0631a9:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t;};},cdd4ad87:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o);}return a;};},cdf1a659:function(e,t,n){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i;};},ce906886:function(e,t,n){var r;if("function"==typeof n)try{r={cloneDeep:n("4831edc3"),constant:n("df18c8e8"),defaults:n("1fc00f58"),each:n("6ae941e3"),filter:n("e8cc97d4"),find:n("b5e7b78f"),flatten:n("f0706e85"),forEach:n("325a7ff6"),forIn:n("06f4e2df"),has:n("684a09cf"),isUndefined:n("0654920e"),last:n("e7d99e70"),map:n("3af9c24c"),mapValues:n("af247a07"),max:n("e5d2c8b8"),merge:n("9f537f33"),min:n("bebef26b"),minBy:n("da50efcc"),now:n("e5791bbd"),pick:n("5c9f5160"),range:n("d875ee61"),reduce:n("ef673027"),sortBy:n("3cb21ffa"),uniqueId:n("be524c36"),values:n("1d48c64c"),zipObject:n("8b65b5b5")};}catch(e){}r||(r=window._),e.exports=r;},cf496f3c:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"TileSourceService",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=n("852bbaa9"),a=r._(n("daaa1548")),o=i._(n("b6874a87")),s=r._(n("d9c7302c"));class l{getCombineFeature(e){let t=null,n=e[0];return e.map(e=>{let n=o.polygon(e.coordinates);t=null===t?n:(0,s.default)(t,n);}),n&&(t.properties=(0,a.default)({},n)),t;}}},cf58c1f3:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("e6d4594c"));function i(e,t,n,i){var a,o,s,l,u,c,d,f,h,p=this._x0,v=this._y0,g=this._z0,m=this._x1,y=this._y1,b=this._z1,_=[],x=this._root;for(x&&_.push(new r.default(x,p,v,g,m,y,b)),null==i?i=1/0:(p=e-i,v=t-i,g=n-i,m=e+i,y=t+i,b=n+i,i*=i);f=_.pop();)if((x=f.node)&&!((o=f.x0)>m)&&!((s=f.y0)>y)&&!((l=f.z0)>b)&&!((u=f.x1)<p)&&!((c=f.y1)<v)&&!((d=f.z1)<g)){if(x.length){var w=(o+u)/2,E=(s+c)/2,M=(l+d)/2;_.push(new r.default(x[7],w,E,M,u,c,d),new r.default(x[6],o,E,M,w,c,d),new r.default(x[5],w,s,M,u,E,d),new r.default(x[4],o,s,M,w,E,d),new r.default(x[3],w,E,l,u,c,M),new r.default(x[2],o,E,l,w,c,M),new r.default(x[1],w,s,l,u,E,M),new r.default(x[0],o,s,l,w,E,M)),(h=(n>=M)<<2|(t>=E)<<1|e>=w)&&(f=_[_.length-1],_[_.length-1]=_[_.length-1-h],_[_.length-1-h]=f);}else{var S=e-+this._x.call(null,x.data),k=t-+this._y.call(null,x.data),C=n-+this._z.call(null,x.data),A=S*S+k*k+C*C;if(A<i){var L=Math.sqrt(i=A);p=e-L,v=t-L,g=n-L,m=e+L,y=t+L,b=n+L,a=x.data;}}}return a;}},cf7441db:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("b6081162")),i=function(e){return(0,r.default)(e,"Function");};},cff8ffe1:function(e,t,n){"use strict";var r=n("ce906886");e.exports=function(e,t){for(var n=0,i=1;i<t.length;++i)n+=function(e,t,n){for(var i=r.zipObject(n,r.map(n,function(e,t){return t;})),a=r.flatten(r.map(t,function(t){return r.sortBy(r.map(e.outEdges(t),function(t){return{pos:i[t.w],weight:e.edge(t).weight};}),"pos");}),!0),o=1;o<n.length;)o<<=1;var s=2*o-1;o-=1;var l=r.map(Array(s),function(){return 0;}),u=0;return r.forEach(a.forEach(function(e){var t=e.pos+o;l[t]+=e.weight;for(var n=0;t>0;)t%2&&(n+=l[t+1]),t=t-1>>1,l[t]+=e.weight;u+=e.weight*n;})),u;}(e,t[i-1],t[i]);return n;};},d038e143:function(e,t,n){var r=n("c692a276"),i=n("d6849795")(r);e.exports=i;},d0820664:function(e,t,n){"use strict";var r=n("ce906886"),i=n("5bf20808").Graph,a=n("b192169f");function o(e,t){var n={};return r.reduce(t,function(t,i){var a=0,o=0,s=t.length,u=r.last(i);return r.forEach(i,function(t,c){var d=function(e,t){if(e.node(t).dummy)return r.find(e.predecessors(t),function(t){return e.node(t).dummy;});}(e,t),f=d?e.node(d).order:s;(d||t===u)&&(r.forEach(i.slice(o,c+1),function(t){r.forEach(e.predecessors(t),function(r){var i=e.node(r),o=i.order;(o<a||f<o)&&!(i.dummy&&e.node(t).dummy)&&l(n,r,t);});}),o=c+1,a=f);}),i;}),n;}function s(e,t){var n={};function i(t,i,a,o,s){var u;r.forEach(r.range(i,a),function(i){u=t[i],e.node(u).dummy&&r.forEach(e.predecessors(u),function(t){var r=e.node(t);r.dummy&&(r.order<o||r.order>s)&&l(n,t,u);});});}return r.reduce(t,function(t,n){var a,o=-1,s=0;return r.forEach(n,function(r,l){if("border"===e.node(r).dummy){var u=e.predecessors(r);u.length&&(a=e.node(u[0]).order,i(n,s,l,o,a),s=l,o=a);}i(n,s,n.length,a,t.length);}),n;}),n;}function l(e,t,n){if(t>n){var r=t;t=n,n=r;}var i=e[t];i||(e[t]=i={}),i[n]=!0;}function u(e,t,n){if(t>n){var i=t;t=n,n=i;}return r.has(e[t],n);}function c(e,t,n,i){var a={},o={},s={};return r.forEach(t,function(e){r.forEach(e,function(e,t){a[e]=e,o[e]=e,s[e]=t;});}),r.forEach(t,function(e){var t=-1;r.forEach(e,function(e){var l=i(e);if(l.length)for(var c=((l=r.sortBy(l,function(e){return s[e];})).length-1)/2,d=Math.floor(c),f=Math.ceil(c);d<=f;++d){var h=l[d];o[e]===e&&t<s[h]&&!u(n,e,h)&&(o[h]=e,o[e]=a[e]=a[h],t=s[h]);}});}),{root:a,align:o};}function d(e,t,n,a,o){var s,l,u,c,d,f={},h=(u=new i,s=(c=e.graph()).nodesep,l=c.edgesep,d=function(e,t,n){var i,a,u=e.node(t),c=e.node(n);if(i=0+u.width/2,r.has(u,"labelpos"))switch(u.labelpos.toLowerCase()){case"l":a=-u.width/2;break;case"r":a=u.width/2;}if(a&&(i+=o?a:-a),a=0,i+=(u.dummy?l:s)/2+(c.dummy?l:s)/2+c.width/2,r.has(c,"labelpos"))switch(c.labelpos.toLowerCase()){case"l":a=c.width/2;break;case"r":a=-c.width/2;}return a&&(i+=o?a:-a),a=0,i;},r.forEach(t,function(t){var i;r.forEach(t,function(t){var r=n[t];if(u.setNode(r),i){var a=n[i],o=u.edge(a,r);u.setEdge(a,r,Math.max(d(e,t,i),o||0));}i=t;});}),u),p=o?"borderLeft":"borderRight";function v(e,t){for(var n=h.nodes(),r=n.pop(),i={};r;)i[r]?e(r):(i[r]=!0,n.push(r),n=n.concat(t(r))),r=n.pop();}return v(function(e){f[e]=h.inEdges(e).reduce(function(e,t){return Math.max(e,f[t.v]+h.edge(t));},0);},h.predecessors.bind(h)),v(function(t){var n=h.outEdges(t).reduce(function(e,t){return Math.min(e,f[t.w]-h.edge(t));},Number.POSITIVE_INFINITY),r=e.node(t);n!==Number.POSITIVE_INFINITY&&r.borderType!==p&&(f[t]=Math.max(f[t],n));},h.successors.bind(h)),r.forEach(a,function(e){f[e]=f[n[e]];}),f;}function f(e,t){return r.minBy(r.values(t),function(t){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return r.forIn(t,function(t,r){var a=e.node(r).width/2;n=Math.max(t+a,n),i=Math.min(t-a,i);}),n-i;});}function h(e,t){var n=r.values(t),i=r.min(n),a=r.max(n);r.forEach(["u","d"],function(n){r.forEach(["l","r"],function(o){var s,l=n+o,u=e[l];if(u!==t){var c=r.values(u);(s="l"===o?i-r.min(c):a-r.max(c))&&(e[l]=r.mapValues(u,function(e){return e+s;}));}});});}function p(e,t){return r.mapValues(e.ul,function(n,i){if(t)return e[t.toLowerCase()][i];var a=r.sortBy(r.map(e,i));return(a[1]+a[2])/2;});}e.exports={positionX:function(e){var t,n=a.buildLayerMatrix(e),i=r.merge(o(e,n),s(e,n)),l={};r.forEach(["u","d"],function(a){t="u"===a?n:r.values(n).reverse(),r.forEach(["l","r"],function(n){"r"===n&&(t=r.map(t,function(e){return r.values(e).reverse();}));var o=("u"===a?e.predecessors:e.successors).bind(e),s=c(e,t,i,o),u=d(e,t,s.root,s.align,"r"===n);"r"===n&&(u=r.mapValues(u,function(e){return-e;})),l[a+n]=u;});});var u=f(e,l);return h(l,u),p(l,e.graph().align);},findType1Conflicts:o,findType2Conflicts:s,addConflict:l,hasConflict:u,verticalAlignment:c,horizontalCompaction:d,alignCoordinates:h,findSmallestWidthAlignment:f,balance:p};},d092a378:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"LngLatBounds",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("d812e418")),i=n("5c93f055");class a{constructor(e,t){(0,r.default)(this,"_ne",void 0),(0,r.default)(this,"_sw",void 0),e&&(t?this.setSouthWest(e).setNorthEast(t):Array.isArray(e)&&(4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])));}setNorthEast(e){return this._ne=e instanceof i.LngLat?new i.LngLat(e.lng,e.lat):i.LngLat.convert(e),this;}setSouthWest(e){return this._sw=e instanceof i.LngLat?new i.LngLat(e.lng,e.lat):i.LngLat.convert(e),this;}extend(e){let t,n;let r=this._sw,o=this._ne;if(e instanceof i.LngLat)t=e,n=e;else if(!(e instanceof a))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(a.convert(e)):this.extend(i.LngLat.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(i.LngLat.convert(e)):this;else if(t=e._sw,n=e._ne,!t||!n)return this;return r||o?(r.lng=Math.min(t.lng,r.lng),r.lat=Math.min(t.lat,r.lat),o.lng=Math.max(n.lng,o.lng),o.lat=Math.max(n.lat,o.lat)):(this._sw=new i.LngLat(t.lng,t.lat),this._ne=new i.LngLat(n.lng,n.lat)),this;}getCenter(){return new i.LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2);}getSouthWest(){return this._sw;}getNorthEast(){return this._ne;}getNorthWest(){return new i.LngLat(this.getWest(),this.getNorth());}getSouthEast(){return new i.LngLat(this.getEast(),this.getSouth());}getWest(){return this._sw.lng;}getSouth(){return this._sw.lat;}getEast(){return this._ne.lng;}getNorth(){return this._ne.lat;}toArray(){return[this._sw.toArray(),this._ne.toArray()];}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`;}isEmpty(){return!(this._sw&&this._ne);}contains(e){let{lng:t,lat:n}=i.LngLat.convert(e),r=this._sw.lat<=n&&n<=this._ne.lat,a=this._sw.lng<=t&&t<=this._ne.lng;return this._sw.lng>this._ne.lng&&(a=this._sw.lng>=t&&t>=this._ne.lng),r&&a;}static convert(e){return e instanceof a?e:new a(e);}static fromLngLat(e,t=0){let n=360*t/40075017,r=n/Math.cos(Math.PI/180*e.lat);return new a(new i.LngLat(e.lng-r,e.lat-n),new i.LngLat(e.lng+r,e.lat+n));}}},d0ab0443:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return b;}});var r=n("777fffbe"),i=n("852bbaa9"),a=i._(n("0910777e")),o=r._(n("1a33586c")),s=r._(n("abc78c0a")),l=r._(n("bf6b8c7f")),u=r._(n("cf58c1f3")),c=n("90b8a4ed"),d=i._(n("5e762d8e")),f=r._(n("0a2d5f8b")),h=r._(n("97c31b1e")),p=r._(n("9d85763c")),v=r._(n("b1667d5e")),g=i._(n("0d154dce")),m=i._(n("45e3b1d7")),y=i._(n("d8c0cd4a"));function b(e,t,n,r){var i=new _(null==t?g.defaultX:t,null==n?m.defaultY:n,null==r?y.defaultZ:r,NaN,NaN,NaN,NaN,NaN,NaN);return null==e?i:i.addAll(e);}function _(e,t,n,r,i,a,o,s,l){this._x=e,this._y=t,this._z=n,this._x0=r,this._y0=i,this._z0=a,this._x1=o,this._y1=s,this._z1=l,this._root=void 0;}function x(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t;}var w=b.prototype=_.prototype;w.copy=function(){var e,t,n=new _(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),r=this._root;if(!r)return n;if(!r.length)return n._root=x(r),n;for(e=[{source:r,target:n._root=Array(8)}];r=e.pop();)for(var i=0;i<8;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=Array(8)}):r.target[i]=x(t));return n;},w.add=a.default,w.addAll=a.addAll,w.cover=o.default,w.data=s.default,w.extent=l.default,w.find=u.default,w.findAllWithinRadius=c.findAllWithinRadius,w.remove=d.default,w.removeAll=d.removeAll,w.root=f.default,w.size=h.default,w.visit=p.default,w.visitAfter=v.default,w.x=g.default,w.y=m.default,w.z=y.default;},d1473659:function(e,t,n){var r=n("7c1db5f7");e.exports=function(e){return e==e&&!r(e);};},d18fbaa5:function(e,t,n){e.exports=function(){return[];};},d1945137:function(e,t,n){var r=n("f0706e85"),i=n("9fb0e475"),a=n("399c1f06");e.exports=function(e){return a(i(e,void 0,r),e+"");};},d1adb660:function(e,t,n){"use strict";function r(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]));}n.d(t,"__esModule",{value:!0}),n.d(t,"distanceSquareRoot",{enumerable:!0,get:function(){return r;}});},d2230a39:function(e,t,n){var r=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return r.call(e);}catch(e){}try{return e+"";}catch(e){}}return"";};},d239a2bf:function(e,t,n){var r=n("ce906886"),i=n("b192169f");e.exports={run:function(e){var t,n=i.addDummyNode(e,"root",{},"_root"),a=(t={},r.forEach(e.children(),function(n){!function n(i,a){var o=e.children(i);o&&o.length&&r.forEach(o,function(e){n(e,a+1);}),t[i]=a;}(n,1);}),t),o=r.max(r.values(a))-1,s=2*o+1;e.graph().nestingRoot=n,r.forEach(e.edges(),function(t){e.edge(t).minlen*=s;});var l=r.reduce(e.edges(),function(t,n){return t+e.edge(n).weight;},0)+1;r.forEach(e.children(),function(t){(function e(t,n,a,o,s,l,u){var c=t.children(u);if(!c.length){u!==n&&t.setEdge(n,u,{weight:0,minlen:a});return;}var d=i.addBorderNode(t,"_bt"),f=i.addBorderNode(t,"_bb"),h=t.node(u);t.setParent(d,u),h.borderTop=d,t.setParent(f,u),h.borderBottom=f,r.forEach(c,function(r){e(t,n,a,o,s,l,r);var i=t.node(r),c=i.borderTop?i.borderTop:r,h=i.borderBottom?i.borderBottom:r,p=i.borderTop?o:2*o,v=c!==h?1:s-l[u]+1;t.setEdge(d,c,{weight:p,minlen:v,nestingEdge:!0}),t.setEdge(h,f,{weight:p,minlen:v,nestingEdge:!0});}),t.parent(u)||t.setEdge(n,d,{weight:0,minlen:s+l[u]});})(e,n,s,l,o,a,t);}),e.graph().nodeRankFactor=s;},cleanup:function(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,r.forEach(e.edges(),function(t){e.edge(t).nestingEdge&&e.removeEdge(t);});}};},d23dbaca:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("fa52488c")),o=r._(n("f1ed3b6a")),s=r._(n("bec2d0e3"));class l extends s.default{initTileLayer(){var e=this;return(0,i.default)(function*(){let t=e.getSourceOption(),n=t.data.features[0].properties,r=new a.default().source(t.data,t.options).size(1).shape("line").color("red"),i=new o.default({minZoom:e.z-1,maxZoom:e.z+1,textAllowOverlap:!0}).source([n],{parser:{type:"json",x:"x",y:"y"}}).size(20).color("red").shape(e.key).style({stroke:"#fff",strokeWidth:2});yield e.addLayer(r),yield e.addLayer(i),e.isLoaded=!0;})();}getSourceOption(){let e=this.parent.getSource();return{data:{type:"FeatureCollection",features:this.sourceTile.data.layers.testTile.features},options:{parser:{type:"geojson"},transforms:e.transforms}};}}},d2667e75:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("dbd10968")),a=r._(n("81285970"));class o extends i.default{getServiceConstructor(){return a.default;}}},d26a46d3:function(e,t,n){var r=n("5975dc71"),i=n("f3125f72"),a=n("3d05bb3e"),o=n("b1e98c38"),s=n("4adafcdb");function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1]);}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,e.exports=l;},d283da89:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"getDrawDirection",{enumerable:!0,get:function(){return i;}});var r=n("bfd80e4b");function i(e){return(0,r.getPathArea)(e)>=0;}},d28588fd:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=(0,n("777fffbe")._(n("d465a478")).default)(Object.getPrototypeOf,Object);},d29fda11:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return a;}});var r=n("777fffbe")._(n("494da66d")),i=Array.prototype.splice,a=function(e){var t=this.__data__,n=(0,r.default)(t,e);return!(n<0)&&(n==t.length-1?t.pop():i.call(t,n,1),--this.size,!0);};},d2bdbec4:function(e,t,n){var r=n("cc74f26d"),i=n("5861a980"),a=n("31e26024"),o=n("81c54a07"),s=n("0ea4ba5a"),l=n("5e913e76"),u=r?r.prototype:void 0,c=u?u.valueOf:void 0;e.exports=function(e,t,n,r,u,d,f){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":if(e.byteLength!=t.byteLength||!d(new i(e),new i(t)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return a(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var h=s;case"[object Set]":var p=1&r;if(h||(h=l),e.size!=t.size&&!p)break;var v=f.get(e);if(v)return v==t;r|=2,f.set(e,t);var g=o(h(e),h(t),r,u,d,f);return f.delete(e),g;case"[object Symbol]":if(c)return c.call(e)==c.call(t);}return!1;};},d2dabb01:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"isAnyArray",{enumerable:!0,get:function(){return i;}});let r=Object.prototype.toString;function i(e){let t=r.call(e);return t.endsWith("Array]")&&!t.includes("Big");}},d3006e59:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=n("d9b661b3"),s=r._(n("755bc4f8")),l=n("f717bab4");class u extends s.default{constructor(...e){super(...e),(0,a.default)(this,"texture",void 0),(0,a.default)(this,"earthTime",3.4),(0,a.default)(this,"sunX",1e3),(0,a.default)(this,"sunY",1e3),(0,a.default)(this,"sunZ",1e3),(0,a.default)(this,"sunRadius",Math.sqrt(this.sunX*this.sunX+this.sunY*this.sunY+this.sunZ*this.sunZ));}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,NORMAL:9,UV:10});}getCommonUniformsInfo(){let{animateOption:e,globalOptions:t}=this.layer.getLayerConfig();null!=e&&e.enable&&(this.mapService.rotateY({reg:.002}),this.earthTime+=.02,this.sunY=10,this.sunX=Math.cos(this.earthTime)*(this.sunRadius-this.sunY),this.sunZ=Math.sin(this.earthTime)*(this.sunRadius-this.sunY));let n={u_sunLight:[this.sunX,this.sunY,this.sunZ,0],u_ambientRatio:(null==t?void 0:t.ambientRatio)||.6,u_diffuseRatio:(null==t?void 0:t.diffuseRatio)||.4,u_specularRatio:(null==t?void 0:t.specularRatio)||.1};return this.textures=[this.texture],this.getUniformsBufferInfo(n);}setEarthTime(e){this.earthTime=e,this.sunY=10,this.sunX=Math.cos(this.earthTime)*(this.sunRadius-this.sunY),this.sunZ=Math.sin(this.earthTime)*(this.sunRadius-this.sunY),this.layerService.throttleRenderLayers();}initModels(){var e=this;return(0,i.default)(function*(){let{globalOptions:t}=e.layer.getLayerConfig();(null==t?void 0:t.earthTime)!==void 0&&e.setEarthTime(t.earthTime);let n=e.layer.getSource(),{createTexture2D:r}=e.rendererService;return e.texture=r({height:0,width:0}),n.data.images.then(t=>{e.texture=r({data:t[0],width:t[0].width,height:t[0].height}),e.textures=[e.texture],e.layerService.reRender();}),e.initUniformsBuffer(),e.buildModels();})();}clearModels(){return"";}buildModels(){var e=this;return(0,i.default)(function*(){return e.layer.zIndex=-998,[(yield e.layer.buildLayerModel({moduleName:"earthBase",vertexShader:'// attribute vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\n// attribute vec2 a_Extrude;\n// attribute float a_Size;\n// attribute float a_Shape;\n\nlayout(std140) uniform commonUniforms {\n	vec4 u_sunLight: [1.0, -10.5, 12.0,0.0];\n	float u_ambientRatio : 0.5;\n	float u_diffuseRatio : 0.3;\n	float u_specularRatio : 0.2;\n};\n\n#pragma include "scene_uniforms"\n\nout vec2 v_texCoord;\nout float v_lightWeight;\n\nfloat calc_lighting(vec4 pos) {\n\n	vec3 worldPos = vec3(pos * u_ModelMatrix);\n\n	vec3 worldNormal = a_Normal;\n\n	// cal light weight\n	vec3 viewDir = normalize(u_CameraPosition - worldPos);\n\n	vec3 lightDir = normalize(u_sunLight.xyz);\n\n	vec3 halfDir = normalize(viewDir+lightDir);\n	// lambert\n	float lambert = dot(worldNormal, lightDir);\n	// specular\n	float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);\n	//sum to light weight\n	float lightWeight = u_ambientRatio + u_diffuseRatio * lambert + u_specularRatio * specular;\n\n	return lightWeight;\n}\n\nvoid main() {\n\n	v_texCoord = a_Uv;\n\n	float lightWeight = calc_lighting(vec4(a_Position, 1.0));\n	v_lightWeight = lightWeight;\n\n	gl_Position = u_ViewProjectionMatrix * u_ModelMatrix * vec4(a_Position, 1.0);\n}\n',fragmentShader:"uniform sampler2D u_texture;\n\nin vec2 v_texCoord;\nin float v_lightWeight;\nout vec4 outputColor;\n\nvoid main() {\n    vec4 color = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y));\n    color.xyz = color.xyz * v_lightWeight;\n    outputColor = color;\n}\n",defines:e.getDefines(),triangulation:l.earthTriangulation,depth:{enable:!0},blend:e.getBlend()}))];})();}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:o.AttributeType.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:o.gl.STATIC_DRAW,data:[],type:o.gl.FLOAT},size:3,update:(e,t,n,r,i)=>i}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:o.AttributeType.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:2,update:(e,t,n)=>[n[3],n[4]]}});}}},d320934e:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return _;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("b131ee44")),o=r._(n("f89fb776")),s=r._(n("d812e418")),l=r._(n("6f10f19e")),u=n("d9b661b3"),c=n("fb1ec05a"),d=n("71293cfd"),f=r._(n("d41013ea")),h=r._(n("4f2bad25")),p=n("0e8eb136"),v=n("0f809895"),g=n("cad18bdf");let m=["id","style","minZoom","maxZoom","token","mapInstance","plugin"];!function(e,t){var n="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,r="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram);if(!n&&!r&&(t||(t=document),t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i);}var o=t.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o);}}(`.amap-logo {
  display: none !important;
}

.amap-copyright {
  display: none !important;
}

.amap-overlays {
  z-index: 3 !important;
}
`);let y="f59bcf249433f8b05caaee19f349b3d7";window.forceWebGL=!0;let b={contextmenu:"rightclick",camerachange:"viewchange"};class _ extends f.default{constructor(...e){super(...e),(0,s.default)(this,"viewport",new h.default),(0,s.default)(this,"version",p.MapType.GAODE),(0,s.default)(this,"handleCameraChanged",()=>{let e=this.getViewState();this.updateView(e);});}getType(){return"amap";}init(){var e=this;return(0,o.default)(function*(){let t=e.config,{id:n,style:r="light",minZoom:o=0,maxZoom:s=24,token:u=y,mapInstance:c,plugin:d=[]}=t,f=(0,a.default)(t,m);if(window.AMap||c||(d.push("Map3D"),yield l.default.load({key:u,version:"2.0",plugins:d})),c)e.map=c,e.mapContainer=e.map.getContainer(),e.map.on("viewchange",e.handleCameraChanged);else{let t=(0,i.default)({mapStyle:e.getMapStyleValue(r),zooms:[o,s],viewMode:"3D"},f);if(t.zoom&&(t.zoom+=1),u===y&&(window._AMapSecurityConfig={securityJsCode:"2653011adeb04230b3a26cc9a780a800"},console.warn(`%c${e.configService.getSceneWarninfo("MapToken")}!`,"color: #873bf4;font-weigh:900;font-size: 16px;")),!n)throw Error("No container id specified");window.forceWebGL=!0,e.mapContainer=e.creatMapContainer(n);let a=new AMap.Map(e.mapContainer,t);e.map=a,a.on("viewchange",e.handleCameraChanged);}e.syncInitViewPort();})();}syncInitViewPort(){let e=this.getViewState();this.updateView(e);}getViewState(){let{center:e,zoom:t}=function(e){let t=e._view.getOptions();return{center:t.center,zoom:t.zoom};}(this.map);return{center:e,viewportWidth:this.map.getContainer().clientWidth,viewportHeight:this.map.getContainer().clientHeight,bearing:-this.map.getRotation(),pitch:this.map.getPitch(),zoom:t-1};}creatMapContainer(e){let t=super.creatMapContainer(e),n=document.createElement("div");return n.style.cssText+=`
       position: absolute;
       top: 0;
       height: 100%;
       width: 100%;
     `,n.id=c.lodashUtil.uniqueId("l7_amap_div"),t.appendChild(n),n;}getContainer(){return this.map.getContainer();}addMarkerContainer(){if(!this.map)return;let e=this.map.getContainer();if(null!==e){let t=e.getElementsByClassName("amap-maps")[0];t.style.zIndex="auto",this.markerContainer=c.DOM.create("div","l7-marker-container2",t);}}getMarkerContainer(){return this.markerContainer;}getCanvasOverlays(){var e;return null===(e=this.mapContainer)||void 0===e?void 0:e.querySelector(".amap-overlays");}on(e,t){-1!==u.MapServiceEvent.indexOf(e)?this.eventEmitter.on(e,t):this.map.on(b[e]||e,t);}off(e,t){-1!==u.MapServiceEvent.indexOf(e)?this.eventEmitter.off(e,t):this.map.off(b[e]||e,t);}getSize(){let e=this.map.getSize();return[e.getWidth(),e.getHeight()];}getMinZoom(){return this.map.getZooms()[0]-1;}getMaxZoom(){return this.map.getZooms()[1]-1;}getZoom(){return this.map.getZoom()-1;}getCenter(e){if(null!=e&&e.padding){let t=this.getCenter(),n=(0,v.toPaddingOptions)(e.padding),r=this.lngLatToPixel([t.lng,t.lat]),i=[(n.right-n.left)/2,(n.bottom-n.top)/2];return this.pixelToLngLat([r.x-i[0],r.y-i[1]]);}let t=this.map.getCenter();return{lng:t.getLng(),lat:t.getLat()};}getPitch(){return this.map.getPitch();}getRotation(){return 360-this.map.getRotation();}getBounds(){let e=this.map.getBounds(),t=e.getNorthEast(),n=e.getSouthWest(),r=this.getCenter(),i=r.lng>t.getLng()||r.lng<n.getLng()?180-t.getLng():t.getLng();return[[r.lng<n.getLng()?n.getLng()-180:n.getLng(),n.getLat()],[i,t.getLat()]];}getMapContainer(){return this.mapContainer;}getMapCanvasContainer(){var e;return null===(e=this.map.getContainer())||void 0===e?void 0:e.getElementsByClassName("amap-maps")[0];}getMapStyleConfig(){return g.MapTheme;}getMapStyleValue(e){return this.getMapStyleConfig()[e]||e;}getMapStyle(){return this.map.getMapStyle();}setMapStyle(e){this.map.setMapStyle(this.getMapStyleValue(e));}setRotation(e){return this.map.setRotation(e);}zoomIn(){this.map.zoomIn();}zoomOut(){this.map.zoomOut();}panTo(e){this.map.panTo(e);}panBy(e=0,t=0){this.map.panBy(e,t);}fitBounds(e){this.map.setBounds(new AMap.Bounds([e[0][0],e[0][1],e[1][0],e[1][1]]),!0);}setZoomAndCenter(e,t){this.map.setZoomAndCenter(e+1,t);}setCenter(e,t){if(null!=t&&t.padding){let n=(0,v.toPaddingOptions)(t.padding),r=this.lngLatToPixel(e),i=[(n.right-n.left)/2,(n.bottom-n.top)/2],a=this.pixelToLngLat([r.x+i[0],r.y+i[1]]);this.map.setCenter([a.lng,a.lat]);}else this.map.setCenter(e);}setPitch(e){return this.map.setPitch(e);}setZoom(e){return this.map.setZoom(e+1);}setMaxZoom(e){throw Error("Method not implemented.");}setMinZoom(e){throw Error("Method not implemented.");}setMapStatus(e){this.map.setStatus(e);}meterToCoord(e,t){let n=AMap.GeometryUtil.distance(new AMap.LngLat(...e),new AMap.LngLat(...t)),[r,i]=(0,c.amap2Project)(...e),[a,o]=(0,c.amap2Project)(...t);return Math.sqrt(Math.pow(r-a,2)+Math.pow(i-o,2))/n;}pixelToLngLat(e){let t=this.map.pixelToLngLat(new AMap.Pixel(e[0],e[1]));return{lng:t.getLng(),lat:t.getLat()};}lngLatToPixel(e){let t=this.map.lnglatToPixel(e);return{x:t.getX(),y:t.getY()};}containerToLngLat(e){let t=new AMap.Pixel(e[0],e[1]),n=this.map.containerToLngLat(t);return{lng:null==n?void 0:n.getLng(),lat:null==n?void 0:n.getLat()};}lngLatToContainer(e){let t=this.map.lngLatToContainer(e);return{x:t.getX(),y:t.getY()};}lngLatToMercator([e,t],n){let[r,i]=(0,c.amap2Project)(e,t);return{x:r,y:i,z:n};}getModelMatrix(e,t,n,r=[1,1,1]){let i=this.viewport.projectFlat(e),a=d.mat4.create();return d.mat4.translate(a,a,d.vec3.fromValues(i[0],i[1],t)),d.mat4.scale(a,a,d.vec3.fromValues(r[0],r[1],r[2])),d.mat4.rotateX(a,a,n[0]),d.mat4.rotateY(a,a,n[1]),d.mat4.rotateZ(a,a,n[2]),a;}exportMap(e){var t;let n=null===(t=this.getContainer())||void 0===t?void 0:t.getElementsByClassName("amap-layer")[0];return"jpg"===e?null==n?void 0:n.toDataURL("image/jpeg"):null==n?void 0:n.toDataURL("image/png");}destroy(){var e;super.destroy(),null===(e=this.mapContainer)||void 0===e||null===(e=e.parentNode)||void 0===e||e.removeChild(this.mapContainer),delete window.initAMap;let t=document.getElementById("amap-script");t&&document.head.removeChild(t),this.map.destroy();}}},d34a8369:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"scanSegment",{enumerable:!0,get:function(){return d;}});var r=n("9bb662e6"),i=n("383ce26f"),a=n("396286a4"),o=n("638df17c"),s=n("4b858df8"),l=n("5b973812"),u=n("af11c929"),c=n("b3f83c26");function d(e){var t=e.max,n=e.pathValue,d=e.index,f=n.charCodeAt(d),h=i.paramsCount[n[d].toLowerCase()];if(e.segmentStart=d,!(0,l.isPathCommand)(f)){e.err='[path-util]: Invalid path value "'.concat(n[d],'" is not a path command');return;}if(e.index+=1,(0,s.skipSpaces)(e),e.data=[],!h){(0,r.finalizeSegment)(e);return;}for(;;){for(var p=h;p>0;p-=1){if((0,c.isArcCommand)(f)&&(3===p||4===p)?(0,a.scanFlag)(e):(0,o.scanParam)(e),e.err.length)return;e.data.push(e.param),(0,s.skipSpaces)(e),e.index<t&&44===n.charCodeAt(e.index)&&(e.index+=1,(0,s.skipSpaces)(e));}if(e.index>=e.max||!(0,u.isDigitStart)(n.charCodeAt(e.index)))break;}(0,r.finalizeSegment)(e);}},d3b4f9a2:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("a9c461d6")),i=function(e,t){var n=(0,r.default)(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this;};},d3ed11ba:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){return void 0===e;};},d41013ea:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe")._(n("d812e418")),i=n("d9b661b3"),a=n("f86d399e"),o=n("570a7fd1");class s{constructor(e){(0,r.default)(this,"map",void 0),(0,r.default)(this,"simpleMapCoord",new o.SimpleMapCoord),(0,r.default)(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),(0,r.default)(this,"config",void 0),(0,r.default)(this,"configService",void 0),(0,r.default)(this,"coordinateSystemService",void 0),(0,r.default)(this,"eventEmitter",void 0),(0,r.default)(this,"markerContainer",void 0),(0,r.default)(this,"mapContainer",void 0),(0,r.default)(this,"cameraChangedCallback",void 0),this.config=e.mapConfig,this.configService=e.globalConfigService,this.coordinateSystemService=e.coordinateSystemService,this.eventEmitter=new a.EventEmitter;}onCameraChanged(e){this.cameraChangedCallback=e;}updateView(e){var t;this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:e.bearing,center:e.center,viewportHeight:e.viewportHeight,pitch:e.pitch,viewportWidth:e.viewportWidth,zoom:e.zoom}),this.updateCoordinateSystemService(),null===(t=this.cameraChangedCallback)||void 0===t||t.call(this,this.viewport);}updateCoordinateSystemService(){let{offsetCoordinate:e=!0}=this.config;this.viewport.getZoom()>12&&e?this.coordinateSystemService.setCoordinateSystem(i.CoordinateSystem.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(i.CoordinateSystem.LNGLAT);}creatMapContainer(e){return"string"==typeof e?document.getElementById(e):e;}getMapStyleValue(e){var t;return null!==(t=this.getMapStyleConfig()[e])&&void 0!==t?t:e;}setBgColor(e){this.bgColor=e;}getMapContainer(){return this.mapContainer;}getMarkerContainer(){return this.markerContainer;}getOverlayContainer(){}getCanvasOverlays(){}emit(e,...t){this.eventEmitter.emit(e,...t);}once(e,t){this.eventEmitter.once(e,t);}meterToCoord(e,t){return 1;}destroy(){this.eventEmitter.removeAllListeners();}}},d42d4d7a:function(e,t,n){var r=n("7ad58a24"),i=n("ea7bb476"),a=n("31ebf18c");e.exports=function(e){return function(t,n,o){return o&&"number"!=typeof o&&i(t,n,o)&&(n=o=void 0),t=a(t),void 0===n?(n=t,t=0):n=a(n),o=void 0===o?t<n?1:-1:a(o),r(t,n,o,e);};};},d438c68f:function(e,t,n){var r=Object.prototype.hasOwnProperty;e.exports=function(e,t){return null!=e&&r.call(e,t);};},d4539838:function(e,t,n){"use strict";var r=n("ce906886"),i=n("092f4a86");e.exports={run:function(e){var t,n,a,o="greedy"===e.graph().acyclicer?i(e,function(t){return e.edge(t).weight;}):(t=[],n={},a={},r.forEach(e.nodes(),function i(o){r.has(a,o)||(a[o]=!0,n[o]=!0,r.forEach(e.outEdges(o),function(e){r.has(n,e.w)?t.push(e):i(e.w);}),delete n[o]);}),t);r.forEach(o,function(t){var n=e.edge(t);e.removeEdge(t),n.forwardName=t.name,n.reversed=!0,e.setEdge(t.w,t.v,n,r.uniqueId("rev"));});},undo:function(e){r.forEach(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r);}});}};},d45a39b7:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("6ebbe753")),i=function(){this.__data__=new r.default,this.size=0;};},d465a478:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e,t){return function(n){return e(t(n));};};},d4fd229c:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("9d065c04"),i=function(e,t){var n=(0,r.useRef)(void 0);(0,r.useEffect)(function(){var r,i=(r=n.current)?r.map(function(e,n){return Object.is(r[n],null==t?void 0:t[n])?-1:n;}).filter(function(e){return e>=0;}):t?t.map(function(e,t){return t;}):[],a=n.current;return n.current=t,e(i,a,t);},t);};},d50110f4:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"HandlerManager",{enumerable:!0,get:function(){return L;}});var r=n("777fffbe"),i=r._(n("d812e418")),a=r._(n("be334174")),o=n("5aa23130"),s=n("2268cb10"),l=n("26c960bc"),u=n("c6607ac6"),c=n("cca3484a"),d=n("73c8c35c"),f=n("a0767c5f"),h=n("0078e0f4"),p=n("a4875846"),v=n("92215959"),g=n("38de6db6"),m=n("3c9d1159"),y=n("2db08bc9"),b=n("f945577b"),_=n("82438925"),x=n("b684c672"),w=n("262c4dce"),E=n("e31a659c"),M=n("b448a57d"),S=n("f9562c3c");let k=e=>e.zoom||e.drag||e.pitch||e.rotate;class C extends M.Event{constructor(e,t){super(e),(0,i.default)(this,"type","renderFrame"),(0,i.default)(this,"timeStamp",void 0),this.timeStamp=t;}}function A(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta;}class L{constructor(e,t){(0,i.default)(this,"_map",void 0),(0,i.default)(this,"_el",void 0),(0,i.default)(this,"_handlers",void 0),(0,i.default)(this,"_eventsInProgress",void 0),(0,i.default)(this,"_frameId",void 0),(0,i.default)(this,"_inertia",void 0),(0,i.default)(this,"_bearingSnap",void 0),(0,i.default)(this,"_handlersById",void 0),(0,i.default)(this,"_updatingCamera",void 0),(0,i.default)(this,"_changes",void 0),(0,i.default)(this,"_zoom",void 0),(0,i.default)(this,"_previousActiveHandlers",void 0),(0,i.default)(this,"_listeners",void 0),(0,i.default)(this,"handleWindowEvent",e=>{this.handleEvent(e,`${e.type}Window`);}),(0,i.default)(this,"handleEvent",(e,t)=>{if("blur"===e.type){this.stop(!0);return;}this._updatingCamera=!0;let n="renderFrame"===e.type?void 0:e,r={needsRenderFrame:!1},i={},a={},o=e.touches,s=o?this._getMapTouches(o):void 0,l=s?E.DOM.touchPos(this._map.getCanvasContainer(),s):E.DOM.mousePos(this._map.getCanvasContainer(),e);for(let{handlerName:o,handler:u,allowed:c}of this._handlers){let d;u.isEnabled()&&(this._blockedByActive(a,c,o)?u.reset():u[t||e.type]&&(d=u[t||e.type](e,l,s),this.mergeHandlerResult(r,i,d,o,n),d&&d.needsRenderFrame&&this._triggerRenderFrame()),(d||u.isActive())&&(a[o]=u));}let u={};for(let e in this._previousActiveHandlers)a[e]||(u[e]=n);this._previousActiveHandlers=a,(Object.keys(u).length||A(r))&&(this._changes.push([r,i,u]),this._triggerRenderFrame()),(Object.keys(a).length||A(r))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:c}=r;c&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],c(this._map));}),this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new x.HandlerInertia(e),this._bearingSnap=t.bearingSnap||7,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(t);let n=this._el;for(let[e,t,r]of(this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[window,"blur",void 0]],this._listeners))E.DOM.addEventListener(e,t,e===document?this.handleWindowEvent:this.handleEvent,r);}destroy(){for(let[e,t,n]of this._listeners)E.DOM.removeEventListener(e,t,e===document?this.handleWindowEvent:this.handleEvent,n);}_addDefaultHandlers(e){let t=this._map,n=t.getCanvasContainer();this._add("mapEvent",new c.MapEventHandler(t,e));let r=t.boxZoom=new o.BoxZoomHandler(t,e);this._add("boxZoom",r),e.interactive&&e.boxZoom&&r.enable();let i=t.cooperativeGestures=new l.CooperativeGesturesHandler(t,e.cooperativeGestures);this._add("cooperativeGestures",i),e.cooperativeGestures&&i.enable();let a=new y.TapZoomHandler(t),x=new s.ClickZoomHandler(t);t.doubleClickZoom=new h.DoubleClickZoomHandler(x,a),this._add("tapZoom",a),this._add("clickZoom",x),e.interactive&&e.doubleClickZoom&&t.doubleClickZoom.enable();let w=new m.TapDragZoomHandler;this._add("tapDragZoom",w);let E=t.touchPitch=new _.TwoFingersTouchPitchHandler(t);this._add("touchPitch",E),e.interactive&&e.touchPitch&&t.touchPitch.enable(e.touchPitch);let M=(0,d.generateMouseRotationHandler)(e),S=(0,d.generateMousePitchHandler)(e);t.dragRotate=new v.DragRotateHandler(e,M,S),this._add("mouseRotate",M,["mousePitch"]),this._add("mousePitch",S,["mouseRotate"]),e.interactive&&e.dragRotate&&t.dragRotate.enable();let k=(0,d.generateMousePanHandler)(e),C=new b.TouchPanHandler(e,t);t.dragPan=new p.DragPanHandler(n,k,C),this._add("mousePan",k),this._add("touchPan",C,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&t.dragPan.enable(e.dragPan);let A=new _.TwoFingersTouchRotateHandler,L=new _.TwoFingersTouchZoomHandler;t.touchZoomRotate=new g.TwoFingersTouchZoomRotateHandler(n,L,A,w),this._add("touchRotate",A,["touchPan","touchZoom"]),this._add("touchZoom",L,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&t.touchZoomRotate.enable(e.touchZoomRotate);let P=t.scrollZoom=new f.ScrollZoomHandler(t,()=>this._triggerRenderFrame());this._add("scrollZoom",P,["mousePan"]),e.interactive&&e.scrollZoom&&t.scrollZoom.enable(e.scrollZoom);let N=t.keyboard=new u.KeyboardHandler(t);this._add("keyboard",N),e.interactive&&e.keyboard&&t.keyboard.enable(),this._add("blockableMapEvent",new c.BlockableMapEventHandler(t));}_add(e,t,n){this._handlers.push({handlerName:e,handler:t,allowed:n}),this._handlersById[e]=t;}stop(e){if(!this._updatingCamera){for(let{handler:e}of this._handlers)e.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[];}}isActive(){for(let{handler:e}of this._handlers)if(e.isActive())return!0;return!1;}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming();}isRotating(){return!!this._eventsInProgress.rotate;}isMoving(){return!!k(this._eventsInProgress)||this.isZooming();}_blockedByActive(e,t,n){for(let r in e)if(r!==n&&(!t||0>t.indexOf(r)))return!0;return!1;}_getMapTouches(e){let t=[];for(let n of e){let e=n.target;this._el.contains(e)&&t.push(n);}return t;}mergeHandlerResult(e,t,n,r,i){if(!n)return;(0,S.extend)(e,n);let a={handlerName:r,originalEvent:n.originalEvent||i};void 0!==n.zoomDelta&&(t.zoom=a),void 0!==n.panDelta&&(t.drag=a),void 0!==n.pitchDelta&&(t.pitch=a),void 0!==n.bearingDelta&&(t.rotate=a);}_applyChanges(){let e={},t={},n={};for(let[r,i,o]of this._changes)r.panDelta&&(e.panDelta=(e.panDelta||new a.default(0,0))._add(r.panDelta)),r.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+r.zoomDelta),r.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+r.bearingDelta),r.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+r.pitchDelta),void 0!==r.around&&(e.around=r.around),void 0!==r.pinchAround&&(e.pinchAround=r.pinchAround),r.noInertia&&(e.noInertia=r.noInertia),(0,S.extend)(t,i),(0,S.extend)(n,o);this._updateMapTransform(e,t,n),this._changes=[];}_updateMapTransform(e,t,n){let r=this._map,i=r._getTransformForUpdate();if(!A(e))return this._fireEvents(t,n,!0);let{panDelta:a,zoomDelta:o,bearingDelta:s,pitchDelta:l,pinchAround:u}=e,{around:c}=e;void 0!==u&&(c=u),r._stop(!0),c=c||r.transform.centerPoint;let d=i.pointLocation(a?c.sub(a):c);s&&(i.bearing+=s),l&&(i.pitch+=l),o&&(i.zoom+=o),i.setLocationAtPoint(d,c),r._applyUpdatedTransform(i),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(t,n,!0);}_fireEvents(e,t,n){let r;let i=k(this._eventsInProgress),a=k(e),o={};for(let t in e){let{originalEvent:n}=e[t];this._eventsInProgress[t]||(o[`${t}start`]=n),this._eventsInProgress[t]=e[t];}for(let e in!i&&a&&this._fireEvent("movestart",a.originalEvent),o)this._fireEvent(e,o[e]);for(let t in a&&this._fireEvent("move",a.originalEvent),e){let{originalEvent:n}=e[t];this._fireEvent(t,n);}let s={};for(let e in this._eventsInProgress){let{handlerName:n,originalEvent:i}=this._eventsInProgress[e];this._handlersById[n].isActive()||(delete this._eventsInProgress[e],r=t[n]||i,s[`${e}end`]=r);}for(let e in s)this._fireEvent(e,s[e]);let l=k(this._eventsInProgress),u=(i||a)&&!l;if(n&&u){this._updatingCamera=!0;let e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions);if(e&&(e.essential||!w.browser.prefersReducedMotion)){let t;0!==(t=e.bearing||this._map.getBearing())&&-this._bearingSnap<t&&t<this._bearingSnap&&(e.bearing=0),e.freezeElevation=!0,this._map.easeTo(e,{originalEvent:r});}else{let e;this._map.fire(new M.Event("moveend",{originalEvent:r})),0!==(e=this._map.getBearing())&&-this._bearingSnap<e&&e<this._bearingSnap&&this._map.resetNorth();}this._updatingCamera=!1;}}_fireEvent(e,t){this._map.fire(new M.Event(e,t?{originalEvent:t}:{}));}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new C("renderFrame",e)),this._applyChanges();});}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame());}}},d5217792:function(e,t,n){e.exports=function(){return!1;};},d57bce82:function(e,t,n){var r=n("65974307"),i=n("d18fbaa5"),a=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,s=o?function(e){return null==e?[]:r(o(e=Object(e)),function(t){return a.call(e,t);});}:i;e.exports=s;},d59953b5:function(e,t,n){var r=n("6e3a9823"),i=n("7c1db5f7");e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t;};},d5f60c89:function(e,t,n){var r=n("f10a19cc"),i=n("0040cd97"),a=n("1f86664c");e.exports=function(e,t,n){for(var o=-1,s=t.length,l={};++o<s;){var u=t[o],c=r(e,u);n(c,u)&&i(l,a(u,e),c);}return l;};},d5fb2cc8:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("0c1d8df4");},d6849795:function(e,t,n){var r=n("481b6514");e.exports=function(e,t){return function(n,i){if(null==n)return n;if(!r(n))return e(n,i);for(var a=n.length,o=t?a:-1,s=Object(n);(t?o--:++o<a)&&!1!==i(s[o],o,s););return n;};};},d6947c32:function(e,t,n){"use strict";function r(e,t){var n=e[0],r=t.x1,i=t.y1,a=t.x2,o=t.y2,s=e.slice(1).map(Number),l=e;if("TQ".includes(n)||(t.qx=null,t.qy=null),"H"===n)l=["L",e[1],i];else if("V"===n)l=["L",r,e[1]];else if("S"===n){var u=2*r-a,c=2*i-o;t.x1=u,t.y1=c,l=["C",u,c].concat(s);}else if("T"===n){var d=2*r-t.qx,f=2*i-t.qy;t.qx=d,t.qy=f,l=["Q",d,f].concat(s);}else if("Q"===n){var h=s[0],p=s[1];t.qx=h,t.qy=p;}return l;}n.d(t,"__esModule",{value:!0}),n.d(t,"normalizeSegment",{enumerable:!0,get:function(){return r;}});},d72829b5:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("d812e418")),o=n("fb1ec05a"),s=n("f86d399e");class l extends s.EventEmitter{getMarkerLayerContainerSize(){}constructor(e){super(),(0,a.default)(this,"markerOption",void 0),(0,a.default)(this,"popup",void 0),(0,a.default)(this,"mapsService",void 0),(0,a.default)(this,"lngLat",void 0),(0,a.default)(this,"scene",void 0),(0,a.default)(this,"added",!1),(0,a.default)(this,"preLngLat",{lng:0,lat:0}),(0,a.default)(this,"onMarkerDragStart",e=>{let t=this.mapsService.getContainer();if(!t)return;this.mapsService.setMapStatus({dragEnable:!1,zoomEnable:!1});let{left:n,top:r}=t.getClientRects()[0],{x:i,y:a}=e;this.preLngLat=this.mapsService.containerToLngLat([i-n,a-r]),this.mapsService.on("mousemove",this.onMarkerDragMove),document.addEventListener("mouseup",this.onMarkerDragEnd),this.emit("dragstart",this.lngLat);}),(0,a.default)(this,"onMarkerDragMove",e=>{let t=e.lngLat||e.lnglat,{lng:n,lat:r}=this.preLngLat,{lng:i,lat:a}=t,o={lng:this.lngLat.lng+i-n,lat:this.lngLat.lat+a-r};this.setLnglat(o),this.preLngLat=t,this.emit("dragging",o);}),(0,a.default)(this,"onMarkerDragEnd",()=>{this.mapsService.setMapStatus({dragEnable:!0,zoomEnable:!0}),this.mapsService.off("mousemove",this.onMarkerDragMove),document.removeEventListener("mouseup",this.onMarkerDragEnd),this.emit("dragend",this.lngLat);}),(0,a.default)(this,"eventHandle",e=>{this.polyfillEvent(e),this.emit(e.type,{target:e,data:this.markerOption.extData,lngLat:this.lngLat});}),(0,a.default)(this,"touchStartTime",void 0),this.markerOption=(0,i.default)((0,i.default)({},this.getDefault()),e),(0,o.bindAll)(["update","onMove","onMapClick","updatePositionWhenZoom"],this),this.init();}getDefault(){return{element:void 0,anchor:o.anchorType.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1,overflowHide:!0};}addTo(e){this.scene=e,this.mapsService=e.mapService;let{element:t}=this.markerOption;return this.mapsService.getMarkerContainer().appendChild(t),this.registerMarkerEvent(t),this.mapsService.on("camerachange",this.update),this.update(),this.updateDraggable(),this.added=!0,this.emit("added"),this;}remove(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("camerachange",this.update)),this.unRegisterMarkerEvent(),this.removeAllListeners();let{element:e}=this.markerOption;return e&&o.DOM.remove(e),this.popup&&this.popup.remove(),this;}setLnglat(e){return this.lngLat=e,Array.isArray(e)&&(this.lngLat={lng:e[0],lat:e[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this;}getLnglat(){return this.lngLat;}getElement(){return this.markerOption.element;}setElement(e){if(!this.added)return this.once("added",()=>{this.setElement(e);}),this;let{element:t}=this.markerOption;return t&&o.DOM.remove(t),this.markerOption.element=e,this.init(),this.mapsService.getMarkerContainer().appendChild(e),this.registerMarkerEvent(e),this.updateDraggable(),this.update(),this;}openPopup(){if(!this.added)return this.once("added",()=>{this.openPopup();}),this;let e=this.popup;return e&&(e.isOpen()||e.addTo(this.scene)),this;}closePopup(){this.added||this.once("added",()=>{this.closePopup();});let e=this.popup;return e&&e.remove(),this;}setPopup(e){return this.popup=e,this.lngLat&&this.popup.setLnglat(this.lngLat),this;}togglePopup(){let e=this.popup;return e&&(e.isOpen()?e.remove():e.addTo(this.scene)),this;}getPopup(){return this.popup;}getOffset(){return this.markerOption.offsets;}setDraggable(e){this.markerOption.draggable=e,this.updateDraggable();}getDraggable(){return this.markerOption.draggable;}getExtData(){return this.markerOption.extData;}setExtData(e){this.markerOption.extData=e;}update(){if(!this.mapsService)return;let{element:e,anchor:t}=this.markerOption;this.updatePosition(),o.DOM.setTransform(e,`${o.anchorTranslate[t]}`);}updatePositionWhenZoom(e){if(!this.mapsService)return;let{element:t,offsets:n}=this.markerOption,{lng:r,lat:i}=this.lngLat;if(t){t.style.display="block",t.style.whiteSpace="nowrap";let{containerHeight:a,containerWidth:o,bounds:s}=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize();if(!s)return;let l=e.map,u=e.center,c=e.zoom,d=l.DE(this.lngLat,c,u);if(d.x=Math.round(d.x+n[0]),d.y=Math.round(d.y-n[1]),Math.abs(s[0][0])>180||Math.abs(s[1][0])>180){if(d.x>o){let e=this.mapsService.lngLatToContainer([r-360,i]);d.x=e.x;}if(d.x<0){let e=this.mapsService.lngLatToContainer([r+360,i]);d.x=e.x;}}(d.x>o||d.x<0||d.y>a||d.y<0)&&(t.style.display="none"),t.style.left=d.x+"px",t.style.top=d.y+"px",t.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)";}}onMapClick(e){let{element:t}=this.markerOption;this.popup&&t&&this.togglePopup();}getCurrentContainerSize(){let e=this.mapsService.getContainer();return{containerHeight:(null==e?void 0:e.scrollHeight)||0,containerWidth:(null==e?void 0:e.scrollWidth)||0,bounds:this.mapsService.getBounds()};}updateDraggable(){let{element:e}=this.markerOption;null==e||e.removeEventListener("mousedown",this.onMarkerDragStart),this.mapsService.off("mousemove",this.onMarkerDragMove),document.removeEventListener("mouseup",this.onMarkerDragEnd),this.markerOption.draggable&&(null==e||e.addEventListener("mousedown",this.onMarkerDragStart));}updatePosition(){if(!this.mapsService)return;let{element:e,offsets:t}=this.markerOption,{lng:n,lat:r}=this.lngLat,i=this.mapsService.lngLatToContainer([n,r]);if(e){e.style.display="block",e.style.whiteSpace="nowrap";let{containerHeight:a,containerWidth:o,bounds:s}=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize();if(!s)return;if(Math.abs(s[0][0])>180||Math.abs(s[1][0])>180){if(i.x>o){let e=this.mapsService.lngLatToContainer([n-360,r]);i.x=e.x;}if(i.x<0){let e=this.mapsService.lngLatToContainer([n+360,r]);i.x=e.x;}}this.markerOption.overflowHide&&(i.x>o||i.x<0||i.y>a||i.y<0)&&(e.style.display="none"),e.style.left=i.x+t[0]+"px",e.style.top=i.y-t[1]+"px";}}init(){let{element:e}=this.markerOption,{color:t,anchor:n}=this.markerOption;if(!e){e=o.DOM.create("div"),this.markerOption.element=e;let n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height","48px"),n.setAttributeNS(null,"width","48px"),n.setAttributeNS(null,"viewBox","0 0 1024 1024");let r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),r.setAttributeNS(null,"fill",t),n.appendChild(r),e.appendChild(n);}o.DOM.addClass(e,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(t=>{var n,r;let i=(null===(n=this.markerOption)||void 0===n?void 0:n.style)&&(null===(r=this.markerOption)||void 0===r?void 0:r.style[t]);e&&(e.style[t]=i);}),(0,o.applyAnchorClass)(e,n,"marker");}registerMarkerEvent(e){e.addEventListener("click",this.onMapClick),e.addEventListener("mousemove",this.eventHandle),e.addEventListener("click",this.eventHandle),e.addEventListener("mousedown",this.eventHandle),e.addEventListener("mouseup",this.eventHandle),e.addEventListener("dblclick",this.eventHandle),e.addEventListener("contextmenu",this.eventHandle),e.addEventListener("mouseover",this.eventHandle),e.addEventListener("mouseout",this.eventHandle),e.addEventListener("touchstart",this.eventHandle),e.addEventListener("touchend",this.eventHandle);}unRegisterMarkerEvent(){let e=this.getElement();e.removeEventListener("click",this.onMapClick),e.removeEventListener("mousemove",this.eventHandle),e.removeEventListener("click",this.eventHandle),e.removeEventListener("mousedown",this.eventHandle),e.removeEventListener("mouseup",this.eventHandle),e.removeEventListener("dblclick",this.eventHandle),e.removeEventListener("contextmenu",this.eventHandle),e.removeEventListener("mouseover",this.eventHandle),e.removeEventListener("mouseout",this.eventHandle),e.removeEventListener("touchstart",this.eventHandle),e.removeEventListener("touchend",this.eventHandle);}polyfillEvent(e){this.mapsService&&"amap"===this.mapsService.getType()&&!(0,o.isPC)()&&("touchstart"===e.type&&(this.touchStartTime=Date.now()),"touchend"===e.type&&Date.now()-this.touchStartTime<300&&this.emit("click",{target:e,data:this.markerOption.extData,lngLat:this.lngLat}));}addDragHandler(e){return null;}onUp(e){throw Error("Method not implemented.");}}},d75116b0:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"CanvasModel",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=r._(n("755bc4f8")),s=n("909eb2d3"),l=n("fd3c1e7f");class u extends o.default{constructor(...e){super(...e),(0,a.default)(this,"canvas",null),(0,a.default)(this,"ctx",void 0),(0,a.default)(this,"ctxType",void 0),(0,a.default)(this,"viewportSize",void 0),(0,a.default)(this,"initCanvas",()=>{var e,t,n,r,i;let{zIndex:a,getContext:o}=this.layerConfig,s=document.createElement("canvas"),u=this.layer.getModelType();this.canvas=s,s.classList.add("l7-canvas-layer"),s.style.position="absolute",s.style.top="0",s.style.left="0",s.style.zIndex=String(a),this.resetCanvasSize();let c=null!==(e=null===(t=(n=this.mapService).getCanvasOverlays)||void 0===t?void 0:t.call(n))&&void 0!==e?e:null===(r=(i=this.mapService).getMapCanvasContainer)||void 0===r?void 0:r.call(i);null==c||c.appendChild(s),this.ctx=o?o(s):s.getContext(l.CanvasContextTypeMap[u]),this.ctx||console.error("Failed to get rendering context for canvas"),this.bindListeners();}),(0,a.default)(this,"resetViewportSize",()=>{let{width:e,height:t}=this.rendererService.getViewportSize();this.viewportSize=[e,t];}),(0,a.default)(this,"resetCanvasSize",()=>{let e=this.canvas;if(!e)return;this.resetViewportSize();let[t,n]=this.mapService.getSize(),[r,i]=this.viewportSize;e.width=r,e.height=i,e.style.width=t+"px",e.style.height=n+"px";}),(0,a.default)(this,"renderCanvas",()=>{var e;this.canvas||this.initCanvas();let{draw:t,drawingOnCanvas:n}=this.layerConfig,[r,i]=this.viewportSize,a=this.mapService.getBounds();null===(e=null!=t?t:n)||void 0===e||e({canvas:this.canvas,ctx:this.ctx,container:{width:r,height:i,bounds:a},size:[r,i],utils:{lngLatToContainer:this.lngLatToContainer},mapService:this.mapService});}),(0,a.default)(this,"removeCanvas",()=>{if(this.canvas){var e;null===(e=this.canvas.parentElement)||void 0===e||e.removeChild(this.canvas),this.canvas=null;}this.unbindListeners();}),(0,a.default)(this,"onMapResize",()=>{requestAnimationFrame(()=>{this.resetCanvasSize(),this.renderCanvas();});}),(0,a.default)(this,"lngLatToContainer",e=>{let{x:t,y:n}=this.mapService.lngLatToContainer(e);return{x:t*window.devicePixelRatio,y:n*window.devicePixelRatio};});}get layerConfig(){return this.layer.getLayerConfig();}initModels(){var e=this;return(0,i.default)(function*(){return e.renderCanvas(),[];})();}bindListeners(){this.mapService.on("resize",this.onMapResize);let{trigger:e,update:t}=this.layerConfig;t===s.CanvasUpdateType.ALWAYS||"change"===e?this.mapService.on("mapchange",this.renderCanvas):(this.mapService.on("zoomstart",this.removeCanvas),this.mapService.on("zoomend",this.renderCanvas),this.mapService.on("movestart",this.removeCanvas),this.mapService.on("moveend",this.renderCanvas));}unbindListeners(){this.mapService.off("resize",this.onMapResize),this.mapService.off("mapchange",this.renderCanvas),this.mapService.off("zoomstart",this.removeCanvas),this.mapService.off("zoomend",this.renderCanvas),this.mapService.off("movestart",this.removeCanvas),this.mapService.off("moveend",this.renderCanvas);}registerBuiltinAttributes(){}}},d781f976:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("fe2236de")),a=r._(n("d28588fd")),o=r._(n("beff956c")),s=r._(n("b1c21490")),l=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)(0,i.default)(t,(0,o.default)(e)),e=(0,a.default)(e);return t;}:s.default;},d7dbbb4d:function(e,t,n){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t;};},d85ce7f8:function(e,t,n){},d875ee61:function(e,t,n){var r=n("d42d4d7a")();e.exports=r;},d8b05ce3:function(e,t,n){var r=n("ce906886");e.exports=function(e,t){return r.map(t,function(t){var n=e.inEdges(t);if(!n.length)return{v:t};var i=r.reduce(n,function(t,n){var r=e.edge(n),i=e.node(n.v);return{sum:t.sum+r.weight*i.order,weight:t.weight+r.weight};},{sum:0,weight:0});return{v:t,barycenter:i.sum/i.weight,weight:i.weight};});};},d8c0cd4a:function(e,t,n){"use strict";function r(e){return e[2];}function i(e){return arguments.length?(this._z=e,this):this._z;}n.d(t,"__esModule",{value:!0}),n.e(t,{default:function(){return i;},defaultZ:function(){return r;}});},d9782b0d:function(e,t,n){var r=n("df9a72ce");e.exports=function(e,t){return e&&e.length&&t&&t.length?r(e,t):e;};},d9d6a854:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("d1751d7c")._(n("477f9224"),t);},da378b41:function(e,t,n){"use strict";function r(e){if(isNaN(a=+this._x.call(null,e)))return this;var t,n,r,i,a,o,s,l,u,c=this._root,d=this._x0,f=this._x1;if(!c)return this;if(c.length)for(;;){if((s=a>=(o=(d+f)/2))?d=o:f=o,t=c,!(c=c[l=+s]))return this;if(!c.length)break;t[l+1&1]&&(n=t,u=l);}for(;c.data!==e;)if(r=c,!(c=c.next))return this;return((i=c.next)&&delete c.next,r)?i?r.next=i:delete r.next:t?(i?t[l]=i:delete t[l],(c=t[0]||t[1])&&c===(t[1]||t[0])&&!c.length&&(n?n[u]=c:this._root=c)):this._root=i,this;}function i(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this;}n.d(t,"__esModule",{value:!0}),n.e(t,{default:function(){return r;},removeAll:function(){return i;}});},da50efcc:function(e,t,n){var r=n("271c9ad5"),i=n("32f27622"),a=n("f24cd761");e.exports=function(e,t){return e&&e.length?r(e,i(t,2),a):void 0;};},dbd10968:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("d812e418"));class o{constructor(e){(0,a.default)(this,"configService",void 0),(0,a.default)(this,"config",void 0),this.config=e;}setContainer(e,t){this.configService=e.globalConfigService,e.mapConfig=(0,i.default)((0,i.default)({},this.config),{},{id:t}),e.mapService=new(this.getServiceConstructor())(e);}getServiceConstructor(){throw Error("Method not implemented.");}}},dc323adb:function(e,t,n){var r=n("d038e143"),i=n("481b6514");e.exports=function(e,t){var n=-1,a=i(e)?Array(e.length):[];return r(e,function(e,r,i){a[++n]=t(e,r,i);}),a;};},dc6ae360:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("933e3867"),n("71ba123c");},dd127df2:function(e,t,n){var r=n("ed2bf8a3"),i=n("3036e156"),a=n("95baa305");e.exports=function(e,t){var n,o=new i,s={},l=new a;function u(e){var r=e.v===n?e.w:e.v,i=l.priority(r);if(void 0!==i){var a=t(e);a<i&&(s[r]=n,l.decrease(r,a));}}if(0===e.nodeCount())return o;r.each(e.nodes(),function(e){l.add(e,Number.POSITIVE_INFINITY),o.setNode(e);}),l.decrease(e.nodes()[0],0);for(var c=!1;l.size()>0;){if(n=l.removeMin(),r.has(s,n))o.setEdge(n,s[n]);else if(c)throw Error("Input graph is not connected: "+e);else c=!0;e.nodeEdges(n).forEach(u);}return o;};},dd837acc:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("a684d625")),a=r._(n("beff956c")),o=r._(n("33ea99bb")),s=function(e){return(0,i.default)(e,o.default,a.default);};},dd879316:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("b6081162")),i=function(e){return(0,r.default)(e,"Boolean");};},ddd1eef0:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"HeatmapLayer",{enumerable:!0,get:function(){return r.HeatmapLayer;}});var r=n("f42269e5");},ddf11daa:function(e,t,n){var r=n("52e00352")();e.exports=r;},decf5ea9:function(e,t,n){e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t];};},df18c8e8:function(e,t,n){e.exports=function(e){return function(){return e;};};},df63ef95:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"equalizeSegments",{enumerable:!0,get:function(){return function e(t,n,r,i){if(void 0===i&&(i=0),i>50)return console.warn("Maximum recursion depth reached in equalizeSegments"),[t,n];var o=a(t),s=a(n),l=o.length,u=s.length,c=o.filter(function(e){return e.l;}).length,d=s.filter(function(e){return e.l;}).length,f=o.filter(function(e){return e.l;}).reduce(function(e,t){return e+t.l;},0)/c||0,h=s.filter(function(e){return e.l;}).reduce(function(e,t){return e+t.l;},0)/d||0,p=r||Math.max(l,u),v=[f,h],g=[p-l,p-u],m=0,y=[o,s].map(function(e,t){return e.l===p?e.map(function(e){return e.s;}):e.map(function(e,n){return m=n&&g[t]&&e.l>=v[t],g[t]-=m?1:0,m?e.ss:[e.s];}).flat();});return y[0].length===y[1].length?y:e(y[0],y[1],p,i+1);};}});var r=n("04cc7448"),i=n("65f3d028");function a(e){return e.map(function(e,t,n){var a,o,s,l,u,c,d,f,h,p,v,g,m=t&&n[t-1].slice(-2).concat(e.slice(1)),y=t?(0,i.segmentCubicFactory)(m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7],m[8],{bbox:!1}).length:0;return g=t?y?(void 0===a&&(a=.5),o=m.slice(0,2),s=m.slice(2,4),l=m.slice(4,6),u=m.slice(6,8),c=(0,r.midPoint)(o,s,a),d=(0,r.midPoint)(s,l,a),f=(0,r.midPoint)(l,u,a),h=(0,r.midPoint)(c,d,a),p=(0,r.midPoint)(d,f,a),v=(0,r.midPoint)(h,p,a),[["C"].concat(c,h,v),["C"].concat(p,f,u)]):[e,e]:[e],{s:e,ss:g,l:y};});}},df79d367:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"TaskQueue",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("d812e418"));class i{constructor(){(0,r.default)(this,"_queue",void 0),(0,r.default)(this,"_id",void 0),(0,r.default)(this,"_cleared",void 0),(0,r.default)(this,"_currentlyRunning",void 0),this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1;}add(e){let t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t;}remove(e){let t=this._currentlyRunning;for(let n of t?this._queue.concat(t):this._queue)if(n.id===e){n.cancelled=!0;return;}}run(e=0){if(this._currentlyRunning)throw Error("Attempting to run(), but is already running.");let t=this._currentlyRunning=this._queue;for(let n of(this._queue=[],t))if(!n.cancelled&&(n.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1;}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[];}}},df7a0006:function(e,t,n){var r=n("0a222680"),i=n("35422ad4"),a=n("b1b86e3e"),o=n("48ddba2e"),s=n("fb3db304");function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1]);}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,e.exports=l;},df9a72ce:function(e,t,n){var r=n("cdf1a659"),i=n("31f4de56"),a=n("96fd0d51"),o=n("689596c4"),s=n("d7dbbb4d"),l=Array.prototype.splice;e.exports=function(e,t,n,u){var c=u?a:i,d=-1,f=t.length,h=e;for(e===t&&(t=s(t)),n&&(h=r(e,o(n)));++d<f;)for(var p=0,v=t[d],g=n?n(v):v;(p=c(h,g,p,u))>-1;)h!==e&&l.call(h,p,1),l.call(e,p,1);return e;};},dfc7d926:function(e,t,n){"use strict";function r(e){return e[1];}function i(e){return arguments.length?(this._y=e,this):this._y;}n.d(t,"__esModule",{value:!0}),n.e(t,{default:function(){return i;},defaultY:function(){return r;}});},dfdbf11f:function(e,t,n){e.exports=function(e,t,n,r,i){return i(e,function(e,i,a){n=r?(r=!1,e):t(n,e,i,a);}),n;};},e00f71ac:function(e,t,n){e.exports=function(e,t){return e>t;};},e06645db:function(e,t,n){var r=n("a8a8fe9d"),i=n("3453eb7f");e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0;};},e06a3031:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("daaa1548")),o=n("fb1ec05a"),s=r._(n("755bc4f8")),l=n("f717bab4");class u extends s.default{getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,a.default)((0,a.default)({},e.uniformsOption),t.uniformsOption);}getCommonUniformsInfo(){let{opacity:e=1,color:t="#000"}=this.layer.getLayerConfig(),n={u_color:(0,o.rgb2arr)(t),u_opacity:e||1};return this.getUniformsBufferInfo(n);}initModels(){var e=this;return(0,i.default)(function*(){return e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"mask",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\n\nlayout(std140) uniform commonUniorm {\n  vec4 u_color;\n  float u_opacity;\n};\n\n#pragma include "projection"\n\nvoid main() {\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n}\n\n',fragmentShader:"layout(std140) uniform commonUniorm {\n  vec4 u_color;\n  float u_opacity;\n};\n\nout vec4 outputColor;\n\nvoid main() {\n  outputColor = u_color;\n  outputColor.a *= u_opacity;\n}\n",defines:e.getDefines(),triangulation:l.polygonTriangulation,depth:{enable:!1},pick:!1}))];})();}clearModels(e=!0){e&&this.layerService.clear();}registerBuiltinAttributes(){return"";}}},e1364649:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{BaseMapService:function(){return i.default;},BaseMapWrapper:function(){return a.default;}});var r=n("777fffbe"),i=r._(n("80dad29a")),a=r._(n("dbd10968"));},e1705225:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("dbd10968")),a=r._(n("a69098c0"));class o extends i.default{getServiceConstructor(){return a.default;}}},e1f276f6:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{arcBox:function(){return l;},cubicBox:function(){return v;},cubicPointDistance:function(){return g;},distance:function(){return o;},lineLength:function(){return c;},linePointAt:function(){return d;},linePointToLine:function(){return f;},polylineLength:function(){return m;},quadBox:function(){return _;},quadPointDistance:function(){return x;}});var r=n("777fffbe")._(n("6c762716")),i=n("0d884ee9"),a=n("71293cfd");function o(e,t,n,r){var i=e-n,a=t-r;return Math.sqrt(i*i+a*a);}function s(e,t){var n=Math.min.apply(Math,(0,r.default)(e)),i=Math.min.apply(Math,(0,r.default)(t));return{x:n,y:i,width:Math.max.apply(Math,(0,r.default)(e))-n,height:Math.max.apply(Math,(0,r.default)(t))-i};}function l(e,t,n,r,i,a,o){for(var s=Math.atan(-r/n*Math.tan(i)),l=1/0,u=-1/0,c=[a,o],d=-(2*Math.PI);d<=2*Math.PI;d+=Math.PI){var f=s+d;a<o?a<f&&f<o&&c.push(f):o<f&&f<a&&c.push(f);}for(var h=0;h<c.length;h++){var p,v=n*Math.cos(i)*Math.cos(p=c[h])-r*Math.sin(i)*Math.sin(p)+e;v<l&&(l=v),v>u&&(u=v);}for(var g=Math.atan(r/(n*Math.tan(i))),m=1/0,y=-1/0,b=[a,o],_=-(2*Math.PI);_<=2*Math.PI;_+=Math.PI){var x=g+_;a<o?a<x&&x<o&&b.push(x):o<x&&x<a&&b.push(x);}for(var w=0;w<b.length;w++){var E,M=n*Math.sin(i)*Math.cos(E=b[w])+r*Math.cos(i)*Math.sin(E)+t;M<m&&(m=M),M>y&&(y=M);}return{x:l,y:m,width:u-l,height:y-m};}function u(e,t,n,i,a,s){var l=-1,u=1/0,c=[n,i],d=20;s&&s>200&&(d=s/10);for(var f=1/d,h=f/10,p=0;p<=d;p++){var v=p*f,g=[a.apply(void 0,(0,r.default)(e.concat([v]))),a.apply(void 0,(0,r.default)(t.concat([v])))],m=o(c[0],c[1],g[0],g[1]);m<u&&(l=v,u=m);}if(0===l)return{x:e[0],y:t[0]};if(1===l){var y=e.length;return{x:e[y-1],y:t[y-1]};}u=1/0;for(var b=0;b<32&&!(h<1e-4);b++){var _=l-h,x=l+h,w=[a.apply(void 0,(0,r.default)(e.concat([_]))),a.apply(void 0,(0,r.default)(t.concat([_])))],E=o(c[0],c[1],w[0],w[1]);if(_>=0&&E<u)l=_,u=E;else{var M=[a.apply(void 0,(0,r.default)(e.concat([x]))),a.apply(void 0,(0,r.default)(t.concat([x])))],S=o(c[0],c[1],M[0],M[1]);x<=1&&S<u?(l=x,u=S):h*=.5;}}return{x:a.apply(void 0,(0,r.default)(e.concat([l]))),y:a.apply(void 0,(0,r.default)(t.concat([l])))};}function c(e,t,n,r){return o(e,t,n,r);}function d(e,t,n,r,i){return{x:(1-i)*e+i*n,y:(1-i)*t+i*r};}function f(e,t,n,r,i,o){var s=[n-e,r-t];if(a.vec2.exactEquals(s,[0,0]))return Math.sqrt((i-e)*(i-e)+(o-t)*(o-t));var l=[-s[1],s[0]];return a.vec2.normalize(l,l),Math.abs(a.vec2.dot([i-e,o-t],l));}function h(e,t,n,r,i){var a=1-i;return a*a*a*e+3*t*i*a*a+3*n*i*i*a+r*i*i*i;}function p(e,t,n,r){var a,o,s,l=-3*e+9*t-9*n+3*r,u=6*e-12*t+6*n,c=3*t-3*e,d=[];if((0,i.isNumberEqual)(l,0))!(0,i.isNumberEqual)(u,0)&&(a=-c/u)>=0&&a<=1&&d.push(a);else{var f=u*u-4*l*c;(0,i.isNumberEqual)(f,0)?d.push(-u/(2*l)):f>0&&(a=(-u+(s=Math.sqrt(f)))/(2*l),o=(-u-s)/(2*l),a>=0&&a<=1&&d.push(a),o>=0&&o<=1&&d.push(o));}return d;}function v(e,t,n,r,i,a,o,l){for(var u=[e,o],c=[t,l],d=p(e,n,i,o),f=p(t,r,a,l),v=0;v<d.length;v++)u.push(h(e,n,i,o,d[v]));for(var g=0;g<f.length;g++)c.push(h(t,r,a,l,f[g]));return s(u,c);}function g(e,t,n,r,i,a,s,l,c,d,f){var p=u([e,n,i,s],[t,r,a,l],c,d,h,f);return o(p.x,p.y,c,d);}function m(e){return function(e){if(e.length<2)return 0;for(var t=0,n=0;n<e.length-1;n++){var r=e[n],i=e[n+1];t+=o(r[0],r[1],i[0],i[1]);}return t;}(e);}function y(e,t,n,r){var i=1-r;return i*i*e+2*r*i*t+r*r*n;}function b(e,t,n){var r=e+n-2*t;if((0,i.isNumberEqual)(r,0))return[.5];var a=(e-t)/r;return a<=1&&a>=0?[a]:[];}function _(e,t,n,r,i,a){var o=b(e,n,i)[0],l=b(t,r,a)[0],u=[e,i],c=[t,a];return void 0!==o&&u.push(y(e,n,i,o)),void 0!==l&&c.push(y(t,r,a,l)),s(u,c);}function x(e,t,n,r,i,a,s,l){var c=u([e,n,i],[t,r,a],s,l,y);return o(c.x,c.y,s,l);}},e2594fe6:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"parsePathString",{enumerable:!0,get:function(){return s;}});var r=n("759cce50"),i=n("d34a8369"),a=n("4b858df8"),o=n("07d71ad2");function s(e){if((0,r.isPathArray)(e))return[].concat(e);var t=new o.PathParser(e);for((0,a.skipSpaces)(t);t.index<t.max&&!t.err.length;)(0,i.scanSegment)(t);return t.err?t.err:t.segments;}},e31a659c:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"DOM",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("d812e418")),a=r._(n("be334174"));class o{static testProp(e){if(!o.docStyle)return e[0];for(let t=0;t<e.length;t++)if(e[t]in o.docStyle)return e[t];return e[0];}static create(e,t,n){let r=window.document.createElement(e);return void 0!==t&&(r.className=t),n&&n.appendChild(r),r;}static createNS(e,t){return window.document.createElementNS(e,t);}static disableDrag(){o.docStyle&&o.selectProp&&(o.userSelect=o.docStyle[o.selectProp],o.docStyle[o.selectProp]="none");}static enableDrag(){o.docStyle&&o.selectProp&&(o.docStyle[o.selectProp]=o.userSelect);}static setTransform(e,t){e.style[o.transformProp]=t;}static addEventListener(e,t,n,r={}){"passive"in r?e.addEventListener(t,n,r):e.addEventListener(t,n,r.capture);}static removeEventListener(e,t,n,r={}){"passive"in r?e.removeEventListener(t,n,r):e.removeEventListener(t,n,r.capture);}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",o.suppressClickInternal,!0);}static suppressClick(){window.addEventListener("click",o.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",o.suppressClickInternal,!0);},0);}static getScale(e){let t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth||1,y:t.height/e.offsetHeight||1,boundingClientRect:t};}static getPoint(e,t,n){let r=t.boundingClientRect;return new a.default((n.clientX-r.left)/t.x-e.clientLeft,(n.clientY-r.top)/t.y-e.clientTop);}static mousePos(e,t){let n=o.getScale(e);return o.getPoint(e,n,t);}static touchPos(e,t){let n=[],r=o.getScale(e);for(let i=0;i<t.length;i++)n.push(o.getPoint(e,r,t[i]));return n;}static mouseButton(e){return e.button;}static remove(e){e.parentNode&&e.parentNode.removeChild(e);}}(0,i.default)(o,"docStyle","undefined"!=typeof window&&window.document&&window.document.documentElement.style),(0,i.default)(o,"userSelect",void 0),(0,i.default)(o,"selectProp",o.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"])),(0,i.default)(o,"transformProp",o.testProp(["transform","WebkitTransform"]));},e3492f1a:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("dbd10968")),a=r._(n("afba4989"));class o extends i.default{getServiceConstructor(){return a.default;}}},e34c617b:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=r._(n("4ce96d25")),s=r._(n("77ed14f2"));class l extends o.default{constructor(...e){super(...e),(0,a.default)(this,"type","GeometryLayer"),(0,a.default)(this,"defaultSourceConfig",{data:[{x:0,y:0}],options:{parser:{type:"json",x:"x",y:"y"}}});}buildModels(){var e=this;return(0,i.default)(function*(){let t=e.getModelType();e.layerModel=new s.default[t](e),yield e.initLayerModels();})();}getDefaultConfig(){return({plane:{},sprite:{},billboard:{}})[this.getModelType()];}getModelType(){var e;let t=this.styleAttributeService.getLayerStyleAttribute("shape"),n=null==t||null===(e=t.scale)||void 0===e?void 0:e.field;return"plane"===n?"plane":"sprite"===n?"sprite":"billboard"===n?"billboard":"plane";}}},e367577c:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("82f98358")),a=r._(n("7850ca64")),o=r._(n("b4039cbe"));function s(e){var t=e.width,n=e.height,r=e.bounds,s=e.minExtent,l=void 0===s?0:s,u=e.maxZoom,c=e.padding,d=void 0===c?0:c,f=e.offset,h=void 0===f?[0,0]:f,p=(0,i.default)(r,2),v=(0,i.default)(p[0],2),g=v[0],m=v[1],y=(0,i.default)(p[1],2),b=y[0],_=y[1];if(Number.isFinite(d)){var x=d;d={top:x,bottom:x,left:x,right:x};}else(0,o.default)(Number.isFinite(d.top)&&Number.isFinite(d.bottom)&&Number.isFinite(d.left)&&Number.isFinite(d.right));var w=new a.default({width:t,height:n,longitude:0,latitude:0,zoom:0}),E=w.project([g,_]),M=w.project([b,m]),S=[Math.max(Math.abs(M[0]-E[0]),l),Math.max(Math.abs(M[1]-E[1]),l)],k=[t-d.left-d.right-2*Math.abs(h[0]),n-d.top-d.bottom-2*Math.abs(h[1])];(0,o.default)(k[0]>0&&k[1]>0);var C=k[0]/S[0],A=k[1]/S[1],L=(d.right-d.left)/2/C,P=(d.bottom-d.top)/2/A,N=[(M[0]+E[0])/2+L,(M[1]+E[1])/2+P],O=w.unproject(N),I=w.zoom+Math.log2(Math.abs(Math.min(C,A)));return{longitude:O[0],latitude:O[1],zoom:Math.min(I,void 0===u?24:u)};}},e3d5f8e1:function(e,t,n){var r=n("6e3a9823"),i=n("f28dfa76");e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==r(e);};},e3f531bc:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{TextTrianglation:function(){return v;},default:function(){return g;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("f89fb776")),o=r._(n("d812e418")),s=n("d9b661b3"),l=n("fb1ec05a"),u=r._(n("755bc4f8")),c=r._(n("9deed87f")),d=n("226a180d");let f='#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105\n#define FONT_SIZE 48.0\n\nuniform sampler2D u_sdf_map;\nlayout(std140) uniform commonUniforms {\n  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];\n  vec2 u_sdf_map_size;\n  float u_raisingHeight: 0.0;\n  float u_stroke_width : 2;\n  float u_gamma_scale : 0.5;\n  float u_halo_blur : 0.5;\n};\n\nin vec2 v_uv;\nin float v_gamma_scale;\nin vec4 v_color;\nin vec4 v_stroke_color;\nin float v_fontScale;\n\nout vec4 outputColor;\n\n#pragma include "picking"\nvoid main() {\n  // get style data mapping\n\n  // get sdf from atlas\n  float dist = texture(SAMPLER_2D(u_sdf_map), v_uv).a;\n\n  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;\n  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;\n\n  highp float gamma_scaled = gamma * v_gamma_scale;\n\n  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n\n  outputColor = mix(v_color, v_stroke_color, smoothstep(0., 0.5, 1.- dist));\n\n  outputColor.a *= alpha;\n   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20\n  if (outputColor.a < 0.01) {\n    discard;\n  }\n  outputColor = filterColor(outputColor);\n}\n',h='#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105\n#define FONT_SIZE 24.0\n\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_TEXT_OFFSETS) in vec2 a_textOffsets;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_tex;\n\nlayout(std140) uniform commonUniforms {\n  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];\n  vec2 u_sdf_map_size;\n  float u_raisingHeight: 0.0;\n  float u_stroke_width : 2;\n  float u_gamma_scale : 0.5;\n  float u_halo_blur : 0.5;\n};\n\nout vec2 v_uv;\nout float v_gamma_scale;\nout vec4 v_color;\nout vec4 v_stroke_color;\nout float v_fontScale;\n\n#pragma include "projection"\n#pragma include "picking"\n#pragma include "rotation_2d"\n\nvoid main() {\n  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97\n\n  v_uv = a_tex / u_sdf_map_size;\n\n\n\n  v_color = vec4(a_Color.xyz, a_Color.w * opacity);\n  v_stroke_color = vec4(u_stroke_color.xyz, u_stroke_color.w * opacity);\n\n  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B\n  float fontScale = a_Size / FONT_SIZE;\n  v_fontScale = fontScale;\n\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\n  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  vec2 offset = rotate_matrix(a_textOffsets,rotation);\n\n  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);\n\n  float raiseHeight = u_raisingHeight;\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);\n    raiseHeight = u_raisingHeight * mapboxZoomScale;\n  }\n\n  vec4 projected_position = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));\n\n  gl_Position = vec4(\n    projected_position.xy / projected_position.w + offset * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);\n  v_gamma_scale = gl_Position.w;\n  setPickingColor(a_PickingColor);\n\n}\n',{isEqual:p}=l.lodashUtil;function v(e){let t=e.id,n=[],r=[];if(!this.glyphInfoMap||!this.glyphInfoMap[t])return{vertices:[],indices:[],size:7};let i=this.glyphInfoMap[t].centroid,a=2===i.length?[i[0],i[1],0]:i;return this.glyphInfoMap[t].glyphQuads.forEach((e,t)=>{n.push(...a,e.tex.x,e.tex.y+e.tex.height,e.tl.x,e.tl.y,...a,e.tex.x+e.tex.width,e.tex.y+e.tex.height,e.tr.x,e.tr.y,...a,e.tex.x+e.tex.width,e.tex.y,e.br.x,e.br.y,...a,e.tex.x,e.tex.y,e.bl.x,e.bl.y),r.push(0+4*t,1+4*t,2+4*t,2+4*t,3+4*t,0+4*t);}),{vertices:n,indices:r,size:7};}class g extends u.default{constructor(...e){var t;super(...e),t=this,(0,o.default)(this,"glyphInfo",void 0),(0,o.default)(this,"glyphInfoMap",{}),(0,o.default)(this,"rawEncodeData",void 0),(0,o.default)(this,"texture",void 0),(0,o.default)(this,"currentZoom",-1),(0,o.default)(this,"extent",void 0),(0,o.default)(this,"textureHeight",0),(0,o.default)(this,"textCount",0),(0,o.default)(this,"preTextStyle",{}),(0,o.default)(this,"mapping",(0,a.default)(function*(){t.initGlyph(),t.updateTexture(),yield t.reBuildModel();}));}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,TEXT_OFFSETS:10,UV:11});}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,i.default)((0,i.default)((0,i.default)({},e.uniformsOption),t.uniformsOption),{u_sdf_map:this.textures[0]});}getCommonUniformsInfo(){let{stroke:e="#fff",strokeWidth:t=0,halo:n=.5,gamma:r=2,raisingHeight:i=0}=this.layer.getLayerConfig(),a=this.getFontServiceMapping(),o=this.getFontServiceCanvas();a&&Object.keys(a).length!==this.textCount&&o&&(this.updateTexture(),this.textCount=Object.keys(a).length),this.preTextStyle=this.getTextStyle();let s={u_stroke_color:(0,l.rgb2arr)(e),u_sdf_map_size:[(null==o?void 0:o.width)||1,(null==o?void 0:o.height)||1],u_raisingHeight:Number(i),u_stroke_width:t,u_gamma_scale:r,u_halo_blur:n};return this.getUniformsBufferInfo(s);}initModels(){var e=this;return(0,a.default)(function*(){return e.bindEvent(),e.extent=e.textExtent(),e.rawEncodeData=e.layer.getEncodedData(),e.preTextStyle=e.getTextStyle(),e.initUniformsBuffer(),e.buildModels();})();}buildModels(){var e=this;return(0,a.default)(function*(){let{textAllowOverlap:t=!1}=e.layer.getLayerConfig();return e.initGlyph(),e.updateTexture(),t||e.filterGlyphs(),[(yield e.layer.buildLayerModel({moduleName:"pointText",vertexShader:h,fragmentShader:f,defines:e.getDefines(),inject:e.getInject(),triangulation:v.bind(e),depth:{enable:!1}}))];})();}needUpdate(){var e=this;return(0,a.default)(function*(){let{textAllowOverlap:t=!1,textAnchor:n="center",textOffset:r,padding:i,fontFamily:a,fontWeight:o}=e.getTextStyle();if(!p(i,e.preTextStyle.padding)||!p(r,e.preTextStyle.textOffset)||!p(n,e.preTextStyle.textAnchor)||!p(a,e.preTextStyle.fontFamily)||!p(o,e.preTextStyle.fontWeight))return yield e.mapping(),!0;if(t)return!1;let s=e.mapService.getZoom(),u=e.mapService.getBounds(),c=(0,l.boundsContains)(e.extent,u);return(Math.abs(e.currentZoom-s)>.5||!c||t!==e.preTextStyle.textAllowOverlap)&&(yield e.reBuildModel(),!0);})();}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy(),this.layer.off("remapping",this.mapping);}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:s.AttributeType.Attribute,descriptor:{shaderLocation:this.attributeLocation.TEXT_OFFSETS,name:"a_textOffsets",buffer:{usage:s.gl.STATIC_DRAW,data:[],type:s.gl.FLOAT},size:2,update:(e,t,n)=>[n[5],n[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:s.AttributeType.Attribute,descriptor:{name:"a_tex",shaderLocation:this.attributeLocation.UV,buffer:{usage:s.gl.DYNAMIC_DRAW,data:[],type:s.gl.FLOAT},size:2,update:(e,t,n)=>[n[3],n[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:s.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:s.gl.DYNAMIC_DRAW,data:[],type:s.gl.FLOAT},size:1,update:e=>{let{size:t=12}=e;return Array.isArray(t)?[t[0]]:[t];}}});}bindEvent(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping);}textExtent(){let e=this.mapService.getBounds();return(0,l.padBounds)(e,.5);}initTextFont(){let{fontWeight:e,fontFamily:t}=this.getTextStyle(),n=this.rawEncodeData,r=[];n.forEach(e=>{let{shape:t=""}=e;for(let e of t=t.toString())-1===r.indexOf(e)&&r.push(e);}),this.fontService.setFontOptions({characterSet:r,fontWeight:e,fontFamily:t,iconfont:!1});}initIconFontTex(){let{fontWeight:e,fontFamily:t}=this.getTextStyle(),n=this.rawEncodeData,r=[];n.forEach(e=>{let{shape:t=""}=e;t=`${t}`,-1===r.indexOf(t)&&r.push(t);}),this.fontService.setFontOptions({characterSet:r,fontWeight:e,fontFamily:t,iconfont:!0});}getTextStyle(){let{fontWeight:e="400",fontFamily:t="sans-serif",textAllowOverlap:n=!1,padding:r=[0,0],textAnchor:i="center",textOffset:a=[0,0],opacity:o=1,strokeOpacity:s=1,strokeWidth:l=0,stroke:u="#000"}=this.layer.getLayerConfig();return{fontWeight:e,fontFamily:t,textAllowOverlap:n,padding:r,textAnchor:i,textOffset:a,opacity:o,strokeOpacity:s,strokeWidth:l,stroke:u};}generateGlyphLayout(e){let t=this.getFontServiceMapping(),{spacing:n=2,textAnchor:r="center",textOffset:i}=this.layer.getLayerConfig(),a=this.rawEncodeData;this.glyphInfo=a.map(a=>{let{shape:o="",id:s,size:u=1}=a,c=a.textOffset?a.textOffset:i||[0,0],f=a.textAnchor?a.textAnchor:r||"center",h=(0,d.shapeText)(o.toString(),t,u,f,"left",n,c,e),p=(0,d.getGlyphQuads)(h,c,!1);return a.shaping=h,a.glyphQuads=p,a.centroid=(0,l.calculateCentroid)(a.coordinates),this.glyphInfoMap[s]={shaping:h,glyphQuads:p,centroid:(0,l.calculateCentroid)(a.coordinates)},a;});}getFontServiceMapping(){let{fontWeight:e="400",fontFamily:t="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getMappingByKey(`${t}_${e}`);}getFontServiceCanvas(){let{fontWeight:e="400",fontFamily:t="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getCanvasByKey(`${t}_${e}`);}filterGlyphs(){let{padding:e=[0,0],textAllowOverlap:t=!1}=this.layer.getLayerConfig();if(t)return;this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();let{width:n,height:r}=this.rendererService.getViewportSize(),i=new c.default(n,r);this.glyphInfo.filter(t=>{let{shaping:n,id:r=0}=t,a=t.centroid,o=t.size/16,s=this.mapService.lngLatToContainer(a),{box:l}=i.placeCollisionBox({x1:n.left*o-e[0],x2:n.right*o+e[0],y1:n.top*o-e[1],y2:n.bottom*o+e[1],anchorPointX:s.x,anchorPointY:s.y});return!!l&&!!l.length&&(i.insertCollisionBox(l,r),!0);}).forEach(e=>{this.glyphInfoMap[e.id]=e;});}initGlyph(){let{iconfont:e=!1}=this.layer.getLayerConfig();e?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(e);}updateTexture(){let{createTexture2D:e}=this.rendererService,t=this.getFontServiceCanvas();this.textureHeight=t.height,this.texture&&this.texture.destroy(),this.texture=e({data:t,mag:s.gl.LINEAR,min:s.gl.LINEAR,width:t.width,height:t.height}),this.textures=[this.texture];}reBuildModel(){var e=this;return(0,a.default)(function*(){e.filterGlyphs();let t=yield e.layer.buildLayerModel({moduleName:"pointText",vertexShader:h,fragmentShader:f,triangulation:v.bind(e),defines:e.getDefines(),inject:e.getInject(),depth:{enable:!1}});e.layer.models=[t];})();}}},e489f84a:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("6ca3854b")),i=function(e){return(0,r.default)(e)?"":e.toString();};},e4f46be2:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("6ca3854b")),a=r._(n("99ff515c")),o=r._(n("b5881774")),s=r._(n("64b9b79c")),l=Object.prototype.hasOwnProperty,u=function(e){if((0,i.default)(e))return!0;if((0,a.default)(e))return!e.length;var t=(0,o.default)(e);if("Map"===t||"Set"===t)return!e.size;if((0,s.default)(e))return!Object.keys(e).length;for(var n in e)if(l.call(e,n))return!1;return!0;};},e5791bbd:function(e,t,n){var r=n("16b3b059");e.exports=function(){return r.Date.now();};},e58a514e:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("a420544c")),a=r._(n("33ea99bb")),o=function(e,t){return e&&(0,i.default)(t,(0,a.default)(t),e);};},e5d2c8b8:function(e,t,n){var r=n("271c9ad5"),i=n("e00f71ac"),a=n("81d598f3");e.exports=function(e){return e&&e.length?r(e,a,i):void 0;};},e625a2d1:function(e,t,n){var r=n("3d15f15b");e.exports={Graph:r.Graph,json:n("f66919d9"),alg:n("e9367c14"),version:r.version};},e656c7f2:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("731b2a36")),a=r._(n("388a74b8")),o="object"==typeof t&&t&&!t.nodeType&&t,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,l=s&&s.exports===o?i.default.Buffer:void 0,u=(l?l.isBuffer:void 0)||a.default;},e6577566:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e){return this.__data__.has(e);};},e6d4594c:function(e,t,n){"use strict";function r(e,t,n,r,i,a,o){this.node=e,this.x0=t,this.y0=n,this.z0=r,this.x1=i,this.y1=a,this.z1=o;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},e729dbbb:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{PointTriangulation:function(){return l;},default:function(){return u;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=n("d9b661b3"),o=r._(n("755bc4f8")),s=n("fb1ec05a");function l(e){let t=e.coordinates;return{vertices:[...t],indices:[0],size:t.length};}class u extends o.default{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9});}getDefaultStyle(){return{blend:"additive"};}getCommonUniformsInfo(){let{blend:e,strokeOpacity:t=1,strokeWidth:n=0,stroke:r="#fff"}=this.layer.getLayerConfig(),i={u_stroke_color:(0,s.rgb2arr)(r),u_additive:"additive"===e?1:0,u_stroke_opacity:t,u_stroke_width:n};return this.getUniformsBufferInfo(i);}initModels(){var e=this;return(0,i.default)(function*(){return e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){return e.layer.triangulation=l,e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:'\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\n\nlayout(std140) uniform commonUniorm {\n  vec4 u_stroke_color;\n  float u_additive;\n  float u_stroke_opacity;\n  float u_stroke_width;\n};\n\nout vec4 v_color;\nout float v_blur;\nout float v_innerRadius;\n\n#pragma include "projection"\n#pragma include "picking"\n#pragma include "project"\nvoid main() {\n  v_color = vec4(a_Color.xyz, a_Color.w * opacity);\n  v_blur = 1.0 - max(2.0 / a_Size, 0.05);\n  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);\n\n  vec2 offset = project_pixel(u_offsets);\n\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\n  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));\n\n  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'\nlayout(std140) uniform commonUniorm {\n  vec4 u_stroke_color;\n  float u_additive;\n  float u_stroke_opacity;\n  float u_stroke_width;\n};\n\nin vec4 v_color;\nin float v_blur;\nin float v_innerRadius;\n\nout vec4 outputColor;\n\n#pragma include "picking"\nvoid main() {\n  vec2 center = vec2(0.5);\n\n  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1\n  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;\n  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62\n  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);\n\n\n  if(v_innerRadius < 0.99) {\n    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01\n    float blurWidth = (1.0 - v_blur)/2.0;\n    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);\n    if(fragmengTocenter > v_innerRadius + blurWidth) {\n      outputColor = stroke;\n    } else if(fragmengTocenter > v_innerRadius - blurWidth){\n      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);\n      outputColor = mix(v_color, stroke, mixR);\n    } else {\n      outputColor = v_color;\n    }\n  } else {\n    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01\n    outputColor = v_color;\n  }\n\n  outputColor = filterColor(outputColor);\n  \n  if(u_additive > 0.0) {\n    outputColor *= circleClipOpacity;\n  } else {\n    outputColor.a *= circleClipOpacity;\n  }\n\n}\n',defines:e.getDefines(),inject:e.getInject(),triangulation:l,depth:{enable:!1},primitive:a.gl.POINTS}))];})();}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:a.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:a.gl.DYNAMIC_DRAW,data:[],type:a.gl.FLOAT},size:1,update:e=>{let{size:t=1}=e;return Array.isArray(t)?[t[0]]:[t];}}});}}},e777c749:function(e,t,n){e.exports=function(e,t){return null!=e&&t in Object(e);};},e791d475:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("80e60ee8");},e7d99e70:function(e,t,n){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0;};},e7fea481:function(e,t,n){"use strict";function r(e){return"number"==typeof e;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},e8a85aaa:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{deepMergeLayerOptions:function(){return s;},isSourceChanged:function(){return l;}});var r=n("c9dce8f9"),i=n("c1f97feb"),a=n("a24d4a8c");let o=(e,...t)=>{for(let n=0;n<t.length;n+=1)!function e(t,n,r=0,i=5){for(let o in n)if(Object.prototype.hasOwnProperty.call(n,o)){let s=n[o];null!==s&&(0,a.isPlainObject)(s)?((0,a.isPlainObject)(t[o])||(t[o]={}),r<i?e(t[o],s,r+1,i):t[o]=n[o]):Array.isArray(s)?(t[o]=[],t[o]=t[o].concat(s)):void 0!==s&&(t[o]=s);}}(e,t[n],0,1);return e;},s=(e,t)=>{let{source:n}=e,a=(0,r.__rest)(e,["source"]),{source:s}=t,l=o({},a,(0,r.__rest)(t,["source"]));return s instanceof i.Source?l.source=s:n instanceof i.Source?l.source=n:l.source=Object.assign(Object.assign({},n),s),l;},l=(e,t)=>{if(e instanceof i.Source&&t instanceof i.Source)return e!==t;let{data:n}=e,o=(0,r.__rest)(e,["data"]),{data:s}=t,l=(0,r.__rest)(t,["data"]);return n!==s||!(0,a.isEqual)(o,l);};},e8cc97d4:function(e,t,n){var r=n("65974307"),i=n("262487a2"),a=n("32f27622"),o=n("c0051812");e.exports=function(e,t){return(o(e)?r:i)(e,a(t,3));};},e9367c14:function(e,t,n){e.exports={components:n("31710123"),dijkstra:n("87d0acba"),dijkstraAll:n("c0d419e3"),findCycles:n("ff7f0115"),floydWarshall:n("bbae2951"),isAcyclic:n("94c768e4"),postorder:n("57634791"),preorder:n("ace6cca6"),prim:n("dd127df2"),tarjan:n("bd478e5d"),topsort:n("9ec718eb")};},e95afa28:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("a24d4a8c");},e9ce9d12:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"Popper",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe")._(n("d812e418")),i=n("fb1ec05a"),a=n("f86d399e");class o extends a.EventEmitter{get buttonRect(){return this.button.getBoundingClientRect();}constructor(e,t){super(),(0,r.default)(this,"popperDOM",void 0),(0,r.default)(this,"contentDOM",void 0),(0,r.default)(this,"button",void 0),(0,r.default)(this,"option",void 0),(0,r.default)(this,"isShow",!1),(0,r.default)(this,"content",void 0),(0,r.default)(this,"timeout",null),(0,r.default)(this,"show",()=>(this.isShow||!this.contentDOM.innerHTML||(this.resetPopperPosition(),i.DOM.removeClass(this.popperDOM,"l7-popper-hide"),this.isShow=!0,this.option.unique&&o.conflictPopperList.forEach(e=>{e!==this&&e.isShow&&e.hide();}),this.emit("show"),window.addEventListener("pointerdown",this.onPopperUnClick)),this)),(0,r.default)(this,"hide",()=>(this.isShow&&(i.DOM.addClass(this.popperDOM,"l7-popper-hide"),this.isShow=!1,this.emit("hide"),window.removeEventListener("pointerdown",this.onPopperUnClick)),this)),(0,r.default)(this,"setHideTimeout",()=>{this.timeout||(this.timeout=window.setTimeout(()=>{this.isShow&&(this.hide(),this.timeout=null);},300));}),(0,r.default)(this,"clearHideTimeout",()=>{this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null);}),(0,r.default)(this,"onBtnClick",()=>{this.isShow?this.hide():this.show();}),(0,r.default)(this,"onPopperUnClick",e=>{i.DOM.findParentElement(e.target,[".l7-button-control",".l7-popper-content"])||this.hide();}),(0,r.default)(this,"onBtnMouseLeave",()=>{this.setHideTimeout();}),(0,r.default)(this,"onBtnMouseMove",()=>{this.clearHideTimeout(),this.isShow||this.show();}),this.button=e,this.option=t,this.init(),t.unique&&o.conflictPopperList.push(this);}getPopperDOM(){return this.popperDOM;}getIsShow(){return this.isShow;}getContent(){return this.content;}setContent(e){"string"==typeof e?this.contentDOM.innerHTML=e:e instanceof HTMLElement&&(i.DOM.clearChildren(this.contentDOM),this.contentDOM.appendChild(e)),this.content=e;}init(){let{trigger:e}=this.option;this.popperDOM=this.createPopper(),"click"===e?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave));}destroy(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),i.DOM.remove(this.popperDOM);}resetPopperPosition(){let e={},{container:t,offset:n=[0,0],placement:r}=this.option,[a,o]=n,s=this.button.getBoundingClientRect(),l=t.getBoundingClientRect(),{left:u,right:c,top:d,bottom:f}=i.DOM.getDiffRect(s,l),h=!1,p=!1;/^(left|right)/.test(r)?(r.includes("left")?e.right=`${s.width+c}px`:r.includes("right")&&(e.left=`${s.width+u}px`),r.includes("start")?e.top=`${d}px`:r.includes("end")?e.bottom=`${f}px`:(e.top=`${d+s.height/2}px`,p=!0,e.transform=`translate(${a}px, calc(${o}px - 50%))`)):/^(top|bottom)/.test(r)&&(r.includes("top")?e.bottom=`${s.height+f}px`:r.includes("bottom")&&(e.top=`${s.height+d}px`),r.includes("start")?e.left=`${u}px`:r.includes("end")?e.right=`${c}px`:(e.left=`${u+s.width/2}px`,h=!0,e.transform=`translate(calc(${a}px - 50%), ${o}px)`)),e.transform=`translate(calc(${a}px - ${h?"50%":"0%"}), calc(${o}px - ${p?"50%":"0%"})`;let v=r.split("-");v.length&&i.DOM.addClass(this.popperDOM,v.map(e=>`l7-popper-${e}`).join(" ")),i.DOM.addStyle(this.popperDOM,i.DOM.css2Style(e));}createPopper(){let{container:e,className:t="",content:n}=this.option,r=i.DOM.create("div",`l7-popper l7-popper-hide ${t}`),a=i.DOM.create("div","l7-popper-content"),o=i.DOM.create("div","l7-popper-arrow");return r.appendChild(a),r.appendChild(o),e.appendChild(r),this.popperDOM=r,this.contentDOM=a,n&&this.setContent(n),r;}}(0,r.default)(o,"conflictPopperList",[]);},e9eb317a:function(e,t,n){e.exports=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var a=Array(i);++r<i;)a[r]=e[r+t];return a;};},ea7bb476:function(e,t,n){var r=n("31e26024"),i=n("481b6514"),a=n("05d6656f"),o=n("7c1db5f7");e.exports=function(e,t,n){if(!o(n))return!1;var s=typeof t;return("number"==s?!!(i(n)&&a(t,n.length)):"string"==s&&t in n)&&r(n[t],e);};},eadbad1c:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe"),i=n("655dca65"),a=n("201ec6be"),o=n("6495e7c6"),s=r._(n("4a8d04f1")),l=r._(n("1632ee7b")),u=n("2a1c9565");function c(){var e,t,n,r,c,d,f=(0,s.default)(-30),h=1,p=1/0,v=.81;function g(r){var s,l=e.length,d=(1===t?(0,i.binarytree)(e,u.x):2===t?(0,a.quadtree)(e,u.x,u.y):3===t?(0,o.octree)(e,u.x,u.y,u.z):null).visitAfter(y);for(c=r,s=0;s<l;++s)n=e[s],d.visit(b);}function m(){if(e){var t,n,r=e.length;for(t=0,d=Array(r);t<r;++t)d[(n=e[t]).index]=+f(n,t,e);}}function y(e){var n,r,i,a,o,s,l=0,u=0,c=e.length;if(c){for(i=a=o=s=0;s<c;++s)(n=e[s])&&(r=Math.abs(n.value))&&(l+=n.value,u+=r,i+=r*(n.x||0),a+=r*(n.y||0),o+=r*(n.z||0));l*=Math.sqrt(4/c),e.x=i/u,t>1&&(e.y=a/u),t>2&&(e.z=o/u);}else{(n=e).x=n.data.x,t>1&&(n.y=n.data.y),t>2&&(n.z=n.data.z);do l+=d[n.data.index];while(n=n.next)}e.value=l;}function b(e,i,a,o,s){if(!e.value)return!0;var u=[a,o,s][t-1],f=e.x-n.x,g=t>1?e.y-n.y:0,m=t>2?e.z-n.z:0,y=u-i,b=f*f+g*g+m*m;if(y*y/v<b)return b<p&&(0===f&&(b+=(f=(0,l.default)(r))*f),t>1&&0===g&&(b+=(g=(0,l.default)(r))*g),t>2&&0===m&&(b+=(m=(0,l.default)(r))*m),b<h&&(b=Math.sqrt(h*b)),n.vx+=f*e.value*c/b,t>1&&(n.vy+=g*e.value*c/b),t>2&&(n.vz+=m*e.value*c/b)),!0;if(!e.length&&!(b>=p)){(e.data!==n||e.next)&&(0===f&&(b+=(f=(0,l.default)(r))*f),t>1&&0===g&&(b+=(g=(0,l.default)(r))*g),t>2&&0===m&&(b+=(m=(0,l.default)(r))*m),b<h&&(b=Math.sqrt(h*b)));do e.data!==n&&(y=d[e.data.index]*c/b,n.vx+=f*y,t>1&&(n.vy+=g*y),t>2&&(n.vz+=m*y));while(e=e.next)}}return g.initialize=function(n,...i){e=n,r=i.find(e=>"function"==typeof e)||Math.random,t=i.find(e=>[1,2,3].includes(e))||2,m();},g.strength=function(e){return arguments.length?(f="function"==typeof e?e:(0,s.default)(+e),m(),g):f;},g.distanceMin=function(e){return arguments.length?(h=e*e,g):Math.sqrt(h);},g.distanceMax=function(e){return arguments.length?(p=e*e,g):Math.sqrt(p);},g.theta=function(e){return arguments.length?(v=e*e,g):Math.sqrt(v);},g;}},eaf99dcc:function(e,t,n){"use strict";function r(e,t){var n,r=1;function i(){var i,a,o=n.length,s=0,l=0;for(i=0;i<o;++i)s+=(a=n[i]).x,l+=a.y;for(s=(s/o-e)*r,l=(l/o-t)*r,i=0;i<o;++i)a=n[i],a.x-=s,a.y-=l;}return null==e&&(e=0),null==t&&(t=0),i.initialize=function(e){n=e;},i.x=function(t){return arguments.length?(e=+t,i):e;},i.y=function(e){return arguments.length?(t=+e,i):t;},i.strength=function(e){return arguments.length?(r=+e,i):r;},i;}n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});},eb793955:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("daaa1548")),o=r._(n("d812e418")),s=n("d9b661b3"),l=r._(n("755bc4f8")),u=n("f717bab4");class c extends l.default{constructor(...e){super(...e),(0,o.default)(this,"texture",void 0);}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9});}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,a.default)((0,a.default)({},e.uniformsOption),t.uniformsOption);}getCommonUniformsInfo(){let{speed:e=.5}=this.layer.getLayerConfig(),t={u_speed:e,u_time:this.layer.getLayerAnimateTime(),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(t);}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()};}initModels(){var e=this;return(0,i.default)(function*(){return e.loadTexture(),e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;\n\nlayout(std140) uniform commonUniforms {\n  float u_speed;\n  float u_time;\n};\nout vec4 v_Color;\nout vec2 v_uv;\n\n#pragma include "projection"\n\nvoid main() {\n  v_uv = a_uv;\n  v_Color = a_Color;\n  v_Color.a *= opacity;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n}\n\n',fragmentShader:"uniform sampler2D u_texture;\nlayout(std140) uniform commonUniforms {\n  float u_speed;\n  float u_time;\n};\n\nout vec4 outputColor;\n\n\nin vec4 v_Color;\nin vec2 v_uv;\n\nfloat rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }\n\nfloat water(vec3 p) {\n  float t = u_time * u_speed;\n  p.z += t * 2.; p.x += t * 2.;\n  vec3 c1 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;\n  p.z += t * 3.; p.x += t * 0.52;\n  vec3 c2 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;\n  p.z += t * 4.; p.x += t * 0.8;\n  vec3 c3 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;\n  c1 += c2 - c3;\n  float z = (c1.x + c1.y + c1.z) / 3.;\n  return p.y + z / 4.;\n}\n\nfloat map(vec3 p) {\n  float d = 100.0;\n  d = water(p);\n  return d;\n}\n\nfloat intersect(vec3 ro, vec3 rd) {\n  float d = 0.0;\n  for (int i = 0; i <= 100; i++) {\n    float h = map(ro + rd * d);\n    if (h < 0.1) return  d;\n    d += h;\n  }\n  return 0.0;\n}\n\nvec3 norm(vec3 p) {\n  float eps = .1;\n  return normalize(vec3(\n    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),\n    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),\n    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))\n  ));\n} \n\nfloat calSpc() {\n  vec3 l1 = normalize(vec3(1, 1, 1));\n  vec3 ro = vec3(-3, 20, -8);\n  vec3 rc = vec3(0, 0, 0);\n  vec3 ww = normalize(rc - ro);\n  vec3 uu = normalize(cross(vec3(0,1,0), ww));\n  vec3 vv = normalize(cross(rc - ro, uu));\n  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);\n  float d = intersect(ro, rd);\n  vec3 p = ro + rd * d;\n  vec3 n = norm(p);\n  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);\n  return spc;\n}\n\nvoid main() {\n\n  outputColor = v_Color;\n  float spc = calSpc();\n  outputColor += spc * 0.4;\n}\n",triangulation:u.polygonTriangulation,defines:e.getDefines(),inject:e.getInject(),primitive:s.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1,diagnosticDerivativeUniformityEnabled:!1}))];})();}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy();}registerBuiltinAttributes(){let[e,t,n,r]=this.layer.getSource().extent,i=n-e,a=r-t;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:s.AttributeType.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:s.gl.STATIC_DRAW,data:[],type:s.gl.FLOAT},size:2,update:(n,r,o)=>{let[s,l]=o;return[(s-e)/i,(l-t)/a];}}});}loadTexture(){let{waterTexture:e}=this.layer.getLayerConfig(),{createTexture2D:t}=this.rendererService;this.texture=t({height:1,width:1});let n=new Image;n.crossOrigin="",e?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),n.src=e):n.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",n.onload=()=>{this.texture=t({data:n,width:n.width,height:n.height,wrapS:s.gl.MIRRORED_REPEAT,wrapT:s.gl.MIRRORED_REPEAT,min:s.gl.LINEAR,mag:s.gl.LINEAR}),this.layerService.reRender();};}}},ebc8c370:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return w;}});var r=n("777fffbe"),i=r._(n("3c3019cc")),a=r._(n("96ab26b2")),o=r._(n("63aee470")),s=r._(n("591af935")),l=r._(n("33da6861")),u=r._(n("4086b076")),c=r._(n("cb5e6d96")),d="[object Map]",f="[object Promise]",h="[object Set]",p="[object WeakMap]",v="[object DataView]",g=(0,c.default)(i.default),m=(0,c.default)(a.default),y=(0,c.default)(o.default),b=(0,c.default)(s.default),_=(0,c.default)(l.default),x=u.default;(i.default&&x(new i.default(new ArrayBuffer(1)))!=v||a.default&&x(new a.default)!=d||o.default&&x(o.default.resolve())!=f||s.default&&x(new s.default)!=h||l.default&&x(new l.default)!=p)&&(x=function(e){var t=(0,u.default)(e),n="[object Object]"==t?e.constructor:void 0,r=n?(0,c.default)(n):"";if(r)switch(r){case g:return v;case m:return d;case y:return f;case b:return h;case _:return p;}return t;});var w=x;},ebd74549:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=r._(n("4ce96d25")),s=n("4dd8dc26"),l=r._(n("9da356db"));class u extends o.default{constructor(...e){super(...e),(0,a.default)(this,"type","RasterLayer");}buildModels(){var e=this;return(0,i.default)(function*(){let t=e.getModelType();e.layerModel=new l.default[t](e),yield e.initLayerModels();})();}getDefaultConfig(){return({raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}})[this.getModelType()];}getModelType(){switch(this.layerSource.getParserType()){case"raster":case"ndi":default:return"raster";case"rasterRgb":case"rgb":return"rasterRgb";case"image":return"rasterTerrainRgb";}}getLegend(e){if("color"!==e)return{type:void 0,field:void 0,items:[]};let t=this.getLayerConfig().rampColors;return(0,s.rampColor2legend)(t,e);}}},ec3e7c7c:function(e,t,n){var r=n("3e5a5661");e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength);};},eccaef7c:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"createDOM",{enumerable:!0,get:function(){return r.createDOM;}});var r=n("c4f4b481");},ecda7e01:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("d2dabb01");function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,r.isAnyArray)(e))throw TypeError("input must be an array");if(0===e.length)throw TypeError("input must not be empty");var n=t.fromIndex,i=void 0===n?0:n,a=t.toIndex,o=void 0===a?e.length:a;if(i<0||i>=e.length||!Number.isInteger(i))throw Error("fromIndex must be a positive integer smaller than length");if(o<=i||o>e.length||!Number.isInteger(o))throw Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=e[i],l=i+1;l<o;l++)e[l]>s&&(s=e[l]);return s;}},ece1ce11:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"HeatmapLayer",{enumerable:!0,get:function(){return o;}});var r=n("ddd1eef0"),i=n("9d065c04"),a=n("acec17a3"),o=(0,i.memo)((0,i.forwardRef)(function(e,t){var n=(0,a.useCreateLayer)(r.HeatmapLayer,e);return(0,a.useLayerEvent)(n.current,e),(0,i.useImperativeHandle)(t,function(){return n.current;}),null;}));},ed13580d:function(e,t,n){var r=n("6ce1af71"),i=n("7c1db5f7");e.exports=function(e,t,n){var a=!0,o=!0;if("function"!=typeof e)throw TypeError("Expected a function");return i(n)&&(a="leading"in n?!!n.leading:a,o="trailing"in n?!!n.trailing:o),r(e,t,{leading:a,maxWait:t,trailing:o});};},ed2bf8a3:function(e,t,n){var r;if("function"==typeof n)try{r={clone:n("ae7833e7"),constant:n("df18c8e8"),each:n("6ae941e3"),filter:n("e8cc97d4"),has:n("684a09cf"),isArray:n("c0051812"),isEmpty:n("36ba8608"),isFunction:n("d59953b5"),isUndefined:n("0654920e"),keys:n("16ec8ed6"),map:n("3af9c24c"),reduce:n("ef673027"),size:n("66ee10cd"),transform:n("8ef9d700"),union:n("acd36e4a"),values:n("1d48c64c")};}catch(e){}r||(r=window._),e.exports=r;},ee80be28:function(e,t,n){var r=n("13060ce4"),i=n("98710e85"),a=n("a6555055"),o=n("49f9401f"),s=n("d1473659"),l=n("297109c8"),u=n("c4fc35e5");e.exports=function(e,t){return o(e)&&s(t)?l(u(e),t):function(n){var o=i(n,e);return void 0===o&&o===t?a(n,e):r(t,o,3);};};},eea0eef8:function(e,t,n){"use strict";function r(e){return e[0];}function i(e){return arguments.length?(this._x=e,this):this._x;}n.d(t,"__esModule",{value:!0}),n.e(t,{default:function(){return i;},defaultX:function(){return r;}});},eed78134:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return f;}});var r=n("777fffbe"),i=r._(n("05a4af02")),a=r._(n("ae14e70c")),o=r._(n("aa15234a")),s=r._(n("05c30d73")),l=r._(n("ba9a3e2b")),u=r._(n("39a6347f")),c=i.default?i.default.prototype:void 0,d=c?c.valueOf:void 0,f=function(e,t,n,r,i,c,f){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":if(e.byteLength!=t.byteLength||!c(new a.default(e),new a.default(t)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return(0,o.default)(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var h=l.default;case"[object Set]":var p=1&r;if(h||(h=u.default),e.size!=t.size&&!p)break;var v=f.get(e);if(v)return v==t;r|=2,f.set(e,t);var g=(0,s.default)(h(e),h(t),r,i,c,f);return f.delete(e),g;case"[object Symbol]":if(d)return d.call(e)==d.call(t);}return!1;};},ef21f553:function(e,t,n){var r=n("a985b25e"),i=n("bf992847");e.exports=function(e,t){return r(e,i(e),t);};},ef3d4035:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return b;}});var r=n("777fffbe"),i=n("852bbaa9"),a=r._(n("daaa1548")),o=r._(n("f89fb776")),s=r._(n("d812e418")),l=n("d9b661b3"),u=n("fb1ec05a"),c=n("5139e142"),d=i._(n("059bce2f")),f=i._(n("1700b93d")),h=r._(n("1fc5e31d"));let{isNil:p,isString:v,uniq:g}=u.lodashUtil,m=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,y={[l.ScaleTypes.LINEAR]:f.scaleLinear,[l.ScaleTypes.POWER]:f.scalePow,[l.ScaleTypes.LOG]:f.scaleLog,[l.ScaleTypes.IDENTITY]:h.default,[l.ScaleTypes.SEQUENTIAL]:f.scaleSequential,[l.ScaleTypes.TIME]:f.scaleTime,[l.ScaleTypes.QUANTILE]:f.scaleQuantile,[l.ScaleTypes.QUANTIZE]:f.scaleQuantize,[l.ScaleTypes.THRESHOLD]:f.scaleThreshold,[l.ScaleTypes.CAT]:f.scaleOrdinal,[l.ScaleTypes.DIVERGING]:f.scaleDiverging};class b{constructor(){(0,s.default)(this,"scaleOptions",{});}apply(e,{styleAttributeService:t}){var n,r=this;e.hooks.init.tapPromise("FeatureScalePlugin",(0,o.default)(function*(){var n;e.log(l.IDebugLog.ScaleInitStart,l.ILayerStage.INIT),r.scaleOptions=e.getScaleOptions();let i=t.getLayerStyleAttributes(),a=null===(n=e.getSource())||void 0===n?void 0:n.data.dataArray;Array.isArray(a)&&0===a.length||(r.caculateScalesForAttributes(i||[],a),e.log(l.IDebugLog.ScaleInitEnd,l.ILayerStage.INIT));})),e.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",(n=(0,o.default)(function*(n){if(!n)return n;e.log(l.IDebugLog.ScaleInitStart,l.ILayerStage.UPDATE),r.scaleOptions=e.getScaleOptions();let i=t.getLayerStyleAttributes(),a=e.getSource().data.dataArray;return!!Array.isArray(a)&&0===a.length||(r.caculateScalesForAttributes(i||[],a),e.log(l.IDebugLog.ScaleInitEnd,l.ILayerStage.UPDATE),e.layerModelNeedUpdate=!0,!0);}),function(e){return n.apply(this,arguments);})),e.hooks.beforeRender.tap("FeatureScalePlugin",()=>{if(e.layerModelNeedUpdate)return;this.scaleOptions=e.getScaleOptions();let n=t.getLayerStyleAttributes(),r=e.getSource().data.dataArray;if((!Array.isArray(r)||0!==r.length)&&n){let e=n.filter(e=>e.needRescale);e.length&&this.caculateScalesForAttributes(e,r);}});}isNumber(e){return!isNaN(parseFloat(e))&&isFinite(e);}caculateScalesForAttributes(e,t){e.forEach(e=>{if(e.scale){let n=e.scale,r=e.scale.field;n.names=this.parseFields(p(r)?[]:r);let i=[];n.names.forEach(n=>{var r;i.push(this.createScale(n,e.name,null===(r=e.scale)||void 0===r?void 0:r.values,t));}),i.some(e=>e.type===l.StyleScaleType.VARIABLE)?(n.type=l.StyleScaleType.VARIABLE,i.forEach(e=>{var t,r;if(!n.callback&&"text"!==n.values)switch(null===(t=e.option)||void 0===t?void 0:t.type){case l.ScaleTypes.LOG:case l.ScaleTypes.LINEAR:case l.ScaleTypes.POWER:if(n.values&&n.values.length>2){let t=e.scale.ticks(n.values.length);e.scale.domain(t);}n.values?e.scale.range(n.values):e.scale.range(e.option.domain);break;case l.ScaleTypes.QUANTILE:case l.ScaleTypes.QUANTIZE:case l.ScaleTypes.THRESHOLD:e.scale.range(n.values);break;case l.ScaleTypes.IDENTITY:break;case l.ScaleTypes.CAT:n.values?e.scale.range(n.values):e.scale.range(e.option.domain);break;case l.ScaleTypes.DIVERGING:case l.ScaleTypes.SEQUENTIAL:e.scale.interpolator(d.interpolateRgbBasis(n.values));}"text"===n.values&&e.scale.range(null===(r=e.option)||void 0===r?void 0:r.domain);})):(n.type=l.StyleScaleType.CONSTANT,n.defaultValues=i.map((e,t)=>e.scale(n.names[t]))),n.scalers=i.map(e=>({field:e.field,func:e.scale,option:e.option})),e.needRescale=!1;}});}parseFields(e){return Array.isArray(e)?e:v(e)?e.split("*"):[e];}createScale(e,t,n,r){var i,a;let o=this.scaleOptions[t]&&(null===(i=this.scaleOptions[t])||void 0===i?void 0:i.field)===e?this.scaleOptions[t]:this.scaleOptions[e],s={field:e,scale:void 0,type:l.StyleScaleType.VARIABLE,option:o};if(!r||!r.length)return o&&o.type?s.scale=this.createDefaultScale(o):(s.scale=f.scaleOrdinal([e]),s.type=l.StyleScaleType.CONSTANT),s;let u=null===(a=r.find(t=>!p(t[e])))||void 0===a?void 0:a[e];if(this.isNumber(e)||p(u)&&!o)s.scale=f.scaleOrdinal([e]),s.type=l.StyleScaleType.CONSTANT;else{let t=o&&o.type||this.getDefaultType(u);"text"===n&&(t=l.ScaleTypes.CAT),void 0===n&&(t=l.ScaleTypes.IDENTITY);let i=this.createScaleConfig(t,e,o,r);s.scale=this.createDefaultScale(i),s.option=i;}return s;}getDefaultType(e){let t=l.ScaleTypes.LINEAR;return"string"==typeof e&&(t=m.test(e)?l.ScaleTypes.TIME:l.ScaleTypes.CAT),t;}createScaleConfig(e,t,n,r){let i=(0,a.default)((0,a.default)({},n),{},{type:e});if(null!=i&&i.domain)return i;let o=[];if(e===l.ScaleTypes.QUANTILE){let e=new Map;null==r||r.forEach(n=>{e.set(n._id,n[t]);}),o=Array.from(e.values());}else o=(null==r?void 0:r.map(e=>e[t]))||[];if(e===l.ScaleTypes.CAT||e===l.ScaleTypes.IDENTITY)i.domain=g(o);else if(e===l.ScaleTypes.QUANTILE)i.domain=o;else if(e===l.ScaleTypes.DIVERGING){let e=(0,c.extent)(o),t=(null==n?void 0:n.neutral)!==void 0?null==n?void 0:n.neutral:(e[0]+e[1])/2;i.domain=[e[0],t,e[1]];}else i.domain=(0,c.extent)(o);return i;}createDefaultScale({type:e,domain:t,unknown:n,clamp:r,nice:i}){let a=y[e]();return t&&a.domain&&a.domain(t),n&&a.unknown(n),void 0!==r&&a.clamp&&a.clamp(r),void 0!==i&&a.nice&&a.nice(i),a;}}},ef51a61d:function(e,t,n){var r=n("586e66d4"),i=n("3f78af0a"),a=n("314af657"),o=n("46423930"),s=n("89b6e2f1"),l=n("6e3a9823"),u=n("d2230a39"),c="[object Map]",d="[object Promise]",f="[object Set]",h="[object WeakMap]",p="[object DataView]",v=u(r),g=u(i),m=u(a),y=u(o),b=u(s),_=l;(r&&_(new r(new ArrayBuffer(1)))!=p||i&&_(new i)!=c||a&&_(a.resolve())!=d||o&&_(new o)!=f||s&&_(new s)!=h)&&(_=function(e){var t=l(e),n="[object Object]"==t?e.constructor:void 0,r=n?u(n):"";if(r)switch(r){case v:return p;case g:return c;case m:return d;case y:return f;case b:return h;}return t;}),e.exports=_;},ef642ab1:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{AABB:function(){return ea;},AbstractRendererPlugin:function(){return Q;},CanvasEvent:function(){return iU;},CustomEvent:function(){return rO;},DisplayObject:function(){return ib;},ElementEvent:function(){return rF;},GradientType:function(){return tv;},Node:function(){return rR;},OffscreenCanvasCreator:function(){return rD;},Shape:function(){return $;},UnitType:function(){return tr;},computeLinearGradient:function(){return tP;},computeRadialGradient:function(){return tN;},isPattern:function(){return tj;},parseTransform:function(){return ny;},parsedTransformToMat4:function(){return rg;}});var r,i,a,o,s,l,u,c,d,f,h,p,v,g,m,y,b,_,x,w,E,M,S,k,C,A,L=n("777fffbe"),P=L._(n("daaa1548")),N=L._(n("1316cf9d")),O=L._(n("3d495adb")),I=L._(n("6c762716")),R=L._(n("66a06515")),D=L._(n("20defe2a")),z=L._(n("82f98358")),B=L._(n("e90c9dbd")),U=n("71293cfd");n("2b312dbf");var F=n("0d884ee9"),j=L._(n("d812e418")),V=L._(n("0389e1e1")),G=n("e1f276f6"),H=L._(n("83128d43")),W=L._(n("f89fb776")),Z=L._(n("d38f5467")),q=L._(n("b131ee44"));let Y=n("7b266b54");"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==Y||"undefined"!=typeof self&&self;var X={exports:{}};r=function(){function e(e,t,n){var r=e[t];e[t]=e[n],e[n]=r;}function t(e,t){return e<t?-1:e>t?1:0;}var n=function(e){void 0===e&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear();};function r(e,t){i(e,0,e.children.length,t,e);}function i(e,t,n,r,i){i||(i=f(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=t;o<n;o++){var s=e.children[o];a(i,e.leaf?r(s):s);}return i;}function a(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e;}function o(e,t){return e.minX-t.minX;}function s(e,t){return e.minY-t.minY;}function l(e){return(e.maxX-e.minX)*(e.maxY-e.minY);}function u(e){return e.maxX-e.minX+(e.maxY-e.minY);}function c(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY;}function d(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY;}function f(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};}function h(n,r,i,a,o){for(var s=[r,i];s.length;)if(!((i=s.pop())-(r=s.pop())<=a)){var l=r+Math.ceil((i-r)/a/2)*a;(function t(n,r,i,a,o){for(;a>i;){if(a-i>600){var s=a-i+1,l=r-i+1,u=Math.log(s),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1),f=Math.max(i,Math.floor(r-l*c/s+d)),h=Math.min(a,Math.floor(r+(s-l)*c/s+d));t(n,r,f,h,o);}var p=n[r],v=i,g=a;for(e(n,i,r),o(n[a],p)>0&&e(n,i,a);v<g;){for(e(n,v,g),v++,g--;0>o(n[v],p);)v++;for(;o(n[g],p)>0;)g--;}0===o(n[i],p)?e(n,i,g):e(n,++g,a),g<=r&&(i=g+1),r<=g&&(a=g-1);}})(n,l,r||0,i||n.length-1,o||t),s.push(r,l,l,i);}}return n.prototype.all=function(){return this._all(this.data,[]);},n.prototype.search=function(e){var t=this.data,n=[];if(!d(e,t))return n;for(var r=this.toBBox,i=[];t;){for(var a=0;a<t.children.length;a++){var o=t.children[a],s=t.leaf?r(o):o;d(e,s)&&(t.leaf?n.push(o):c(e,s)?this._all(o,n):i.push(o));}t=i.pop();}return n;},n.prototype.collides=function(e){var t=this.data;if(!d(e,t))return!1;for(var n=[];t;){for(var r=0;r<t.children.length;r++){var i=t.children[r],a=t.leaf?this.toBBox(i):i;if(d(e,a)){if(t.leaf||c(e,a))return!0;n.push(i);}}t=n.pop();}return!1;},n.prototype.load=function(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(var t=0;t<e.length;t++)this.insert(e[t]);return this;}var n=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length){if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r;}this._insert(n,this.data.height-n.height-1,!0);}}else this.data=n;return this;},n.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this;},n.prototype.clear=function(){return this.data=f([]),this;},n.prototype.remove=function(e,t){if(!e)return this;for(var n,r,i,a=this.data,o=this.toBBox(e),s=[],l=[];a||s.length;){if(a||(a=s.pop(),r=s[s.length-1],n=l.pop(),i=!0),a.leaf){var u=function(e,t,n){if(!n)return t.indexOf(e);for(var r=0;r<t.length;r++)if(n(e,t[r]))return r;return -1;}(e,a.children,t);if(-1!==u){a.children.splice(u,1),s.push(a),this._condense(s);break;}}!i&&!a.leaf&&c(a,o)?(s.push(a),l.push(n),n=0,r=a,a=a.children[0]):r?(n++,a=r.children[n],i=!1):a=null;}return this;},n.prototype.toBBox=function(e){return e;},n.prototype.compareMinX=function(e,t){return e.minX-t.minX;},n.prototype.compareMinY=function(e,t){return e.minY-t.minY;},n.prototype.toJSON=function(){return this.data;},n.prototype.fromJSON=function(e){return this.data=e,this;},n.prototype._all=function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t;},n.prototype._build=function(e,t,n,i){var a,o=n-t+1,s=this._maxEntries;if(o<=s)return r(a=f(e.slice(t,n+1)),this.toBBox),a;i||(i=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,i-1))),(a=f([])).leaf=!1,a.height=i;var l=Math.ceil(o/s),u=l*Math.ceil(Math.sqrt(s));h(e,t,n,u,this.compareMinX);for(var c=t;c<=n;c+=u){var d=Math.min(c+u-1,n);h(e,c,d,l,this.compareMinY);for(var p=c;p<=d;p+=l){var v=Math.min(p+l-1,d);a.children.push(this._build(e,p,v,i-1));}}return r(a,this.toBBox),a;},n.prototype._chooseSubtree=function(e,t,n,r){for(;r.push(t),!t.leaf&&r.length-1!==n;){for(var i=1/0,a=1/0,o=void 0,s=0;s<t.children.length;s++){var u=t.children[s],c=l(u),d=(Math.max(u.maxX,e.maxX)-Math.min(u.minX,e.minX))*(Math.max(u.maxY,e.maxY)-Math.min(u.minY,e.minY))-c;d<a?(a=d,i=c<i?c:i,o=u):d===a&&c<i&&(i=c,o=u);}t=o||t.children[0];}return t;},n.prototype._insert=function(e,t,n){var r=n?e:this.toBBox(e),i=[],o=this._chooseSubtree(r,this.data,t,i);for(o.children.push(e),a(o,r);t>=0;)if(i[t].children.length>this._maxEntries)this._split(i,t),t--;else break;this._adjustParentBBoxes(r,i,t);},n.prototype._split=function(e,t){var n=e[t],i=n.children.length,a=this._minEntries;this._chooseSplitAxis(n,a,i);var o=this._chooseSplitIndex(n,a,i),s=f(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,r(n,this.toBBox),r(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s);},n.prototype._splitRoot=function(e,t){this.data=f([e,t]),this.data.height=e.height+1,this.data.leaf=!1,r(this.data,this.toBBox);},n.prototype._chooseSplitIndex=function(e,t,n){for(var r,a=1/0,o=1/0,s=t;s<=n-t;s++){var u=i(e,0,s,this.toBBox),c=i(e,s,n,this.toBBox),d=function(e,t){var n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY);return Math.max(0,Math.min(e.maxX,t.maxX)-n)*Math.max(0,Math.min(e.maxY,t.maxY)-r);}(u,c),f=l(u)+l(c);d<a?(a=d,r=s,o=f<o?f:o):d===a&&f<o&&(o=f,r=s);}return r||n-t;},n.prototype._chooseSplitAxis=function(e,t,n){var r=e.leaf?this.compareMinX:o,i=e.leaf?this.compareMinY:s;this._allDistMargin(e,t,n,r)<this._allDistMargin(e,t,n,i)&&e.children.sort(r);},n.prototype._allDistMargin=function(e,t,n,r){e.children.sort(r);for(var o=this.toBBox,s=i(e,0,t,o),l=i(e,n-t,n,o),c=u(s)+u(l),d=t;d<n-t;d++){var f=e.children[d];a(s,e.leaf?o(f):f),c+=u(s);}for(var h=n-t-1;h>=t;h--){var p=e.children[h];a(l,e.leaf?o(p):p),c+=u(l);}return c;},n.prototype._adjustParentBBoxes=function(e,t,n){for(var r=n;r>=0;r--)a(t[r],e);},n.prototype._condense=function(e){for(var t=e.length-1,n=void 0;t>=0;t--)0===e[t].children.length?t>0?(n=e[t-1].children).splice(n.indexOf(e[t]),1):this.clear():r(e[t],this.toBBox);},n;},X.exports=r(),X.exports;var $=((i={}).GROUP="g",i.FRAGMENT="fragment",i.CIRCLE="circle",i.ELLIPSE="ellipse",i.IMAGE="image",i.RECT="rect",i.LINE="line",i.POLYLINE="polyline",i.POLYGON="polygon",i.TEXT="text",i.PATH="path",i.HTML="html",i.MESH="mesh",i),K=((a={})[a.ZERO=0]="ZERO",a[a.NEGATIVE_ONE=1]="NEGATIVE_ONE",a),Q=(0,O.default)(function e(){(0,N.default)(this,e),this.plugins=[];},[{key:"addRenderingPlugin",value:function(e){this.plugins.push(e),this.context.renderingPlugins.push(e);}},{key:"removeAllRenderingPlugins",value:function(){var e=this;this.plugins.forEach(function(t){var n=e.context.renderingPlugins.indexOf(t);n>=0&&e.context.renderingPlugins.splice(n,1);});}}]),J=U.vec3.add,ee=U.vec3.copy,et=U.vec3.max,en=U.vec3.min,er=U.vec3.scale,ei=U.vec3.sub,ea=function(){function e(){(0,N.default)(this,e),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0];}return(0,O.default)(e,[{key:"update",value:function(e,t){ee(this.center,e),ee(this.halfExtents,t),ei(this.min,this.center,this.halfExtents),J(this.max,this.center,this.halfExtents);}},{key:"setMinMax",value:function(e,t){J(this.center,t,e),er(this.center,this.center,.5),ei(this.halfExtents,t,e),er(this.halfExtents,this.halfExtents,.5),ee(this.min,e),ee(this.max,t);}},{key:"getMin",value:function(){return this.min;}},{key:"getMax",value:function(){return this.max;}},{key:"add",value:function(t){if(!e.isEmpty(t)){if(e.isEmpty(this)){this.setMinMax(t.getMin(),t.getMax());return;}var n=this.center,r=n[0],i=n[1],a=n[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],c=r-s,d=r+s,f=i-l,h=i+l,p=a-u,v=a+u,g=t.center,m=g[0],y=g[1],b=g[2],_=t.halfExtents,x=_[0],w=_[1],E=_[2],M=m-x,S=m+x,k=y-w,C=y+w,A=b-E,L=b+E;M<c&&(c=M),S>d&&(d=S),k<f&&(f=k),C>h&&(h=C),A<p&&(p=A),L>v&&(v=L),n[0]=(c+d)*.5,n[1]=(f+h)*.5,n[2]=(p+v)*.5,o[0]=(d-c)*.5,o[1]=(h-f)*.5,o[2]=(v-p)*.5,this.min[0]=c,this.min[1]=f,this.min[2]=p,this.max[0]=d,this.max[1]=h,this.max[2]=v;}}},{key:"setFromTransformedAABB",value:function(e,t){var n=this.center,r=this.halfExtents,i=e.center,a=e.halfExtents,o=t[0],s=t[4],l=t[8],u=t[1],c=t[5],d=t[9],f=t[2],h=t[6],p=t[10],v=Math.abs(o),g=Math.abs(s),m=Math.abs(l),y=Math.abs(u),b=Math.abs(c),_=Math.abs(d),x=Math.abs(f),w=Math.abs(h),E=Math.abs(p);n[0]=t[12]+o*i[0]+s*i[1]+l*i[2],n[1]=t[13]+u*i[0]+c*i[1]+d*i[2],n[2]=t[14]+f*i[0]+h*i[1]+p*i[2],r[0]=v*a[0]+g*a[1]+m*a[2],r[1]=y*a[0]+b*a[1]+_*a[2],r[2]=x*a[0]+w*a[1]+E*a[2],ei(this.min,n,r),J(this.max,n,r);}},{key:"intersects",value:function(e){var t=this.getMax(),n=this.getMin(),r=e.getMax(),i=e.getMin();return n[0]<=r[0]&&t[0]>=i[0]&&n[1]<=r[1]&&t[1]>=i[1]&&n[2]<=r[2]&&t[2]>=i[2];}},{key:"intersection",value:function(t){if(!this.intersects(t))return null;var n=new e,r=et([0,0,0],this.getMin(),t.getMin()),i=en([0,0,0],this.getMax(),t.getMax());return n.setMinMax(r,i),n;}},{key:"getNegativeFarPoint",value:function(e){return 273===e.pnVertexFlag?ee([0,0,0],this.min):272===e.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===e.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===e.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===e.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===e.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===e.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]];}},{key:"getPositiveFarPoint",value:function(e){return 273===e.pnVertexFlag?ee([0,0,0],this.max):272===e.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===e.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===e.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===e.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===e.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===e.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]];}}],[{key:"isEmpty",value:function(e){return!e||0===e.halfExtents[0]&&0===e.halfExtents[1]&&0===e.halfExtents[2];}}]);}(),eo=(0,O.default)(function e(t,n){(0,N.default)(this,e),this.distance=t||0,this.normal=n||U.vec3.fromValues(0,1,0),this.updatePNVertexFlag();},[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0);}},{key:"distanceToPoint",value:function(e){return U.vec3.dot(e,this.normal)-this.distance;}},{key:"normalize",value:function(){var e=1/U.vec3.len(this.normal);U.vec3.scale(this.normal,this.normal,e),this.distance*=e;}},{key:"intersectsLine",value:function(e,t,n){var r=this.distanceToPoint(e),i=r/(r-this.distanceToPoint(t)),a=i>=0&&i<=1;return a&&n&&U.vec3.lerp(n,e,t,i),a;}}]),es=((o={})[o.OUTSIDE=4294967295]="OUTSIDE",o[o.INSIDE=0]="INSIDE",o[o.INDETERMINATE=2147483647]="INDETERMINATE",o),el=(0,O.default)(function e(t){if((0,N.default)(this,e),this.planes=[],t)this.planes=t;else for(var n=0;n<6;n++)this.planes.push(new eo);},[{key:"extractFromVPMatrix",value:function(e){var t=(0,z.default)(e,16),n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],d=t[9],f=t[10],h=t[11],p=t[12],v=t[13],g=t[14],m=t[15];U.vec3.set(this.planes[0].normal,a-n,u-o,h-c),this.planes[0].distance=m-p,U.vec3.set(this.planes[1].normal,a+n,u+o,h+c),this.planes[1].distance=m+p,U.vec3.set(this.planes[2].normal,a+r,u+s,h+d),this.planes[2].distance=m+v,U.vec3.set(this.planes[3].normal,a-r,u-s,h-d),this.planes[3].distance=m-v,U.vec3.set(this.planes[4].normal,a-i,u-l,h-f),this.planes[4].distance=m-g,U.vec3.set(this.planes[5].normal,a+i,u+l,h+f),this.planes[5].distance=m+g,this.planes.forEach(function(e){e.normalize(),e.updatePNVertexFlag();});}}]),eu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,N.default)(this,e),this.x=0,this.y=0,this.x=t,this.y=n;}return(0,O.default)(e,[{key:"clone",value:function(){return new e(this.x,this.y);}},{key:"copyFrom",value:function(e){this.x=e.x,this.y=e.y;}}]);}(),ec=function(){function e(t,n,r,i){(0,N.default)(this,e),this.x=t,this.y=n,this.width=r,this.height=i,this.left=t,this.right=t+r,this.top=n,this.bottom=n+i;}return(0,O.default)(e,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(t){return new e(t.x,t.y,t.width,t.height);}},{key:"applyTransform",value:function(t,n){var r=U.vec4.fromValues(t.x,t.y,0,1),i=U.vec4.fromValues(t.x+t.width,t.y,0,1),a=U.vec4.fromValues(t.x,t.y+t.height,0,1),o=U.vec4.fromValues(t.x+t.width,t.y+t.height,0,1),s=U.vec4.create(),l=U.vec4.create(),u=U.vec4.create(),c=U.vec4.create();U.vec4.transformMat4(s,r,n),U.vec4.transformMat4(l,i,n),U.vec4.transformMat4(u,a,n),U.vec4.transformMat4(c,o,n);var d=Math.min(s[0],l[0],u[0],c[0]),f=Math.min(s[1],l[1],u[1],c[1]),h=Math.max(s[0],l[0],u[0],c[0]),p=Math.max(s[1],l[1],u[1],c[1]);return e.fromRect({x:d,y:f,width:h-d,height:p-f});}}]);}(),ed="Method not implemented.";function ef(e){return void 0===e?0:e>360||e<-360?e%360:e;}var eh=U.vec3.create();function ep(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return Array.isArray(e)&&3===e.length?r?U.vec3.clone(e):U.vec3.copy(eh,e):(0,F.isNumber)(e)?r?U.vec3.fromValues(e,t,n):U.vec3.set(eh,e,t,n):r?U.vec3.fromValues(e[0],e[1]||t,e[2]||n):U.vec3.set(eh,e[0],e[1]||t,e[2]||n);}var ev=Math.PI/180,eg=180/Math.PI,em=Math.PI/2;function ey(e,t){var n,r,i,a,o,s,l,u,c,d,f,h,p,v,g,m,y;return 16===t.length?(i=U.mat4.getScaling(U.vec3.create(),t),o=(a=(0,z.default)(i,3))[0],s=a[1],l=a[2],(u=Math.asin(-t[2]/o))<em?u>-em?(n=Math.atan2(t[6]/s,t[10]/l),r=Math.atan2(t[1]/o,t[0]/o)):(r=0,n=-Math.atan2(t[4]/s,t[5]/s)):(r=0,n=Math.atan2(t[4]/s,t[5]/s)),e[0]=n,e[1]=u,e[2]=r):(c=t[0],d=t[1],f=t[2],h=t[3],m=c*c+(p=d*d)+(v=f*f)+(g=h*h),(y=c*h-d*f)>.499995*m?(e[0]=em,e[1]=2*Math.atan2(d,c),e[2]=0):y<-.499995*m?(e[0]=-em,e[1]=2*Math.atan2(d,c),e[2]=0):(e[0]=Math.asin(2*(c*f-h*d)),e[1]=Math.atan2(2*(c*h+d*f),1-2*(v+g)),e[2]=Math.atan2(2*(c*d+f*h),1-2*(p+v)))),e;}function eb(e){var t=e[0],n=e[1],r=e[3],i=e[4],a=Math.sqrt(t*t+n*n),o=Math.sqrt(r*r+i*i);if(t*i-n*r<0&&(t<i?a=-a:o=-o),a){var s=1/a;t*=s,n*=s;}if(o){var l=1/o;r*=l,i*=l;}var u=Math.atan2(n,t)*eg;return[e[6],e[7],a,o,u];}var e_=U.mat4.create(),ex=U.mat4.create(),ew=U.vec4.create(),eE=[U.vec3.create(),U.vec3.create(),U.vec3.create()],eM=U.vec3.create();function eT(e,t,n,r,i){e[0]=t[0]*r+n[0]*i,e[1]=t[1]*r+n[1]*i,e[2]=t[2]*r+n[2]*i;}var eS=((s={})[s.ORBITING=0]="ORBITING",s[s.EXPLORING=1]="EXPLORING",s[s.TRACKING=2]="TRACKING",s),ek=((l={})[l.DEFAULT=0]="DEFAULT",l[l.ROTATIONAL=1]="ROTATIONAL",l[l.TRANSLATIONAL=2]="TRANSLATIONAL",l[l.CINEMATIC=3]="CINEMATIC",l),eC=((u={})[u.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",u[u.PERSPECTIVE=1]="PERSPECTIVE",u),eA={UPDATED:"updated"},eL=(0,O.default)(function e(){(0,N.default)(this,e),this.clipSpaceNearZ=K.NEGATIVE_ONE,this.eventEmitter=new B.default,this.matrix=U.mat4.create(),this.right=U.vec3.fromValues(1,0,0),this.up=U.vec3.fromValues(0,1,0),this.forward=U.vec3.fromValues(0,0,1),this.position=U.vec3.fromValues(0,0,1),this.focalPoint=U.vec3.fromValues(0,0,0),this.distanceVector=U.vec3.fromValues(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=U.mat4.create(),this.projectionMatrixInverse=U.mat4.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=eS.EXPLORING,this.trackingMode=ek.DEFAULT,this.projectionMode=eC.PERSPECTIVE,this.frustum=new el,this.orthoMatrix=U.mat4.create();},[{key:"isOrtho",value:function(){return this.projectionMode===eC.ORTHOGRAPHIC;}},{key:"getProjectionMode",value:function(){return this.projectionMode;}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix;}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse;}},{key:"getFrustum",value:function(){return this.frustum;}},{key:"getPosition",value:function(){return this.position;}},{key:"getFocalPoint",value:function(){return this.focalPoint;}},{key:"getDollyingStep",value:function(){return this.dollyingStep;}},{key:"getNear",value:function(){return this.near;}},{key:"getFar",value:function(){return this.far;}},{key:"getZoom",value:function(){return this.zoom;}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix;}},{key:"getView",value:function(){return this.view;}},{key:"setEnableUpdate",value:function(e){this.enableUpdate=e;}},{key:"setType",value:function(e,t){return this.type=e,this.type===eS.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===eS.TRACKING&&void 0!==t&&this.setTrackingMode(t),this;}},{key:"setProjectionMode",value:function(e){return this.projectionMode=e,this;}},{key:"setTrackingMode",value:function(e){if(this.type!==eS.TRACKING)throw Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=e,this;}},{key:"setWorldRotation",value:function(e){return this.rotateWorld=e,this._getAngles(),this;}},{key:"getViewTransform",value:function(){return U.mat4.invert(U.mat4.create(),this.matrix);}},{key:"getWorldTransform",value:function(){return this.matrix;}},{key:"jitterProjectionMatrix",value:function(e,t){var n=U.mat4.fromTranslation(U.mat4.create(),[e,t,0]);this.jitteredProjectionMatrix=U.mat4.multiply(U.mat4.create(),n,this.projectionMatrix);}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0;}},{key:"setMatrix",value:function(e){return this.matrix=e,this._update(),this;}},{key:"setProjectionMatrix",value:function(e){this.projectionMatrix=e;}},{key:"setFov",value:function(e){return this.setPerspective(this.near,this.far,e,this.aspect),this;}},{key:"setAspect",value:function(e){return this.setPerspective(this.near,this.far,this.fov,e),this;}},{key:"setNear",value:function(e){return this.projectionMode===eC.PERSPECTIVE?this.setPerspective(e,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,e,this.far),this;}},{key:"setFar",value:function(e){return this.projectionMode===eC.PERSPECTIVE?this.setPerspective(this.near,e,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,e),this;}},{key:"setViewOffset",value:function(e,t,n,r,i,a){return this.aspect=e/t,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.projectionMode===eC.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===eC.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"setZoom",value:function(e){return this.zoom=e,this.projectionMode===eC.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===eC.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this;}},{key:"setZoomByViewportPoint",value:function(e,t){var n=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),r=n.x,i=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(r,i),this.setFocalPoint(r,i),this.setZoom(e),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),s=o.x,l=o.y,u=U.vec3.fromValues(s-r,l-i,0),c=U.vec3.dot(u,this.right)/U.vec3.length(this.right),d=U.vec3.dot(u,this.up)/U.vec3.length(this.up),f=this.getPosition(),h=(0,z.default)(f,2),p=h[0],v=h[1],g=this.getFocalPoint(),m=(0,z.default)(g,2),y=m[0],b=m[1];return this.setPosition(p-c,v-d),this.setFocalPoint(y-c,b-d),this;}},{key:"setPerspective",value:function(e,t,n,r){this.projectionMode=eC.PERSPECTIVE,this.fov=n,this.near=e,this.far=t,this.aspect=r;var i,a=this.near*Math.tan(.5*this.fov*ev)/this.zoom,o=2*a,s=this.aspect*o,l=-.5*s;if(null!==(i=this.view)&&void 0!==i&&i.enabled){var u=this.view.fullWidth,c=this.view.fullHeight;l+=this.view.offsetX*s/u,a-=this.view.offsetY*o/c,s*=this.view.width/u,o*=this.view.height/c;}return!function(e,t,n,r,i,a,o){var s,l,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=2*a,d=n-t,f=r-i,h=o-a,p=o*a;u?(s=-o/h,l=-p/h):(s=-(o+a)/h,l=-2*p/h),e[0]=c/d,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c/f,e[6]=0,e[7]=0,e[8]=(n+t)/d,e[9]=(r+i)/f,e[10]=s,e[11]=-1,e[12]=0,e[13]=0,e[14]=l,e[15]=0;}(this.projectionMatrix,l,l+s,a-o,a,e,this.far,this.clipSpaceNearZ===K.ZERO),U.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this;}},{key:"setOrthographic",value:function(e,t,n,r,i,a){this.projectionMode=eC.ORTHOGRAPHIC,this.rright=t,this.left=e,this.top=n,this.bottom=r,this.near=i,this.far=a;var o,s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,d=u-s,f=u+s,h=c+l,p=c-l;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var v=(this.rright-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d+=v*this.view.offsetX,f=d+v*this.view.width,h-=g*this.view.offsetY,p=h-g*this.view.height;}return this.clipSpaceNearZ===K.NEGATIVE_ONE?U.mat4.ortho(this.projectionMatrix,d,f,h,p,i,a):U.mat4.orthoZO(this.projectionMatrix,d,f,h,p,i,a),U.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this;}},{key:"setPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2],r=ep(e,t,n);return this._setPosition(r),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this;}},{key:"setFocalPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],r=U.vec3.fromValues(0,1,0);if(this.focalPoint=ep(e,t,n),this.trackingMode===ek.CINEMATIC){var i=U.vec3.subtract(U.vec3.create(),this.focalPoint,this.position);e=i[0],t=i[1],n=i[2];var a=Math.asin(t/U.vec3.length(i))*eg,o=90+Math.atan2(n,e)*eg,s=U.mat4.create();U.mat4.rotateY(s,s,o*ev),U.mat4.rotateX(s,s,a*ev),r=U.vec3.transformMat4(U.vec3.create(),[0,1,0],s);}return U.mat4.invert(this.matrix,U.mat4.lookAt(U.mat4.create(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this;}},{key:"getDistance",value:function(){return this.distance;}},{key:"getDistanceVector",value:function(){return this.distanceVector;}},{key:"setDistance",value:function(e){if(this.distance===e||e<0)return this;this.distance=e,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var t=U.vec3.create();e=this.distance;var n=this.forward,r=this.focalPoint;return t[0]=e*n[0]+r[0],t[1]=e*n[1]+r[1],t[2]=e*n[2]+r[2],this._setPosition(t),this.triggerUpdate(),this;}},{key:"setMaxDistance",value:function(e){return this.maxDistance=e,this;}},{key:"setMinDistance",value:function(e){return this.minDistance=e,this;}},{key:"setAzimuth",value:function(e){return this.azimuth=ef(e),this.computeMatrix(),this._getAxes(),this.type===eS.ORBITING||this.type===eS.EXPLORING?this._getPosition():this.type===eS.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getAzimuth",value:function(){return this.azimuth;}},{key:"setElevation",value:function(e){return this.elevation=ef(e),this.computeMatrix(),this._getAxes(),this.type===eS.ORBITING||this.type===eS.EXPLORING?this._getPosition():this.type===eS.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getElevation",value:function(){return this.elevation;}},{key:"setRoll",value:function(e){return this.roll=ef(e),this.computeMatrix(),this._getAxes(),this.type===eS.ORBITING||this.type===eS.EXPLORING?this._getPosition():this.type===eS.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getRoll",value:function(){return this.roll;}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate();}},{key:"computeMatrix",value:function(){var e=U.quat.setAxisAngle(U.quat.create(),[0,0,1],this.roll*ev);U.mat4.identity(this.matrix);var t=U.quat.setAxisAngle(U.quat.create(),[1,0,0],(this.rotateWorld&&this.type!==eS.TRACKING||this.type===eS.TRACKING?1:-1)*this.elevation*ev),n=U.quat.setAxisAngle(U.quat.create(),[0,1,0],(this.rotateWorld&&this.type!==eS.TRACKING||this.type===eS.TRACKING?1:-1)*this.azimuth*ev),r=U.quat.multiply(U.quat.create(),n,t);r=U.quat.multiply(U.quat.create(),r,e);var i=U.mat4.fromQuat(U.mat4.create(),r);this.type===eS.ORBITING||this.type===eS.EXPLORING?(U.mat4.translate(this.matrix,this.matrix,this.focalPoint),U.mat4.multiply(this.matrix,this.matrix,i),U.mat4.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===eS.TRACKING&&(U.mat4.translate(this.matrix,this.matrix,this.position),U.mat4.multiply(this.matrix,this.matrix,i));}},{key:"_setPosition",value:function(e,t,n){this.position=ep(e,t,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix();}},{key:"_getAxes",value:function(){U.vec3.copy(this.right,ep(U.vec4.transformMat4(U.vec4.create(),[1,0,0,0],this.matrix))),U.vec3.copy(this.up,ep(U.vec4.transformMat4(U.vec4.create(),[0,1,0,0],this.matrix))),U.vec3.copy(this.forward,ep(U.vec4.transformMat4(U.vec4.create(),[0,0,1,0],this.matrix))),U.vec3.normalize(this.right,this.right),U.vec3.normalize(this.up,this.up),U.vec3.normalize(this.forward,this.forward);}},{key:"_getAngles",value:function(){var e=this.distanceVector[0],t=this.distanceVector[1],n=this.distanceVector[2],r=U.vec3.length(this.distanceVector);if(0===r){this.elevation=0,this.azimuth=0;return;}this.type===eS.TRACKING?(this.elevation=Math.asin(t/r)*eg,this.azimuth=Math.atan2(-e,-n)*eg):this.rotateWorld?(this.elevation=Math.asin(t/r)*eg,this.azimuth=Math.atan2(-e,-n)*eg):(this.elevation=-(Math.asin(t/r)*eg),this.azimuth=-(Math.atan2(-e,-n)*eg));}},{key:"_getPosition",value:function(){U.vec3.copy(this.position,ep(U.vec4.transformMat4(U.vec4.create(),[0,0,0,1],this.matrix))),this._getDistance();}},{key:"_getFocalPoint",value:function(){U.vec3.transformMat3(this.distanceVector,[0,0,-this.distance],U.mat3.fromMat4(U.mat3.create(),this.matrix)),U.vec3.add(this.focalPoint,this.position,this.distanceVector),this._getDistance();}},{key:"_getDistance",value:function(){this.distanceVector=U.vec3.subtract(U.vec3.create(),this.focalPoint,this.position),this.distance=U.vec3.length(this.distanceVector),this.dollyingStep=this.distance/100;}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===eC.ORTHOGRAPHIC){var e=this.position,t=U.quat.setAxisAngle(U.quat.create(),[0,0,1],-this.roll*Math.PI/180);U.mat4.fromRotationTranslationScaleOrigin(this.orthoMatrix,t,U.vec3.fromValues((this.rright-this.left)/2-e[0],(this.top-this.bottom)/2-e[1],0),U.vec3.fromValues(this.zoom,this.zoom,1),e);}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var e=this.getViewTransform(),t=U.mat4.multiply(U.mat4.create(),this.getPerspective(),e);this.getFrustum().extractFromVPMatrix(t),this.eventEmitter.emit(eA.UPDATED);}}},{key:"rotate",value:function(e,t,n){throw Error(ed);}},{key:"pan",value:function(e,t){throw Error(ed);}},{key:"dolly",value:function(e){throw Error(ed);}},{key:"createLandmark",value:function(e,t){throw Error(ed);}},{key:"gotoLandmark",value:function(e,t){throw Error(ed);}},{key:"cancelLandmarkAnimation",value:function(){throw Error(ed);}}]),eP=((c={})[c.Standard=0]="Standard",c),eN=((d={})[d.ADDED=0]="ADDED",d[d.REMOVED=1]="REMOVED",d[d.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",d),eO={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new ec(0,0,0,0)},eI=((f={}).COORDINATE="<coordinate>",f.COLOR="<color>",f.PAINT="<paint>",f.NUMBER="<number>",f.ANGLE="<angle>",f.OPACITY_VALUE="<opacity-value>",f.SHADOW_BLUR="<shadow-blur>",f.LENGTH="<length>",f.PERCENTAGE="<percentage>",f.LENGTH_PERCENTAGE="<length> | <percentage>",f.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",f.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",f.LIST_OF_POINTS="<list-of-points>",f.PATH="<path>",f.FILTER="<filter>",f.Z_INDEX="<z-index>",f.OFFSET_DISTANCE="<offset-distance>",f.DEFINED_PATH="<defined-path>",f.MARKER="<marker>",f.TRANSFORM="<transform>",f.TRANSFORM_ORIGIN="<transform-origin>",f.TEXT="<text>",f.TEXT_TRANSFORM="<text-transform>",f);function eR(e,t,n){e.prototype=t.prototype=n,n.constructor=e;}function eD(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n;}function ez(){}var eB="\\s*([+-]?\\d+)\\s*",eU="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",eF="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ej=/^#([0-9a-f]{3,8})$/,eV=RegExp(`^rgb\\(${eB},${eB},${eB}\\)$`),eG=RegExp(`^rgb\\(${eF},${eF},${eF}\\)$`),eH=RegExp(`^rgba\\(${eB},${eB},${eB},${eU}\\)$`),eW=RegExp(`^rgba\\(${eF},${eF},${eF},${eU}\\)$`),eZ=RegExp(`^hsl\\(${eU},${eF},${eF}\\)$`),eq=RegExp(`^hsla\\(${eU},${eF},${eF},${eU}\\)$`),eY={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function eX(){return this.rgb().formatHex();}function e$(){return this.rgb().formatRgb();}function eK(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=ej.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?eQ(t):3===n?new e0(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?eJ(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?eJ(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=eV.exec(e))?new e0(t[1],t[2],t[3],1):(t=eG.exec(e))?new e0(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=eH.exec(e))?eJ(t[1],t[2],t[3],t[4]):(t=eW.exec(e))?eJ(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=eZ.exec(e))?e7(t[1],t[2]/100,t[3]/100,1):(t=eq.exec(e))?e7(t[1],t[2]/100,t[3]/100,t[4]):eY.hasOwnProperty(e)?eQ(eY[e]):"transparent"===e?new e0(NaN,NaN,NaN,0):null;}function eQ(e){return new e0(e>>16&255,e>>8&255,255&e,1);}function eJ(e,t,n,r){return r<=0&&(e=t=n=NaN),new e0(e,t,n,r);}function e0(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r;}function e1(){return`#${e4(this.r)}${e4(this.g)}${e4(this.b)}`;}function e2(){let e=e3(this.opacity);return`${1===e?"rgb(":"rgba("}${e5(this.r)}, ${e5(this.g)}, ${e5(this.b)}${1===e?")":`, ${e})`}`;}function e3(e){return isNaN(e)?1:Math.max(0,Math.min(1,e));}function e5(e){return Math.max(0,Math.min(255,Math.round(e)||0));}function e4(e){return((e=e5(e))<16?"0":"")+e.toString(16);}function e7(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new e8(e,t,n,r);}function e6(e){if(e instanceof e8)return new e8(e.h,e.s,e.l,e.opacity);if(e instanceof ez||(e=eK(e)),!e)return new e8;if(e instanceof e8)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=t===a?(n-r)/s+(n<r)*6:n===a?(r-t)/s+2:(t-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new e8(o,s,l,e.opacity);}function e8(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r;}function e9(e){return(e=(e||0)%360)<0?e+360:e;}function te(e){return Math.max(0,Math.min(1,e||0));}function tt(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255;}function tn(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw TypeError("Expected a function");var n=function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=t?t.apply(this,i):i[0],s=n.cache;if(s.has(o))return s.get(o);var l=e.apply(this,i);return n.cache=s.set(o,l)||s,l;};return n.cache=new(tn.Cache||Map),tn.cacheList.push(n.cache),n;}eR(ez,eK,{copy(e){return Object.assign(new this.constructor,this,e);},displayable(){return this.rgb().displayable();},hex:eX,formatHex:eX,formatHex8:function(){return this.rgb().formatHex8();},formatHsl:function(){return e6(this).formatHsl();},formatRgb:e$,toString:e$}),eR(e0,function(e,t,n,r){var i;return 1==arguments.length?((i=e)instanceof ez||(i=eK(i)),i)?new e0((i=i.rgb()).r,i.g,i.b,i.opacity):new e0:new e0(e,t,n,null==r?1:r);},eD(ez,{brighter(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new e0(this.r*e,this.g*e,this.b*e,this.opacity);},darker(e){return e=null==e?.7:Math.pow(.7,e),new e0(this.r*e,this.g*e,this.b*e,this.opacity);},rgb(){return this;},clamp(){return new e0(e5(this.r),e5(this.g),e5(this.b),e3(this.opacity));},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1;},hex:e1,formatHex:e1,formatHex8:function(){return`#${e4(this.r)}${e4(this.g)}${e4(this.b)}${e4((isNaN(this.opacity)?1:this.opacity)*255)}`;},formatRgb:e2,toString:e2})),eR(e8,function(e,t,n,r){return 1==arguments.length?e6(e):new e8(e,t,n,null==r?1:r);},eD(ez,{brighter(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new e8(this.h,this.s,this.l*e,this.opacity);},darker(e){return e=null==e?.7:Math.pow(.7,e),new e8(this.h,this.s,this.l*e,this.opacity);},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new e0(tt(e>=240?e-240:e+120,i,r),tt(e,i,r),tt(e<120?e+240:e-120,i,r),this.opacity);},clamp(){return new e8(e9(this.h),te(this.s),te(this.l),e3(this.opacity));},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1;},formatHsl(){let e=e3(this.opacity);return`${1===e?"hsl(":"hsla("}${e9(this.h)}, ${100*te(this.s)}%, ${100*te(this.l)}%${1===e?")":`, ${e})`}`;}})),tn.Cache=Map,tn.cacheList=[],tn.clearCache=function(){tn.cacheList.forEach(function(e){return e.clear();});};var tr=((h={})[h.kUnknown=0]="kUnknown",h[h.kNumber=1]="kNumber",h[h.kPercentage=2]="kPercentage",h[h.kEms=3]="kEms",h[h.kPixels=4]="kPixels",h[h.kRems=5]="kRems",h[h.kDegrees=6]="kDegrees",h[h.kRadians=7]="kRadians",h[h.kGradians=8]="kGradians",h[h.kTurns=9]="kTurns",h[h.kMilliseconds=10]="kMilliseconds",h[h.kSeconds=11]="kSeconds",h[h.kInteger=12]="kInteger",h),ti=((p={})[p.kUNumber=0]="kUNumber",p[p.kUPercent=1]="kUPercent",p[p.kULength=2]="kULength",p[p.kUAngle=3]="kUAngle",p[p.kUTime=4]="kUTime",p[p.kUOther=5]="kUOther",p),ta=((v={})[v.kYes=0]="kYes",v[v.kNo=1]="kNo",v),to=((g={})[g.kYes=0]="kYes",g[g.kNo=1]="kNo",g),ts=[{name:"em",unit_type:tr.kEms},{name:"px",unit_type:tr.kPixels},{name:"deg",unit_type:tr.kDegrees},{name:"rad",unit_type:tr.kRadians},{name:"grad",unit_type:tr.kGradians},{name:"ms",unit_type:tr.kMilliseconds},{name:"s",unit_type:tr.kSeconds},{name:"rem",unit_type:tr.kRems},{name:"turn",unit_type:tr.kTurns}],tl=((m={})[m.kUnknownType=0]="kUnknownType",m[m.kUnparsedType=1]="kUnparsedType",m[m.kKeywordType=2]="kKeywordType",m[m.kUnitType=3]="kUnitType",m[m.kSumType=4]="kSumType",m[m.kProductType=5]="kProductType",m[m.kNegateType=6]="kNegateType",m[m.kInvertType=7]="kInvertType",m[m.kMinType=8]="kMinType",m[m.kMaxType=9]="kMaxType",m[m.kClampType=10]="kClampType",m[m.kTransformType=11]="kTransformType",m[m.kPositionType=12]="kPositionType",m[m.kURLImageType=13]="kURLImageType",m[m.kColorType=14]="kColorType",m[m.kUnsupportedColorType=15]="kUnsupportedColorType",m),tu=function(e){switch(e){case tr.kNumber:case tr.kInteger:return ti.kUNumber;case tr.kPercentage:return ti.kUPercent;case tr.kPixels:return ti.kULength;case tr.kMilliseconds:case tr.kSeconds:return ti.kUTime;case tr.kDegrees:case tr.kRadians:case tr.kGradians:case tr.kTurns:return ti.kUAngle;default:return ti.kUOther;}},tc=function(e){switch(e){case ti.kUNumber:return tr.kNumber;case ti.kULength:return tr.kPixels;case ti.kUPercent:return tr.kPercentage;case ti.kUTime:return tr.kSeconds;case ti.kUAngle:return tr.kDegrees;default:return tr.kUnknown;}},td=function(e){var t=1;switch(e){case tr.kPixels:case tr.kDegrees:case tr.kSeconds:break;case tr.kMilliseconds:t=.001;break;case tr.kRadians:t=180/Math.PI;break;case tr.kGradians:t=.9;break;case tr.kTurns:t=360;}return t;},tf=function(e){switch(e){case tr.kNumber:case tr.kInteger:break;case tr.kPercentage:return"%";case tr.kEms:return"em";case tr.kRems:return"rem";case tr.kPixels:return"px";case tr.kDegrees:return"deg";case tr.kRadians:return"rad";case tr.kGradians:return"grad";case tr.kMilliseconds:return"ms";case tr.kSeconds:return"s";case tr.kTurns:return"turn";}return"";},th=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"toString",value:function(){return this.buildCSSText(ta.kNo,to.kNo,"");}},{key:"isNumericValue",value:function(){return this.getType()>=tl.kUnitType&&this.getType()<=tl.kClampType;}}],[{key:"isAngle",value:function(e){return e===tr.kDegrees||e===tr.kRadians||e===tr.kGradians||e===tr.kTurns;}},{key:"isLength",value:function(e){return e>=tr.kEms&&e<tr.kDegrees;}},{key:"isRelativeUnit",value:function(e){return e===tr.kPercentage||e===tr.kEms||e===tr.kRems;}},{key:"isTime",value:function(e){return e===tr.kSeconds||e===tr.kMilliseconds;}}]),tp=function(e){function t(e){var n;return(0,N.default)(this,t),(n=(0,R.default)(this,t)).colorSpace=e,n;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"getType",value:function(){return tl.kColorType;}},{key:"to",value:function(e){return this;}}]);}(th),tv=((y={})[y.Constant=0]="Constant",y[y.LinearGradient=1]="LinearGradient",y[y.RadialGradient=2]="RadialGradient",y),tg=function(e){function t(e,n){var r;return(0,N.default)(this,t),(r=(0,R.default)(this,t)).type=e,r.value=n,r;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"clone",value:function(){return new t(this.type,this.value);}},{key:"buildCSSText",value:function(e,t,n){return n;}},{key:"getType",value:function(){return tl.kColorType;}}]);}(th),tm=function(e){function t(e){var n;return(0,N.default)(this,t),(n=(0,R.default)(this,t)).value=e,n;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"clone",value:function(){return new t(this.value);}},{key:"getType",value:function(){return tl.kKeywordType;}},{key:"buildCSSText",value:function(e,t,n){return n+this.value;}}]);}(th),ty=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(e)?"NaN":e>0?"infinity":"-infinity")+t;},tb=function(e){return tc(tu(e));},t_=function(e){function t(e){var n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tr.kNumber;return(0,N.default)(this,t),r=(0,R.default)(this,t),i="string"==typeof a?(n=a)?"number"===n?tr.kNumber:"percent"===n||"%"===n?tr.kPercentage:ts.find(function(e){return e.name===n;}).unit_type:tr.kUnknown:a,r.unit=i,r.value=e,r;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"clone",value:function(){return new t(this.value,this.unit);}},{key:"equals",value:function(e){return this.value===e.value&&this.unit===e.unit;}},{key:"getType",value:function(){return tl.kUnitType;}},{key:"convertTo",value:function(e){if(this.unit===e)return new t(this.value,this.unit);var n=tb(this.unit);if(n!==tb(e)||n===tr.kUnknown)return null;var r=td(this.unit)/td(e);return new t(this.value*r,e);}},{key:"buildCSSText",value:function(e,t,n){var r;switch(this.unit){case tr.kUnknown:break;case tr.kInteger:r=Number(this.value).toFixed(0);break;case tr.kNumber:case tr.kPercentage:case tr.kEms:case tr.kRems:case tr.kPixels:case tr.kDegrees:case tr.kRadians:case tr.kGradians:case tr.kMilliseconds:case tr.kSeconds:case tr.kTurns:var i=this.value,a=tf(this.unit);if(i<-999999||i>999999){var o=tf(this.unit);r=!Number.isFinite(i)||Number.isNaN(i)?ty(i,o):i+(o||"");}else r="".concat(i).concat(a);}return n+r;}}]);}(th),tx=new t_(0,"px");new t_(1,"px");var tw=new t_(0,"deg"),tE=function(e){function t(e,n,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(0,N.default)(this,t),(i=(0,R.default)(this,t,["rgb"])).r=e,i.g=n,i.b=r,i.alpha=a,i.isNone=o,i;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"clone",value:function(){return new t(this.r,this.g,this.b,this.alpha);}},{key:"buildCSSText",value:function(e,t,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")");}}]);}(tp),tM=new tm("unset"),tT={"":tM,unset:tM,initial:new tm("initial"),inherit:new tm("inherit")},tS=new tE(0,0,0,0,!0),tk=new tE(0,0,0,0),tC=tn(function(e,t,n,r){return new tE(e,t,n,r);},function(e,t,n,r){return"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(r,")");}),tA=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tr.kNumber;return new t_(e,t);};new t_(50,"%");var tL=function(){var e={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},t="";function n(e){throw Error("".concat(t,": ").concat(e));}function r(){return i("linear-gradient",e.linearGradient,o)||i("repeating-linear-gradient",e.repeatingLinearGradient,o)||i("radial-gradient",e.radialGradient,s)||i("repeating-radial-gradient",e.repeatingRadialGradient,s)||i("conic-gradient",e.conicGradient,s);}function i(t,r,i){return a(r,function(r){var a=i();return a&&!y(e.comma)&&n("Missing comma before color stops"),{type:t,orientation:a,colorStops:f(h)};});}function a(t,r){var i=y(t);if(i){y(e.startCall)||n("Missing (");var a=r(i);return y(e.endCall)||n("Missing )"),a;}}function o(){return m("directional",e.sideOrCorner,1)||m("angular",e.angleValue,1);}function s(){var n,r,i=l();return i&&((n=[]).push(i),r=t,y(e.comma)&&((i=l())?n.push(i):t=r)),n;}function l(){var e,t,n=((e=m("shape",/^(circle)/i,0))&&(e.style=g()||u()),e||((t=m("shape",/^(ellipse)/i,0))&&(t.style=v()||u()),t));if(n)n.at=c();else{var r=u();if(r){n=r;var i=c();i&&(n.at=i);}else{var a=d();a&&(n={type:"default-radial",at:a});}}return n;}function u(){return m("extent-keyword",e.extentKeywords,1);}function c(){if(m("position",/^at/,0)){var e=d();return e||n("Missing positioning value"),e;}}function d(){var e={x:v(),y:v()};if(e.x||e.y)return{type:"position",value:e};}function f(t){var r=t(),i=[];if(r)for(i.push(r);y(e.comma);)(r=t())?i.push(r):n("One extra comma");return i;}function h(){var t=m("hex",e.hexColor,1)||a(e.rgbaColor,function(){return{type:"rgba",value:f(p)};})||a(e.rgbColor,function(){return{type:"rgb",value:f(p)};})||m("literal",e.literalColor,0);return t||n("Expected color definition"),t.length=v(),t;}function p(){return y(e.number)[1];}function v(){return m("%",e.percentageValue,1)||m("position-keyword",e.positionKeywords,1)||g();}function g(){return m("px",e.pixelValue,1)||m("em",e.emValue,1);}function m(e,t,n){var r=y(t);if(r)return{type:e,value:r[n]};}function y(e){var n=/^[\n\r\t\s]+/.exec(t);n&&b(n[0].length);var r=e.exec(t);return r&&b(r[0].length),r;}function b(e){t=t.substring(e);}return function(e){var i;return t=e,i=f(r),t.length>0&&n("Invalid input not EOF"),i;};}();function tP(e,t,n,r){var i=r.value*ev,a=0+t/2,o=0+n/2,s=Math.abs(t*Math.cos(i))+Math.abs(n*Math.sin(i));return{x1:e[0]+a-Math.cos(i)*s/2,y1:e[1]+o-Math.sin(i)*s/2,x2:e[0]+a+Math.cos(i)*s/2,y2:e[1]+o+Math.sin(i)*s/2};}function tN(e,t,n,r,i,a){var o=r.value,s=i.value;r.unit===tr.kPercentage&&(o=r.value/100*t),i.unit===tr.kPercentage&&(s=i.value/100*n);var l=Math.max((0,F.distanceSquareRoot)([0,0],[o,s]),(0,F.distanceSquareRoot)([0,n],[o,s]),(0,F.distanceSquareRoot)([t,n],[o,s]),(0,F.distanceSquareRoot)([t,0],[o,s]));return a&&(a instanceof t_?l=a.value:a instanceof tm&&("closest-side"===a.value?l=Math.min(o,t-o,s,n-s):"farthest-side"===a.value?l=Math.max(o,t-o,s,n-s):"closest-corner"===a.value&&(l=Math.min((0,F.distanceSquareRoot)([0,0],[o,s]),(0,F.distanceSquareRoot)([0,n],[o,s]),(0,F.distanceSquareRoot)([t,n],[o,s]),(0,F.distanceSquareRoot)([t,0],[o,s]))))),{x:o+e[0],y:s+e[1],r:l};}var tO=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,tI=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,tR=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,tD=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,tz={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},tB=tn(function(e){return tA("angular"===e.type?Number(e.value):tz[e.value]||0,"deg");}),tU=tn(function(e){var t=50,n=50,r="%",i="%";if((null==e?void 0:e.type)==="position"){var a=e.value,o=a.x,s=a.y;(null==o?void 0:o.type)==="position-keyword"&&("left"===o.value?t=0:"center"===o.value?t=50:"right"===o.value?t=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),(null==s?void 0:s.type)==="position-keyword"&&("left"===s.value?t=0:"center"===s.value?n=50:"right"===s.value?t=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),((null==o?void 0:o.type)==="px"||(null==o?void 0:o.type)==="%"||(null==o?void 0:o.type)==="em")&&(r=null==o?void 0:o.type,t=Number(o.value)),((null==s?void 0:s.type)==="px"||(null==s?void 0:s.type)==="%"||(null==s?void 0:s.type)==="em")&&(i=null==s?void 0:s.type,n=Number(s.value));}return{cx:tA(t,r),cy:tA(n,i)};}),tF=tn(function(e){if(e.indexOf("linear")>-1||e.indexOf("radial")>-1)return tL(e).map(function(e){var t=e.type,n=e.orientation,r=e.colorStops;!function(e){var t=e.length;e[t-1].length=null!==(a=e[t-1].length)&&void 0!==a?a:{type:"%",value:"100"},t>1&&(e[0].length=null!==(o=e[0].length)&&void 0!==o?o:{type:"%",value:"0"});for(var n=0,r=Number(e[0].length.value),i=1;i<t;i++){var a,o,s,l=null===(s=e[i].length)||void 0===s?void 0:s.value;if(!(0,F.isNil)(l)&&!(0,F.isNil)(r)){for(var u=1;u<i-n;u++)e[n+u].length={type:"%",value:"".concat(r+(Number(l)-r)*u/(i-n))};n=i,r=Number(l);}}}(r);var i=r.map(function(e){var t,n;return{offset:tA(Number(e.length.value),"%"),color:(t=e.type,n=e.value,"hex"===t?"#".concat(n):"literal"===t?n:"rgb"===t?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")"))};});if("linear-gradient"===t)return new tg(tv.LinearGradient,{angle:n?tB(n):tw,steps:i});if("radial-gradient"===t&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var a,o=tU(n[0].at),s=o.cx,l=o.cy;if(n[0].style){var u=n[0].style,c=u.type,d=u.value;"extent-keyword"===c?(tT[d]||(tT[d]=new tm(d)),a=tT[d]):a=tA(d,c);}return new tg(tv.RadialGradient,{cx:s,cy:l,size:a,steps:i});}});var t=e[0];if("("===e[1]||"("===e[2]){if("l"===t){var n=tO.exec(e);if(n){var r,i=(null===(r=n[2].match(tD))||void 0===r?void 0:r.map(function(e){return e.split(":");}))||[];return[new tg(tv.LinearGradient,{angle:tA(parseFloat(n[1]),"deg"),steps:i.map(function(e){var t=(0,z.default)(e,2),n=t[0],r=t[1];return{offset:tA(100*Number(n),"%"),color:r};})})];}}else if("r"===t){var a=function(e){var t=tI.exec(e);if(t){var n,r=(null===(n=t[4].match(tD))||void 0===n?void 0:n.map(function(e){return e.split(":");}))||[];return{cx:tA(50,"%"),cy:tA(50,"%"),steps:r.map(function(e){var t=(0,z.default)(e,2),n=t[0],r=t[1];return{offset:tA(100*Number(n),"%"),color:r};})};}return null;}(e);if(a){if(!(0,F.isString)(a))return[new tg(tv.RadialGradient,a)];e=a;}}else if("p"===t)return function(e){var t=tR.exec(e);if(t){var n=t[1],r=t[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat";}return{image:r,repetition:n};}return null;}(e);}});function tj(e){return e&&!!e.image;}function tV(e){return e&&!(0,F.isNil)(e.r)&&!(0,F.isNil)(e.g)&&!(0,F.isNil)(e.b);}var tG=tn(function(e){if(tj(e))return(0,P.default)({repetition:"repeat"},e);if((0,F.isNil)(e)&&(e=""),"transparent"===e)return tk;if("currentColor"===e)e="black";else if("none"===e)return tS;var t=tF(e);if(t)return t;var n=eK(e),r=[0,0,0,0];return null!==n&&(r[0]=n.r||0,r[1]=n.g||0,r[2]=n.b||0,r[3]=n.opacity),tC.apply(void 0,r);});function tH(e,t){if(tV(e)&&tV(t))return[[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],function(e){var t=e.slice();if(t[3])for(var n=0;n<3;n++)t[n]=Math.round((0,F.clamp)(t[n],0,255));return t[3]=(0,F.clamp)(t[3],0,1),"rgba(".concat(t.join(","),")");}];}function tW(e,t){if((0,F.isNil)(t))return tA(0,"px");if(isFinite(Number(t="".concat(t).trim().toLowerCase()))){if("px".search(e)>=0)return tA(Number(t),"px");if("deg".search(e)>=0)return tA(Number(t),"deg");}var n=[];t=t.replace(e,function(e){return n.push(e),"U".concat(e);});var r="U(".concat(e.source,")");return n.map(function(e){return tA(Number(t.replace(RegExp("U".concat(e),"g"),"").replace(RegExp(r,"g"),"*0")),e);})[0];}var tZ=function(e){return tW(/px/g,e);},tq=tn(tZ);tn(function(e){return tW(RegExp("%","g"),e);});var tY=function(e){return(0,F.isNumber)(e)||isFinite(Number(e))?tA(Number(e)||0,"px"):tW(RegExp("px|%|em|rem","g"),e);},tX=tn(tY),t$=function(e){return tW(RegExp("deg|rad|grad|turn","g"),e);},tK=tn(t$);function tQ(e){var t=0;return e.unit===tr.kDegrees?t=e.value:e.unit===tr.kRadians?t=Number(e.value)*eg:e.unit===tr.kTurns?t=360*Number(e.value):e.value&&(t=e.value),t;}function tJ(e,t){var n;return(Array.isArray(e)?n=e.map(function(e){return Number(e);}):(0,F.isString)(e)?n=e.split(" ").map(function(e){return Number(e);}):(0,F.isNumber)(e)&&(n=[e]),2===t)?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===t?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===t&&n.length%2==1?[].concat((0,I.default)(n),(0,I.default)(n)):n;}function t0(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e.unit===tr.kPixels)return Number(e.value);if(e.unit===tr.kPercentage&&n){var i=n.nodeName===$.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[t]:0)+e.value/100*i.halfExtents[t]*2;}return 0;}var t1=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function t2(e){return e.toString();}var t3=function(e){return"number"==typeof e?tA(e):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(e)?tA(Number(e)):tA(0);},t5=tn(t3);function t4(e,t){return[e,t,t2];}function t7(e,t){return function(n,r){return[n,r,function(n){return t2((0,F.clamp)(n,e,t));}];};}function t6(e,t){if(e.length===t.length)return[e,t,function(e){return e;}];}function t8(e){return 0===e.parsedStyle.d.totalLength&&(e.parsedStyle.d.totalLength=(0,F.getTotalLength)(e.parsedStyle.d.absolutePath)),e.parsedStyle.d.totalLength;}function t9(e,t){return e[0]===t[0]&&e[1]===t[1];}function ne(e,t){var n=e.prePoint,r=e.currentPoint,i=e.nextPoint,a=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.acos((a+o-(Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2)))/(2*Math.sqrt(a)*Math.sqrt(o)));if(!s||0===Math.sin(s)||(0,F.isNumberEqual)(s,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));return{xExtra:t/2*(1/Math.sin(s/2))*Math.cos(s/2-(l=l>Math.PI/2?Math.PI-l:l))-t/2||0,yExtra:t/2*(1/Math.sin(s/2))*Math.cos((u=u>Math.PI/2?Math.PI-u:u)-s/2)-t/2||0};}function nt(e,t){return[t[0]+(t[0]-e[0]),t[1]+(t[1]-e[1])];}tn(function(e){return(0,F.isString)(e)?e.split(" ").map(t5):e.map(t5);});var nn=function(e,t){var n=e.x*t.x+e.y*t.y,r=Math.sqrt((Math.pow(e.x,2)+Math.pow(e.y,2))*(Math.pow(t.x,2)+Math.pow(t.y,2)));return(e.x*t.y-e.y*t.x<0?-1:1)*Math.acos(n/r);},nr=function(e,t,n,r,i,a,o,s){t=Math.abs(t),n=Math.abs(n);var l=(r=(0,F.mod)(r,360))*ev;if(e.x===o.x&&e.y===o.y)return{x:e.x,y:e.y,ellipticalArcAngle:0};if(0===t||0===n)return{x:0,y:0,ellipticalArcAngle:0};var u=(e.x-o.x)/2,c=(e.y-o.y)/2,d={x:Math.cos(l)*u+Math.sin(l)*c,y:-Math.sin(l)*u+Math.cos(l)*c},f=Math.pow(d.x,2)/Math.pow(t,2)+Math.pow(d.y,2)/Math.pow(n,2);f>1&&(t*=Math.sqrt(f),n*=Math.sqrt(f));var h=(Math.pow(t,2)*Math.pow(n,2)-Math.pow(t,2)*Math.pow(d.y,2)-Math.pow(n,2)*Math.pow(d.x,2))/(Math.pow(t,2)*Math.pow(d.y,2)+Math.pow(n,2)*Math.pow(d.x,2)),p=(i!==a?1:-1)*Math.sqrt(h=h<0?0:h),v={x:p*(t*d.y/n),y:p*(-(n*d.x)/t)},g={x:Math.cos(l)*v.x-Math.sin(l)*v.y+(e.x+o.x)/2,y:Math.sin(l)*v.x+Math.cos(l)*v.y+(e.y+o.y)/2},m={x:(d.x-v.x)/t,y:(d.y-v.y)/n},y=nn({x:1,y:0},m),b=nn(m,{x:(-d.x-v.x)/t,y:(-d.y-v.y)/n});!a&&b>0?b-=2*Math.PI:a&&b<0&&(b+=2*Math.PI);var _=y+(b%=2*Math.PI)*s,x=t*Math.cos(_),w=n*Math.sin(_);return{x:Math.cos(l)*x-Math.sin(l)*w+g.x,y:Math.sin(l)*x+Math.cos(l)*w+g.y,ellipticalArcStartAngle:y,ellipticalArcEndAngle:y+b,ellipticalArcAngle:_,ellipticalArcCenter:g,resultantRx:t,resultantRy:n};};function ni(e,t){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=e.arcParams,i=r.rx,a=void 0===i?0:i,o=r.ry,s=void 0===o?0:o,l=r.xRotation,u=r.arcFlag,c=r.sweepFlag,d=nr({x:e.prePoint[0],y:e.prePoint[1]},a,s,l,!!u,!!c,{x:e.currentPoint[0],y:e.currentPoint[1]},t),f=nr({x:e.prePoint[0],y:e.prePoint[1]},a,s,l,!!u,!!c,{x:e.currentPoint[0],y:e.currentPoint[1]},n?t+.005:t-.005),h=f.x-d.x,p=f.y-d.y,v=Math.sqrt(h*h+p*p);return{x:-h/v,y:-p/v};}function na(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]);}function no(e,t){return na(e)*na(t)?(e[0]*t[0]+e[1]*t[1])/(na(e)*na(t)):1;}function ns(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(no(e,t));}var nl=function(e){if(""===e||Array.isArray(e)&&0===e.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};try{t=(0,F.normalizePath)(e);}catch(n){t=(0,F.normalizePath)(""),console.error("[g]: Invalid SVG Path definition: ".concat(e));}!function(e){for(var t=0;t<e.length;t++){var n=e[t-1],r=e[t];if("M"===r[0]&&n){var i=n[0],a=[r[1],r[2]],o=void 0;"L"===i||"M"===i?o=[n[1],n[2]]:("C"===i||"A"===i||"Q"===i)&&(o=[n[n.length-2],n[n.length-1]]),o&&t9(a,o)&&(e.splice(t,1),t--);}}}(t);var t,n=function(e){for(var t=!1,n=e.length,r=0;r<n;r++){var i=e[r][0];if("C"===i||"A"===i||"Q"===i){t=!0;break;}}return t;}(t),r=function(e){for(var t=[],n=[],r=[],i=0;i<e.length;i++){var a=e[i],o=a[0];"M"===o?(r.length&&(n.push(r),r=[]),r.push([a[1],a[2]])):"Z"===o?r.length&&(t.push(r),r=[]):r.push([a[1],a[2]]);}return r.length>0&&n.push(r),{polygons:t,polylines:n};}(t),i=r.polygons,a=r.polylines,o=function(e){for(var t=[],n=null,r=null,i=null,a=0,o=e.length,s=0;s<o;s++){var l=e[s];r=e[s+1];var u=l[0],c={command:u,prePoint:n,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":i=[l[1],l[2]],a=s;break;case"A":var d=function(e,t){var n=t[1],r=t[2],i=(0,F.mod)(t[3]*ev,2*Math.PI),a=t[4],o=t[5],s=e[0],l=e[1],u=t[6],c=t[7],d=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-c)/2,f=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-c)/2,h=d*d/(n*n)+f*f/(r*r);h>1&&(n*=Math.sqrt(h),r*=Math.sqrt(h));var p=n*n*(f*f)+r*r*(d*d),v=p?Math.sqrt((n*n*(r*r)-p)/p):1;a===o&&(v*=-1),isNaN(v)&&(v=0);var g=r?v*n*f/r:0,m=n?-(v*r)*d/n:0,y=(s+u)/2+Math.cos(i)*g-Math.sin(i)*m,b=(l+c)/2+Math.sin(i)*g+Math.cos(i)*m,_=[(d-g)/n,(f-m)/r],x=[(-1*d-g)/n,(-1*f-m)/r],w=ns([1,0],_),E=ns(_,x);return -1>=no(_,x)&&(E=Math.PI),no(_,x)>=1&&(E=0),0===o&&E>0&&(E-=2*Math.PI),1===o&&E<0&&(E+=2*Math.PI),{cx:y,cy:b,rx:t9(e,[u,c])?0:n,ry:t9(e,[u,c])?0:r,startAngle:w,endAngle:w+E,xRotation:i,arcFlag:a,sweepFlag:o};}(n,l);c.arcParams=d;}if("Z"===u)n=i,r=e[a+1];else{var f=l.length;n=[l[f-2],l[f-1]];}r&&"Z"===r[0]&&(r=e[a],t[a]&&(t[a].prePoint=n)),c.currentPoint=n,t[a]&&t9(n,t[a].currentPoint)&&(t[a].prePoint=c.prePoint);var h=r?[r[r.length-2],r[r.length-1]]:null;c.nextPoint=h;var p=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[p[0]-n[0],p[1]-n[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]];else if("Q"===u){var v=[l[1],l[2]];c.startTangent=[p[0]-v[0],p[1]-v[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]];}else if("T"===u){var g=t[s-1],m=nt(g.currentPoint,p);"Q"===g.command?(c.command="Q",c.startTangent=[p[0]-m[0],p[1]-m[1]],c.endTangent=[n[0]-m[0],n[1]-m[1]]):(c.command="TL",c.startTangent=[p[0]-n[0],p[1]-n[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]]);}else if("C"===u){var y=[l[1],l[2]],b=[l[3],l[4]];c.startTangent=[p[0]-y[0],p[1]-y[1]],c.endTangent=[n[0]-b[0],n[1]-b[1]],0===c.startTangent[0]&&0===c.startTangent[1]&&(c.startTangent=[y[0]-b[0],y[1]-b[1]]),0===c.endTangent[0]&&0===c.endTangent[1]&&(c.endTangent=[b[0]-y[0],b[1]-y[1]]);}else if("S"===u){var _=t[s-1],x=nt(_.currentPoint,p),w=[l[1],l[2]];"C"===_.command?(c.command="C",c.startTangent=[p[0]-x[0],p[1]-x[1]]):(c.command="SQ",c.startTangent=[p[0]-w[0],p[1]-w[1]]),c.endTangent=[n[0]-w[0],n[1]-w[1]];}else if("A"===u){var E=ni(c,0),M=E.x,S=E.y,k=ni(c,1,!1),C=k.x,A=k.y;c.startTangent=[M,S],c.endTangent=[C,A];}t.push(c);}return t;}(t),s=function(e,t){for(var n=[],r=[],i=[],a=0;a<e.length;a++){var o=e[a],s=o.currentPoint,l=o.params,u=o.prePoint,c=void 0;switch(o.command){case"Q":c=(0,G.quadBox)(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":c=(0,G.cubicBox)(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var d=o.arcParams;c=(0,G.arcBox)(d.cx,d.cy,d.rx,d.ry,d.xRotation,d.startAngle,d.endAngle);break;default:n.push(s[0]),r.push(s[1]);}c&&(o.box=c,n.push(c.x,c.x+c.width),r.push(c.y,c.y+c.height));}n=n.filter(function(e){return!Number.isNaN(e)&&e!==1/0&&e!==-1/0;}),r=r.filter(function(e){return!Number.isNaN(e)&&e!==1/0&&e!==-1/0;});var f=(0,F.min)(n),h=(0,F.min)(r),p=(0,F.max)(n),v=(0,F.max)(r);if(0===i.length)return{x:f,y:h,width:p-f,height:v-h};for(var g=0;g<i.length;g++){var m=i[g],y=m.currentPoint;y[0]===f?f-=ne(m,0).xExtra:y[0]===p&&(p+=ne(m,0).xExtra),y[1]===h?h-=ne(m,t).yExtra:y[1]===v&&(v+=ne(m,t).yExtra);}return{x:f,y:h,width:p-f,height:v-h};}(o,0),l=s.x,u=s.y,c=s.width,d=s.height;return{absolutePath:t,hasArc:n,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(c)?c:0,height:Number.isFinite(d)?d:0}};},nu=tn(nl);function nc(e){return(0,F.isString)(e)?nu(e):nl(e);}function nd(e,t,n){var r=e.curve,i=t.curve;r&&0!==r.length||(r=(0,F.path2Curve)(e.absolutePath,!1),e.curve=r),i&&0!==i.length||(i=(0,F.path2Curve)(t.absolutePath,!1),t.curve=i);var a=[r,i];r.length!==i.length&&(a=(0,F.equalizeSegments)(r,i));var o=(0,F.getDrawDirection)(a[0])!==(0,F.getDrawDirection)(a[1])?(0,F.reverseCurve)(a[0]):(0,F.clonePath)(a[0]);return[o,(0,F.getRotatedCurve)(a[1],o),function(e){return e;}];}function nf(e,t){return[e.points,t.points,function(e){return e;}];}var nh=/\s*(\w+)\(([^)]*)\)/g;function np(e){return function(t){var n=0;return e.map(function(e){return null===e?t[n++]:e;});};}function nv(e){return e;}var ng={matrix:["NNNNNN",[null,null,0,0,null,null,0,0,0,0,1,0,null,null,0,1],nv],matrix3d:["NNNNNNNNNNNNNNNN",nv],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",np([null,null,new t_(1)]),nv],scaleX:["N",np([null,new t_(1),new t_(1)]),np([null,new t_(1)])],scaleY:["N",np([new t_(1),null,new t_(1)]),np([new t_(1),null])],scaleZ:["N",np([new t_(1),new t_(1),null])],scale3d:["NNN",nv],skew:["Aa",null,nv],skewX:["A",null,np([null,tw])],skewY:["A",null,np([tw,null])],translate:["Tt",np([null,null,tx]),nv],translateX:["T",np([null,tx,tx]),np([null,tx])],translateY:["T",np([tx,null,tx]),np([tx,null])],translateZ:["L",np([tx,tx,null])],translate3d:["TTL",nv]};function nm(e){for(var t=[],n=e.length,r=0;r<n;r++){var i=e[r],a=i[0],o=i.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!ng[a])return[];var s=o.map(function(e){return tA(e);});t.push({t:a,d:s});}return t;}function ny(e){if(Array.isArray(e))return nm(e);if("none"===(e=(e||"none").trim()))return[];var t,n=[],r=0;for(nh.lastIndex=0;(t=nh.exec(e))&&t.index===r;){r=t.index+t[0].length;var i=t[1],a=ng[i];if(!a)break;var o=t[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],d=s[u],f=void 0;if(void 0===(f=c?({A:function(e){return"0"===e.trim()?tw:tK(e);},N:t5,T:tX,L:tq})[d.toUpperCase()](c):({a:tw,n:l[0],t:tx})[d]))return[];l.push(f);}if(n.push({t:i,d:l}),nh.lastIndex===e.length)return n;}return[];}function nb(e){if(Array.isArray(e))return nm(e);if("none"===(e=(e||"none").trim()))return[];var t,n=[],r=0;for(nh.lastIndex=0;(t=nh.exec(e))&&t.index===r;){r=t.index+t[0].length;var i=t[1],a=ng[i];if(!a)break;var o=t[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],d=s[u],f=void 0;if(void 0===(f=c?({A:function(e){return"0"===e.trim()?tw:t$(e);},N:t3,T:tY,L:tZ})[d.toUpperCase()](c):({a:tw,n:l[0],t:tx})[d]))return[];l.push(f);}if(n.push({t:i,d:l}),nh.lastIndex===e.length)return n;}return[];}function n_(e){switch(e.t){case"rotateX":return[1,0,0,0,0,Math.cos(i=tQ(e.d[0])*ev),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return[Math.cos(i=tQ(e.d[0])*ev),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return[Math.cos(i=tQ(e.d[0])*ev),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":t=e.d[0].value,n=e.d[1].value,r=e.d[2].value,i=tQ(e.d[3])*ev;var t,n,r,i,a=t*t+n*n+r*r;if(0===a)t=1,n=0,r=0;else if(1!==a){var o=Math.sqrt(a);t/=o,n/=o,r/=o;}var s=Math.sin(i/2),l=s*Math.cos(i/2),u=s*s;return[1-2*(n*n+r*r)*u,2*(t*n*u+r*l),2*(t*r*u-n*l),0,2*(t*n*u-r*l),1-2*(t*t+r*r)*u,2*(n*r*u+t*l),0,2*(t*r*u+n*l),2*(n*r*u-t*l),1-2*(t*t+n*n)*u,0,0,0,0,1];case"scale":return[e.d[0].value,0,0,0,0,e.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[e.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,e.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,e.d[0].value,0,0,0,0,1];case"scale3d":return[e.d[0].value,0,0,0,0,e.d[1].value,0,0,0,0,e.d[2].value,0,0,0,0,1];case"skew":var c=tQ(e.d[0])*ev;return[1,Math.tan(tQ(e.d[1])*ev),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return[1,0,0,0,Math.tan(i=tQ(e.d[0])*ev),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return[1,Math.tan(i=tQ(e.d[0])*ev),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,t=t0(e.d[0],0,null)||0,n=t0(e.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,t=t0(e.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=t0(e.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r=t0(e.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,t=t0(e.d[0],0,null)||0,n=t0(e.d[1],0,null)||0,r=t0(e.d[2],0,null)||0,1];case"perspective":var d=t0(e.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,d?-1/d:0,0,0,0,1];case"matrix":return[e.d[0].value,e.d[1].value,0,0,e.d[2].value,e.d[3].value,0,0,0,0,1,0,e.d[4].value,e.d[5].value,0,1];case"matrix3d":return e.d.map(function(e){return e.value;});}}function nx(e,t){return[e[0]*t[0]+e[4]*t[1]+e[8]*t[2]+e[12]*t[3],e[1]*t[0]+e[5]*t[1]+e[9]*t[2]+e[13]*t[3],e[2]*t[0]+e[6]*t[1]+e[10]*t[2]+e[14]*t[3],e[3]*t[0]+e[7]*t[1]+e[11]*t[2]+e[15]*t[3],e[0]*t[4]+e[4]*t[5]+e[8]*t[6]+e[12]*t[7],e[1]*t[4]+e[5]*t[5]+e[9]*t[6]+e[13]*t[7],e[2]*t[4]+e[6]*t[5]+e[10]*t[6]+e[14]*t[7],e[3]*t[4]+e[7]*t[5]+e[11]*t[6]+e[15]*t[7],e[0]*t[8]+e[4]*t[9]+e[8]*t[10]+e[12]*t[11],e[1]*t[8]+e[5]*t[9]+e[9]*t[10]+e[13]*t[11],e[2]*t[8]+e[6]*t[9]+e[10]*t[10]+e[14]*t[11],e[3]*t[8]+e[7]*t[9]+e[11]*t[10]+e[15]*t[11],e[0]*t[12]+e[4]*t[13]+e[8]*t[14]+e[12]*t[15],e[1]*t[12]+e[5]*t[13]+e[9]*t[14]+e[13]*t[15],e[2]*t[12]+e[6]*t[13]+e[10]*t[14]+e[14]*t[15],e[3]*t[12]+e[7]*t[13]+e[11]*t[14]+e[15]*t[15]];}function nw(e){var t=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return!function(e,t,n,r,i,a){if(!(!function(e,t){var n=t[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)e[i]=t[i]*r;return!0;}(e_,e)||(U.mat4.copy(ex,e_),ex[3]=0,ex[7]=0,ex[11]=0,ex[15]=1,1e-8>Math.abs(U.mat4.determinant(ex))))){var o=e_[3],s=e_[7],l=e_[11],u=e_[12],c=e_[13],d=e_[14],f=e_[15];if(0!==o||0!==s||0!==l){if(ew[0]=o,ew[1]=s,ew[2]=l,ew[3]=f,!U.mat4.invert(ex,ex))return;U.mat4.transpose(ex,ex),U.vec4.transformMat4(i,ew,ex);}else i[0]=i[1]=i[2]=0,i[3]=1;if(t[0]=u,t[1]=c,t[2]=d,eE[0][0]=e_[0],eE[0][1]=e_[1],eE[0][2]=e_[2],eE[1][0]=e_[4],eE[1][1]=e_[5],eE[1][2]=e_[6],eE[2][0]=e_[8],eE[2][1]=e_[9],eE[2][2]=e_[10],n[0]=U.vec3.length(eE[0]),U.vec3.normalize(eE[0],eE[0]),r[0]=U.vec3.dot(eE[0],eE[1]),eT(eE[1],eE[1],eE[0],1,-r[0]),n[1]=U.vec3.length(eE[1]),U.vec3.normalize(eE[1],eE[1]),r[0]/=n[1],r[1]=U.vec3.dot(eE[0],eE[2]),eT(eE[2],eE[2],eE[0],1,-r[1]),r[2]=U.vec3.dot(eE[1],eE[2]),eT(eE[2],eE[2],eE[1],1,-r[2]),n[2]=U.vec3.length(eE[2]),U.vec3.normalize(eE[2],eE[2]),r[1]/=n[2],r[2]/=n[2],U.vec3.cross(eM,eE[1],eE[2]),0>U.vec3.dot(eE[0],eM))for(var h=0;h<3;h++)n[h]*=-1,eE[h][0]*=-1,eE[h][1]*=-1,eE[h][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+eE[0][0]-eE[1][1]-eE[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-eE[0][0]+eE[1][1]-eE[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-eE[0][0]-eE[1][1]+eE[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+eE[0][0]+eE[1][1]+eE[2][2],0)),eE[2][1]>eE[1][2]&&(a[0]=-a[0]),eE[0][2]>eE[2][0]&&(a[1]=-a[1]),eE[1][0]>eE[0][1]&&(a[2]=-a[2]);}}(0===e.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:e.map(n_).reduce(nx),t,n,r,i,a),[[t,n,r,a,i]];}var nE=function(){function e(e,t){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var a=0;a<4;a++)n[r][i]+=t[r][a]*e[a][i];return n;}return function(t,n,r,i,a){for(var o,s=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=0;l<4;l++)s[l][3]=a[l];for(var u=0;u<3;u++)for(var c=0;c<3;c++)s[3][u]+=t[c]*s[c][u];var d=i[0],f=i[1],h=i[2],p=i[3],v=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];v[0][0]=1-2*(f*f+h*h),v[0][1]=2*(d*f-h*p),v[0][2]=2*(d*h+f*p),v[1][0]=2*(d*f+h*p),v[1][1]=1-2*(d*d+h*h),v[1][2]=2*(f*h-d*p),v[2][0]=2*(d*h-f*p),v[2][1]=2*(f*h+d*p),v[2][2]=1-2*(d*d+f*f),s=e(s,v);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];r[2]&&(g[2][1]=r[2],s=e(s,g)),r[1]&&(g[2][1]=0,g[2][0]=r[0],s=e(s,g)),r[0]&&(g[2][0]=0,g[1][0]=r[0],s=e(s,g));for(var m=0;m<3;m++)for(var y=0;y<3;y++)s[m][y]*=n[m];return 0===(o=s)[0][2]&&0===o[0][3]&&0===o[1][2]&&0===o[1][3]&&0===o[2][0]&&0===o[2][1]&&1===o[2][2]&&0===o[2][3]&&0===o[3][2]&&1===o[3][3]?[s[0][0],s[0][1],s[1][0],s[1][1],s[3][0],s[3][1]]:s[0].concat(s[1],s[2],s[3]);};}();function nM(e){return e.toFixed(6).replace(".000000","");}function nT(e,t){var n,r;return(e.decompositionPair!==t&&(e.decompositionPair=t,n=nw(e)),t.decompositionPair!==e&&(t.decompositionPair=e,r=nw(t)),null===n[0]||null===r[0])?[[!1],[!0],function(n){return n?t[0].d:e[0].d;}]:(n[0].push(0),r[0].push(1),[n,r,function(e){var t=function(e,t,n){var r=function(e,t){for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n;}(e,t);r=(0,F.clamp)(r,-1,1);var i=[];if(1===r)i=e;else for(var a=Math.acos(r),o=1*Math.sin(n*a)/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(e[s]*(Math.cos(n*a)-r*o)+t[s]*o);return i;}(n[0][3],r[0][3],e[5]);return nE(e[0],e[1],e[2],t,e[4]).map(nM).join(",");}]);}function nS(e){return e.replace(/[XY]/,"");}function nk(e){return e.replace(/(X|Y|Z|3d)?$/,"3d");}function nC(e,t,n){var r=!1;if(!e.length||!t.length){e.length||(r=!0,e=t,t=[]);for(var i=0;i<e.length;i++)!function(){var n=e[i],r=n.t,a=n.d,o="scale"===r.substring(0,5)?1:0;t.push({t:r,d:a.map(function(e){return"number"==typeof e?tA(o):tA(o,e.unit);})});}();}var a=[],o=[],s=[];if(e.length!==t.length){var l=nT(e,t);a=[l[0]],o=[l[1]],s=[["matrix",[l[2]]]];}else for(var u=0;u<e.length;u++){var c=e[u].t,d=t[u].t,f=e[u].d,h=t[u].d,p=ng[c],v=ng[d],g=void 0;if("perspective"===c&&"perspective"===d||("matrix"===c||"matrix3d"===c)&&("matrix"===d||"matrix3d"===d)){var m=nT([e[u]],[t[u]]);a.push(m[0]),o.push(m[1]),s.push(["matrix",[m[2]]]);continue;}if(c===d)g=c;else if(p[2]&&v[2]&&nS(c)===nS(d))g=nS(c),f=p[2](f),h=v[2](h);else if(p[1]&&v[1]&&nk(c)===nk(d))g=nk(c),f=p[1](f),h=v[1](h);else{var y=nT(e,t);a=[y[0]],o=[y[1]],s=[["matrix",[y[2]]]];break;}for(var b=[],_=[],x=[],w=0;w<f.length;w++){var E=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=e.value||0,s=t.value||0,l=tb(e.unit),u=e.convertTo(l),c=t.convertTo(l);return u&&c?(o=u.value,s=c.value,a=tf(e.unit)):(t_.isLength(e.unit)||t_.isLength(t.unit))&&(o=t0(e,i,n),s=t0(t,i,n),a="px"),[o,s,function(e){return r&&(e=Math.max(e,0)),e+a;}];}(f[w],h[w],n,!1,w);b[w]=E[0],_[w]=E[1],x.push(E[2]);}a.push(b),o.push(_),s.push([g,x]);}if(r){var M=a;a=o,o=M;}return[a,o,function(e){return e.map(function(e,t){var n=e.map(function(e,n){return s[t][1][n](e);}).join(",");return"matrix"===s[t][0]&&16===n.split(",").length&&(s[t][0]="matrix3d"),"matrix3d"===s[t][0]&&6===n.split(",").length&&(s[t][0]="matrix"),"".concat(s[t][0],"(").concat(n,")");}).join(" ");}];}var nA=tn(function(e){if((0,F.isString)(e)){if("text-anchor"===e)return[tA(0,"px"),tA(0,"px")];var t=e.split(" ");return(1===t.length&&("top"===t[0]||"bottom"===t[0]?(t[1]=t[0],t[0]="center"):t[1]="center"),2!==t.length)?null:[tX(nL(t[0])),tX(nL(t[1]))];}return[tA(e[0]||0,"px"),tA(e[1]||0,"px")];});function nL(e){return"center"===e?"50%":"left"===e||"top"===e?"0%":"right"===e||"bottom"===e?"100%":e;}var nP=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:eI.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:eI.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:eI.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:eI.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:eI.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:eI.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:eI.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:eI.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:eI.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:eI.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:eI.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:eI.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:eI.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:eI.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:eI.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:eI.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:eI.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:eI.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:eI.FILTER},{n:"clipPath",syntax:eI.DEFINED_PATH},{n:"textPath",syntax:eI.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:eI.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:eI.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:eI.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:eI.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:eI.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:eI.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:eI.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:eI.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:eI.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:eI.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:eI.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:eI.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:eI.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:eI.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:eI.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:eI.COORDINATE},{n:"y1",int:!0,l:!0,syntax:eI.COORDINATE},{n:"z1",int:!0,l:!0,syntax:eI.COORDINATE},{n:"x2",int:!0,l:!0,syntax:eI.COORDINATE},{n:"y2",int:!0,l:!0,syntax:eI.COORDINATE},{n:"z2",int:!0,l:!0,syntax:eI.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:eI.PATH,p:50},{n:"points",int:!0,l:!0,syntax:eI.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:eI.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:eI.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:eI.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:eI.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:eI.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:eI.NUMBER,d:function(e){return e===$.PATH||e===$.POLYGON||e===$.POLYLINE?"4":"10";}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:eI.MARKER},{n:"markerEnd",syntax:eI.MARKER},{n:"markerMid",syntax:eI.MARKER},{n:"markerStartOffset",syntax:eI.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:eI.LENGTH,l:!0,int:!0,d:"0"}],nN=new Set(nP.filter(function(e){return!!e.l;}).map(function(e){return e.n;})),nO={},nI=(0,O.default)(function e(t){var n=this;(0,N.default)(this,e),this.runtime=t,nP.forEach(function(e){n.registerMetadata(e);});},[{key:"registerMetadata",value:function(e){[e.n].concat((0,I.default)(e.a||[])).forEach(function(t){nO[t]=e;});}},{key:"getPropertySyntax",value:function(e){return this.runtime.CSSPropertySyntaxFactory[e];}},{key:"processProperties",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(e.attributes,t);var i=e.parsedStyle.clipPath,a=e.parsedStyle.offsetPath;!function(e,t){var n=nR(e);for(var r in t)n.has(r)&&(e.parsedStyle[r]=t[r]);}(e,t);var o=!!r.forceUpdateGeometry;if(!o){for(var s in t)if(nN.has(s)){o=!0;break;}}var l=nR(e);l.has("fill")&&t.fill&&(e.parsedStyle.fill=tG(t.fill)),l.has("stroke")&&t.stroke&&(e.parsedStyle.stroke=tG(t.stroke)),l.has("shadowColor")&&t.shadowColor&&(e.parsedStyle.shadowColor=tG(t.shadowColor)),l.has("filter")&&t.filter&&(e.parsedStyle.filter=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(t=t.toLowerCase().trim()))return[];for(var n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;(e=n.exec(t))&&e.index===i;)if(i=e.index+e[0].length,t1.indexOf(e[1])>-1&&r.push({name:e[1],params:e[2].split(" ").map(function(e){return tW(/deg|rad|grad|turn|px|%/g,e)||tG(e);})}),n.lastIndex===t.length)return r;return[];}(t.filter)),l.has("radius")&&!(0,F.isNil)(t.radius)&&(e.parsedStyle.radius=tJ(t.radius,4)),l.has("lineDash")&&!(0,F.isNil)(t.lineDash)&&(e.parsedStyle.lineDash=tJ(t.lineDash,"even")),l.has("points")&&t.points&&(e.parsedStyle.points=(n=t.points,{points:(0,F.isString)(n)?n.split(" ").map(function(e){var t=e.split(","),n=(0,z.default)(t,2),r=n[0],i=n[1];return[Number(r),Number(i)];}):n,totalLength:0,segments:[]})),l.has("d")&&""===t.d&&(e.parsedStyle.d=(0,P.default)({},eO)),l.has("d")&&t.d&&(e.parsedStyle.d=nc(t.d)),l.has("textTransform")&&t.textTransform&&this.runtime.CSSPropertySyntaxFactory[eI.TEXT_TRANSFORM].calculator(null,null,{value:t.textTransform},e,null),l.has("clipPath")&&!(0,F.isUndefined)(t.clipPath)&&this.runtime.CSSPropertySyntaxFactory[eI.DEFINED_PATH].calculator("clipPath",i,t.clipPath,e,this.runtime),l.has("offsetPath")&&t.offsetPath&&this.runtime.CSSPropertySyntaxFactory[eI.DEFINED_PATH].calculator("offsetPath",a,t.offsetPath,e,this.runtime),l.has("transform")&&t.transform&&(e.parsedStyle.transform=ny(t.transform)),l.has("transformOrigin")&&t.transformOrigin&&(e.parsedStyle.transformOrigin=nA(t.transformOrigin)),l.has("markerStart")&&t.markerStart&&(e.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[eI.MARKER].calculator(null,t.markerStart,t.markerStart,null,null)),l.has("markerEnd")&&t.markerEnd&&(e.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[eI.MARKER].calculator(null,t.markerEnd,t.markerEnd,null,null)),l.has("markerMid")&&t.markerMid&&(e.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[eI.MARKER].calculator("",t.markerMid,t.markerMid,null,null)),l.has("zIndex")&&!(0,F.isNil)(t.zIndex)&&this.runtime.CSSPropertySyntaxFactory[eI.Z_INDEX].postProcessor(e),l.has("offsetDistance")&&!(0,F.isNil)(t.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[eI.OFFSET_DISTANCE].postProcessor(e),l.has("transform")&&t.transform&&this.runtime.CSSPropertySyntaxFactory[eI.TRANSFORM].postProcessor(e),l.has("transformOrigin")&&t.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[eI.TRANSFORM_ORIGIN].postProcessor(e),o&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e));}},{key:"updateGeometry",value:function(e){var t=e.nodeName,n=this.runtime.geometryUpdaterFactory[t];if(n){var r=e.geometry;r.contentBounds||(r.contentBounds=new ea),r.renderBounds||(r.renderBounds=new ea);var i=e.parsedStyle,a=n.update(i,e),o=a.cx,s=a.cy,l=a.cz,u=a.hwidth,c=void 0===u?0:u,d=a.hheight,f=void 0===d?0:d,h=a.hdepth,p=[Math.abs(c),Math.abs(f),void 0===h?0:h],v=i.stroke,g=i.lineWidth,m=i.increasedLineWidthForHitTesting,y=i.shadowType,b=void 0===y?"outer":y,_=i.shadowColor,x=i.filter,w=i.transformOrigin,E=[void 0===o?0:o,void 0===s?0:s,void 0===l?0:l];r.contentBounds.update(E,p);var M=t===$.POLYLINE||t===$.POLYGON||t===$.PATH?Math.SQRT2:.5;if(v&&!v.isNone){var S=(((void 0===g?1:g)||0)+((void 0===m?0:m)||0))*M;p[0]+=S,p[1]+=S;}if(r.renderBounds.update(E,p),_&&b&&"inner"!==b){var k=r.renderBounds,C=k.min,A=k.max,L=i.shadowBlur,P=i.shadowOffsetX,N=i.shadowOffsetY,O=L||0,I=P||0,R=N||0,D=C[0]-O+I,z=A[0]+O+I,B=C[1]-O+R,F=A[1]+O+R;C[0]=Math.min(C[0],D),A[0]=Math.max(A[0],z),C[1]=Math.min(C[1],B),A[1]=Math.max(A[1],F),r.renderBounds.setMinMax(C,A);}(void 0===x?[]:x).forEach(function(e){var t=e.name,n=e.params;if("blur"===t){var i=n[0].value;r.renderBounds.update(r.renderBounds.center,U.vec3.add(r.renderBounds.halfExtents,r.renderBounds.halfExtents,[i,i,0]));}else if("drop-shadow"===t){var a=n[0].value,o=n[1].value,s=n[2].value,l=r.renderBounds,u=l.min,c=l.max,d=u[0]-s+a,f=c[0]+s+a,h=u[1]-s+o,p=c[1]+s+o;u[0]=Math.min(u[0],d),c[0]=Math.max(c[0],f),u[1]=Math.min(u[1],h),c[1]=Math.max(c[1],p),r.renderBounds.setMinMax(u,c);}}),e.geometry.dirty=!1;var j=f<0,V=(c<0?-1:1)*(w?t0(w[0],0,e,!0):0),G=(j?-1:1)*(w?t0(w[1],1,e,!0):0);(V||G)&&e.setOrigin(V,G);}}},{key:"updateSizeAttenuation",value:function(e,t){e.style.isSizeAttenuation?(e.style.rawLineWidth||(e.style.rawLineWidth=e.style.lineWidth),e.style.lineWidth=(e.style.rawLineWidth||1)/t,e.nodeName===$.CIRCLE&&(e.style.rawR||(e.style.rawR=e.style.r),e.style.r=(e.style.rawR||1)/t)):(e.style.rawLineWidth&&(e.style.lineWidth=e.style.rawLineWidth,delete e.style.rawLineWidth),e.nodeName===$.CIRCLE&&e.style.rawR&&(e.style.r=e.style.rawR,delete e.style.rawR));}}]);function nR(e){return e.constructor.PARSED_STYLE_LIST;}var nD=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=t4;},[{key:"calculator",value:function(e,t,n,r){return tQ(n);}}]),nz=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"calculator",value:function(e,t,n,r,i){return n instanceof tm&&(n=null),i.sceneGraphService.updateDisplayObjectDependency(e,t,n,r),"clipPath"===e&&r.forEach(function(e){0===e.childNodes.length&&i.sceneGraphService.dirtifyToRoot(e);}),n;}}]),nB=(0,O.default)(function e(){(0,N.default)(this,e),this.parser=tG,this.mixer=tH;},[{key:"calculator",value:function(e,t,n,r){return n instanceof tm?"none"===n.value?tS:tk:n;}}]),nU=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"calculator",value:function(e,t,n){return n instanceof tm?[]:n;}}]);function nF(e){var t=e.parsedStyle.fontSize;return(0,F.isNil)(t)?null:t;}var nj=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=t4;},[{key:"calculator",value:function(e,t,n,r,i){if((0,F.isNumber)(n))return n;if(!t_.isRelativeUnit(n.unit))return n.value;if(n.unit===tr.kPercentage)return 0;if(n.unit===tr.kEms){if(r.parentNode){var a,o=nF(r.parentNode);if(o)return o*n.value;}return 0;}if(n.unit===tr.kRems){if(null!=r&&null!==(a=r.ownerDocument)&&void 0!==a&&a.documentElement){var s=nF(r.ownerDocument.documentElement);if(s)return s*n.value;}return 0;}}}]),nV=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=t6;},[{key:"calculator",value:function(e,t,n){return n.map(function(e){return e.value;});}}]),nG=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=t6;},[{key:"calculator",value:function(e,t,n){return n.map(function(e){return e.value;});}}]),nH=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"calculator",value:function(e,t,n,r){n instanceof tm&&(n=null);var i,a=null===(i=n)||void 0===i?void 0:i.cloneNode(!0);return a&&(a.style.isMarker=!0),a;}}]),nW=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=t4;},[{key:"calculator",value:function(e,t,n){return n.value;}}]),nZ=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=t7(0,1);},[{key:"calculator",value:function(e,t,n){return n.value;}},{key:"postProcessor",value:function(e){var t=e.parsedStyle,n=t.offsetPath,r=t.offsetDistance;if(n){var i=n.nodeName;if(i===$.LINE||i===$.PATH||i===$.POLYLINE){var a=n.getPoint(r);a&&e.setLocalPosition(a.x,a.y);}}}}]),nq=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=t7(0,1);},[{key:"calculator",value:function(e,t,n){return n.value;}}]),nY=(0,O.default)(function e(){(0,N.default)(this,e),this.parser=nc,this.mixer=nd;},[{key:"calculator",value:function(e,t,n){return n instanceof tm&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new ec(0,0,0,0)}:n;}}]),nX=(0,O.default)(function e(){(0,N.default)(this,e),this.mixer=nf;}),n$=function(e){function t(){var e;(0,N.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,R.default)(this,t,[].concat(r))).mixer=t7(0,1/0),e;}return(0,D.default)(t,e),(0,O.default)(t);}(nj),nK=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"calculator",value:function(e,t,n,r){return n instanceof tm?"unset"===n.value?"":n.value:"".concat(n);}},{key:"postProcessor",value:function(e){e.nodeValue="".concat(e.parsedStyle.text)||"";}}]),nQ=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"calculator",value:function(e,t,n,r){var i=r.getAttribute("text");if(i){var a=i;"capitalize"===n.value?a=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===n.value?a=i.toLowerCase():"uppercase"===n.value&&(a=i.toUpperCase()),r.parsedStyle.text=a;}return n.value;}}]);function nJ(e,t){var n=Number(e.parsedStyle.zIndex||0),r=Number(t.parsedStyle.zIndex||0);if(n===r){var i=e.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(e)-a.indexOf(t);}}return n-r;}new WeakMap,"undefined"!=typeof window&&window.document;var n0={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},n1="object"==typeof performance&&performance.now?performance:Date;function n2(e){return e.nodeName===$.FRAGMENT||e.getRootNode().nodeName===$.FRAGMENT;}var n3=1,n5="object"==typeof self&&self.self===self?self:"object"==typeof Y&&Y.global===Y?Y:{},n4=Date.now(),n7={},n6=Date.now(),n8=function(e){if("function"!=typeof e)throw TypeError("".concat(e," is not a function"));var t=Date.now(),n=t-n6,r=n3++;return n7[r]=e,Object.keys(n7).length>1||setTimeout(function(){n6=t;var e=n7;n7={},Object.keys(e).forEach(function(t){return e[t](n5.performance&&"function"==typeof n5.performance.now?n5.performance.now():Date.now()-n4);});},n>16?0:16-n),r;},n9=function(e){return"string"!=typeof e?n8:""===e?n5.requestAnimationFrame:n5["".concat(e,"RequestAnimationFrame")];},re=function(e,t){for(var n=0;void 0!==e[n];){if(t(e[n]))return e[n];n+=1;}}(["","webkit","moz","ms","o"],function(e){return!!n9(e);}),rt=n9(re),rn="string"!=typeof re?function(e){delete n7[e];}:""===re?n5.cancelAnimationFrame:n5["".concat(re,"CancelAnimationFrame")]||n5["".concat(re,"CancelRequestAnimationFrame")];n5.requestAnimationFrame=rt,n5.cancelAnimationFrame=rn;var rr=(0,O.default)(function e(){(0,N.default)(this,e),this.callbacks=[];},[{key:"getCallbacksNum",value:function(){return this.callbacks.length;}},{key:"tapPromise",value:function(e,t){this.callbacks.push(t);}},{key:"promise",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.all(this.callbacks.map(function(e){return e.apply(void 0,t);}));}}]),ri=(0,O.default)(function e(){(0,N.default)(this,e),this.callbacks=[];},[{key:"tapPromise",value:function(e,t){this.callbacks.push(t);}},{key:"promise",value:(b=(0,W.default)((0,H.default)().mark(function e(){var t,n,r,i,a=arguments;return(0,H.default)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.callbacks.length){e.next=14;break;}return e.next=3,(t=this.callbacks)[0].apply(t,a);case 3:n=e.sent,r=0;case 5:if(!(r<this.callbacks.length-1)){e.next=13;break;}return i=this.callbacks[r],e.next=9,i(n);case 9:n=e.sent;case 10:r++,e.next=5;break;case 13:return e.abrupt("return",n);case 14:return e.abrupt("return",null);case 15:case"end":return e.stop();}},e,this);})),function(){return b.apply(this,arguments);})}]),ra=(0,O.default)(function e(){(0,N.default)(this,e),this.callbacks=[];},[{key:"tap",value:function(e,t){this.callbacks.push(t);}},{key:"call",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=arguments;this.callbacks.forEach(function(e){e.apply(void 0,r);});}}]),ro=(0,O.default)(function e(){(0,N.default)(this,e),this.callbacks=[];},[{key:"tap",value:function(e,t){this.callbacks.push(t);}},{key:"call",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this.callbacks.length){for(var r=arguments,i=this.callbacks[0].apply(void 0,r),a=0;a<this.callbacks.length-1;a++)i=(0,this.callbacks[a])(i);return i;}return null;}}]),rs=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],rl=/([\"\'])[^\'\"]+\1/;function ru(e,t,n){return U.mat4.identity(e),e[4]=Math.tan(t),e[1]=Math.tan(n),e;}var rc=U.mat4.create(),rd=U.mat4.create(),rf={scale:function(e){U.mat4.fromScaling(rc,[e[0].value,e[1].value,1]);},scaleX:function(e){U.mat4.fromScaling(rc,[e[0].value,1,1]);},scaleY:function(e){U.mat4.fromScaling(rc,[1,e[0].value,1]);},scaleZ:function(e){U.mat4.fromScaling(rc,[1,1,e[0].value]);},scale3d:function(e){U.mat4.fromScaling(rc,[e[0].value,e[1].value,e[2].value]);},translate:function(e){U.mat4.fromTranslation(rc,[e[0].value,e[1].value,0]);},translateX:function(e){U.mat4.fromTranslation(rc,[e[0].value,0,0]);},translateY:function(e){U.mat4.fromTranslation(rc,[0,e[0].value,0]);},translateZ:function(e){U.mat4.fromTranslation(rc,[0,0,e[0].value]);},translate3d:function(e){U.mat4.fromTranslation(rc,[e[0].value,e[1].value,e[2].value]);},rotate:function(e){U.mat4.fromZRotation(rc,tQ(e[0])*ev);},rotateX:function(e){U.mat4.fromXRotation(rc,tQ(e[0])*ev);},rotateY:function(e){U.mat4.fromYRotation(rc,tQ(e[0])*ev);},rotateZ:function(e){U.mat4.fromZRotation(rc,tQ(e[0])*ev);},rotate3d:function(e){U.mat4.fromRotation(rc,tQ(e[3])*ev,[e[0].value,e[1].value,e[2].value]);},skew:function(e){ru(rc,e[0].value*ev,e[1].value*ev);},skewX:function(e){ru(rc,e[0].value*ev,0);},skewY:function(e){ru(rc,0,e[0].value*ev);},matrix:function(e){U.mat4.set(rc,e[0].value,e[1].value,0,0,e[2].value,e[3].value,0,0,0,0,1,0,e[4].value,e[5].value,0,1);},matrix3d:function(e){U.mat4.set.apply(U.mat4,[rc].concat((0,I.default)(e.map(function(e){return e.value;}))));}},rh=U.vec3.fromValues(1,1,1),rp=U.vec3.create(),rv={translate:function(e,t){ia.sceneGraphService.setLocalScale(e,rh,!1),ia.sceneGraphService.setLocalEulerAngles(e,rp,void 0,void 0,!1),ia.sceneGraphService.setLocalPosition(e,[t[0].value,t[1].value,0],!1),ia.sceneGraphService.dirtifyLocal(e,e.transformable);}};function rg(e,t){if(e.length){if(1===e.length&&rv[e[0].t]){rv[e[0].t](t,e[0].d);return;}for(var n=U.mat4.identity(rd),r=0;r<e.length;r++){var i=e[r],a=i.t,o=i.d,s=rf[a];s&&(s(o),U.mat4.mul(n,n,rc));}t.setLocalTransform(n);}else t.resetLocalTransform();return t.getLocalTransform();}var rm=(0,O.default)(function e(){(0,N.default)(this,e),this.parser=nb,this.mixer=nC;},[{key:"calculator",value:function(e,t,n,r){return n instanceof tm?[]:n;}},{key:"postProcessor",value:function(e){rg(e.parsedStyle.transform,e);}}]),ry=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"postProcessor",value:function(e){var t=e.parsedStyle.transformOrigin;t[0].unit===tr.kPixels&&t[1].unit===tr.kPixels?e.setOrigin(t[0].value,t[1].value):e.getGeometryBounds();}}]),rb=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"calculator",value:function(e,t,n,r){return n.value;}},{key:"postProcessor",value:function(e){if(e.parentNode){var t=e.parentNode,n=t.renderable,r=t.sortable;n&&(n.dirty=!0),r&&(r.dirty=!0,r.dirtyReason=eN.Z_INDEX_CHANGED);}}}]),r_=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e,t){var n=e.cx,r=e.cy,i=e.r,a=void 0===i?0:i;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:a,hheight:a};}}]),rx=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e,t){var n=e.cx,r=e.cy,i=e.rx,a=e.ry;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:void 0===i?0:i,hheight:void 0===a?0:a};}}]),rw=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e){var t=e.x1,n=e.y1,r=e.x2,i=e.y2,a=Math.min(t,r),o=Math.min(n,i),s=(Math.max(t,r)-a)/2,l=(Math.max(n,i)-o)/2;return{cx:a+s,cy:o+l,hwidth:s,hheight:l};}}]),rE=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e){var t=e.d.rect,n=t.x,r=t.y,i=t.width,a=t.height,o=i/2,s=a/2;return{cx:n+o,cy:r+s,hwidth:o,hheight:s};}}]),rM=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e){if(e.points&&(0,F.isArray)(e.points.points)){var t=e.points.points,n=Math.min.apply(Math,(0,I.default)(t.map(function(e){return e[0];}))),r=Math.max.apply(Math,(0,I.default)(t.map(function(e){return e[0];}))),i=Math.min.apply(Math,(0,I.default)(t.map(function(e){return e[1];}))),a=Math.max.apply(Math,(0,I.default)(t.map(function(e){return e[1];}))),o=(r-n)/2,s=(a-i)/2;return{cx:n+o,cy:i+s,hwidth:o,hheight:s};}return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rT=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e,t){var n=e.x,r=e.y,i=e.src,a=e.width,o=e.height,s=void 0===a?0:a,l=void 0===o?0:o;return!i||(0,F.isString)(i)||(s||(s=i.width,e.width=s),l||(l=i.height,e.height=l)),{cx:(void 0===n?0:n)+s/2,cy:(void 0===r?0:r)+l/2,hwidth:s/2,hheight:l/2};}}]),rS=(0,O.default)(function e(t){(0,N.default)(this,e),this.globalRuntime=t;},[{key:"isReadyToMeasure",value:function(e,t){return e.text;}},{key:"update",value:function(e,t){var n,r=e.text,i=e.textAlign,a=void 0===i?"start":i,o=e.lineWidth,s=void 0===o?1:o,l=e.textBaseline,u=void 0===l?"alphabetic":l,c=e.dx,d=void 0===c?0:c,f=e.dy,h=void 0===f?0:f,p=e.x,v=e.y;if(!this.isReadyToMeasure(e,t))return e.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var g=((null==t||null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,m=this.globalRuntime.textService.measureText(r,e,g);e.metrics=m;var y=m.width,b=m.height,_=y/2,x=b/2,w=(void 0===p?0:p)+_;"center"===a||"middle"===a?w+=s/2-_:("right"===a||"end"===a)&&(w+=s-2*_);var E=(void 0===v?0:v)-x;return"middle"===u?E+=x:"top"===u||"hanging"===u?E+=2*x:"alphabetic"===u||("bottom"===u||"ideographic"===u)&&(E+=0),d&&(w+=d),h&&(E+=h),{cx:w,cy:E,hwidth:_,hheight:x};}}]),rk=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e,t){return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rC=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"update",value:function(e,t){var n=e.x,r=e.y,i=e.width,a=void 0===i?0:i,o=e.height,s=void 0===o?0:o;return{cx:(void 0===n?0:n)+a/2,cy:(void 0===r?0:r)+s/2,hwidth:a/2,hheight:s/2};}}]),rA=(0,O.default)(function e(t){(0,N.default)(this,e),this.eventPhase=e.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new eu,this.page=new eu,this.canvas=new eu,this.viewport=new eu,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t;},[{key:"name",get:function(){return this.type;}},{key:"layerX",get:function(){return this.layer.x;}},{key:"layerY",get:function(){return this.layer.y;}},{key:"pageX",get:function(){return this.page.x;}},{key:"pageY",get:function(){return this.page.y;}},{key:"x",get:function(){return this.canvas.x;}},{key:"y",get:function(){return this.canvas.y;}},{key:"canvasX",get:function(){return this.canvas.x;}},{key:"canvasY",get:function(){return this.canvas.y;}},{key:"viewportX",get:function(){return this.viewport.x;}},{key:"viewportY",get:function(){return this.viewport.y;}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path;}},{key:"propagationPath",get:function(){return this.composedPath();}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0;}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0;}},{key:"stopPropagation",value:function(){this.propagationStopped=!0;}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw Error(ed);}}]),rL=function(e){function t(){var e;(0,N.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,R.default)(this,t,[].concat(r))).client=new eu,e.movement=new eu,e.offset=new eu,e.global=new eu,e.screen=new eu,e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"clientX",get:function(){return this.client.x;}},{key:"clientY",get:function(){return this.client.y;}},{key:"movementX",get:function(){return this.movement.x;}},{key:"movementY",get:function(){return this.movement.y;}},{key:"offsetX",get:function(){return this.offset.x;}},{key:"offsetY",get:function(){return this.offset.y;}},{key:"globalX",get:function(){return this.global.x;}},{key:"globalY",get:function(){return this.global.y;}},{key:"screenX",get:function(){return this.screen.x;}},{key:"screenY",get:function(){return this.screen.y;}},{key:"getModifierState",value:function(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e);}},{key:"initMouseEvent",value:function(){throw Error(ed);}}]);}(rA),rP=function(e){function t(){var e;(0,N.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,R.default)(this,t,[].concat(r))).width=0,e.height=0,e.isPrimary=!1,e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[];}},{key:"getPredictedEvents",value:function(){throw Error("getPredictedEvents is not supported!");}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this);}}]);}(rL),rN=function(e){function t(){return(0,N.default)(this,t),(0,R.default)(this,t,arguments);}return(0,D.default)(t,e),(0,O.default)(t,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this);}}]);}(rL),rO=function(e){function t(e,n){var r;return(0,N.default)(this,t),(r=(0,R.default)(this,t,[null])).type=e,r.detail=n,Object.assign(r,n),r;}return(0,D.default)(t,e),(0,O.default)(t);}(rA),rI=new WeakMap,rR=function(e){function t(){var e;(0,N.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,R.default)(this,t,[].concat(r))).shadow=!1,e.ownerDocument=null,e.isConnected=!1,e.baseURI="",e.childNodes=[],e.nodeType=0,e.nodeName="",e.nodeValue=null,e.parentNode=null,e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"textContent",get:function(){var e="";this.nodeName===$.TEXT&&(e+=this.style.text);var t,n=(0,Z.default)(this.childNodes);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.nodeName===$.TEXT?e+=r.nodeValue:e+=r.textContent;}}catch(e){n.e(e);}finally{n.f();}return e;},set:function(e){var t=this;this.childNodes.slice().forEach(function(e){t.removeChild(e);}),this.nodeName===$.TEXT&&(this.style.text="".concat(e));}},{key:"getRootNode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(e):e.composed&&this.host?this.host.getRootNode(e):this;}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0;}},{key:"isDefaultNamespace",value:function(e){throw Error(ed);}},{key:"lookupNamespaceURI",value:function(e){throw Error(ed);}},{key:"lookupPrefix",value:function(e){throw Error(ed);}},{key:"normalize",value:function(){throw Error(ed);}},{key:"isEqualNode",value:function(e){return this===e;}},{key:"isSameNode",value:function(e){return this.isEqualNode(e);}},{key:"parent",get:function(){return this.parentNode;}},{key:"parentElement",get:function(){return null;}},{key:"nextSibling",get:function(){return null;}},{key:"previousSibling",get:function(){return null;}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null;}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null;}},{key:"compareDocumentPosition",value:function(e){if(e===this)return 0;for(var n,r=e,i=this,a=[r],o=[i];null!==(n=r.parentNode)&&void 0!==n?n:i.parentNode;)r=r.parentNode?(a.push(r.parentNode),r.parentNode):r,i=i.parentNode?(o.push(i.parentNode),i.parentNode):i;if(r!==i)return t.DOCUMENT_POSITION_DISCONNECTED|t.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|t.DOCUMENT_POSITION_PRECEDING;var s=a.length>o.length?a:o,l=s===a?o:a;if(s[s.length-l.length]===l[0])return s===a?t.DOCUMENT_POSITION_CONTAINED_BY|t.DOCUMENT_POSITION_FOLLOWING:t.DOCUMENT_POSITION_CONTAINS|t.DOCUMENT_POSITION_PRECEDING;for(var u=s.length-l.length,c=l.length-1;c>=0;c--){var d=l[c],f=s[u+c];if(f!==d){var h=d.parentNode.childNodes;if(h.indexOf(d)<h.indexOf(f)){if(l===a)return t.DOCUMENT_POSITION_PRECEDING;return t.DOCUMENT_POSITION_FOLLOWING;}if(s===a)return t.DOCUMENT_POSITION_PRECEDING;break;}}return t.DOCUMENT_POSITION_FOLLOWING;}},{key:"contain",value:function(e){return this.contains(e);}},{key:"contains",value:function(e){for(var t=e;t&&this!==t;)t=t.parentNode;return!!t;}},{key:"getAncestor",value:function(e){for(var t=this;e>0&&t;)t=t.parentNode,e--;return t;}},{key:"forEach",value:function(e){for(var t=[this];t.length>0;){var n=t.pop();if(!1===e(n))break;for(var r=n.childNodes.length-1;r>=0;r--)t.push(n.childNodes[r]);}}}],[{key:"isNode",value:function(e){return!!e.childNodes;}}]);}((0,O.default)(function e(){(0,N.default)(this,e),this.emitter=new B.default;},[{key:"on",value:function(e,t,n){return this.addEventListener(e,t,n),this;}},{key:"addEventListener",value:function(e,t,n){var r=!1,i=!1;if((0,F.isBoolean)(n))r=n;else if(n){var a=n.capture;r=void 0!==a&&a;var o=n.once;i=void 0!==o&&o;}r&&(e+="capture"),t=(0,F.isFunction)(t)?t:t.handleEvent;var s=(0,F.isFunction)(t)?void 0:t;return i?this.emitter.once(e,t,s):this.emitter.on(e,t,s),this;}},{key:"off",value:function(e,t,n){return e?this.removeEventListener(e,t,n):this.removeAllEventListeners(),this;}},{key:"removeAllEventListeners",value:function(){var e;null===(e=this.emitter)||void 0===e||e.removeAllListeners();}},{key:"removeEventListener",value:function(e,t,n){if(!this.emitter)return this;((0,F.isBoolean)(n)?n:null==n?void 0:n.capture)&&(e+="capture"),t=(0,F.isFunction)(t)?t:null===(r=t)||void 0===r?void 0:r.handleEvent;var r,i=(0,F.isFunction)(t)?void 0:t;return this.emitter.off(e,t,i),this;}},{key:"emit",value:function(e,t){this.dispatchEvent(new rO(e,t));}},{key:"dispatchEvent",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=rI.get(this);if(!r&&(r=this.document?this:this.defaultView?this.defaultView:null===(t=this.ownerDocument)||void 0===t?void 0:t.defaultView)&&rI.set(this,r),r){if(e.manager=r.getEventService(),!e.manager)return!1;e.defaultPrevented=!1,e.path?e.path.length=0:e.page=[],n||(e.target=this),e.manager.dispatchEvent(e,e.type,n);}else this.emitter.emit(e.type,e);return!e.defaultPrevented;}}]));rR.DOCUMENT_POSITION_DISCONNECTED=1,rR.DOCUMENT_POSITION_PRECEDING=2,rR.DOCUMENT_POSITION_FOLLOWING=4,rR.DOCUMENT_POSITION_CONTAINS=8,rR.DOCUMENT_POSITION_CONTAINED_BY=16,rR.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,(0,O.default)(function e(t,n){var r=this;(0,N.default)(this,e),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=U.mat4.create(),this.tmpVec3=U.vec3.create(),this.onPointerDown=function(e){var t=r.createPointerEvent(e);if(r.dispatchEvent(t,"pointerdown"),"touch"===t.pointerType)r.dispatchEvent(t,"touchstart");else if("mouse"===t.pointerType||"pen"===t.pointerType){var n=2===t.button;r.dispatchEvent(t,n?"rightdown":"mousedown");}r.trackingData(e.pointerId).pressTargetsByButton[e.button]=t.composedPath(),r.freeEvent(t);},this.onPointerUp=function(e){var t=n1.now(),n=r.createPointerEvent(e,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)r.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var i=2===n.button;r.dispatchEvent(n,i?"rightup":"mouseup");}var a=r.trackingData(e.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[e.button]),s=o;if(o&&!n.composedPath().includes(o)){for(var l=o;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,r.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)r.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var u=2===n.button;r.notifyTarget(n,u?"rightupoutside":"mouseupoutside");}rR.isNode(l)&&(l=l.parentNode);}delete a.pressTargetsByButton[e.button],s=l;}if(s){var c,d=r.clonePointerEvent(n,"click");d.target=s,d.path=[],a.clicksByButton[e.button]||(a.clicksByButton[e.button]={clickCount:0,target:d.target,timeStamp:t});var f=r.context.renderingContext.root.ownerDocument.defaultView,h=a.clicksByButton[e.button];h.target===d.target&&t-h.timeStamp<f.getConfig().dblClickSpeed?++h.clickCount:h.clickCount=1,h.target=d.target,h.timeStamp=t,d.detail=h.clickCount,null!==(c=n.detail)&&void 0!==c&&c.preventClick||(r.context.config.useNativeClickEvent||"mouse"!==d.pointerType&&"touch"!==d.pointerType||r.dispatchEvent(d,"click"),r.dispatchEvent(d,"pointertap")),r.freeEvent(d);}r.freeEvent(n);},this.onPointerMove=function(e){var t=r.createPointerEvent(e,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),n="mouse"===t.pointerType||"pen"===t.pointerType,i=r.trackingData(e.pointerId),a=r.findMountedTarget(i.overTargets);if(i.overTargets&&a!==t.target){var o="mousemove"===e.type?"mouseout":"pointerout",s=r.createPointerEvent(e,o,a||void 0);if(r.dispatchEvent(s,"pointerout"),n&&r.dispatchEvent(s,"mouseout"),!t.composedPath().includes(a)){var l=r.createPointerEvent(e,"pointerleave",a||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&!t.composedPath().includes(l.target);)l.currentTarget=l.target,r.notifyTarget(l),n&&r.notifyTarget(l,"mouseleave"),rR.isNode(l.target)&&(l.target=l.target.parentNode);r.freeEvent(l);}r.freeEvent(s);}if(a!==t.target){var u="mousemove"===e.type?"mouseover":"pointerover",c=r.clonePointerEvent(t,u);r.dispatchEvent(c,"pointerover"),n&&r.dispatchEvent(c,"mouseover");for(var d=a&&rR.isNode(a)&&a.parentNode;d&&d!==(rR.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&d!==t.target;)d=d.parentNode;if(!d||d===(rR.isNode(r.rootTarget)&&r.rootTarget.parentNode)){var f=r.clonePointerEvent(t,"pointerenter");for(f.eventPhase=f.AT_TARGET;f.target&&f.target!==a&&f.target!==(rR.isNode(r.rootTarget)&&r.rootTarget.parentNode);)f.currentTarget=f.target,r.notifyTarget(f),n&&r.notifyTarget(f,"mouseenter"),rR.isNode(f.target)&&(f.target=f.target.parentNode);r.freeEvent(f);}r.freeEvent(c);}r.dispatchEvent(t,"pointermove"),"touch"===t.pointerType&&r.dispatchEvent(t,"touchmove"),n&&(r.dispatchEvent(t,"mousemove"),r.cursor=r.getCursor(t.target)),i.overTargets=t.composedPath(),r.freeEvent(t);},this.onPointerOut=function(e){var t=r.trackingData(e.pointerId);if(t.overTargets){var n="mouse"===e.pointerType||"pen"===e.pointerType,i=r.findMountedTarget(t.overTargets),a=r.createPointerEvent(e,"pointerout",i||void 0);r.dispatchEvent(a),n&&r.dispatchEvent(a,"mouseout");var o=r.createPointerEvent(e,"pointerleave",i||void 0);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(rR.isNode(r.rootTarget)&&r.rootTarget.parentNode);)o.currentTarget=o.target,r.notifyTarget(o),n&&r.notifyTarget(o,"mouseleave"),rR.isNode(o.target)&&(o.target=o.target.parentNode);t.overTargets=null,r.freeEvent(a),r.freeEvent(o);}r.cursor=null;},this.onPointerOver=function(e){var t=r.trackingData(e.pointerId),n=r.createPointerEvent(e),i="mouse"===n.pointerType||"pen"===n.pointerType;r.dispatchEvent(n,"pointerover"),i&&r.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(r.cursor=r.getCursor(n.target));var a=r.clonePointerEvent(n,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==(rR.isNode(r.rootTarget)&&r.rootTarget.parentNode);)a.currentTarget=a.target,r.notifyTarget(a),i&&r.notifyTarget(a,"mouseenter"),rR.isNode(a.target)&&(a.target=a.target.parentNode);t.overTargets=n.composedPath(),r.freeEvent(n),r.freeEvent(a);},this.onPointerUpOutside=function(e){var t=r.trackingData(e.pointerId),n=r.findMountedTarget(t.pressTargetsByButton[e.button]),i=r.createPointerEvent(e);if(n){for(var a=n;a;)i.currentTarget=a,r.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType||("mouse"===i.pointerType||"pen"===i.pointerType)&&r.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),rR.isNode(a)&&(a=a.parentNode);delete t.pressTargetsByButton[e.button];}r.freeEvent(i);},this.onWheel=function(e){var t=r.createWheelEvent(e);r.dispatchEvent(t),r.freeEvent(t);},this.onClick=function(e){if(r.context.config.useNativeClickEvent){var t=r.createPointerEvent(e);r.dispatchEvent(t),r.freeEvent(t);}},this.onPointerCancel=function(e){var t=r.createPointerEvent(e,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(t),r.freeEvent(t);},this.globalRuntime=t,this.context=n;},[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick);}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear();}},{key:"getScale",value:function(){var e=this.context.contextService.getBoundingClientRect(),t=1,n=1,r=this.context.contextService.getDomElement();if(r&&e){var i=r.offsetWidth,a=r.offsetHeight;i&&a&&(t=e.width/i,n=e.height/a);}return{scaleX:t,scaleY:n,bbox:e};}},{key:"client2Viewport",value:function(e){var t=this.getScale(),n=t.scaleX,r=t.scaleY,i=t.bbox;return new eu((e.x-((null==i?void 0:i.left)||0))/n,(e.y-((null==i?void 0:i.top)||0))/r);}},{key:"viewport2Client",value:function(e){var t=this.getScale(),n=t.scaleX,r=t.scaleY,i=t.bbox;return new eu((e.x+((null==i?void 0:i.left)||0))*n,(e.y+((null==i?void 0:i.top)||0))*r);}},{key:"viewport2Canvas",value:function(e){var t=e.x,n=e.y,r=this.rootTarget.defaultView.getCamera(),i=this.context.config,a=i.width,o=i.height,s=r.getPerspectiveInverse(),l=r.getWorldTransform(),u=U.mat4.multiply(this.tmpMatrix,l,s),c=U.vec3.set(this.tmpVec3,t/a*2-1,(1-n/o)*2-1,0);return U.vec3.transformMat4(c,c,u),new eu(c[0],c[1]);}},{key:"canvas2Viewport",value:function(e){var t=this.rootTarget.defaultView.getCamera(),n=t.getPerspective(),r=t.getViewTransform(),i=U.mat4.multiply(this.tmpMatrix,n,r),a=U.vec3.set(this.tmpVec3,e.x,e.y,0);U.vec3.transformMat4(this.tmpVec3,this.tmpVec3,i);var o=this.context.config,s=o.width,l=o.height;return new eu((a[0]+1)/2*s,(1-(a[1]+1)/2)*l);}},{key:"setPickHandler",value:function(e){this.pickHandler=e;}},{key:"addEventMapping",value:function(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort(function(e,t){return e.priority-t.priority;});}},{key:"mapEvent",value:function(e){if(this.rootTarget){var t=this.mappingTable[e.type];if(t)for(var n=0,r=t.length;n<r;n++)t[n].fn(e);else console.warn("[EventService]: Event mapping not defined for ".concat(e.type));}}},{key:"dispatchEvent",value:function(e,t,n){if(n){e.eventPhase=e.AT_TARGET;var r=this.rootTarget.defaultView||null;e.currentTarget=r,this.notifyListeners(e,t);}else e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t);}},{key:"propagate",value:function(e,t){if(e.target){var n=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(e.currentTarget=n[r],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!e.propagationStopped&&!e.propagationImmediatelyStopped){var i=n.indexOf(e.currentTarget);e.eventPhase=e.BUBBLING_PHASE;for(var a=i+1;a<n.length;a++)if(e.currentTarget=n[a],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;}}}},{key:"propagationPath",value:function(e){var t=[e],n=this.rootTarget.defaultView||null;if(n&&n===e)return t.unshift(n.document),t;for(var r=0;r<2048&&e!==this.rootTarget;r++)rR.isNode(e)&&e.parentNode&&(t.push(e.parentNode),e=e.parentNode);return n&&t.push(n),t;}},{key:"hitTest",value:function(e){var t=e.viewportX,n=e.viewportY,r=this.context.config,i=r.width,a=r.height,o=r.disableHitTesting;return t<0||n<0||t>i||n>a?null:!o&&this.pickHandler(e)||this.rootTarget||null;}},{key:"isNativeEventFromCanvas",value:function(e,t){var n,r=null==t?void 0:t.target;if(null!==(n=r)&&void 0!==n&&n.shadowRoot&&(r=t.composedPath()[0]),r){if(r===e)return!0;if(e&&e.contains)return e.contains(r);}return null!=t&&!!t.composedPath&&t.composedPath().indexOf(e)>-1;}},{key:"getExistedHTML",value:function(e){if(e.nativeEvent.composedPath)for(var t=0,n=e.nativeEvent.composedPath();t<n.length;t++){var r=n[t],i=this.nativeHTMLMap.get(r);if(i)return i;}return null;}},{key:"pickTarget",value:function(e){return this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY});}},{key:"createPointerEvent",value:function(e,t,n,r){var i=this.allocateEvent(rP);this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e;var a=this.getExistedHTML(i),o=this.context.contextService.getDomElement();return i.target=null!=n?n:a||this.isNativeEventFromCanvas(o,i.nativeEvent)&&this.pickTarget(i)||r,"string"==typeof t&&(i.type=t),i;}},{key:"createWheelEvent",value:function(e){var t=this.allocateEvent(rN);this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e;var n=this.getExistedHTML(t),r=this.context.contextService.getDomElement();return t.target=n||this.isNativeEventFromCanvas(r,t.nativeEvent)&&this.pickTarget(t),t;}},{key:"trackingData",value:function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e];}},{key:"cloneWheelEvent",value:function(e){var t=this.allocateEvent(rN);return t.nativeEvent=e.nativeEvent,t.originalEvent=e.originalEvent,this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.target=e.target,t.path=e.composedPath().slice(),t.type=e.type,t;}},{key:"clonePointerEvent",value:function(e,t){var n=this.allocateEvent(rP);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=null!=t?t:n.type,n;}},{key:"copyPointerData",value:function(e,t){t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist;}},{key:"copyMouseData",value:function(e,t){t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.client.copyFrom(e.client),t.movement.copyFrom(e.movement),t.canvas.copyFrom(e.canvas),t.screen.copyFrom(e.screen),t.global.copyFrom(e.global),t.offset.copyFrom(e.offset);}},{key:"copyWheelData",value:function(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ;}},{key:"copyData",value:function(e,t){t.isTrusted=e.isTrusted,t.timeStamp=n1.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.page.copyFrom(e.page),t.viewport.copyFrom(e.viewport);}},{key:"allocateEvent",value:function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=[],t.target=null,t;}},{key:"freeEvent",value:function(e){if(e.manager!==this)throw Error("It is illegal to free an event not managed by this EventBoundary!");var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e);}},{key:"notifyTarget",value:function(e,t){t=null!=t?t:e.type;var n=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(t,"capture"):t;this.notifyListeners(e,n),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t);}},{key:"notifyListeners",value:function(e,t){var n=e.currentTarget.emitter,r=n._events[t];if(r){if("fn"in r)r.once&&n.removeListener(t,r.fn,void 0,!0),r.fn.call(e.currentTarget||r.context,e);else for(var i=0;i<r.length&&!e.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(t,r[i].fn,void 0,!0),r[i].fn.call(e.currentTarget||r[i].context,e);}}},{key:"findMountedTarget",value:function(e){if(!e)return null;for(var t=e[e.length-1],n=e.length-2;n>=0;n--){var r=e[n];if(r===this.rootTarget||rR.isNode(r)&&r.parentNode===t)t=e[n];else break;}return t;}},{key:"getCursor",value:function(e){for(var t=e;t;){var n=!!t.getAttribute&&t.getAttribute("cursor");if(n)return n;t=rR.isNode(t)&&t.parentNode;}}}]);var rD=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"getOrCreateCanvas",value:function(e,t){if(this.canvas)return this.canvas;if(e||ia.offscreenCanvas)this.canvas=e||ia.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,P.default)({willReadFrequently:!0},t));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,P.default)({willReadFrequently:!0},t)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"));}catch(e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,P.default)({willReadFrequently:!0},t));}return this.canvas.width=10,this.canvas.height=10,this.canvas;}},{key:"getOrCreateContext",value:function(e,t){return this.context||this.getOrCreateCanvas(e,t),this.context;}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0);}catch(e){}try{return document.createElement("canvas");}catch(e){}return null;}}]),rz=((_={})[_.CAMERA_CHANGED=0]="CAMERA_CHANGED",_[_.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",_[_.NONE=2]="NONE",_);(0,O.default)(function e(t,n){(0,N.default)(this,e),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new ra,initAsync:new rr,dirtycheck:new ro,cull:new ro,beginFrame:new ra,beforeRender:new ra,render:new ra,afterRender:new ra,endFrame:new ra,destroy:new ra,pick:new ri,pickSync:new ro,pointerDown:new ra,pointerUp:new ra,pointerMove:new ra,pointerOut:new ra,pointerOver:new ra,pointerWheel:new ra,pointerCancel:new ra,click:new ra},this.globalRuntime=t,this.context=n;},[{key:"init",value:function(e){var t=this,n=(0,P.default)((0,P.default)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(e){e.apply(n,t.globalRuntime);}),this.hooks.init.call(),0===this.hooks.initAsync.getCallbacksNum()?(this.inited=!0,e()):this.hooks.initAsync.promise().then(function(){t.inited=!0,e();}).catch(function(e){});}},{key:"getStats",value:function(){return this.stats;}},{key:"disableDirtyRectangleRendering",value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(rz.CAMERA_CHANGED);}},{key:"render",value:function(e,t,n){var r=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var i=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(i.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),i.renderReasons.size&&this.inited){i.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var a=1===i.renderReasons.size&&i.renderReasons.has(rz.CAMERA_CHANGED),o=!e.disableRenderHooks||!(e.disableRenderHooks&&a);o&&this.renderDisplayObject(i.root,e,i),this.hooks.beginFrame.call(t),o&&i.renderListCurrentFrame.forEach(function(e){r.hooks.beforeRender.call(e),r.hooks.render.call(e),r.hooks.afterRender.call(e);}),this.hooks.endFrame.call(t),i.renderListCurrentFrame=[],i.renderReasons.clear(),n();}}},{key:"renderDisplayObject",value:function(e,t,n){for(var r=this,i=t.renderer.getConfig(),a=i.enableDirtyCheck,o=i.enableCulling,s=[e];s.length>0;){var l,u=s.pop();!function(e){var t=e.renderable,i=e.sortable,s=a?t.dirty||n.dirtyRectangleRenderingDisabled?e:null:e;if(s){var l=o?r.hooks.cull.call(s,r.context.camera):s;l&&(r.stats.rendered+=1,n.renderListCurrentFrame.push(l));}t.dirty=!1,i.renderOrder=r.zIndexCounter,r.zIndexCounter+=1,r.stats.total+=1,i.dirty&&(r.sort(e,i),i.dirty=!1,i.dirtyChildren=[],i.dirtyReason=void 0);}(u);for(var c=(null===(l=u.sortable)||void 0===l||null===(l=l.sorted)||void 0===l?void 0:l.length)>0?u.sortable.sorted:u.childNodes,d=c.length-1;d>=0;d--)s.push(c[d]);}}},{key:"sort",value:function(e,t){var n,r;(null==t||null===(n=t.sorted)||void 0===n?void 0:n.length)>0&&t.dirtyReason!==eN.Z_INDEX_CHANGED?t.dirtyChildren.forEach(function(n){var r=t.sorted.indexOf(n);if(r>-1&&t.sorted.splice(r,1),e.childNodes.indexOf(n)>-1){if(0===t.sorted.length)t.sorted.push(n);else{var i=function(e,t){for(var n=0,r=e.length;n<r;){var i=n+r>>>1;0>nJ(e[i],t)?n=i+1:r=i;}return n;}(t.sorted,n);t.sorted.splice(i,0,n);}}}):t.sorted=e.childNodes.slice().sort(nJ),(null===(r=t.sorted)||void 0===r?void 0:r.length)>0&&0===e.childNodes.filter(function(e){return e.parsedStyle.zIndex;}).length&&(t.sorted=[]);}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents();}},{key:"dirtify",value:function(){this.context.renderingContext.renderReasons.add(rz.DISPLAY_OBJECT_CHANGED);}}]);var rB=/\[\s*(.*)=(.*)\s*\]/,rU=(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"selectOne",value:function(e,t){var n=this;if(e.startsWith("."))return t.find(function(t){return((null==t?void 0:t.classList)||[]).indexOf(n.getIdOrClassname(e))>-1;});if(e.startsWith("#"))return t.find(function(t){return t.id===n.getIdOrClassname(e);});if(e.startsWith("[")){var r=this.getAttribute(e),i=r.name,a=r.value;return i?t.find(function(e){return t!==e&&("name"===i?e.name===a:n.attributeToString(e,i)===a);}):null;}return t.find(function(n){return t!==n&&n.nodeName===e;});}},{key:"selectAll",value:function(e,t){var n=this;if(e.startsWith("."))return t.findAll(function(r){return t!==r&&((null==r?void 0:r.classList)||[]).indexOf(n.getIdOrClassname(e))>-1;});if(e.startsWith("#"))return t.findAll(function(r){return t!==r&&r.id===n.getIdOrClassname(e);});if(e.startsWith("[")){var r=this.getAttribute(e),i=r.name,a=r.value;return i?t.findAll(function(e){return t!==e&&("name"===i?e.name===a:n.attributeToString(e,i)===a);}):[];}return t.findAll(function(n){return t!==n&&n.nodeName===e;});}},{key:"is",value:function(e,t){if(e.startsWith("."))return t.className===this.getIdOrClassname(e);if(e.startsWith("#"))return t.id===this.getIdOrClassname(e);if(e.startsWith("[")){var n=this.getAttribute(e),r=n.name,i=n.value;return"name"===r?t.name===i:this.attributeToString(t,r)===i;}return t.nodeName===e;}},{key:"getIdOrClassname",value:function(e){return e.substring(1);}},{key:"getAttribute",value:function(e){var t=e.match(rB),n="",r="";return t&&t.length>2&&(n=t[1].replace(/"/g,""),r=t[2].replace(/"/g,"")),{name:n,value:r};}},{key:"attributeToString",value:function(e,t){if(!e.getAttribute)return"";var n=e.getAttribute(t);return(0,F.isNil)(n)?"":n.toString?n.toString():"";}}]),rF=((x={}).ATTR_MODIFIED="DOMAttrModified",x.INSERTED="DOMNodeInserted",x.MOUNTED="DOMNodeInsertedIntoDocument",x.REMOVED="removed",x.UNMOUNTED="DOMNodeRemovedFromDocument",x.REPARENT="reparent",x.DESTROY="destroy",x.BOUNDS_CHANGED="bounds-changed",x.CULLED="culled",x),rj=function(e){function t(e,n,r,i,a,o,s,l){var u;return(0,N.default)(this,t),(u=(0,R.default)(this,t,[null])).relatedNode=n,u.prevValue=r,u.newValue=i,u.attrName=a,u.attrChange=o,u.prevParsedValue=s,u.newParsedValue=l,u.type=e,u;}return(0,D.default)(t,e),(0,O.default)(t);}(rA);function rV(e){var t=e.renderable;t&&(t.renderBoundsDirty=!0,t.boundsDirty=!0);}rj.ADDITION=2,rj.MODIFICATION=1,rj.REMOVAL=3;var rG=new rj(rF.REPARENT,null,"","","",0,"",""),rH=U.vec2.create(),rW=U.vec3.create(),rZ=U.vec3.fromValues(1,1,1),rq=U.mat4.create(),rY=U.vec2.create(),rX=U.vec3.create(),r$=U.mat4.create(),rK=U.quat.create(),rQ=U.vec3.create(),rJ=U.quat.create(),r0=U.vec3.create(),r1=U.vec3.create(),r2=U.vec3.create(),r3=U.mat4.create(),r5=U.quat.create(),r4=U.quat.create(),r7=U.quat.create(),r6={affectChildren:!0},r8=(0,O.default)(function e(t){(0,N.default)(this,e),this.pendingEvents=new Map,this.boundsChangedEvent=new rO(rF.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=t;},[{key:"matches",value:function(e,t){return this.runtime.sceneGraphSelector.is(e,t);}},{key:"querySelector",value:function(e,t){return this.runtime.sceneGraphSelector.selectOne(e,t);}},{key:"querySelectorAll",value:function(e,t){return this.runtime.sceneGraphSelector.selectAll(e,t);}},{key:"attach",value:function(e,t,n){var r,i=!1;e.parentNode&&(i=e.parentNode!==t,this.detach(e));var a=e.nodeName===$.FRAGMENT,o=n2(t);e.parentNode=t;var s=a?e.childNodes:[e];(0,F.isNumber)(n)?s.forEach(function(e){t.childNodes.splice(n,0,e),e.parentNode=t;}):s.forEach(function(e){t.childNodes.push(e),e.parentNode=t;});var l=t.sortable;if((null!=l&&null!==(r=l.sorted)&&void 0!==r&&r.length||l.dirty||e.parsedStyle.zIndex)&&(-1===l.dirtyChildren.indexOf(e)&&l.dirtyChildren.push(e),l.dirty=!0,l.dirtyReason=eN.ADDED),!o){if(a)this.dirtifyFragment(e);else{var u=e.transformable;u&&this.dirtifyWorld(e,u);}i&&e.dispatchEvent(rG);}}},{key:"detach",value:function(e){if(e.parentNode){var t,n,r=e.transformable,i=e.parentNode.sortable;(null!=i&&null!==(t=i.sorted)&&void 0!==t&&t.length||null!==(n=e.style)&&void 0!==n&&n.zIndex)&&(-1===i.dirtyChildren.indexOf(e)&&i.dirtyChildren.push(e),i.dirty=!0,i.dirtyReason=eN.REMOVED);var a=e.parentNode.childNodes.indexOf(e);a>-1&&e.parentNode.childNodes.splice(a,1),r&&this.dirtifyWorld(e,r),e.parentNode=null;}}},{key:"getOrigin",value:function(e){return e.getGeometryBounds(),e.transformable.origin;}},{key:"setOrigin",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof t&&(t=[t,n,r]);var i=e.transformable;if(t[0]!==i.origin[0]||t[1]!==i.origin[1]||t[2]!==i.origin[2]){var a=i.origin;a[0]=t[0],a[1]=t[1],a[2]=t[2]||0,this.dirtifyLocal(e,i);}}},{key:"rotate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof t&&(t=U.vec3.fromValues(t,n,r));var i=e.transformable;if(null!==e.parentNode&&e.parentNode.transformable){U.quat.fromEuler(rK,t[0],t[1],t[2]);var a=this.getRotation(e),o=this.getRotation(e.parentNode);U.quat.copy(r7,o),U.quat.invert(r7,r7),U.quat.multiply(rK,r7,rK),U.quat.multiply(i.localRotation,rK,a),U.quat.normalize(i.localRotation,i.localRotation),this.dirtifyLocal(e,i);}else this.rotateLocal(e,t);}},{key:"rotateLocal",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof t&&(t=U.vec3.fromValues(t,n,r));var i=e.transformable;U.quat.fromEuler(r4,t[0],t[1],t[2]),U.quat.mul(i.localRotation,i.localRotation,r4),this.dirtifyLocal(e,i);}},{key:"setEulerAngles",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof t&&(t=U.vec3.fromValues(t,n,r));var i=e.transformable;if(null!==e.parentNode&&e.parentNode.transformable){U.quat.fromEuler(i.localRotation,t[0],t[1],t[2]);var a=this.getRotation(e.parentNode);U.quat.copy(r5,U.quat.invert(rK,a)),U.quat.mul(i.localRotation,i.localRotation,r5),this.dirtifyLocal(e,i);}else this.setLocalEulerAngles(e,t);}},{key:"setLocalEulerAngles",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4];"number"==typeof t&&(t=U.vec3.fromValues(t,n,r));var a=e.transformable;U.quat.fromEuler(a.localRotation,t[0],t[1],t[2]),i&&this.dirtifyLocal(e,a);}},{key:"translateLocal",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof t&&(t=U.vec3.fromValues(t,n,r));var i=e.transformable;U.vec3.equals(t,rW)||(U.vec3.transformQuat(t,t,i.localRotation),U.vec3.add(i.localPosition,i.localPosition,t),this.dirtifyLocal(e,i));}},{key:"setPosition",value:function(e,t){var n,r=e.transformable;if(r2[0]=t[0],r2[1]=t[1],r2[2]=null!==(n=t[2])&&void 0!==n?n:0,!U.vec3.equals(this.getPosition(e),r2)){if(U.vec3.copy(r.position,r2),null!==e.parentNode&&e.parentNode.transformable){var i=e.parentNode.transformable;U.mat4.copy(r3,i.worldTransform),U.mat4.invert(r3,r3),U.vec3.transformMat4(r.localPosition,r2,r3);}else U.vec3.copy(r.localPosition,r2);this.dirtifyLocal(e,r);}}},{key:"setLocalPosition",value:function(e,t){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=e.transformable;r1[0]=t[0],r1[1]=t[1],r1[2]=null!==(n=t[2])&&void 0!==n?n:0,!U.vec3.equals(i.localPosition,r1)&&(U.vec3.copy(i.localPosition,r1),r&&this.dirtifyLocal(e,i));}},{key:"scaleLocal",value:function(e,t){var n,r=e.transformable;U.vec3.multiply(r.localScale,r.localScale,U.vec3.set(rX,t[0],t[1],null!==(n=t[2])&&void 0!==n?n:1)),this.dirtifyLocal(e,r);}},{key:"setLocalScale",value:function(e,t){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=e.transformable;U.vec3.set(rX,t[0],t[1],null!==(n=t[2])&&void 0!==n?n:i.localScale[2]),!U.vec3.equals(rX,i.localScale)&&(U.vec3.copy(i.localScale,rX),r&&this.dirtifyLocal(e,i));}},{key:"translate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof t&&(t=U.vec3.set(rX,t,n,r)),U.vec3.equals(t,rW)||(U.vec3.add(rX,this.getPosition(e),t),this.setPosition(e,rX));}},{key:"setRotation",value:function(e,t,n,r,i){var a=e.transformable;if("number"==typeof t&&(t=U.quat.fromValues(t,n,r,i)),null!==e.parentNode&&e.parentNode.transformable){var o=this.getRotation(e.parentNode);U.quat.copy(rK,o),U.quat.invert(rK,rK),U.quat.multiply(a.localRotation,rK,t),U.quat.normalize(a.localRotation,a.localRotation),this.dirtifyLocal(e,a);}else this.setLocalRotation(e,t);}},{key:"setLocalRotation",value:function(e,t,n,r,i){var a=!(arguments.length>5)||void 0===arguments[5]||arguments[5];"number"==typeof t&&(t=U.quat.set(rK,t,n,r,i));var o=e.transformable;U.quat.copy(o.localRotation,t),a&&this.dirtifyLocal(e,o);}},{key:"setLocalSkew",value:function(e,t,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];"number"==typeof t&&(t=U.vec2.set(rY,t,n));var i=e.transformable;U.vec2.copy(i.localSkew,t),r&&this.dirtifyLocal(e,i);}},{key:"dirtifyLocal",value:function(e,t){n2(e)||t.localDirtyFlag||(t.localDirtyFlag=!0,t.dirtyFlag||this.dirtifyWorld(e,t));}},{key:"dirtifyWorld",value:function(e,t){t.dirtyFlag||this.unfreezeParentToRoot(e),this.dirtifyWorldInternal(e,t),this.dirtifyToRoot(e,!0);}},{key:"dirtifyFragment",value:function(e){var t=e.transformable;t&&(t.frozen=!1,t.dirtyFlag=!0,t.localDirtyFlag=!0);var n=e.renderable;n&&(n.renderBoundsDirty=!0,n.boundsDirty=!0,n.dirty=!0);for(var r=e.childNodes.length,i=0;i<r;i++)this.dirtifyFragment(e.childNodes[i]);e.nodeName===$.FRAGMENT&&this.pendingEvents.set(e,!1);}},{key:"triggerPendingEvents",value:function(){var e=this,t=new Set,n=function(n,r){!n.isConnected||t.has(n)||n.nodeName===$.FRAGMENT||(e.boundsChangedEvent.detail=r,e.boundsChangedEvent.target=n,n.isMutationObserved?n.dispatchEvent(e.boundsChangedEvent):n.ownerDocument.defaultView.dispatchEvent(e.boundsChangedEvent,!0),t.add(n));};this.pendingEvents.forEach(function(e,t){t.nodeName!==$.FRAGMENT&&(r6.affectChildren=e,e?t.forEach(function(e){n(e,r6);}):n(t,r6));}),t.clear(),this.clearPendingEvents();}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear();}},{key:"dirtifyToRoot",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e;for(n.renderable&&(n.renderable.dirty=!0);n;)rV(n),n=n.parentNode;t&&e.forEach(function(e){rV(e);}),this.informDependentDisplayObjects(e),this.pendingEvents.set(e,t);}},{key:"updateDisplayObjectDependency",value:function(e,t,n,r){if(t&&t!==n){var i=this.displayObjectDependencyMap.get(t);if(i&&i[e]){var a=i[e].indexOf(r);i[e].splice(a,1);}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[e]||(o[e]=[]),o[e].push(r);}}},{key:"informDependentDisplayObjects",value:function(e){var t=this,n=this.displayObjectDependencyMap.get(e);n&&Object.keys(n).forEach(function(e){n[e].forEach(function(n){t.dirtifyToRoot(n,!0),n.dispatchEvent(new rj(rF.ATTR_MODIFIED,n,t,t,e,rj.MODIFICATION,t,t)),n.isCustomElement&&n.isConnected&&n.attributeChangedCallback&&n.attributeChangedCallback(e,t,t);});});}},{key:"getPosition",value:function(e){var t=e.transformable;return U.mat4.getTranslation(t.position,this.getWorldTransform(e,t));}},{key:"getRotation",value:function(e){var t=e.transformable;return U.mat4.getRotation(t.rotation,this.getWorldTransform(e,t));}},{key:"getScale",value:function(e){var t=e.transformable;return U.mat4.getScaling(t.scaling,this.getWorldTransform(e,t));}},{key:"getWorldTransform",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transformable;return(t.localDirtyFlag||t.dirtyFlag)&&(e.parentNode&&e.parentNode.transformable&&this.getWorldTransform(e.parentNode),this.sync(e,t)),t.worldTransform;}},{key:"getLocalPosition",value:function(e){return e.transformable.localPosition;}},{key:"getLocalRotation",value:function(e){return e.transformable.localRotation;}},{key:"getLocalScale",value:function(e){return e.transformable.localScale;}},{key:"getLocalSkew",value:function(e){return e.transformable.localSkew;}},{key:"calcLocalTransform",value:function(e){if(0!==e.localSkew[0]||0!==e.localSkew[1]){U.mat4.fromRotationTranslationScaleOrigin(e.localTransform,e.localRotation,e.localPosition,U.vec3.fromValues(1,1,1),e.origin),(0!==e.localSkew[0]||0!==e.localSkew[1])&&(U.mat4.identity(r$),r$[4]=Math.tan(e.localSkew[0]),r$[1]=Math.tan(e.localSkew[1]),U.mat4.multiply(e.localTransform,e.localTransform,r$));var t=U.mat4.fromRotationTranslationScaleOrigin(r$,U.quat.set(rK,0,0,0,1),U.vec3.set(rX,1,1,1),e.localScale,e.origin);U.mat4.multiply(e.localTransform,e.localTransform,t);}else{var n=e.localTransform,r=e.localPosition,i=e.localRotation,a=e.localScale,o=e.origin,s=0!==r[0]||0!==r[1]||0!==r[2],l=1!==i[3]||0!==i[0]||0!==i[1]||0!==i[2],u=1!==a[0]||1!==a[1]||1!==a[2],c=0!==o[0]||0!==o[1]||0!==o[2];l||u||c?U.mat4.fromRotationTranslationScaleOrigin(n,i,r,a,o):s?U.mat4.fromTranslation(n,r):U.mat4.identity(n);}}},{key:"getLocalTransform",value:function(e){var t=e.transformable;return t.localDirtyFlag&&(this.calcLocalTransform(t),t.localDirtyFlag=!1),t.localTransform;}},{key:"setLocalTransform",value:function(e,t){var n=U.mat4.getTranslation(rQ,t),r=U.mat4.getRotation(rJ,t),i=U.mat4.getScaling(r0,t);this.setLocalScale(e,i,!1),this.setLocalPosition(e,n,!1),this.setLocalRotation(e,r,void 0,void 0,void 0,!1),this.dirtifyLocal(e,e.transformable);}},{key:"resetLocalTransform",value:function(e){this.setLocalScale(e,rZ,!1),this.setLocalPosition(e,rW,!1),this.setLocalEulerAngles(e,rW,void 0,void 0,!1),this.setLocalSkew(e,rH,void 0,!1),this.dirtifyLocal(e,e.transformable);}},{key:"getTransformedGeometryBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.getGeometryBounds(e,t);if(!ea.isEmpty(r)){var i=n||new ea;return i.setFromTransformedAABB(r,this.getWorldTransform(e)),i;}return null;}},{key:"getGeometryBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.geometry;return n.dirty&&ia.styleValueRegistry.updateGeometry(e),(t?n.renderBounds:n.contentBounds||null)||new ea;}},{key:"getBounds",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.renderable;if(!r.boundsDirty&&!n&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&n&&r.renderBounds)return r.renderBounds;var i=n?r.renderBounds:r.bounds,a=this.getTransformedGeometryBounds(e,n,i);if(e.childNodes.forEach(function(e){var r=t.getBounds(e,n);r&&(a?a.add(r):(a=i||new ea).update(r.center,r.halfExtents));}),a||(a=new ea),n){var o=function(e){var t,n=e;do{if(null===(t=n.parsedStyle)||void 0===t?void 0:t.clipPath)return n;n=n.parentElement;}while(null!==n)return null;}(e);if(o){var s=o.parsedStyle.clipPath.getBounds(n);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents);}}return n?(r.renderBounds=a,r.renderBoundsDirty=!1):(r.bounds=a,r.boundsDirty=!1),a;}},{key:"getLocalBounds",value:function(e){if(e.parentNode){var t=rq;e.parentNode.transformable&&(t=U.mat4.invert(r$,this.getWorldTransform(e.parentNode)));var n=this.getBounds(e);if(!ea.isEmpty(n)){var r=new ea;return r.setFromTransformedAABB(n,t),r;}}return this.getBounds(e);}},{key:"getBoundingClientRect",value:function(e){var t,n,r=this.getGeometryBounds(e);ea.isEmpty(r)||(n=new ea).setFromTransformedAABB(r,this.getWorldTransform(e));var i=null===(t=e.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t?void 0:t.getContextService().getBoundingClientRect();if(n){var a=n.getMin(),o=(0,z.default)(a,2),s=o[0],l=o[1],u=n.getMax(),c=(0,z.default)(u,2),d=c[0],f=c[1];return new ec(s+((null==i?void 0:i.left)||0),l+((null==i?void 0:i.top)||0),d-s,f-l);}return new ec((null==i?void 0:i.left)||0,(null==i?void 0:i.top)||0,0,0);}},{key:"dirtifyWorldInternal",value:function(e,t){var n=this;if(!t.dirtyFlag){t.dirtyFlag=!0,t.frozen=!1,e.childNodes.forEach(function(e){var t=e.transformable;t.dirtyFlag||n.dirtifyWorldInternal(e,t);});var r=e.renderable;r&&(r.renderBoundsDirty=!0,r.boundsDirty=!0,r.dirty=!0);}}},{key:"syncHierarchy",value:function(e){var t=e.transformable;if(!t.frozen){t.frozen=!0,(t.localDirtyFlag||t.dirtyFlag)&&this.sync(e,t);for(var n=e.childNodes,r=0;r<n.length;r++)this.syncHierarchy(n[r]);}}},{key:"sync",value:function(e,t){if(t.localDirtyFlag&&(this.calcLocalTransform(t),t.localDirtyFlag=!1),t.dirtyFlag){var n=e.parentNode,r=n&&n.transformable;null!==n&&r?U.mat4.multiply(t.worldTransform,r.worldTransform,t.localTransform):U.mat4.copy(t.worldTransform,t.localTransform),t.dirtyFlag=!1;}}},{key:"unfreezeParentToRoot",value:function(e){for(var t=e.parentNode;t;){var n=t.transformable;n&&(n.frozen=!1),t=t.parentNode;}}}]),r9={MetricsString:"|\xc9q\xc5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},ie=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,it=new RegExp("".concat(/[!%),.:;?\]}¢°·'""†‡›℃∶、。〃〆〕〗〞﹚﹜！＂％＇），．：；？！］｝～]/.source,"|").concat(/[!),.:;?\]}¢·–—'"•"、。〆〞〕〉》」︰︱︲︳﹐﹑﹒﹓﹔﹕﹖﹘﹚﹜！），．：；？︶︸︺︼︾﹀﹂﹗］｜｝､]/.source,"|").concat(/[)\]｝〕〉》」』】〙〗〟'"｠»ヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻‐゠–〜?!‼⁇⁈⁉・、:;,。.]/.source,"|").concat(/[!%),.:;?\]}¢°'"†‡℃〆〈《「『〕！％），．：；？］｝]/.source)),ir=new RegExp("".concat(/[$(£¥·'"〈《「『【〔〖〝﹙﹛＄（．［｛￡￥]/.source,"|").concat(/[([{£¥'"‵〈《「『〔〝︴﹙﹛（｛︵︷︹︻︽︿﹁﹃﹏]/.source,"|").concat(/[([｛〔〈《「『【〘〖〝'"｟«—...‥〳〴〵]/.source,"|").concat(/[$([{£¥'"々〇〉》」〔＄（［｛｠￥￦#]/.source)),ii=(0,O.default)(function e(t){var n=this;(0,N.default)(this,e),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(e,t){return!n.isBreakingSpace(t)&&!!(e&&(ir.exec(t)||it.exec(e)));},this.trimByKinsokuShorui=function(e){var t=(0,I.default)(e),n=t[t.length-2];if(!n)return e;var r=n[n.length-1];return t[t.length-2]=n.slice(0,-1),t[t.length-1]=r+t[t.length-1],t;},this.runtime=t;},[{key:"measureFont",value:function(e,t){if(this.fontMetricsCache[e])return this.fontMetricsCache[e];var n={ascent:0,descent:0,fontSize:0},r=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(t),i=this.runtime.offscreenCanvasCreator.getOrCreateContext(t,{willReadFrequently:!0});i.font=e;var a=r9.MetricsString+r9.BaselineSymbol,o=Math.ceil(i.measureText(a).width),s=Math.ceil(i.measureText(r9.BaselineSymbol).width),l=r9.HeightMultiplier*s;s=s*r9.BaselineMultiplier|0,r.width=o,r.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(a,0,s);var u=i.getImageData(0,0,o||1,l||1).data,c=u.length,d=4*o,f=0,h=0,p=!1;for(f=0;f<s;++f){for(var v=0;v<d;v+=4)if(255!==u[h+v]){p=!0;break;}if(p)break;h+=d;}for(n.ascent=s-f,h=c-d,p=!1,f=l;f>s;--f){for(var g=0;g<d;g+=4)if(255!==u[h+g]){p=!0;break;}if(p)break;h-=d;}return n.descent=f-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[e]=n,n;}},{key:"measureText",value:function(e,t,n){var r=t.fontSize,i=void 0===r?16:r,a=t.wordWrap,o=t.lineHeight,s=t.lineWidth,l=void 0===s?1:s,u=t.textBaseline,c=void 0===u?"alphabetic":u,d=t.textAlign,f=void 0===d?"start":d,h=t.letterSpacing,p=void 0===h?0:h,v=t.textPath;t.textPathSide,t.textPathStartOffset;var g=t.leading,m=void 0===g?0:g,y=function(e){for(var t=e.fontSize,n=void 0===t?16:t,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight,s=(0,F.isNumber)(n)&&"".concat(n,"px")||"16px",l=(void 0===r?"sans-serif":r).split(","),u=l.length-1;u>=0;u--){var c=l[u].trim();!rl.test(c)&&0>rs.indexOf(c)&&(c='"'.concat(c,'"')),l[u]=c;}return"".concat(void 0===i?"normal":i," ").concat(void 0===a?"normal":a," ").concat(void 0===o?"normal":o," ").concat(s," ").concat(l.join(","));}(t),b=this.measureFont(y,n);0===b.fontSize&&(b.fontSize=i,b.ascent=i);var _=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);_.font=y,t.isOverflowing=!1;var x=(void 0!==a&&a?this.wordWrap(e,t,n):e).split(/(?:\r\n|\r|\n)/),w=Array(x.length),E=0;if(v){v.getTotalLength();for(var M=0;M<x.length;M++)_.measureText(x[M]).width,x[M].length;}else{for(var S=0;S<x.length;S++){var k=_.measureText(x[S]).width+(x[S].length-1)*p;w[S]=k,E=Math.max(E,k);}var C=E+l,A=o||b.fontSize+l,L=Math.max(A,b.fontSize+l)+(x.length-1)*(A+m);A+=m;var P=0;return"middle"===c?P=-L/2:"bottom"===c||"alphabetic"===c||"ideographic"===c?P=-L:("top"===c||"hanging"===c)&&(P=0),{font:y,width:C,height:L,lines:x,lineWidths:w,lineHeight:A,maxLineWidth:E,fontProperties:b,lineMetrics:w.map(function(e,t){var n=0;return"center"===f||"middle"===f?n-=e/2:("right"===f||"end"===f)&&(n-=e),new ec(n-l/2,P+t*A,e+l,A);})};}}},{key:"wordWrap",value:function(e,t,n){var r=this,i=this,a=t.wordWrapWidth,o=t.letterSpacing,s=void 0===o?0:o,l=t.maxLines,u=void 0===l?1/0:l,c=t.textOverflow,d=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),f=(void 0===a?0:a)+s,h="";"ellipsis"===c?h="...":c&&"clip"!==c&&(h=c);var p=Array.from(e),v=[],g=0,m=0,y=-1,b={},_=function(e){return r.getFromCache(e,s,b,d);},x=_(h);function w(e,t,n,r){for(;_(e)<r&&t<p.length-1&&!i.isNewline(p[t+1]);)t+=1,e+=p[t];for(;_(e)>r&&t>=n;)t-=1,e=e.slice(0,-1);return{lineTxt:e,txtLastCharIndex:t};}function E(e,t){if(!(x<=0)&&!(x>f)){if(!v[e]){v[e]=h;return;}var n=w(v[e],t,y+1,f-x);v[e]=n.lineTxt+h;}}for(var M=0;M<p.length;M++){var S=p[M],k=p[M-1],C=p[M+1],A=_(S);if(this.isNewline(S)){if(g+1>=u){t.isOverflowing=!0,M<p.length-1&&E(g,M-1);break;}y=M-1,m=0,v[g+=1]="";continue;}if(m>0&&m+A>f){var L=w(v[g],M-1,y+1,f);if(L.txtLastCharIndex!==M-1){if(v[g]=L.lineTxt,L.txtLastCharIndex===p.length-1)break;S=p[M=L.txtLastCharIndex+1],k=p[M-1],C=p[M+1],A=_(S);}if(g+1>=u){t.isOverflowing=!0,E(g,M-1);break;}if(y=M-1,m=0,v[g+=1]="",this.isBreakingSpace(S))continue;this.canBreakInLastChar(S)||(v=this.trimToBreakable(v),m=this.sumTextWidthByCache(v[g]||"",_)),this.shouldBreakByKinsokuShorui(S,C)&&(v=this.trimByKinsokuShorui(v),m+=_(k||""));}m+=A,v[g]=(v[g]||"")+S;}return v.join("\n");}},{key:"isBreakingSpace",value:function(e){return"string"==typeof e&&r9.BreakingSpaces.indexOf(e.charCodeAt(0))>=0;}},{key:"isNewline",value:function(e){return"string"==typeof e&&r9.Newlines.indexOf(e.charCodeAt(0))>=0;}},{key:"trimToBreakable",value:function(e){var t=(0,I.default)(e),n=t[t.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return t;var i=n.slice(r,r+1),a=this.isBreakingSpace(i);return t[t.length-1]+=n.slice(r+1,n.length),t[t.length-2]=n.slice(0,r+(a?0:1)),t;}},{key:"canBreakInLastChar",value:function(e){return!(e&&ie.test(e));}},{key:"sumTextWidthByCache",value:function(e,t){return e.split("").reduce(function(e,n){return e+t(n);},0);}},{key:"findBreakableIndex",value:function(e){for(var t=e.length-1;t>=0;t--)if(!ie.test(e[t]))return t;return -1;}},{key:"getFromCache",value:function(e,t,n,r){var i=n[e];if("number"!=typeof i){var a=e.length*t;i=r.measureText(e).width+a,n[e]=i;}return i;}}]),ia={},io=(E=new rT,M=new rM,w={},(0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)(w,$.FRAGMENT,null),$.CIRCLE,new r_),$.ELLIPSE,new rx),$.RECT,E),$.IMAGE,E),$.GROUP,new rk),$.LINE,new rw),$.TEXT,new rS(ia)),$.POLYLINE,M),$.POLYGON,M),(0,j.default)((0,j.default)((0,j.default)(w,$.PATH,new rE),$.HTML,new rC),$.MESH,null)),is=(k=new nB,C=new nj,S={},(0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)(S,eI.PERCENTAGE,null),eI.NUMBER,new nW),eI.ANGLE,new nD),eI.DEFINED_PATH,new nz),eI.PAINT,k),eI.COLOR,k),eI.FILTER,new nU),eI.LENGTH,C),eI.LENGTH_PERCENTAGE,C),eI.LENGTH_PERCENTAGE_12,new nV),(0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)((0,j.default)(S,eI.LENGTH_PERCENTAGE_14,new nG),eI.COORDINATE,new nj),eI.OFFSET_DISTANCE,new nZ),eI.OPACITY_VALUE,new nq),eI.PATH,new nY),eI.LIST_OF_POINTS,new nX),eI.SHADOW_BLUR,new n$),eI.TEXT,new nK),eI.TEXT_TRANSFORM,new nQ),eI.TRANSFORM,new rm),(0,j.default)((0,j.default)((0,j.default)(S,eI.TRANSFORM_ORIGIN,new ry),eI.Z_INDEX,new rb),eI.MARKER,new nH));ia.CameraContribution=eL,ia.AnimationTimeline=null,ia.EasingFunction=null,ia.offscreenCanvasCreator=new rD,ia.sceneGraphSelector=new rU,ia.sceneGraphService=new r8(ia),ia.textService=new ii(ia),ia.geometryUpdaterFactory=io,ia.CSSPropertySyntaxFactory=is,ia.styleValueRegistry=new nI(ia),ia.layoutRegistry=null,ia.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==Y?Y:{},ia.enableStyleSyntax=!0,ia.enableSizeAttenuation=!1;var il=0,iu=new rj(rF.INSERTED,null,"","","",0,"",""),ic=new rj(rF.REMOVED,null,"","","",0,"",""),id=new rO(rF.DESTROY),ih=function(e){function t(){var e;(0,N.default)(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,R.default)(this,t,[].concat(r))).entity=il++,e.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},e.cullable={strategy:eP.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},e.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},e.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},e.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},e.rBushNode={aabb:void 0},e.namespaceURI="g",e.scrollLeft=0,e.scrollTop=0,e.clientTop=0,e.clientLeft=0,e.destroyed=!1,e.style={},e.computedStyle={},e.parsedStyle={},e.attributes={},e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"className",get:function(){return this.getAttribute("class")||"";},set:function(e){this.setAttribute("class",e);}},{key:"classList",get:function(){return this.className.split(" ").filter(function(e){return""!==e;});}},{key:"tagName",get:function(){return this.nodeName;}},{key:"children",get:function(){return this.childNodes;}},{key:"childElementCount",get:function(){return this.childNodes.length;}},{key:"firstElementChild",get:function(){return this.firstChild;}},{key:"lastElementChild",get:function(){return this.lastChild;}},{key:"parentElement",get:function(){return this.parentNode;}},{key:"nextSibling",get:function(){if(this.parentNode){var e=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[e+1]||null;}return null;}},{key:"previousSibling",get:function(){if(this.parentNode){var e=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[e-1]||null;}return null;}},{key:"cloneNode",value:function(e){throw Error(ed);}},{key:"appendChild",value:function(e,t){var n;if(e.destroyed)throw Error("Cannot append a destroyed element.");return ia.sceneGraphService.attach(e,this,t),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(n2(this)||e.nodeName!==$.FRAGMENT?this.ownerDocument.defaultView.mountChildren(e):this.ownerDocument.defaultView.mountFragment(e)),this.isMutationObserved&&(iu.relatedNode=this,e.dispatchEvent(iu)),e;}},{key:"insertBefore",value:function(e,t){if(t){e.parentElement&&e.parentElement.removeChild(e);var n=this.childNodes.indexOf(t);-1===n?this.appendChild(e):this.appendChild(e,n);}else this.appendChild(e);return e;}},{key:"replaceChild",value:function(e,t){var n=this.childNodes.indexOf(t);return this.removeChild(t),this.appendChild(e,n),t;}},{key:"removeChild",value:function(e){var t;return ic.relatedNode=this,e.dispatchEvent(ic),null!==(t=e.ownerDocument)&&void 0!==t&&t.defaultView&&e.ownerDocument.defaultView.unmountChildren(e),ia.sceneGraphService.detach(e),e;}},{key:"removeChildren",value:function(){for(var e=this.childNodes.length-1;e>=0;e--){var t=this.childNodes[e];this.removeChild(t);}}},{key:"destroyChildren",value:function(){for(var e=this.childNodes.length-1;e>=0;e--){var t=this.childNodes[e];t.childNodes.length>0&&t.destroyChildren(),t.destroy();}}},{key:"matches",value:function(e){return ia.sceneGraphService.matches(e,this);}},{key:"getElementById",value:function(e){return ia.sceneGraphService.querySelector("#".concat(e),this);}},{key:"getElementsByName",value:function(e){return ia.sceneGraphService.querySelectorAll('[name="'.concat(e,'"]'),this);}},{key:"getElementsByClassName",value:function(e){return ia.sceneGraphService.querySelectorAll(".".concat(e),this);}},{key:"getElementsByTagName",value:function(e){return ia.sceneGraphService.querySelectorAll(e,this);}},{key:"querySelector",value:function(e){return ia.sceneGraphService.querySelector(e,this);}},{key:"querySelectorAll",value:function(e){return ia.sceneGraphService.querySelectorAll(e,this);}},{key:"closest",value:function(e){var t=this;do{if(ia.sceneGraphService.matches(e,t))return t;t=t.parentElement;}while(null!==t)return null;}},{key:"find",value:function(e){var t=this,n=null;return this.forEach(function(r){return!(r!==t&&e(r))||(n=r,!1);}),n;}},{key:"findAll",value:function(e){var t=this,n=[];return this.forEach(function(r){r!==t&&e(r)&&n.push(r);}),n;}},{key:"after",value:function(){var e=this;if(this.parentNode){for(var t=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(n,r){var i;return null===(i=e.parentNode)||void 0===i?void 0:i.appendChild(n,t+r+1);});}}},{key:"before",value:function(){if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n[0],a=n.slice(1);this.parentNode.appendChild(i,e),i.after.apply(i,(0,I.default)(a));}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove();}},{key:"append",value:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach(function(t){return e.appendChild(t);});}},{key:"prepend",value:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach(function(t,n){return e.appendChild(t,n);});}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments);}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this;}},{key:"destroy",value:function(){this.destroyChildren(),this.dispatchEvent(id),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0;}},{key:"getGeometryBounds",value:function(){return ia.sceneGraphService.getGeometryBounds(this);}},{key:"getRenderBounds",value:function(){return ia.sceneGraphService.getBounds(this,!0);}},{key:"getBounds",value:function(){return ia.sceneGraphService.getBounds(this);}},{key:"getLocalBounds",value:function(){return ia.sceneGraphService.getLocalBounds(this);}},{key:"getBoundingClientRect",value:function(){return ia.sceneGraphService.getBoundingClientRect(this);}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle));}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes);}},{key:"getAttribute",value:function(e){if("symbol"!=typeof e)return this.attributes[e];}},{key:"hasAttribute",value:function(e){return this.getAttributeNames().includes(e);}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length;}},{key:"removeAttribute",value:function(e){this.setAttribute(e,null),delete this.attributes[e];}},{key:"setAttribute",value:function(e,t,n,r){this.attributes[e]=t;}},{key:"getAttributeNS",value:function(e,t){throw Error(ed);}},{key:"getAttributeNode",value:function(e){throw Error(ed);}},{key:"getAttributeNodeNS",value:function(e,t){throw Error(ed);}},{key:"hasAttributeNS",value:function(e,t){throw Error(ed);}},{key:"removeAttributeNS",value:function(e,t){throw Error(ed);}},{key:"removeAttributeNode",value:function(e){throw Error(ed);}},{key:"setAttributeNS",value:function(e,t,n){throw Error(ed);}},{key:"setAttributeNode",value:function(e){throw Error(ed);}},{key:"setAttributeNodeNS",value:function(e){throw Error(ed);}},{key:"toggleAttribute",value:function(e,t){throw Error(ed);}}]);}(rR);function ip(e){return!!(null!=e&&e.nodeName);}var iv=ia.globalThis.Proxy?ia.globalThis.Proxy:function(){},ig=new rj(rF.ATTR_MODIFIED,null,null,null,null,rj.MODIFICATION,null,null),im=U.vec3.create(),iy=U.quat.create(),ib=function(e){function t(e){var n;return(0,N.default)(this,t),(n=(0,R.default)(this,t)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=e,n.id=e.id||"",n.name=e.name||"",(e.className||e.class)&&(n.className=e.className||e.class),n.nodeName=e.type||$.GROUP,e.initialParsedStyle&&Object.assign(n.parsedStyle,e.initialParsedStyle),n.initAttributes(e.style),ia.enableStyleSyntax&&(n.style=new iv({setProperty:function(e,t){n.setAttribute(e,t);},getPropertyValue:function(e){return n.getAttribute(e);},removeProperty:function(e){n.removeAttribute(e);},item:function(){return"";}},{get:function(e,t){return void 0!==e[t]?e[t]:n.getAttribute(t);},set:function(e,t,r){return n.setAttribute(t,r),!0;}})),n;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"destroy",value:function(){(0,V.default)(t,"destroy",this,3)([]),this.getAnimations().forEach(function(e){e.cancel();});}},{key:"cloneNode",value:function(e,t){var n=(0,P.default)({},this.attributes);for(var r in n){var i=n[r];ip(i)&&"clipPath"!==r&&"offsetPath"!==r&&"textPath"!==r&&(n[r]=i.cloneNode(e)),t&&(n[r]=t(r,i));}var a=new this.constructor((0,P.default)((0,P.default)({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),e&&this.children.forEach(function(t){if(!t.style.isMarker){var n=t.cloneNode(e);a.appendChild(n);}}),a;}},{key:"initAttributes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ia.styleValueRegistry.processProperties(this,e,{forceUpdateGeometry:!0}),this.renderable.dirty=!0;}},{key:"setAttribute",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];!(0,F.isUndefined)(n)&&(r||n!==this.attributes[e])&&(this.internalSetAttribute(e,n,{memoize:i}),(0,V.default)(t,"setAttribute",this,3)([e,n]));}},{key:"internalSetAttribute",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.renderable,a=this.attributes[e],o=this.parsedStyle[e];ia.styleValueRegistry.processProperties(this,(0,j.default)({},e,t),r),i.dirty=!0;var s=this.parsedStyle[e];this.isConnected&&(ig.relatedNode=this,ig.prevValue=a,ig.newValue=t,ig.attrName=e,ig.prevParsedValue=o,ig.newParsedValue=s,this.isMutationObserved?this.dispatchEvent(ig):(ig.target=this,this.ownerDocument.defaultView.dispatchEvent(ig,!0))),(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(n=this.attributeChangedCallback)||void 0===n||n.call(this,e,a,t,o,s));}},{key:"getBBox",value:function(){var e=this.getBounds(),t=e.getMin(),n=(0,z.default)(t,2),r=n[0],i=n[1],a=e.getMax(),o=(0,z.default)(a,2);return new ec(r,i,o[0]-r,o[1]-i);}},{key:"setOrigin",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ia.sceneGraphService.setOrigin(this,ep(e,t,n,!1)),this;}},{key:"getOrigin",value:function(){return ia.sceneGraphService.getOrigin(this);}},{key:"setPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ia.sceneGraphService.setPosition(this,ep(e,t,n,!1)),this;}},{key:"setLocalPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ia.sceneGraphService.setLocalPosition(this,ep(e,t,n,!1)),this;}},{key:"translate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ia.sceneGraphService.translate(this,ep(e,t,n,!1)),this;}},{key:"translateLocal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ia.sceneGraphService.translateLocal(this,ep(e,t,n,!1)),this;}},{key:"getPosition",value:function(){return ia.sceneGraphService.getPosition(this);}},{key:"getLocalPosition",value:function(){return ia.sceneGraphService.getLocalPosition(this);}},{key:"scale",value:function(e,t,n){return this.scaleLocal(e,t,n);}},{key:"scaleLocal",value:function(e,t,n){return"number"==typeof e&&(t=t||e,n=n||e,e=ep(e,t,n,!1)),ia.sceneGraphService.scaleLocal(this,e),this;}},{key:"setLocalScale",value:function(e,t,n){return"number"==typeof e&&(t=t||e,n=n||e,e=ep(e,t,n,!1)),ia.sceneGraphService.setLocalScale(this,e),this;}},{key:"getLocalScale",value:function(){return ia.sceneGraphService.getLocalScale(this);}},{key:"getScale",value:function(){return ia.sceneGraphService.getScale(this);}},{key:"getEulerAngles",value:function(){var e=ey(im,ia.sceneGraphService.getWorldTransform(this));return(0,z.default)(e,3)[2]*eg;}},{key:"getLocalEulerAngles",value:function(){var e=ey(im,ia.sceneGraphService.getLocalRotation(this));return(0,z.default)(e,3)[2]*eg;}},{key:"setEulerAngles",value:function(e){return ia.sceneGraphService.setEulerAngles(this,0,0,e),this;}},{key:"setLocalEulerAngles",value:function(e){return ia.sceneGraphService.setLocalEulerAngles(this,0,0,e),this;}},{key:"rotateLocal",value:function(e,t,n){return(0,F.isNil)(t)&&(0,F.isNil)(n)?ia.sceneGraphService.rotateLocal(this,0,0,e):ia.sceneGraphService.rotateLocal(this,e,t,n),this;}},{key:"rotate",value:function(e,t,n){return(0,F.isNil)(t)&&(0,F.isNil)(n)?ia.sceneGraphService.rotate(this,0,0,e):ia.sceneGraphService.rotate(this,e,t,n),this;}},{key:"setRotation",value:function(e,t,n,r){return ia.sceneGraphService.setRotation(this,e,t,n,r),this;}},{key:"setLocalRotation",value:function(e,t,n,r){return ia.sceneGraphService.setLocalRotation(this,e,t,n,r),this;}},{key:"setLocalSkew",value:function(e,t){return ia.sceneGraphService.setLocalSkew(this,e,t),this;}},{key:"getRotation",value:function(){return ia.sceneGraphService.getRotation(this);}},{key:"getLocalRotation",value:function(){return ia.sceneGraphService.getLocalRotation(this);}},{key:"getLocalSkew",value:function(){return ia.sceneGraphService.getLocalSkew(this);}},{key:"getLocalTransform",value:function(){return ia.sceneGraphService.getLocalTransform(this);}},{key:"getWorldTransform",value:function(){return ia.sceneGraphService.getWorldTransform(this);}},{key:"setLocalTransform",value:function(e){return ia.sceneGraphService.setLocalTransform(this,e),this;}},{key:"resetLocalTransform",value:function(){ia.sceneGraphService.resetLocalTransform(this);}},{key:"getAnimations",value:function(){return this.activeAnimations;}},{key:"animate",value:function(e,t){var n,r=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return r?r.play(this,e,t):null;}},{key:"isVisible",value:function(){var e;return(null===(e=this.parsedStyle)||void 0===e?void 0:e.visibility)!=="hidden";}},{key:"interactive",get:function(){return this.isInteractive();},set:function(e){this.style.pointerEvents=e?"auto":"none";}},{key:"isInteractive",value:function(){var e;return(null===(e=this.parsedStyle)||void 0===e?void 0:e.pointerEvents)!=="none";}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible);}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,I.default)(this.parentNode.children.map(function(e){return Number(e.style.zIndex);})))+1),this;}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,I.default)(this.parentNode.children.map(function(e){return Number(e.style.zIndex);})))-1),this;}},{key:"getConfig",value:function(){return this.config;}},{key:"attr",value:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n[0],a=n[1];return i?(0,F.isObject)(i)?(Object.keys(i).forEach(function(t){e.setAttribute(t,i[t]);}),this):2===n.length?(this.setAttribute(i,a),this):this.attributes[i]:this.attributes;}},{key:"getMatrix",value:function(e){var t,n,r,i=e||this.getWorldTransform(),a=U.mat4.getTranslation(im,i),o=(0,z.default)(a,2),s=o[0],l=o[1],u=U.mat4.getScaling(im,i),c=(0,z.default)(u,2),d=c[0],f=c[1],h=ey(im,U.mat4.getRotation(iy,i)),p=(0,z.default)(h,3),v=p[0],g=p[2];return n=Math.cos(t=v||g),r=Math.sin(t),U.mat3.fromValues(d*n,f*r,0,-d*r,f*n,0,s,l,1);}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform());}},{key:"setMatrix",value:function(e){var t=eb(e),n=(0,z.default)(t,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setEulerAngles(s).setPosition(r,i).setLocalScale(a,o);}},{key:"setLocalMatrix",value:function(e){var t=eb(e),n=(0,z.default)(t,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setLocalEulerAngles(s).setLocalPosition(r,i).setLocalScale(a,o);}},{key:"show",value:function(){this.forEach(function(e){e.style.visibility="visible";});}},{key:"hide",value:function(){this.forEach(function(e){e.style.visibility="hidden";});}},{key:"getCount",value:function(){return this.childElementCount;}},{key:"getParent",value:function(){return this.parentElement;}},{key:"getChildren",value:function(){return this.children;}},{key:"getFirst",value:function(){return this.firstElementChild;}},{key:"getLast",value:function(){return this.lastElementChild;}},{key:"getChildByIndex",value:function(e){return this.children[e]||null;}},{key:"add",value:function(e,t){return this.appendChild(e,t);}},{key:"set",value:function(e,t){this.config[e]=t;}},{key:"get",value:function(e){return this.config[e];}},{key:"moveTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(e,t,n),this;}},{key:"move",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(e,t,n),this;}},{key:"setZIndex",value:function(e){return this.style.zIndex=e,this;}}]);}(ih);ib.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var i_=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:$.CIRCLE},e)]);}return(0,D.default)(t,e),(0,O.default)(t);}(ib);i_.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ib.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var ix=["style"];(function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,ix);return(0,N.default)(this,t),(e=(0,R.default)(this,t,[(0,P.default)({style:r},i)])).isCustomElement=!0,e;}return(0,D.default)(t,e),(0,O.default)(t);})(ib).PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iw=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:$.ELLIPSE},e)]);}return(0,D.default)(t,e),(0,O.default)(t);}(ib);iw.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ib.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),function(e){function t(){return(0,N.default)(this,t),(0,R.default)(this,t,[{type:$.FRAGMENT}]);}return(0,D.default)(t,e),(0,O.default)(t);}(ib).PARSED_STYLE_LIST=new Set(["class","className"]);var iE=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:$.GROUP},e)]);}return(0,D.default)(t,e),(0,O.default)(t);}(ib);iE.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iM=["style"],iT=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iM);return(0,N.default)(this,t),(e=(0,R.default)(this,t,[(0,P.default)({type:$.HTML,style:r},i)])).cullable.enable=!1,e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"getDomElement",value:function(){return this.parsedStyle.$el;}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"getLocalBounds",value:function(){if(this.parentNode){var e=U.mat4.invert(U.mat4.create(),this.parentNode.getWorldTransform()),t=this.getBounds();if(!ea.isEmpty(t)){var n=new ea;return n.setFromTransformedAABB(t,e),n;}}return this.getBounds();}}]);}(ib);iT.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ib.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var iS=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:$.IMAGE},e)]);}return(0,D.default)(t,e),(0,O.default)(t);}(ib);iS.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ib.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var ik=["style"],iC=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,ik);(0,N.default)(this,t),(e=(0,R.default)(this,t,[(0,P.default)({type:$.LINE,style:(0,P.default)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},r)},i)])).markerStartAngle=0,e.markerEndAngle=0;var a=e.parsedStyle,o=a.markerStart,s=a.markerEnd;return o&&ip(o)&&(e.markerStartAngle=o.getLocalEulerAngles(),e.appendChild(o)),s&&ip(s)&&(e.markerEndAngle=s.getLocalEulerAngles(),e.appendChild(s)),e.transformMarker(!0),e.transformMarker(!1),e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"attributeChangedCallback",value:function(e,t,n,r,i){"x1"===e||"y1"===e||"x2"===e||"y2"===e||"markerStartOffset"===e||"markerEndOffset"===e?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===e?(r&&ip(r)&&(this.markerStartAngle=0,r.remove()),i&&ip(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===e&&(r&&ip(r)&&(this.markerEndAngle=0,r.remove()),i&&ip(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)));}},{key:"transformMarker",value:function(e){var t,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,d=s.markerEndOffset,f=s.x1,h=s.x2,p=s.y1,v=s.y2,g=e?l:u;if(g&&ip(g)){var m=0;e?(r=f,i=p,t=h-f,n=v-p,a=c||0,o=this.markerStartAngle):(r=h,i=v,t=f-h,n=p-v,a=d||0,o=this.markerEndAngle),m=Math.atan2(n,t),g.setLocalEulerAngles(180*m/Math.PI+o),g.setLocalPosition(r+Math.cos(m)*a,i+Math.sin(m)*a);}}},{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,r=n.x1,i=n.y1,a=n.x2,o=n.y2,s=(0,G.linePointAt)(r,i,a,o,e),l=s.x,u=s.y,c=U.vec3.transformMat4(U.vec3.create(),U.vec3.fromValues(l,u,0),t?this.getWorldTransform():this.getLocalTransform());return new eu(c[0],c[1]);}},{key:"getPointAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(e/this.getTotalLength(),t);}},{key:"getTotalLength",value:function(){var e=this.parsedStyle,t=e.x1,n=e.y1,r=e.x2,i=e.y2;return(0,G.lineLength)(t,n,r,i);}}]);}(ib);iC.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ib.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var iA=["style"],iL=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iA);(0,N.default)(this,t),(e=(0,R.default)(this,t,[(0,P.default)({type:$.PATH,style:r,initialParsedStyle:{miterLimit:4,d:(0,P.default)({},eO)}},i)])).markerStartAngle=0,e.markerEndAngle=0,e.markerMidList=[];var a=e.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&ip(o)&&(e.markerStartAngle=o.getLocalEulerAngles(),e.appendChild(o)),l&&ip(l)&&e.placeMarkerMid(l),s&&ip(s)&&(e.markerEndAngle=s.getLocalEulerAngles(),e.appendChild(s)),e.transformMarker(!0),e.transformMarker(!1),e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"attributeChangedCallback",value:function(e,t,n,r,i){"d"===e?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===e||"markerEndOffset"===e?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===e?(r&&ip(r)&&(this.markerStartAngle=0,r.remove()),i&&ip(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===e?(r&&ip(r)&&(this.markerEndAngle=0,r.remove()),i&&ip(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===e&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(e){var t,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,d=s.markerEndOffset,f=e?l:u;if(f&&ip(f)){var h=0;if(e){var p=this.getStartTangent(),v=(0,z.default)(p,2),g=v[0],m=v[1];r=m[0],i=m[1],t=g[0]-m[0],n=g[1]-m[1],a=c||0,o=this.markerStartAngle;}else{var y=this.getEndTangent(),b=(0,z.default)(y,2),_=b[0],x=b[1];r=x[0],i=x[1],t=_[0]-x[0],n=_[1]-x[1],a=d||0,o=this.markerEndAngle;}h=Math.atan2(n,t),f.setLocalEulerAngles(180*h/Math.PI+o),f.setLocalPosition(r+Math.cos(h)*a,i+Math.sin(h)*a);}}},{key:"placeMarkerMid",value:function(e){var t=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(e){e.remove();}),e&&ip(e))for(var n=1;n<t.length-1;n++){var r=(0,z.default)(t[n].currentPoint,2),i=r[0],a=r[1],o=1===n?e:e.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(i,a);}}},{key:"getTotalLength",value:function(){return t8(this);}},{key:"getPointAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.d.absolutePath,r=(0,F.getPointAtLength)(n,e),i=r.x,a=r.y,o=U.vec3.transformMat4(U.vec3.create(),U.vec3.fromValues(i,a,0),t?this.getWorldTransform():this.getLocalTransform());return new eu(o[0],o[1]);}},{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(e*t8(this),t);}},{key:"getStartTangent",value:function(){var e=this.parsedStyle.d.segments,t=[];if(e.length>1){var n=e[0].currentPoint,r=e[1].currentPoint,i=e[1].startTangent;t=[],i?t.push([n[0]-i[0],n[1]-i[1]]):t.push([r[0],r[1]]),t.push([n[0],n[1]]);}return t;}},{key:"getEndTangent",value:function(){var e=this.parsedStyle.d.segments,t=e.length,n=[];if(t>1){var r=e[t-2].currentPoint,i=e[t-1].currentPoint,a=e[t-1].endTangent;n=[],a?n.push([i[0]-a[0],i[1]-a[1]]):n.push([r[0],r[1]]),n.push([i[0],i[1]]);}return n;}}]);}(ib);iL.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ib.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var iP=["style"],iN=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iP);(0,N.default)(this,t),(e=(0,R.default)(this,t,[(0,P.default)({type:$.POLYGON,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},i)])).markerStartAngle=0,e.markerEndAngle=0,e.markerMidList=[];var a=e.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&ip(o)&&(e.markerStartAngle=o.getLocalEulerAngles(),e.appendChild(o)),l&&ip(l)&&e.placeMarkerMid(l),s&&ip(s)&&(e.markerEndAngle=s.getLocalEulerAngles(),e.appendChild(s)),e.transformMarker(!0),e.transformMarker(!1),e;}return(0,D.default)(t,e),(0,O.default)(t,[{key:"attributeChangedCallback",value:function(e,t,n,r,i){"points"===e?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===e||"markerEndOffset"===e?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===e?(r&&ip(r)&&(this.markerStartAngle=0,r.remove()),i&&ip(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===e?(r&&ip(r)&&(this.markerEndAngle=0,r.remove()),i&&ip(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===e&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(e){var t,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,d=s.markerEndOffset,f=(s.points||{}).points,h=e?l:u;if(h&&ip(h)&&f){var p=0;if(r=f[0][0],i=f[0][1],e)t=f[1][0]-f[0][0],n=f[1][1]-f[0][1],a=c||0,o=this.markerStartAngle;else{var v=f.length;this.parsedStyle.isClosed?(t=f[v-1][0]-f[0][0],n=f[v-1][1]-f[0][1]):(r=f[v-1][0],i=f[v-1][1],t=f[v-2][0]-f[v-1][0],n=f[v-2][1]-f[v-1][1]),a=d||0,o=this.markerEndAngle;}p=Math.atan2(n,t),h.setLocalEulerAngles(180*p/Math.PI+o),h.setLocalPosition(r+Math.cos(p)*a,i+Math.sin(p)*a);}}},{key:"placeMarkerMid",value:function(e){var t=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach(function(e){e.remove();}),this.markerMidList=[],e&&ip(e)&&t)for(var n=1;n<(this.parsedStyle.isClosed?t.length:t.length-1);n++){var r=t[n][0],i=t[n][1],a=1===n?e:e.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(r,i);}}}]);}(ib);iN.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ib.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var iO=["style"],iI=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.style,r=(0,q.default)(e,iO);return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:$.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},r)]);}return(0,D.default)(t,e),(0,O.default)(t,[{key:"getTotalLength",value:function(){return 0===this.parsedStyle.points.totalLength&&(this.parsedStyle.points.totalLength=(0,G.polylineLength)(this.parsedStyle.points.points)),this.parsedStyle.points.totalLength;}},{key:"getPointAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(e/this.getTotalLength(),t);}},{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var r,i,a=[],o=0,s=this.getTotalLength();n.forEach(function(e,t){n[t+1]&&((r=[0,0])[0]=o/s,i=(0,G.lineLength)(e[0],e[1],n[t+1][0],n[t+1][1]),o+=i,r[1]=o/s,a.push(r));}),this.parsedStyle.points.segments=a;}var l=0,u=0;this.parsedStyle.points.segments.forEach(function(t,n){e>=t[0]&&e<=t[1]&&(l=(e-t[0])/(t[1]-t[0]),u=n);});var c=(0,G.linePointAt)(n[u][0],n[u][1],n[u+1][0],n[u+1][1],l),d=c.x,f=c.y,h=U.vec3.transformMat4(U.vec3.create(),U.vec3.fromValues(d,f,0),t?this.getWorldTransform():this.getLocalTransform());return new eu(h[0],h[1]);}},{key:"getStartTangent",value:function(){var e=this.parsedStyle.points.points,t=[];return t.push([e[1][0],e[1][1]]),t.push([e[0][0],e[0][1]]),t;}},{key:"getEndTangent",value:function(){var e=this.parsedStyle.points.points,t=e.length-1,n=[];return n.push([e[t-1][0],e[t-1][1]]),n.push([e[t][0],e[t][1]]),n;}}]);}(iN);iI.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(iN.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var iR=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:$.RECT},e)]);}return(0,D.default)(t,e),(0,O.default)(t);}(ib);iR.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ib.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var iD=["style"],iz=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.style,r=(0,q.default)(e,iD);return(0,N.default)(this,t),(0,R.default)(this,t,[(0,P.default)({type:$.TEXT,style:(0,P.default)({fill:"black"},n)},r)]);}return(0,D.default)(t,e),(0,O.default)(t,[{key:"getComputedTextLength",value:function(){var e;return this.getGeometryBounds(),(null===(e=this.parsedStyle.metrics)||void 0===e?void 0:e.maxLineWidth)||0;}},{key:"getLineBoundingRects",value:function(){var e;return this.getGeometryBounds(),(null===(e=this.parsedStyle.metrics)||void 0===e?void 0:e.lineMetrics)||[];}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing;}}]);}(ib);iz.PARSED_STYLE_LIST=new Set([].concat((0,I.default)(ib.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textPathSide","textPathStartOffset","metrics","dx","dy"])),(0,O.default)(function e(){(0,N.default)(this,e),this.registry={},this.define($.CIRCLE,i_),this.define($.ELLIPSE,iw),this.define($.RECT,iR),this.define($.IMAGE,iS),this.define($.LINE,iC),this.define($.GROUP,iE),this.define($.PATH,iL),this.define($.POLYGON,iN),this.define($.POLYLINE,iI),this.define($.TEXT,iz),this.define($.HTML,iT);},[{key:"define",value:function(e,t){this.registry[e]=t;}},{key:"get",value:function(e){return this.registry[e];}}]),function(){function e(t){(0,N.default)(this,e),this.strategies=t;}return(0,O.default)(e,[{key:"apply",value:function(t){var n=t.camera,r=t.renderingService,i=t.renderingContext,a=this.strategies;r.hooks.cull.tap(e.tag,function(e){if(e){var t=e.cullable;return(0===a.length?t.visible=i.unculledEntities.indexOf(e.entity)>-1:t.visible=a.every(function(t){return t.isVisible(n,e);}),!e.isCulled()&&e.isVisible())?e:(e.dispatchEvent(new rO(rF.CULLED)),null);}return e;}),r.hooks.afterRender.tap(e.tag,function(e){e.cullable.visibilityPlaneMask=-1;});}}]);}().tag="Culling",function(){function e(){var t=this;(0,N.default)(this,e),this.autoPreventDefault=!1,this.rootPointerEvent=new rP(null),this.rootWheelEvent=new rN(null),this.onPointerMove=function(e){var n=null===(r=t.context.renderingContext.root)||void 0===r||null===(r=r.ownerDocument)||void 0===r?void 0:r.defaultView;if(!n.supportsTouchEvents||"touch"!==e.pointerType){var r,i,a=t.normalizeToPointerEvent(e,n),o=(0,Z.default)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=t.bootstrapEvent(t.rootPointerEvent,s,n,e);t.context.eventService.mapEvent(l);}}catch(e){o.e(e);}finally{o.f();}t.setCursor(t.context.eventService.cursor);}},this.onClick=function(e){var n,r,i=null===(n=t.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,a=t.normalizeToPointerEvent(e,i),o=(0,Z.default)(a);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=t.bootstrapEvent(t.rootPointerEvent,s,i,e);t.context.eventService.mapEvent(l);}}catch(e){o.e(e);}finally{o.f();}t.setCursor(t.context.eventService.cursor);};}return(0,O.default)(e,[{key:"apply",value:function(t){var n=this;this.context=t;var r=t.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(e){return n.context.renderingService.hooks.pickSync.call({position:e,picked:[],topmost:!0}).picked[0]||null;}),r.hooks.pointerWheel.tap(e.tag,function(e){var t=n.normalizeWheelEvent(e);n.context.eventService.mapEvent(t);}),r.hooks.pointerDown.tap(e.tag,function(e){if(!i.supportsTouchEvents||"touch"!==e.pointerType){var t=n.normalizeToPointerEvent(e,i);n.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();var r,a=(0,Z.default)(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,e);n.context.eventService.mapEvent(s);}}catch(e){a.e(e);}finally{a.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerUp.tap(e.tag,function(e){if(!i.supportsTouchEvents||"touch"!==e.pointerType){var t,r=n.context.contextService.getDomElement(),a=n.context.eventService.isNativeEventFromCanvas(r,e)?"":"outside",o=n.normalizeToPointerEvent(e,i),s=(0,Z.default)(o);try{for(s.s();!(t=s.n()).done;){var l=t.value,u=n.bootstrapEvent(n.rootPointerEvent,l,i,e);u.type+=a,n.context.eventService.mapEvent(u);}}catch(e){s.e(e);}finally{s.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerMove.tap(e.tag,this.onPointerMove),r.hooks.pointerOver.tap(e.tag,this.onPointerMove),r.hooks.pointerOut.tap(e.tag,this.onPointerMove),r.hooks.click.tap(e.tag,this.onClick),r.hooks.pointerCancel.tap(e.tag,function(e){var t,r=n.normalizeToPointerEvent(e,i),a=(0,Z.default)(r);try{for(a.s();!(t=a.n()).done;){var o=t.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,e);n.context.eventService.mapEvent(s);}}catch(e){a.e(e);}finally{a.f();}n.setCursor(n.context.eventService.cursor);});}},{key:"bootstrapEvent",value:function(e,t,n,r){e.view=n,e.originalEvent=null,e.nativeEvent=r,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t);var i=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),a=i.x,o=i.y;e.viewport.x=a,e.viewport.y=o;var s=this.context.eventService.viewport2Canvas(e.viewport),l=s.x,u=s.y;return e.canvas.x=l,e.canvas.y=u,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=r.isTrusted,"pointerleave"===e.type&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=n0[e.type]||e.type),e;}},{key:"normalizeWheelEvent",value:function(e){var t=this.rootWheelEvent;this.transferMouseData(t,e),t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ;var n=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),r=n.x,i=n.y;t.viewport.x=r,t.viewport.y=i;var a=this.context.eventService.viewport2Canvas(t.viewport),o=a.x,s=a.y;return t.canvas.x=o,t.canvas.y=s,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.nativeEvent=e,t.type=e.type,t;}},{key:"transferMouseData",value:function(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=n1.now(),e.type=t.type,e.altKey=t.altKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.screen.x=t.screenX,e.screen.y=t.screenY,e.relatedTarget=null;}},{key:"setCursor",value:function(e){this.context.contextService.applyCursorStyle(e||this.context.config.cursor||"default");}},{key:"normalizeToPointerEvent",value:function(e,t){var n=[];if(t.isTouchEvent(e))for(var r=0;r<e.changedTouches.length;r++){var i=e.changedTouches[r];(0,F.isUndefined)(i.button)&&(i.button=0),(0,F.isUndefined)(i.buttons)&&(i.buttons=1),(0,F.isUndefined)(i.isPrimary)&&(i.isPrimary=1===e.touches.length&&"touchstart"===e.type),(0,F.isUndefined)(i.width)&&(i.width=i.radiusX||1),(0,F.isUndefined)(i.height)&&(i.height=i.radiusY||1),(0,F.isUndefined)(i.tiltX)&&(i.tiltX=0),(0,F.isUndefined)(i.tiltY)&&(i.tiltY=0),(0,F.isUndefined)(i.pointerType)&&(i.pointerType="touch"),(0,F.isUndefined)(i.pointerId)&&(i.pointerId=i.identifier||0),(0,F.isUndefined)(i.pressure)&&(i.pressure=i.force||.5),(0,F.isUndefined)(i.twist)&&(i.twist=0),(0,F.isUndefined)(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=e.type,n.push(i);}else t.isMouseEvent(e)&&((0,F.isUndefined)(e.isPrimary)&&(e.isPrimary=!0),(0,F.isUndefined)(e.width)&&(e.width=1),(0,F.isUndefined)(e.height)&&(e.height=1),(0,F.isUndefined)(e.tiltX)&&(e.tiltX=0),(0,F.isUndefined)(e.tiltY)&&(e.tiltY=0),(0,F.isUndefined)(e.pointerType)&&(e.pointerType="mouse"),(0,F.isUndefined)(e.pointerId)&&(e.pointerId=1),(0,F.isUndefined)(e.pressure)&&(e.pressure=.5),(0,F.isUndefined)(e.twist)&&(e.twist=0),(0,F.isUndefined)(e.tangentialPressure)&&(e.tangentialPressure=0),e.isNormalized=!0),n.push(e);return n;}}]);}().tag="Event";var iB=[$.CIRCLE,$.ELLIPSE,$.IMAGE,$.RECT,$.LINE,$.POLYLINE,$.POLYGON,$.TEXT,$.PATH,$.HTML];(0,O.default)(function e(){(0,N.default)(this,e);},[{key:"isVisible",value:function(e,t){var n,r=t.cullable;if(!r.enable)return!0;var i=t.getRenderBounds();if(ea.isEmpty(i))return!1;var a=e.getFrustum(),o=null===(n=t.parentNode)||void 0===n||null===(n=n.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(t,i,o||es.INDETERMINATE,a.planes),r.visible=r.visibilityPlaneMask!==es.OUTSIDE,r.visible;}},{key:"computeVisibilityWithPlaneMask",value:function(e,t,n,r){if(n===es.OUTSIDE||n===es.INSIDE)return n;for(var i=es.INSIDE,a=iB.indexOf(e.nodeName)>-1,o=0,s=r.length;o<s;++o){var l=1<<o;if((n&l)!=0&&(!a||4!==o&&5!==o)){var u=r[o],c=u.normal,d=u.distance;if(U.vec3.dot(c,t.getPositiveFarPoint(r[o]))+d<0)return es.OUTSIDE;U.vec3.dot(c,t.getNegativeFarPoint(r[o]))+d<0&&(i|=l);}}return i;}}]),function(){function e(){(0,N.default)(this,e),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1;}return(0,O.default)(e,[{key:"apply",value:function(t){var n,r=this,i=t.renderingService,a=t.renderingContext,o=t.rBushRoot,s=a.root.ownerDocument.defaultView;this.rBush=o;var l=function(e){e.target.renderable.dirty=!0,i.dirtify();},u=function(e){r.syncTasks.set(e.target,e.detail.affectChildren),i.dirtify();},c=function(e){var t=e.target;ia.enableSizeAttenuation&&ia.styleValueRegistry.updateSizeAttenuation(t,s.getCamera().getZoom());},d=function(e){var t=e.target,n=t.rBushNode;n.aabb&&r.rBush.remove(n.aabb),r.syncTasks.delete(t),ia.sceneGraphService.dirtifyToRoot(t),i.dirtify();};i.hooks.init.tap(e.tag,function(){s.addEventListener(rF.MOUNTED,c),s.addEventListener(rF.UNMOUNTED,d),s.addEventListener(rF.ATTR_MODIFIED,l),s.addEventListener(rF.BOUNDS_CHANGED,u);}),i.hooks.destroy.tap(e.tag,function(){s.removeEventListener(rF.MOUNTED,c),s.removeEventListener(rF.UNMOUNTED,d),s.removeEventListener(rF.ATTR_MODIFIED,l),s.removeEventListener(rF.BOUNDS_CHANGED,u),r.syncTasks.clear();});var f=null!==(n=ia.globalThis.requestIdleCallback)&&void 0!==n?n:rt.bind(ia.globalThis);i.hooks.endFrame.tap(e.tag,function(){r.isFirstTimeRendering?(r.isFirstTimeRendering=!1,r.syncing=!0,f(function(){r.syncRTree(!0),r.isFirstTimeRenderingFinished=!0;})):r.syncRTree();});}},{key:"syncNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.isConnected){var n=e.rBushNode;n.aabb&&this.rBush.remove(n.aabb);var r=e.getRenderBounds();if(r){var i=e.renderable;t&&(i.dirtyRenderBounds||(i.dirtyRenderBounds=new ea),i.dirtyRenderBounds.update(r.center,r.halfExtents));var a=r.getMin(),o=(0,z.default)(a,2),s=o[0],l=o[1],u=r.getMax(),c=(0,z.default)(u,2),d=c[0],f=c[1];n.aabb||(n.aabb={}),n.aabb.displayObject=e,n.aabb.minX=s,n.aabb.minY=l,n.aabb.maxX=d,n.aabb.maxY=f;}if(n.aabb&&!isNaN(n.aabb.maxX)&&!isNaN(n.aabb.maxX)&&!isNaN(n.aabb.minX)&&!isNaN(n.aabb.minY))return n.aabb;}}},{key:"syncRTree",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t||!this.syncing&&0!==this.syncTasks.size){this.syncing=!0;var n=[],r=new Set,i=function(i){if(!r.has(i)&&i.renderable){var a=e.syncNode(i,t);a&&(n.push(a),r.add(i));}};this.syncTasks.forEach(function(e,t){e&&t.forEach(i);for(var n=t;n;)i(n),n=n.parentElement;}),this.rBush.load(n),n.length=0,this.syncing=!1;}}}]);}().tag="Prepare";var iU=((A={}).READY="ready",A.BEFORE_RENDER="beforerender",A.RERENDER="rerender",A.AFTER_RENDER="afterrender",A.BEFORE_DESTROY="beforedestroy",A.AFTER_DESTROY="afterdestroy",A.RESIZE="resize",A.DIRTY_RECTANGLE="dirtyrectangle",A.RENDERER_CHANGED="rendererchanged",A);new rO(rF.MOUNTED),new rO(rF.UNMOUNTED),new rO(iU.BEFORE_RENDER),new rO(iU.RERENDER),new rO(iU.AFTER_RENDER);},ef666486:function(e,t,n){var r=n("31e26024");e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return -1;};},ef673027:function(e,t,n){var r=n("ab7074ef"),i=n("d038e143"),a=n("32f27622"),o=n("dfdbf11f"),s=n("c0051812");e.exports=function(e,t,n){var l=s(e)?r:o,u=arguments.length<3;return l(e,a(t,4),n,u,i);};},efc6bc29:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return i;}});var r=n("777fffbe")._(n("73ff5a90")),i=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r.default&&void 0===t?"__lodash_hash_undefined__":t,this;};},efd9d035:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"TilePickService",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=n("fb1ec05a"),s=n("cf496f3c");let l="select",u="active";class c{constructor({layerService:e,tileLayerService:t,parent:n}){(0,a.default)(this,"layerService",void 0),(0,a.default)(this,"tileLayerService",void 0),(0,a.default)(this,"tileSourceService",void 0),(0,a.default)(this,"parent",void 0),(0,a.default)(this,"tilePickID",new Map),this.layerService=e,this.tileLayerService=t,this.parent=n,this.tileSourceService=new s.TileSourceService;}pickRender(e){let t=this.tileLayerService.getVisibleTileBylngLat(e.lngLat);if(t){let n=t.getMainLayer();null==n||n.layerPickService.pickRender(e);}}pick(e,t){var n=this;return(0,i.default)(function*(){let r=n.parent.getContainer().pickingService;if("RasterLayer"===e.type){let e=n.tileLayerService.getVisibleTileBylngLat(t.lngLat);if(e&&void 0!==e.getMainLayer()){let r=e.getMainLayer();return r.layerPickService.pickRasterLayer(r,t,n.parent);}return!1;}return n.pickRender(t),r.pickFromPickingFBO(e,t);})();}selectFeature(e){let[t,n,r]=e,i=this.color2PickId(t,n,r);this.tilePickID.set(l,i),this.updateHighLight(t,n,r,l);}highlightPickedFeature(e){let[t,n,r]=e,i=this.color2PickId(t,n,r);this.tilePickID.set(u,i),this.updateHighLight(t,n,r,u);}updateHighLight(e,t,n,r){this.tileLayerService.tiles.map(i=>{let a=i.getMainLayer();switch(r){case l:null==a||a.hooks.beforeSelect.call([e,t,n]);break;case u:null==a||a.hooks.beforeHighlight.call([e,t,n]);}});}setPickState(){let e=this.tilePickID.get(l),t=this.tilePickID.get(u);if(e){let[t,n,r]=this.pickId2Color(e);this.updateHighLight(t,n,r,l);return;}if(t){let[e,n,r]=this.pickId2Color(t);this.updateHighLight(e,n,r,u);return;}}color2PickId(e,t,n){return(0,o.decodePickingColor)(new Uint8Array([e,t,n]));}pickId2Color(e){return(0,o.encodePickingColor)(e);}getFeatureById(e){let t=this.tileLayerService.getTiles().filter(e=>e.visible),n=[];return t.forEach(t=>{n.push(...t.getFeatureById(e));}),n;}pickRasterLayer(){return!1;}}},f065ee2a:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("27db1f6b")),a=r._(n("3a988df8")),o=Object.prototype,s=o.hasOwnProperty,l=o.propertyIsEnumerable,u=(0,i.default)(function(){return arguments;}())?i.default:function(e){return(0,a.default)(e)&&s.call(e,"callee")&&!l.call(e,"callee");};},f0706e85:function(e,t,n){var r=n("afa9632d");e.exports=function(e){return(null==e?0:e.length)?r(e,1):[];};},f070a4f1:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("c21c959b")),a=r._(n("c9dc36b7")),o=r._(n("71a8d152")),s=r._(n("21962781")),l=r._(n("bf5cd903")),u=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return(0,i.default)(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return(0,a.default)(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return(0,l.default)(e,n);case"[object Map]":case"[object Set]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return(0,o.default)(e);case"[object Symbol]":return(0,s.default)(e);}};},f08fe8a7:function(e,t,n){var r=n("0a3b822d"),i=n("2339bf2f"),a=n("0fab4c74");e.exports=function(e){return i(e)?a(e):r(e);};},f0c4f7d7:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return d;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("d812e418")),o=n("fb1ec05a"),s=n("f86d399e"),l=r._(n("b76aac1a")),u=r._(n("d72829b5"));let{merge:c}=o.lodashUtil;class d extends s.EventEmitter{constructor(e){var t;super(),(0,a.default)(this,"markers",[]),(0,a.default)(this,"markerLayerOption",void 0),(0,a.default)(this,"clusterIndex",void 0),(0,a.default)(this,"points",[]),(0,a.default)(this,"clusterMarkers",[]),(0,a.default)(this,"mapsService",void 0),(0,a.default)(this,"scene",void 0),(0,a.default)(this,"zoom",void 0),(0,a.default)(this,"bbox",void 0),(0,a.default)(this,"inited",void 0),(0,a.default)(this,"containerSize",void 0),this.markerLayerOption=c(this.getDefault(),e),(0,o.bindAll)(["update"],this),this.zoom=(null===(t=this.markerLayerOption.clusterOption)||void 0===t?void 0:t.zoom)||-99;}getDefault(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}};}addTo(e){return this.scene=e,this.mapsService=e.mapService,this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.mapsService.on("camerachange",this.setContainerSize.bind(this)),this.mapsService.on("viewchange",this.setContainerSize.bind(this)),this.addMarkers(),this.inited=!0,this;}setContainerSize(){if(!this.mapsService)return;let e=this.mapsService.getContainer();this.containerSize={containerWidth:(null==e?void 0:e.scrollWidth)||0,containerHeight:(null==e?void 0:e.scrollHeight)||0,bounds:this.mapsService.getBounds()};}getContainerSize(){return this.containerSize;}addMarker(e){let t=this.markerLayerOption.cluster;if(e.getMarkerLayerContainerSize=this.getContainerSize.bind(this),t&&(this.addPoint(e,this.markers.length),this.mapsService)){let e=this.mapsService.getZoom(),t=this.mapsService.getBounds();this.bbox=(0,o.padBounds)(t,.5),this.zoom=Math.floor(e),this.getClusterMarker(this.bbox,this.zoom);}this.markers.push(e);}removeMarker(e){this.markers.indexOf(e);let t=this.markers.indexOf(e);t>-1&&(this.markers.splice(t,1),this.markerLayerOption.cluster&&(this.removePoint(t),this.mapsService&&this.getClusterMarker(this.bbox,this.zoom)));}hide(){this.markers.map(e=>{e.getElement().style.opacity="0";}),this.clusterMarkers.map(e=>{e.getElement().style.opacity="0";});}show(){this.markers.map(e=>{e.getElement().style.opacity="1";}),this.clusterMarkers.map(e=>{e.getElement().style.opacity="1";});}getMarkers(){return this.markerLayerOption.cluster?this.clusterMarkers:this.markers;}getOriginMarkers(){return this.markers;}addMarkers(){this.getMarkers().forEach(e=>{e.addTo(this.scene);});}clear(){this.markers.forEach(e=>{e.remove();}),this.clusterMarkers.forEach(e=>{e.remove();}),this.markers=[],this.points=[],this.clusterMarkers=[];}destroy(){this.clear(),this.removeAllListeners(),this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("camerachange",this.setContainerSize.bind(this)),this.mapsService.off("viewchange",this.setContainerSize.bind(this));}addPoint(e,t){let{lng:n,lat:r}=e.getLnglat(),a={geometry:{type:"Point",coordinates:[n,r]},properties:(0,i.default)((0,i.default)({},e.getExtData()),{},{marker_id:t})};this.points.push(a),this.clusterIndex&&this.clusterIndex.load(this.points);}removePoint(e){let t=this.points.findIndex(t=>t.properties.marker_id===e);t>-1&&this.points.splice(t,1),this.clusterIndex&&this.clusterIndex.load(this.points);}initCluster(){if(!this.markerLayerOption.cluster)return;let{radius:e,minZoom:t=0,maxZoom:n}=this.markerLayerOption.clusterOption;this.clusterIndex=new l.default({radius:e,minZoom:t,maxZoom:n}),this.clusterIndex.load(this.points);}getClusterMarker(e,t){let n=e[0].concat(e[1]),r=this.clusterIndex.getClusters(n,t);this.clusterMarkers.forEach(e=>{e.remove();}),this.clusterMarkers=[],r.forEach(e=>{var t,n;let{field:r,method:i}=this.markerLayerOption.clusterOption;if(null!==(t=e.properties)&&void 0!==t&&t.cluster_id){let t=this.getLeaves(null===(n=e.properties)||void 0===n?void 0:n.cluster_id);if(e.properties.clusterData=t,r&&i){let n=null==t?void 0:t.map(e=>({[r]:e.properties[r]})),a=o.Satistics.getColumn(n,r),s=o.Satistics.getSatByColumn(i,a),l="point_"+i;e.properties[l]=s.toFixed(2);}}let a=this.clusterMarker(e);this.clusterMarkers.push(a),a.addTo(this.scene);});}getLeaves(e,t=1/0,n=0){return e?this.clusterIndex.getLeaves(e,t,n):null;}clusterMarker(e){let{element:t=this.generateElement.bind(this)}=this.markerLayerOption.clusterOption;return new u.default({element:t(e)}).setLnglat({lng:e.geometry.coordinates[0],lat:e.geometry.coordinates[1]});}normalMarker(e){let t=e.properties.marker_id;return this.markers[t];}update(){if(!this.mapsService||0===this.markers.length)return;let e=this.mapsService.getZoom(),t=this.mapsService.getBounds();(!this.bbox||Math.abs(e-this.zoom)>=1||!(0,o.boundsContains)(this.bbox,t))&&(this.bbox=(0,o.padBounds)(t,.5),this.zoom=Math.floor(e),this.getClusterMarker(this.bbox,this.zoom));}generateElement(e){let t=o.DOM.create("div","l7-marker-cluster"),n=o.DOM.create("div","",t),r=o.DOM.create("span","",n),{field:i,method:a}=this.markerLayerOption.clusterOption;e.properties.point_count=e.properties.point_count||1;let s=i&&a?e.properties["point_"+a]||e.properties[i]:e.properties.point_count;return r.textContent=s,t;}}},f0dd048d:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return d;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("daaa1548")),o=r._(n("d812e418")),s=n("d9b661b3"),l=n("fb1ec05a"),u=r._(n("755bc4f8")),c=n("f717bab4");class d extends u.default{constructor(...e){super(...e),(0,o.default)(this,"texture1",void 0),(0,o.default)(this,"texture2",void 0),(0,o.default)(this,"texture3",void 0);}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9});}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,a.default)((0,a.default)({},e.uniformsOption),t.uniformsOption);}getCommonUniformsInfo(){let{watercolor:e="#6D99A8",watercolor2:t="#0F121C"}=this.layer.getLayerConfig(),n={u_watercolor:(0,l.rgb2arr)(e),u_watercolor2:(0,l.rgb2arr)(t),u_time:this.layer.getLayerAnimateTime(),u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3};return this.textures=[this.texture1,this.texture2,this.texture3],this.getUniformsBufferInfo(n);}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()};}initModels(){var e=this;return(0,i.default)(function*(){return e.loadTexture(),e.buildModels();})();}buildModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;\n\nlayout(std140) uniform commonUniforms {\n  vec4 u_watercolor;\n  vec4 u_watercolor2;\n  float u_time;\n};\n\nout vec2 v_uv;\nout float v_opacity;\n\n#pragma include "projection"\n\nvoid main() {\n  v_uv = a_uv;\n  v_opacity = opacity;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n}\n\n',fragmentShader:"\nlayout(std140) uniform commonUniforms {\n  vec4 u_watercolor;\n  vec4 u_watercolor2;\n  float u_time;\n};\n\nin vec2 v_uv;\nin float v_opacity;\nout vec4 outputColor;\n\nfloat coast2water_fadedepth = 0.10;\nfloat large_waveheight      = .750; // change to adjust the \"heavy\" waves\nfloat large_wavesize        = 3.4;  // factor to adjust the large wave size\nfloat small_waveheight      = 0.6;  // change to adjust the small random waves\nfloat small_wavesize        = 0.5;   // factor to ajust the small wave size\nfloat water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)\nfloat water_glossylight_fact= 120.; // range [1..200]\nfloat particle_amount       = 70.;\n\nvec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights\n#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun\n\nuniform sampler2D u_texture1;\nuniform sampler2D u_texture2;\nuniform sampler2D u_texture3;\n\n  \n\nfloat hash( float n ) {\n    return fract(sin(n)*43758.5453123);\n}\n\n// 2d noise function\nfloat noise1( in vec2 x ) {\n  vec2 p  = floor(x);\n  vec2 f  = smoothstep(0.0, 1.0, fract(x));\n  float n = p.x + p.y*57.0;\n  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),\n    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);\n}\n\nfloat noise(vec2 p) {\n    return texture(SAMPLER_2D(u_texture2),p*vec2(1./256.)).x;\n}\n\nvec4 highness(vec2 p) {\n    vec4 t = texture(SAMPLER_2D(u_texture1),fract(p));\n    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;\n    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);\n}\n\nfloat height_map( vec2 p ) {\n    vec4 height=highness(p);\n    /*\n    height = -0.5+\n        0.5*smoothstep(-100.,0.,-height)+\n        2.75*smoothstep(0.,2.,height)+\n        1.75*smoothstep(2.,4.,height)+\n        2.75*smoothstep(4.,16.,height)+\n        1.5*smoothstep(16.,1000.,height);\n    */\n\n    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );\n    //p = p*6.;\n    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;\n    f += 0.2500*noise( p ); p = m*p*1.32;\n    f += 0.1666*noise( p ); p = m*p*1.11;\n    f += 0.0834*noise( p ); p = m*p*1.12;\n    f += 0.0634*noise( p ); p = m*p*1.13;\n    f += 0.0444*noise( p ); p = m*p*1.14;\n    f += 0.0274*noise( p ); p = m*p*1.15;\n    f += 0.0134*noise( p ); p = m*p*1.16;\n    f += 0.0104*noise( p ); p = m*p*1.17;\n    f += 0.0084*noise( p );\n    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;\n        const float FLAT_LEVEL = 0.92525;\n        //f = f*0.25+height*0.75;\n    if (f<FLAT_LEVEL)\n        f = f;\n    else\n        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase\n    return clamp(f, 0., 10.);\n}\n\nvec3 plasma_quintic( float x ) {\n    x = clamp( x, 0.0, 1.0);\n    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3\n    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7\n    return vec3(\n        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),\n        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),\n        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );\n}\n\nvec4 color(vec2 p){\n    vec4 c1 = vec4(1.7,1.6,.9,1);\n    vec4 c2 = vec4(.2,.94,.1,1);\n    vec4 c3 = vec4(.3,.2,.0,1);\n    vec4 c4 = vec4(.99,.99,1.6,1);\n    vec4 v = highness(p);\n    float los = smoothstep(0.1,1.1,v.b);\n    float his = smoothstep(3.5,6.5,v.b);\n    float ces = smoothstep(1.,5.,v.a);\n    vec4 lo = mix(c1,c2,los);\n    vec4 hi = mix(c3,c4,his);\n    vec4 ce = mix(lo,hi,ces);\n\n    return vec4(plasma_quintic(ces),1).ragb;\n}\n\nvec3 terrain_map( vec2 p )\n{\n  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture(SAMPLER_2D(u_texture3), fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'\n}\n\nconst mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );\n\nfloat water_map( vec2 p, float height ) {\n    vec2 p2 = p*large_wavesize;\n    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );\n    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );\n\n    // coarse crossing 'ocean' waves...\n    float f = 0.6000*noise( p );\n    f += 0.2500*noise( p*m );\n    f += 0.1666*noise( p*m*m );\n    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;\n\n    p *= small_wavesize;\n    f = 0.;\n    float amp = 1.0, s = .5;\n    for (int i=0; i<9; i++)\n    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }\n    \n    return wave+f*small_waveheight;\n}\n\nfloat nautic(vec2 p) {\n    p *= 18.;\n    float f = 0.;\n    float amp = 1.0, s = .5;\n    for (int i=0; i<3; i++)\n    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }\n    return pow(1.-f, 5.);\n}\n\nfloat particles(vec2 p) {\n    p *= 200.;\n    float f = 0.;\n    float amp = 1.0, s = 1.5;\n    for (int i=0; i<3; i++)\n    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }\n    return pow(f*.35, 7.)*particle_amount;\n}\n\nfloat test_shadow( vec2 xy, float height) {\n    vec3 r0 = vec3(xy, height);\n    vec3 rd = normalize( light - r0 );\n    \n    float hit = 1.0;\n    float t   = 0.001;\n    for (int j=1; j<25; j++)\n    {\n        vec3 p = r0 + t*rd;\n        float h = height_map( p.xy );\n        float height_diff = p.z - h;\n        if (height_diff<0.0)\n        {\n            return 0.0;\n        }\n        t += 0.01+height_diff*.02;\n        hit = min(hit, 2.*height_diff/t); // soft shaddow   \n    }\n    return hit;\n}\n\nvec3 CalcTerrain(vec2 uv, float height) {\n    vec3 col = terrain_map( uv );\n    vec2 iResolution = vec2(512.);\n    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);\n    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);\n    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);\n    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);\n    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));\n    vec3 r0 = vec3(uv, height);\n    vec3 rd = normalize( light - r0 );\n    float grad = dot(norm, rd);\n    col *= grad+pow(grad, 8.);\n    float terrainshade = test_shadow( uv, height );\n    col = mix(col*.25, col, terrainshade);\n    return col;\n}\n\n\nvoid main() {\n  vec3 watercolor = u_watercolor.rgb;\n  vec3 watercolor2 = u_watercolor2.rgb;\n  vec2 uv = v_uv;\n  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)\n  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;\n  float height = height_map( uv );\n  vec3 col;\n\n    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);\n    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);\n    if (height > level)\n    {\n        col = CalcTerrain(uv, height);\n    }\n    if (height <= level)\n    {\n        vec2 dif = vec2(.0, .01);\n        vec2 pos = uv*15. + vec2(u_time*.01);\n        float h1 = water_map(pos-dif,waveheight);\n        float h2 = water_map(pos+dif,waveheight);\n        float h3 = water_map(pos-dif.yx,waveheight);\n        float h4 = water_map(pos+dif.yx,waveheight);\n        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane\n        uv += normwater.xy*.002*(level-height);\n        \n        col = CalcTerrain(uv, height);\n\n        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);\n        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);\n        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;\n        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));\n\n        vec3 r0 = vec3(uv, WATER_LEVEL);\n        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position\n        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction\n        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          \n        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights\n        float gradpos  = dot(vec3(0., 0., 1.), rd);\n        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          \n        float watershade  = test_shadow( uv, level );\n        watercolor *= 2.2+watershade;\n        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;\n        watercolor /= (1.+specular1*1.25);\n        watercolor += watershade*specular2*water_specularcolor;\n        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));\n        \n        col = mix(col, watercolor, coastfade);\n    }\n    \n  outputColor = vec4(col, v_opacity);  \n}\n",defines:e.getDefines(),inject:e.getInject(),triangulation:c.polygonTriangulation,primitive:s.gl.TRIANGLES,depth:{enable:!1}}))];})();}clearModels(){var e,t,n;null===(e=this.texture1)||void 0===e||e.destroy(),null===(t=this.texture2)||void 0===t||t.destroy(),null===(n=this.texture3)||void 0===n||n.destroy();}registerBuiltinAttributes(){let[e,t,n,r]=this.layer.getSource().extent,i=n-e,a=r-t;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:s.AttributeType.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:s.gl.STATIC_DRAW,data:[],type:s.gl.FLOAT},size:2,update:(n,r,o)=>{let[s,l]=o;return[(s-e)/i,(l-t)/a];}}});}loadTexture(){let{createTexture2D:e}=this.rendererService,t={height:0,width:0};function n(t){return e({data:t,width:t.width,height:t.height,wrapS:s.gl.MIRRORED_REPEAT,wrapT:s.gl.MIRRORED_REPEAT,min:s.gl.LINEAR,mag:s.gl.LINEAR});}this.texture1=e(t),this.texture2=e(t),this.texture3=e(t),function(e){let t=0,n=[];["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"].map(r=>{let i=new Image;i.crossOrigin="",i.src=r,n.push(i),i.onload=()=>{3==++t&&e(n);};});}(e=>{this.texture1=n(e[0]),this.texture2=n(e[1]),this.texture3=n(e[2]),this.layerService.reRender();});}}},f10a19cc:function(e,t,n){var r=n("1f86664c"),i=n("c4fc35e5");e.exports=function(e,t){t=r(t,e);for(var n=0,a=t.length;null!=e&&n<a;)e=e[i(t[n++])];return n&&n==a?e:void 0;};},f16c44d2:function(e,t,n){var r=n("3e5a5661");e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length);};},f1ed3b6a:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=r._(n("4ce96d25")),s=r._(n("bd36140e"));class l extends o.default{constructor(...e){super(...e),(0,a.default)(this,"type","PointLayer"),(0,a.default)(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","rotation"]),(0,a.default)(this,"enableDataEncodeStyles",["textOffset","textAnchor"]),(0,a.default)(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}});}buildModels(){var e=this;return(0,i.default)(function*(){let t=e.getModelType();e.layerModel&&e.layerModel.clearModels(),e.layerModel=new s.default[t](e),yield e.initLayerModels();})();}rebuildModels(){var e=this;return(0,i.default)(function*(){yield e.buildModels();})();}getModelTypeWillEmptyData(){if(this.shapeOption){let{field:e,values:t}=this.shapeOption,{shape2d:n}=this.getLayerConfig(),r=this.iconService.getIconMap();if(e&&(null==n?void 0:n.indexOf(e))!==-1)return"fill";if("text"===t)return"text";if(t&&t instanceof Array){for(let e of t)if("string"==typeof e&&r.hasOwnProperty(e))return"image";}}return"normal";}getDefaultConfig(){return({fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}})[this.getModelType()];}getModelType(){let e=this.getEncodedData(),{shape2d:t,shape3d:n,billboard:r=!0}=this.getLayerConfig(),i=this.iconService.getIconMap(),a=e.find(e=>e.hasOwnProperty("shape"));if(!a)return this.getModelTypeWillEmptyData();{let e=a.shape;return"dot"===e?"normal":"simple"===e?"simplePoint":"radar"===e?"radar":"fillImage"===this.layerType||!1===r?"fillImage":(null==t?void 0:t.indexOf(e))!==-1?"GLOBEL"===this.mapService.version?"earthFill":"fill":(null==n?void 0:n.indexOf(e))!==-1?"GLOBEL"===this.mapService.version?"earthExtrude":"extrude":i.hasOwnProperty(e)?"image":"text";}}}},f200d4d8:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return s;}});let r=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],i=(()=>{if("undefined"==typeof document)return!1;let e=r[0],t={};for(let n of r)if((null==n?void 0:n[1])in document){for(let[r,i]of n.entries())t[e[r]]=i;return t;}return!1;})(),a={change:i.fullscreenchange,error:i.fullscreenerror},o={request:(e=document.documentElement,t)=>new Promise((n,r)=>{let a=()=>{o.off("change",a),n();};o.on("change",a);let s=e[i.requestFullscreen](t);s instanceof Promise&&s.then(a).catch(r);}),exit:()=>new Promise((e,t)=>{if(!o.isFullscreen){e();return;}let n=()=>{o.off("change",n),e();};o.on("change",n);let r=document[i.exitFullscreen]();r instanceof Promise&&r.then(n).catch(t);}),toggle:(e,t)=>o.isFullscreen?o.exit():o.request(e,t),onchange(e){o.on("change",e);},onerror(e){o.on("error",e);},on(e,t){let n=a[e];n&&document.addEventListener(n,t,!1);},off(e,t){let n=a[e];n&&document.removeEventListener(n,t,!1);},raw:i};Object.defineProperties(o,{isFullscreen:{get:()=>!!document[i.fullscreenElement]},element:{enumerable:!0,get:()=>{var e;return null!==(e=document[i.fullscreenElement])&&void 0!==e?e:void 0;}},isEnabled:{enumerable:!0,get:()=>!!document[i.fullscreenEnabled]}}),i||(o={isEnabled:!1});var s=o;},f24cd761:function(e,t,n){e.exports=function(e,t){return e<t;};},f28dfa76:function(e,t,n){e.exports=function(e){return null!=e&&"object"==typeof e;};},f2e70cc2:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return c;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=n("d9b661b3"),s=n("fb1ec05a"),l=r._(n("755bc4f8")),u=n("f717bab4");class c extends l.default{constructor(...e){super(...e),(0,a.default)(this,"texture",void 0),(0,a.default)(this,"updateTexture",()=>{let{createTexture2D:e}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return;}this.texture=e({data:this.iconService.getCanvas(),mag:o.gl.NEAREST,min:o.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture];});}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:12,UV:13,DISTANCE_MITER_TOTAL:15});}getCommonUniformsInfo(){let{sourceColor:e,targetColor:t,textureBlend:n="normal",heightfixed:r=!1,lineTexture:i=!1,iconStep:a=100,iconStepCount:o=1}=this.layer.getLayerConfig(),{animateOption:l}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var u;null===(u=this.texture)||void 0===u||u.bind();}let c=0,d=[0,0,0,0],f=[0,0,0,0];e&&t&&(d=(0,s.rgb2arr)(e),f=(0,s.rgb2arr)(t),c=1);let h={u_animate:this.animateOption2Array(l),u_sourceColor:d,u_targetColor:f,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:a,u_heightfixed:Number(r),u_linearColor:c,u_line_texture:i?1:0,u_textureBlend:"normal"===n?0:1,u_iconStepCount:o,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(h);}initModels(){var e=this;return(0,i.default)(function*(){return e.initUniformsBuffer(),e.updateTexture(),e.iconService.on("imageUpdate",e.updateTexture),e.buildModels();})();}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture);}buildModels(){var e=this;return(0,i.default)(function*(){return[(yield e.layer.buildLayerModel({moduleName:"lineWall",vertexShader:'#define Animate 0.0\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;\nlayout(location = ATTRIBUTE_LOCATION_DISTANCE_MITER_TOTAL) in vec3 a_Distance_Total_Miter;\n\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float u_icon_step: 100;\n  float u_heightfixed;\n  float u_linearColor: 0;\n  float u_line_texture;\n  float u_textureBlend;\n  float u_iconStepCount;\n  float u_time;\n};\n\n// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09\nout vec2 v_iconMapUV;\nout vec4 v_color;\nout float v_blur;\nout vec4 v_dataset;\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  float a_Distance = a_Distance_Total_Miter.x;\n  float a_Miter = a_Distance_Total_Miter.y;\n  float a_Total_Distance = a_Distance_Total_Miter.z;\n\n  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B\n  float d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E\n\n  v_iconMapUV = a_iconMapUV;\n  if (u_heightfixed < 1.0) {\n    // \u9AD8\u5EA6\u968F zoom \u8C03\u6574\n    d_texPixelLen = project_pixel(u_icon_step);\n  } else {\n    d_texPixelLen = u_icon_step;\n  }\n\n  if (u_animate.x == Animate || u_linearColor == 1.0) {\n    d_distance_ratio = a_Distance / a_Total_Distance;\n  }\n\n  float miter = (a_Miter + 1.0) / 2.0;\n  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570\n  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B\n  v_dataset[1] = a_Distance; // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB\n  v_dataset[2] = d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E\n  v_dataset[3] = miter; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);\n\n  float originSize = a_Size.x; // \u56FA\u5B9A\u9AD8\u5EA6\n  if (u_heightfixed < 1.0) {\n    originSize = project_float_meter(a_Size.x); // \u9AD8\u5EA6\u968F zoom \u8C03\u6574\n  }\n\n  float wallHeight = originSize * miter;\n  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));\n\n  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);\n  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);\n\n  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4\n  if (\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n  ) {\n    // mapbox\n    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8\n    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);\n    if (u_heightfixed > 0.0) {\n      wallHeight *= mapboxZoomScale;\n    }\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'#define Animate 0.0\n#define LineTexture 1.0\n\n// line texture\n\nuniform sampler2D u_texture;\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float u_icon_step: 100;\n  float u_heightfixed;\n  float u_linearColor: 0;\n  float u_line_texture;\n  float u_textureBlend;\n  float u_iconStepCount;\n  float u_time;\n};\n\n\nin vec2 v_iconMapUV;\nin vec4 v_color;\nin float v_blur;\nin vec4 v_dataset;\n\nout vec4 outputColor;\n\n#pragma include "picking"\n\nvoid main() {\n  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6\n  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B\n  float v = v_dataset.a;\n\n  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272\n    outputColor = mix(u_sourceColor, u_targetColor, v);\n  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272\n     outputColor = v_color;\n  }\n\n  outputColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6\n  if(u_animate.x == Animate) {\n      animateSpeed = u_time / u_animate.y;\n       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);\n      alpha = (alpha + u_animate.w -1.0) / u_animate.w;\n      alpha = smoothstep(0., 1., alpha);\n      outputColor.a *= alpha;\n  }\n\n  if(u_line_texture == LineTexture) { // while load texture\n    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB\n    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E\n    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);\n    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C\n\n    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start\n    float flag = 0.0;\n    if(u > 1.0/u_iconStepCount) {\n      flag = 1.0;\n    }\n    u = fract(u*u_iconStepCount);\n    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end\n\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);\n\n    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694\n    if(flag > 0.0) {\n      pattern = vec4(0.0);\n    }\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      outputColor = filterColor(outputColor + pattern);\n    } else { // replace\n        pattern.a *= v_color.a;\n        if(outputColor.a <= 0.0) {\n          pattern.a = 0.0;\n        }\n        outputColor = filterColor(pattern);\n    }\n  }\n\n\n  // blur - AA\n  if(v < v_blur) {\n    outputColor.a = mix(0.0, outputColor.a, v/v_blur);\n  } else if(v > 1.0 - v_blur) {\n    outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);\n  }\n\n  outputColor = filterColor(outputColor);\n}\n',triangulation:u.LineTriangulation,defines:e.getDefines(),inject:e.getInject(),depth:{enable:!1},blend:e.getBlend()}))];})();}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:o.AttributeType.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:2,update:e=>{let{size:t=1}=e;return Array.isArray(t)?[t[0],t[1]]:[t,0];}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:o.AttributeType.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:o.gl.STATIC_DRAW,data:[],type:o.gl.FLOAT},size:3,update:(e,t,n,r,i)=>i}}),this.styleAttributeService.registerStyleAttribute({name:"distanceAndTotalAndMiter",type:o.AttributeType.Attribute,descriptor:{name:"a_Distance_Total_Miter",shaderLocation:this.attributeLocation.DISTANCE_MITER_TOTAL,buffer:{usage:o.gl.STATIC_DRAW,data:[],type:o.gl.FLOAT},size:3,update:(e,t,n)=>[n[3],n[4],n[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:o.AttributeType.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:o.gl.DYNAMIC_DRAW,data:[],type:o.gl.FLOAT},size:2,update:e=>{let t=this.iconService.getIconMap(),{texture:n}=e,{x:r,y:i}=t[n]||{x:0,y:0};return[r,i];}}});}}},f3125f72:function(e,t,n){var r=n("ef666486"),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():i.call(t,n,1),--this.size,!0);};},f3e186ab:function(e,t,n){var r=function(e,t){return e-t;};!function(){function e(e){void 0===e&&(e=r),this.compareFn=e,this.list=[];}e.prototype.getLeft=function(e){return 2*e+1;},e.prototype.getRight=function(e){return 2*e+2;},e.prototype.getParent=function(e){return 0===e?null:Math.floor((e-1)/2);},e.prototype.isEmpty=function(){return this.list.length<=0;},e.prototype.top=function(){return this.isEmpty()?void 0:this.list[0];},e.prototype.delMin=function(){var e=this.top(),t=this.list.pop();return this.list.length>0&&(this.list[0]=t,this.moveDown(0)),e;},e.prototype.insert=function(e){if(null!==e){this.list.push(e);var t=this.list.length-1;return this.moveUp(t),!0;}return!1;},e.prototype.moveUp=function(e){for(var t=this.getParent(e);e&&e>0&&this.compareFn(this.list[t],this.list[e])>0;){var n=this.list[t];this.list[t]=this.list[e],this.list[e]=n,e=t,t=this.getParent(e);}},e.prototype.moveDown=function(e){var t,n=e,r=this.getLeft(e),i=this.getRight(e),a=this.list.length;null!==r&&r<a&&this.compareFn(this.list[n],this.list[r])>0?n=r:null!==i&&i<a&&this.compareFn(this.list[n],this.list[i])>0&&(n=i),e!==n&&(t=[this.list[n],this.list[e]],this.list[e]=t[0],this.list[n]=t[1],this.moveDown(n));};}();},f3f72fb5:function(e,t,n){var r=n("d26a46d3"),i=n("3f78af0a"),a=n("df7a0006");e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var o=n.__data__;if(!i||o.length<199)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new a(o);}return n.set(e,t),this.size=n.size,this;};},f42269e5:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"HeatmapLayer",{enumerable:!0,get:function(){return a;}});var r=n("c1f97feb"),i=n("6deff457");class a extends i.CoreLayer{constructor(){super(...arguments),this.type="heatmapLayer";}createLayer(){let e=this.getLayerConfig();return new r.HeatmapLayer(e);}}},f5394e0b:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{AbstractMatrix:function(){return i;},CHO:function(){return a;},CholeskyDecomposition:function(){return o;},DistanceMatrix:function(){return s;},EVD:function(){return l;},EigenvalueDecomposition:function(){return u;},LU:function(){return c;},LuDecomposition:function(){return d;},Matrix:function(){return f;},MatrixColumnSelectionView:function(){return h;},MatrixColumnView:function(){return p;},MatrixFlipColumnView:function(){return v;},MatrixFlipRowView:function(){return g;},MatrixRowSelectionView:function(){return m;},MatrixRowView:function(){return y;},MatrixSelectionView:function(){return b;},MatrixSubView:function(){return _;},MatrixTransposeView:function(){return x;},NIPALS:function(){return w;},Nipals:function(){return E;},QR:function(){return M;},QrDecomposition:function(){return S;},SVD:function(){return k;},SingularValueDecomposition:function(){return C;},SymmetricMatrix:function(){return A;},WrapperMatrix1D:function(){return L;},WrapperMatrix2D:function(){return P;},correlation:function(){return N;},covariance:function(){return O;},determinant:function(){return I;},inverse:function(){return R;},linearDependencies:function(){return D;},pseudoInverse:function(){return z;},solve:function(){return B;},wrap:function(){return U;}});var r=n("852bbaa9")._(n("924d5fcb"));let i=r.AbstractMatrix,a=r.CHO,o=r.CholeskyDecomposition,s=r.DistanceMatrix,l=r.EVD,u=r.EigenvalueDecomposition,c=r.LU,d=r.LuDecomposition,f=r.Matrix,h=r.MatrixColumnSelectionView,p=r.MatrixColumnView,v=r.MatrixFlipColumnView,g=r.MatrixFlipRowView,m=r.MatrixRowSelectionView,y=r.MatrixRowView,b=r.MatrixSelectionView,_=r.MatrixSubView,x=r.MatrixTransposeView,w=r.NIPALS,E=r.Nipals,M=r.QR,S=r.QrDecomposition,k=r.SVD,C=r.SingularValueDecomposition,A=r.SymmetricMatrix,L=r.WrapperMatrix1D,P=r.WrapperMatrix2D,N=r.correlation,O=r.covariance,I=r.determinant,R=r.inverse,D=r.linearDependencies,z=r.pseudoInverse,B=r.solve,U=r.wrap;},f6062608:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"getTotalLength",{enumerable:!0,get:function(){return a;}});var r=n("b594a703"),i=n("1d595a1a");function a(e,t){return(0,i.pathLengthFactory)(e,void 0,(0,r.__assign)((0,r.__assign)({},t),{bbox:!1,length:!0})).length;}},f66919d9:function(e,t,n){var r=n("ed2bf8a3"),i=n("3036e156");e.exports={write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:r.map(e.nodes(),function(t){var n=e.node(t),i=e.parent(t),a={v:t};return r.isUndefined(n)||(a.value=n),r.isUndefined(i)||(a.parent=i),a;}),edges:r.map(e.edges(),function(t){var n=e.edge(t),i={v:t.v,w:t.w};return r.isUndefined(t.name)||(i.name=t.name),r.isUndefined(n)||(i.value=n),i;})};return r.isUndefined(e.graph())||(t.value=r.clone(e.graph())),t;},read:function(e){var t=new i(e.options).setGraph(e.value);return r.each(e.nodes,function(e){t.setNode(e.v,e.value),e.parent&&t.setParent(e.v,e.parent);}),r.each(e.edges,function(e){t.setEdge({v:e.v,w:e.w,name:e.name},e.value);}),t;}};},f717bab4:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{GlobelPointFillTriangulation:function(){return p;},HeatmapGridTriangulation:function(){return M;},HeatmapTriangulation:function(){return C;},LineArcTriangulation:function(){return k;},LineTriangulation:function(){return m;},PointExtrudeTriangulation:function(){return v;},PointFillTriangulation:function(){return h;},PointImageTriangulation:function(){return g;},PolygonExtrudeTriangulation:function(){return E;},RasterImageTriangulation:function(){return S;},SimpleLineTriangulation:function(){return y;},earthOuterTriangulation:function(){return P;},earthTriangulation:function(){return L;},polygonTriangulation:function(){return x;},polygonTriangulationWithCenter:function(){return w;}});var r=n("777fffbe"),i=n("852bbaa9"),a=n("fb1ec05a"),o=r._(n("20d317f9")),s=n("6c357209"),l=r._(n("5bf0d2ef")),u=n("6c69325d"),c=i._(n("b6c9e4f0")),d=n("36c59252");let f={};function h(e){let t=(0,a.calculateCentroid)(e.coordinates);return{vertices:[...t,...t,...t,...t],indices:[0,1,2,2,3,0],size:t.length};}function p(e){let t=(0,a.calculateCentroid)(e.coordinates),n=(0,s.lglt2xyz)(t);return{vertices:[...n,...n,...n,...n],indices:[0,1,2,2,3,0],size:n.length};}function v(e){let{shape:t}=e,{positions:n,index:r,normals:i}=function(e,t=!1){if(f&&f[e])return f[e];let n=u.geometryShape[e]?u.geometryShape[e]():u.geometryShape.cylinder(),r=(0,c.extrude_PolygonNormal)([n],t);return f[e]=r,r;}(t,!1);return{vertices:n,indices:r,normals:i,size:5};}function g(e){let t=(0,a.calculateCentroid)(e.coordinates);return{vertices:[...t],indices:[0],size:t.length};}function m(e){let{coordinates:t}=e,n=new l.default({dash:!0,join:"bevel"}),r=t;r[0]&&!Array.isArray(r[0][0])&&(r=[t]),r.forEach(e=>{n.extrude(e);});let i=n.complex;return{vertices:i.positions,indices:i.indices,normals:i.normals,indexes:i.indexes,size:6};}function y(e){let{coordinates:t}=e,n=[];if(!Array.isArray(t[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};let{results:r,totalDistance:i}=function(e){let t=e;Array.isArray(t)&&Array.isArray(t[0])&&Array.isArray(t[0][0])&&(t=e.flat());let n=0;if(t.length<2)return{results:t,totalDistance:0};{let e=[],r=_(t[0],n);e.push(r);for(let r=1;r<t.length-1;r++){n+=b((0,a.aProjectFlat)(t[r-1]),(0,a.aProjectFlat)(t[r]));let i=_(t[r],n);e.push(i),e.push(i);}return n+=b((0,a.aProjectFlat)(t[t.length-2]),(0,a.aProjectFlat)(t[t.length-1])),e.push(_(t[t.length-1],n)),{results:e,totalDistance:n};}}(t);return r.map(e=>{n.push(e[0],e[1],e[2],e[3],0,i);}),{vertices:n,indices:[],normals:[],size:6,count:r.length};}function b(e,t){let n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r);}function _(e,t){return e.length<3&&e.push(0),void 0!==t&&e.push(t),e;}function x(e){let{coordinates:t}=e,{vertices:n,dimensions:r,holes:i}=o.default.flatten(t);return{indices:(0,d.getPolygonSurfaceIndices)(n,i,r),vertices:n,size:r};}function w(e){let{indices:t,vertices:n,size:r}=x(e);return{indices:t,vertices:function(e){let t=[],{center:n,radius:r}=(0,a.calculatePointsCenterAndRadius)(e);for(let i=0;i<e.length;i+=2){let a=e[i],o=e[i+1];t.push(a,o,0,...n,r);}return t;}(n),size:r+4};}function E(e){let t=e.coordinates,{positions:n,index:r,normals:i}=(0,c.extrude_PolygonNormal)(t,!0);return{vertices:n,indices:r,normals:i,size:5};}function M(e){let{shape:t}=e,{positions:n,index:r}=function(e){let t=u.geometryShape[e]?u.geometryShape[e]():u.geometryShape.circle();return -1===["cylinder","triangleColumn","hexagonColumn","squareColumn"].indexOf(e)?(0,c.fillPolygon)([t]):(0,c.default)([t]);}(t);return{vertices:n,indices:r,size:3};}function S(e){let t=e.coordinates;return{vertices:[...t[0],0,0,0,...t[1],0,1,0,...t[2],0,1,1,...t[3],0,0,1],indices:[0,1,2,0,2,3],size:5};}function k(e,t){let{segmentNumber:n=30}=t,r=e.coordinates,i=[],a=[];for(let e=0;e<n;e++)i.push(e,1,e,r[0][0],r[0][1],r[1][0],r[1][1],e,-1,e,r[0][0],r[0][1],r[1][0],r[1][1]),e!==n-1&&a.push(...[0,1,2,1,3,2].map(t=>2*e+t));return{vertices:i,indices:a,size:7};}function C(e){let t=e.coordinates;2===t.length&&t.push(0);let n=A(-1,1),r=A(1,1);return{vertices:[...t,...n,...t,...A(-1,-1),...t,...A(1,-1),...t,...r],indices:[0,1,2,3,0,2],size:5};}function A(e,t){return[(e+1)/2,(t+1)/2];}function L(){let{positionsArr:e,indicesArr:t,normalArr:n}=(0,s.primitiveSphere)(s.EARTH_RADIUS,{segments:s.EARTH_SEGMENTS});return{vertices:e,indices:t,size:5,normals:n};}function P(){let{positionsArr:e,indicesArr:t,normalArr:n}=(0,s.primitiveSphere)(s.EARTH_RADIUS+s.EARTH_RADIUS_OUTER,{segments:s.EARTH_SEGMENTS});return{vertices:e,indices:t,size:5,normals:n};}},f7b704ff:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0});var r,i,a=n("777fffbe"),o=a._(n("1316cf9d")),s=a._(n("3d495adb")),l=n("81e755b2"),u=function(){function e(t,n){(0,o.default)(this,e),this.addedNodes=[],this.attributeName=null,this.attributeNamespace=null,this.nextSibling=null,this.oldValue=null,this.previousSibling=null,this.removedNodes=[],this.type=t,this.target=n;}return(0,s.default)(e,null,[{key:"copy",value:function(t){var n=new e(t.type,t.target);return n.addedNodes=t.addedNodes.slice(),n.removedNodes=t.removedNodes.slice(),n.previousSibling=t.previousSibling,n.nextSibling=t.nextSibling,n.attributeName=t.attributeName,n.attributeNamespace=t.attributeNamespace,n.oldValue=t.oldValue,n;}}]);}(),c=new WeakMap;function d(e,t){for(var n=e;n;n=n.parentNode){var r=c.get(n);if(r)for(var i=0;i<r.length;i++){var a=r[i],o=a.options;if(n===e||o.subtree){var s=t(o);s&&a.enqueue(s);}}}}(0,s.default)(function e(t,n,r){(0,o.default)(this,e),this.transientObservedNodes=[],this.observer=t,this.target=n,this.options=r;},[{key:"enqueue",value:function(e){var t,n=this.observer.records,a=n.length;if(n.length>0){var o,s=(o=n[a-1],o===e?o:i&&(o===i||o===r)?i:null);if(s){n[a-1]=s;return;}}else t=this.observer,h.push(t),f||(f=!0,void 0!==l.runtime.globalThis?l.runtime.globalThis.setTimeout(p):p());n[a]=e;}},{key:"addListeners",value:function(){this.addListeners_(this.target);}},{key:"addListeners_",value:function(e){var t=this.options;t.attributes&&e.addEventListener(l.ElementEvent.ATTR_MODIFIED,this,!0),t.childList&&e.addEventListener(l.ElementEvent.INSERTED,this,!0),(t.childList||t.subtree)&&e.addEventListener(l.ElementEvent.REMOVED,this,!0);}},{key:"removeListeners",value:function(){this.removeListeners_(this.target);}},{key:"removeListeners_",value:function(e){var t=this.options;t.attributes&&e.removeEventListener(l.ElementEvent.ATTR_MODIFIED,this,!0),t.childList&&e.removeEventListener(l.ElementEvent.INSERTED,this,!0),(t.childList||t.subtree)&&e.removeEventListener(l.ElementEvent.REMOVED,this,!0);}},{key:"removeTransientObservers",value:function(){var e=this.transientObservedNodes;this.transientObservedNodes=[],e.forEach(function(e){this.removeListeners_(e);for(var t=c.get(e),n=0;n<t.length;n++)if(t[n]===this){t.splice(n,1);break;}},this);}},{key:"handleEvent",value:function(e){switch(e.stopImmediatePropagation(),e.type){case l.ElementEvent.ATTR_MODIFIED:var t=e.attrName,n=e.relatedNode.namespaceURI;(o=r=new u("attributes",s=e.target)).attributeName=t,o.attributeNamespace=n;var a=e.attrChange===l.MutationEvent.ADDITION?null:e.prevValue;d(s,function(e){if(e.attributes&&(!e.attributeFilter||!e.attributeFilter.length||-1!==e.attributeFilter.indexOf(t)||-1!==e.attributeFilter.indexOf(n)))return e.attributeOldValue?(i||((i=u.copy(r)).oldValue=a),i):o;});break;case l.ElementEvent.REMOVED:case l.ElementEvent.INSERTED:s=e.relatedNode;var o,s,c,f,h=e.target;e.type===l.ElementEvent.INSERTED?(c=[h],f=[]):(c=[],f=[h]);var p=h.previousSibling,v=h.nextSibling;(o=r=new u("childList",s)).addedNodes=c,o.removedNodes=f,o.previousSibling=p,o.nextSibling=v,d(s,function(e){if(e.childList)return o;});}r=i=void 0;}}]);var f=!1,h=[];function p(){f=!1;var e=h;h=[],e.sort(function(e,t){return e.uid-t.uid;});var t=!1;e.forEach(function(e){var n=e.takeRecords();(function(e){e.nodes.forEach(function(t){var n=c.get(t);n&&n.forEach(function(t){t.observer===e&&t.removeTransientObservers();});});})(e),n.length&&(e.callback(n,e),t=!0);}),t&&p();}},f7dd79d0:function(e,t,n){var r=Object.prototype.hasOwnProperty;e.exports=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&r.call(e,"index")&&(n.index=e.index,n.input=e.input),n;};},f8218a40:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e,t){return e.has(t);};},f845928e:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0});var r=n("d1751d7c");r._(n("5f230a3e"),t),r._(n("f7b704ff"),t),r._(n("81e755b2"),t),r._(n("059e0d93"),t);},f86eb389:function(e,t,n){var r=n("c1797885"),i=n("8c5cea5d"),a=n("f16c44d2"),o=n("d7dbbb4d"),s=n("b9363c23"),l=n("2e6bd01b"),u=n("c0051812"),c=n("1cfebee7"),d=n("85163435"),f=n("d59953b5"),h=n("7c1db5f7"),p=n("3a2da975"),v=n("c31b66bd"),g=n("decf5ea9"),m=n("b9a6b588");e.exports=function(e,t,n,y,b,_,x){var w=g(e,n),E=g(t,n),M=x.get(E);if(M){r(e,n,M);return;}var S=_?_(w,E,n+"",e,t,x):void 0,k=void 0===S;if(k){var C=u(E),A=!C&&d(E),L=!C&&!A&&v(E);S=E,C||A||L?u(w)?S=w:c(w)?S=o(w):A?(k=!1,S=i(E,!0)):L?(k=!1,S=a(E,!0)):S=[]:p(E)||l(E)?(S=w,l(w)?S=m(w):(!h(w)||f(w))&&(S=s(E))):k=!1;}k&&(x.set(E,S),b(S,E,y,_,x),x.delete(E)),r(e,n,S);};},f8e0e235:function(e,t,n){"use strict";if(n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}}),!window)throw Error("TMap JSAPI can only be used in Browser.");var r,i=((r=i||{}).notload="notload",r.loading="loading",r.loaded="loaded",r.failed="failed",r);let a={key:"",version:"1.exp",libraries:[]},o={TMap:i.notload},s=[],l=e=>{if("function"==typeof e){if(o.TMap===i.loaded){e(window.TMap);return;}s.push(e);}};var u={load:e=>new Promise((t,n)=>{if(o.TMap===i.failed)n("");else if(o.TMap===i.notload){let{key:r,version:u,libraries:c}=e;if(!r){n("\u8BF7\u586B\u5199key");return;}a.key=r,a.version=u||a.version,a.libraries=c||a.libraries,o.TMap=i.loading,window._onTMapAPILoaded=e=>{if(delete window._onTMapAPILoaded,e)o.TMap=i.failed,n(e);else for(o.TMap=i.loaded;s.length;)s.splice(0,1)[0](window.TMap);};let d=document.createElement("script");d.type="text/javascript",d.async=!1,d.src="https://map.qq.com/api/gljs?callback=_onTMapAPILoaded&v="+a.version+"&key="+r+"&plugin="+a.libraries.join(","),d.onerror=e=>{o.TMap=i.failed,n(e);},(document.body||document.head).appendChild(d),l(t);}else if(o.TMap===i.loaded){if(e.key&&e.key!==a.key){n("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");return;}if(e.version&&e.version!==a.version){n("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");return;}l(t);}}),reset:()=>{delete window.TMap,o={TMap:i.notload};}};},f91bf332:function(e,t,n){var r=n("8ab1b7bd"),i=n("bf992847"),a=n("baa3a209");e.exports=function(e){return r(e,a,i);};},f945577b:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"TouchPanHandler",{enumerable:!0,get:function(){return s;}});var r=n("777fffbe"),i=r._(n("d812e418")),a=r._(n("be334174")),o=n("c4fa2186");class s{constructor(e,t){(0,i.default)(this,"_enabled",void 0),(0,i.default)(this,"_active",void 0),(0,i.default)(this,"_touches",void 0),(0,i.default)(this,"_clickTolerance",void 0),(0,i.default)(this,"_sum",void 0),(0,i.default)(this,"_map",void 0),this._clickTolerance=e.clickTolerance||1,this._map=t,this.reset();}reset(){this._active=!1,this._touches={},this._sum=new a.default(0,0);}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1;}touchstart(e,t,n){return this._calculateTransform(e,t,n);}touchmove(e,t,n){if(!(!this._active||n.length<this.minTouchs()))return e.preventDefault(),this._calculateTransform(e,t,n);}touchend(e,t,n){this._calculateTransform(e,t,n),this._active&&n.length<this.minTouchs()&&this.reset();}touchcancel(){this.reset();}_calculateTransform(e,t,n){n.length>0&&(this._active=!0);let r=(0,o.indexTouches)(n,t),i=new a.default(0,0),s=new a.default(0,0),l=0;for(let e in r){let t=r[e],n=this._touches[e];n&&(i._add(t),s._add(t.sub(n)),l++,r[e]=t);}if(this._touches=r,l<this.minTouchs()||!s.mag())return;let u=s.div(l);if(this._sum._add(u),!(this._sum.mag()<this._clickTolerance))return{around:i.div(l),panDelta:u};}enable(){this._enabled=!0;}disable(){this._enabled=!1,this.reset();}isEnabled(){return this._enabled;}isActive(){return this._active;}}},f9562c3c:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{bezier:function(){return d;},clamp:function(){return a;},defaultEasing:function(){return f;},degreesToRadians:function(){return v;},extend:function(){return u;},interpolates:function(){return i;},pick:function(){return c;},uniqueId:function(){return l;},warnOnce:function(){return p;},wrap:function(){return o;}});var r=n("777fffbe")._(n("812ed3a8"));let i={number:function(e,t,n){return e+n*(t-e);}};function a(e,t,n){return Math.min(n,Math.max(t,e));}function o(e,t,n){let r=n-t,i=((e-t)%r+r)%r+t;return i===t?n:i;}let s=1;function l(){return s++;}function u(e,...t){for(let n of t)for(let t in n)e[t]=n[t];return e;}function c(e,t){let n={};for(let r=0;r<t.length;r++){let i=t[r];i in e&&(n[i]=e[i]);}return n;}function d(e,t,n,i){let a=new r.default(e,t,n,i);return e=>a.solve(e);}let f=d(.25,.1,.25,1),h={};function p(e){h[e]||("undefined"!=typeof console&&console.warn(e),h[e]=!0);}function v(e){return e*Math.PI/180;}},f9a6a7aa:function(e,t,n){function r(){var e={};e._next=e._prev=e,this._sentinel=e;}function i(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev;}function a(e,t){if("_next"!==e&&"_prev"!==e)return t;}e.exports=r,r.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return i(t),t;},r.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&i(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t;},r.prototype.toString=function(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,a)),n=n._prev;return"["+e.join(", ")+"]";};},fa026405:function(e,t,n){var r=n("44862772"),i=n("13056af7"),a=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,o=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");e.exports=function(e){return(e=i(e))&&e.replace(a,r).replace(o,"");};},fa245667:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return o;}});var r=n("777fffbe"),i=r._(n("71f18948")),a=r._(n("10576492")),o=Object.keys?function(e){return Object.keys(e);}:function(e){var t=[];return(0,i.default)(e,function(n,r){(0,a.default)(e)&&"prototype"===r||t.push(r);}),t;};},fa52488c:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return u;}});var r=n("777fffbe"),i=r._(n("daaa1548")),a=r._(n("f89fb776")),o=r._(n("d812e418")),s=r._(n("4ce96d25")),l=r._(n("5fe55d01"));class u extends s.default{constructor(...e){super(...e),(0,o.default)(this,"type","LineLayer"),(0,o.default)(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","thetaOffset"]),(0,o.default)(this,"arrowInsertCount",0),(0,o.default)(this,"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}});}buildModels(){var e=this;return(0,a.default)(function*(){let t=e.getModelType();e.layerModel=new l.default[t](e),yield e.initLayerModels();})();}getDefaultConfig(){return({line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},earthArc3d:{},flowline:{},arrow:{}})[this.getModelType()];}getModelType(){var e;if(this.layerType)return this.layerType;let t=this.styleAttributeService.getLayerStyleAttribute("shape");return(null==t||null===(e=t.scale)||void 0===e?void 0:e.field)||"line";}processData(e){if("simple"!==this.getModelType())return e;let t=[];return e.map(e=>{if(Array.isArray(e.coordinates)&&Array.isArray(e.coordinates[0])&&Array.isArray(e.coordinates[0][0])){let n=(0,i.default)({},e);e.coordinates.map(e=>{t.push((0,i.default)((0,i.default)({},n),{},{coordinates:e}));});}else t.push(e);}),t;}}},fad5290a:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"paramsParser",{enumerable:!0,get:function(){return r;}});var r={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};},fb04a60c:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return l;}});var r=n("777fffbe"),i=r._(n("f89fb776")),a=r._(n("d812e418")),o=r._(n("4ce96d25")),s=r._(n("c9806a9b"));class l extends o.default{constructor(...e){super(...e),(0,a.default)(this,"type","ImageLayer");}buildModels(){var e=this;return(0,i.default)(function*(){let t=e.getModelType();e.layerModel=new s.default[t](e),yield e.initLayerModels();})();}getDefaultConfig(){return({image:{}})[this.getModelType()];}getModelType(){return"image";}}},fb15d750:function(e,t,n){var r=n("6e3a9823"),i=n("f28dfa76");e.exports=function(e){return!0===e||!1===e||i(e)&&"[object Boolean]"==r(e);};},fb3db304:function(e,t,n){var r=n("2c2fd53f");e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this;};},fc59e6b8:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("a24d4a8c"),n("90d6521d"),n("56792f9b");},fc5ae581:function(e,t,n){var r=n("9133840c"),i=n("81e8f94e");e.exports=function(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=i(n))==n?n:0),void 0!==t&&(t=(t=i(t))==t?t:0),r(i(e),t,n);};},fcdc9f66:function(e,t,n){"use strict";var r;n.d(t,"__esModule",{value:!0}),n.d(t,"DistanceType",{enumerable:!0,get:function(){return r;}}),(r||(r={})).EuclideanDistance="euclideanDistance";},fd2cf6a2:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{MappingAttribute:function(){return a;},getMappingFunction:function(){return i;}});var r=n("a24d4a8c");function i(e,t){return(...n)=>{let r={};return e.forEach((e,t)=>{r[e]=n[t];}),delete r.undefined,t(r);};}class a{static shape(e,t){if((0,r.isString)(t))e.shape(t);else if((0,r.isFunction)(t)){let n=[];e.shape(n.join("*"),i(n,t));}else if((0,r.isObject)(t)){let n=t.field?t.field:"";if((0,r.isFunction)(t.value)){let a=(0,r.isArray)(n)?n:n.split("*");e.shape(n,i(a,t.value));}else e.shape(n,t.value);(0,r.isString)(n)&&t.scale&&a.scale(e,n,t.scale);}}static size(e,t){if((0,r.isNumber)(t))e.size(t);else if((0,r.isArray)(t))e.size(t);else if((0,r.isFunction)(t)){let n=[];e.size(n.join("*"),i(n,t));}else if((0,r.isObject)(t)){let n=t.field?t.field:"";if((0,r.isFunction)(t.value)){let a=(0,r.isArray)(n)?n:n.split("*");e.size(n,i(a,t.value));}else e.size(n,t.value);(0,r.isString)(n)&&t.scale&&a.scale(e,n,t.scale);}}static color(e,t){if((0,r.isString)(t))e.color(t);else if((0,r.isFunction)(t)){let n=[];e.color(n.join("*"),i(n,t));}else if((0,r.isObject)(t)){let n=t.field?t.field:"";if((0,r.isFunction)(t.value)){let a=(0,r.isArray)(n)?n:n.split("*");e.color(n,i(a,t.value));}else e.color(n,t.value);(0,r.isString)(n)&&t.scale&&a.scale(e,n,t.scale);}}static scale(e,t,n){e.scale(t,n);}static rotate(e,t){(0,r.isString)(t)||(0,r.isFunction)(t)||(0,r.isObject)(t);}static texture(e,t){(0,r.isString)(t)&&e.texture(t);}static animate(e,t){((0,r.isBoolean)(t)||(0,r.isObject)(t))&&e.animate(t);}static filter(e,t){let n=t.field?t.field:"",a=(0,r.isArray)(n)?n:n.split("*");e.filter(a.join("*"),i(a,t.value));}static style(e,t){t&&e.style(t);}static state(e,t){let{active:n,select:r}=t;n&&e.active(n),r&&e.select(r);}}},fd305af2:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n("89eaa0ba"),Object.prototype.hasOwnProperty;},fd3c1e7f:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"CanvasContextTypeMap",{enumerable:!0,get:function(){return r;}});let r={canvas2d:"2d",webgl:"webgl",webgl2:"webgl2",webgpu:"webgpu"};},fdef7f46:function(e,t,n){"use strict";var r=n("afa361e1").longestPath,i=n("6fd2fa26"),a=n("3a41b8e4");e.exports=function(e){switch(e.graph().ranker){case"network-simplex":default:a(e);break;case"tight-tree":r(e),i(e);break;case"longest-path":o(e);}};var o=r;},fdf787eb:function(e,t,n){var r=n("5f5b66d7"),i=n("375055b0"),a=n("a23dcf43"),o=n("288b8a90"),s=n("15c12ce8");function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1]);}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,e.exports=l;},fe190914:function(e,t,n){var r=n("aece0d56")("toUpperCase");e.exports=r;},fe2236de:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"default",{enumerable:!0,get:function(){return r;}});var r=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e;};},feb50fb2:function(e,t,n){"use strict";var r=n("ce906886"),i=n("d4539838"),a=n("7242d666"),o=n("fdef7f46"),s=n("b192169f").normalizeRanks,l=n("c67b872d"),u=n("b192169f").removeEmptyRanks,c=n("d239a2bf"),d=n("56657ef2"),f=n("6960d5ca"),h=n("3a08efab"),p=n("248f82c8"),v=n("b192169f"),g=n("5bf20808").Graph;e.exports=function(e,t){var n=t&&t.debugTiming?v.time:v.notime;n("layout",function(){var t=n("  buildLayoutGraph",function(){var t,n;return t=new g({multigraph:!0,compound:!0}),n=k(e.graph()),t.setGraph(r.merge({},y,S(n,m),r.pick(n,b))),r.forEach(e.nodes(),function(n){var i=k(e.node(n));t.setNode(n,r.defaults(S(i,_),x)),t.setParent(n,e.parent(n));}),r.forEach(e.edges(),function(n){var i=k(e.edge(n));t.setEdge(n,r.merge({},E,S(i,w),r.pick(i,M)));}),t;});n("  runLayout",function(){n("    makeSpaceForEdgeLabels",function(){var e;e=t.graph(),e.ranksep/=2,r.forEach(t.edges(),function(n){var r=t.edge(n);r.minlen*=2,"c"!==r.labelpos.toLowerCase()&&("TB"===e.rankdir||"BT"===e.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset);});}),n("    removeSelfEdges",function(){r.forEach(t.edges(),function(e){if(e.v===e.w){var n=t.node(e.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:e,label:t.edge(e)}),t.removeEdge(e);}});}),n("    acyclic",function(){i.run(t);}),n("    nestingGraph.run",function(){c.run(t);}),n("    rank",function(){o(v.asNonCompoundGraph(t));}),n("    injectEdgeLabelProxies",function(){r.forEach(t.edges(),function(e){var n=t.edge(e);if(n.width&&n.height){var r=t.node(e.v),i={rank:(t.node(e.w).rank-r.rank)/2+r.rank,e:e};v.addDummyNode(t,"edge-proxy",i,"_ep");}});}),n("    removeEmptyRanks",function(){u(t);}),n("    nestingGraph.cleanup",function(){c.cleanup(t);}),n("    normalizeRanks",function(){s(t);}),n("    assignRankMinMax",function(){var e;e=0,r.forEach(t.nodes(),function(n){var i=t.node(n);i.borderTop&&(i.minRank=t.node(i.borderTop).rank,i.maxRank=t.node(i.borderBottom).rank,e=r.max(e,i.maxRank));}),t.graph().maxRank=e;}),n("    removeEdgeLabelProxies",function(){r.forEach(t.nodes(),function(e){var n=t.node(e);"edge-proxy"===n.dummy&&(t.edge(n.e).labelRank=n.rank,t.removeNode(e));});}),n("    normalize.run",function(){a.run(t);}),n("    parentDummyChains",function(){l(t);}),n("    addBorderSegments",function(){d(t);}),n("    order",function(){h(t);}),n("    insertSelfEdges",function(){var e;e=v.buildLayerMatrix(t),r.forEach(e,function(e){var n=0;r.forEach(e,function(e,i){var a=t.node(e);a.order=i+n,r.forEach(a.selfEdges,function(e){v.addDummyNode(t,"selfedge",{width:e.label.width,height:e.label.height,rank:a.rank,order:i+ ++n,e:e.e,label:e.label},"_se");}),delete a.selfEdges;});});}),n("    adjustCoordinateSystem",function(){f.adjust(t);}),n("    position",function(){p(t);}),n("    positionSelfEdges",function(){r.forEach(t.nodes(),function(e){var n=t.node(e);if("selfedge"===n.dummy){var r=t.node(n.e.v),i=r.x+r.width/2,a=r.y,o=n.x-i,s=r.height/2;t.setEdge(n.e,n.label),t.removeNode(e),n.label.points=[{x:i+2*o/3,y:a-s},{x:i+5*o/6,y:a-s},{x:i+o,y:a},{x:i+5*o/6,y:a+s},{x:i+2*o/3,y:a+s}],n.label.x=n.x,n.label.y=n.y;}});}),n("    removeBorderNodes",function(){r.forEach(t.nodes(),function(e){if(t.children(e).length){var n=t.node(e),i=t.node(n.borderTop),a=t.node(n.borderBottom),o=t.node(r.last(n.borderLeft)),s=t.node(r.last(n.borderRight));n.width=Math.abs(s.x-o.x),n.height=Math.abs(a.y-i.y),n.x=o.x+n.width/2,n.y=i.y+n.height/2;}}),r.forEach(t.nodes(),function(e){"border"===t.node(e).dummy&&t.removeNode(e);});}),n("    normalize.undo",function(){a.undo(t);}),n("    fixupEdgeLabelCoords",function(){r.forEach(t.edges(),function(e){var n=t.edge(e);if(r.has(n,"x"))switch(("l"===n.labelpos||"r"===n.labelpos)&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;}});}),n("    undoCoordinateSystem",function(){f.undo(t);}),n("    translateGraph",function(){(function(e){var t=Number.POSITIVE_INFINITY,n=0,i=Number.POSITIVE_INFINITY,a=0,o=e.graph(),s=o.marginx||0,l=o.marginy||0;function u(e){var r=e.x,o=e.y,s=e.width,l=e.height;t=Math.min(t,r-s/2),n=Math.max(n,r+s/2),i=Math.min(i,o-l/2),a=Math.max(a,o+l/2);}r.forEach(e.nodes(),function(t){u(e.node(t));}),r.forEach(e.edges(),function(t){var n=e.edge(t);r.has(n,"x")&&u(n);}),t-=s,i-=l,r.forEach(e.nodes(),function(n){var r=e.node(n);r.x-=t,r.y-=i;}),r.forEach(e.edges(),function(n){var a=e.edge(n);r.forEach(a.points,function(e){e.x-=t,e.y-=i;}),r.has(a,"x")&&(a.x-=t),r.has(a,"y")&&(a.y-=i);}),o.width=n-t+s,o.height=a-i+l;})(t);}),n("    assignNodeIntersects",function(){r.forEach(t.edges(),function(e){var n,r,i=t.edge(e),a=t.node(e.v),o=t.node(e.w);i.points?(n=i.points[0],r=i.points[i.points.length-1]):(i.points=[],n=o,r=a),i.points.unshift(v.intersectRect(a,n)),i.points.push(v.intersectRect(o,r));});}),n("    reversePoints",function(){r.forEach(t.edges(),function(e){var n=t.edge(e);n.reversed&&n.points.reverse();});}),n("    acyclic.undo",function(){i.undo(t);});}),n("  updateInputGraph",function(){r.forEach(e.nodes(),function(n){var r=e.node(n),i=t.node(n);r&&(r.x=i.x,r.y=i.y,t.children(n).length&&(r.width=i.width,r.height=i.height));}),r.forEach(e.edges(),function(n){var i=e.edge(n),a=t.edge(n);i.points=a.points,r.has(a,"x")&&(i.x=a.x,i.y=a.y);}),e.graph().width=t.graph().width,e.graph().height=t.graph().height;});});};var m=["nodesep","edgesep","ranksep","marginx","marginy"],y={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},b=["acyclicer","ranker","rankdir","align"],_=["width","height"],x={width:0,height:0},w=["minlen","weight","width","height","labeloffset"],E={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},M=["labelpos"];function S(e,t){return r.mapValues(r.pick(e,t),Number);}function k(e){var t={};return r.forEach(e,function(e,n){t[n.toLowerCase()]=e;}),t;}},fede9095:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"LayerEventMap",{enumerable:!0,get:function(){return r;}});var r={onRemove:"remove",onShow:"show",onHide:"hide",onDataUpdate:"dataUpdate",onLegend:"legend",onLegendColor:"legend:color",onLegendSize:"legend:size",onClick:"click",onUnClick:"unclick",onDblClick:"dblclick",onUndblclick:"undblclick",onContextMenu:"contextmenu",onUnContextMenu:"uncontextmenu",onMouseEnter:"mouseenter",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseUp:"mouseup",onMouseDown:"mousedown",onUnMousemove:"unmousemove",onUnMouseup:"unmouseup",onUnMousedown:"unmousedown",onUnPick:"unpick"};},ff3d9f81:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{circleArraw:function(){return d;},classicArrow:function(){return c;},diamondArrow:function(){return u;},getSymbol:function(){return h;},halfTriangleArrow:function(){return o;},lineArrowPath:function(){return f;},rectArrow:function(){return l;},triangleArrow:function(){return s;}});var r=n("777fffbe")._(n("20d317f9")),i=n("6c69325d");let a={circle:2,triangle:2,diamond:4,rect:2,classic:3,halfTriangle:2,none:0};function o(e,t){let{width:n=2,height:r=1}=t;return{vertices:[0,.5*e,1*e*n,-(r+.5)*e,1*e*n,(r-.5)*e,0,.5*e,1*e*n,-(r+.5)*e,1*e*n,(r-.5)*e],indices:[3,4,5],outLineIndices:[0,1,2],normals:[1*e,-2*e,1,-2*e,1.5*e,1,1*e,1.5*e,1,0,0,0,0,0,0,0,0,0],dimensions:2};}function s(e,t){let{width:n=2,height:r=3}=t;return{vertices:[0,0,1*e*n,1*r,1*e*n,-1*r,0,0,1*e*n,1*r,1*e*n,-1*r],outLineIndices:[0,1,2],indices:[3,4,5],normals:[0,-1.5*e,1,2,1*e,1,-2,1*e,1,0,0,0,0,0,0,0,0,0],dimensions:2};}function l(e,t){let{width:n=2,height:r=2}=t;return{vertices:[0,r/2,e*n*1,r/2,e*n*1,-r/2,0,-r/2,0,r/2,e*n*1,r/2,e*n*1,-r/2,0,-r/2],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]};}function u(e,t){let{width:n=2,height:r=3}=t;return{vertices:[0,0,1*n*e,.5*r,2*n*e,0,1*n*e,-.5*r,0,0,1*n*e,.5*r,2*n*e,0,1*n*e,-.5*r],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]};}function c(e,t){let{width:n=2,height:r=3}=t;return{vertices:[0,0,2*e*n,1*r,1.5*e*n,0,2*e*n,-1*r,0,0,2*e*n,1*r,1.5*e*n,0,2*e*n,-1*r],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]};}function d(e,t){let{width:n=2,height:a=2}=t,o=(0,i.circle)(),s=r.default.flatten([o]),l=(0,r.default)(s.vertices,s.holes,s.dimensions),u=o.map(t=>[t[0]*n*e,t[1]*a]).flat();return{vertices:[...u,...u],dimensions:2,indices:l.map(e=>e+o.length),outLineIndices:l,normals:[...o.map(t=>[t[1]*a,t[0]*n*e,1]).flat(),...Array(3*o.length).fill(0)]};}function f(e,t=0,n){let r="object"==typeof n.source?n.source.type:n.source,i="object"==typeof n.target?n.target.type:n.target,{width:o=r?a[r]:0}="object"==typeof n.source?n.source:{},{width:s=i?a[i]:0}="object"==typeof n.target?n.target:{};return{vertices:[0,.5,1*o,...e,1,.5,-1*s,...e,1,-.5,-1*s,...e,0,-.5,1*o,...e,0,.5,1*o,...e,1,.5,-1*s,...e,1,-.5,-1*s,...e,0,-.5,1*o,...e],outLineIndices:[0,1,2,0,2,3].map(e=>e+t),indices:[4,5,6,4,6,7].map(e=>e+t),normals:[1,-1,1,1,1,1,-1,0,1,-1,0,1,0,0,0,0,0,0,0,0,0,0,0,0],dimensions:2};}function h(e,t){let n="object"==typeof e?e.type:e,r="source"===t?1:-1,i="object"==typeof e?e:{};switch(n){case"circle":return d(r,i);case"triangle":return s(r,i);case"diamond":return u(r,i);case"rect":return l(r,i);case"classic":return c(r,i);case"halfTriangle":return o(r,i);default:return{vertices:[],indices:[],normals:[],dimensions:2,outLineIndices:[],outLineNormals:[]};}}},ff7f0115:function(e,t,n){var r=n("ed2bf8a3"),i=n("bd478e5d");e.exports=function(e){return r.filter(i(e),function(t){return t.length>1||1===t.length&&e.hasEdge(t[0],t[0]);});};}}]);
//# sourceMappingURL=vendors_2-async.6f006f62.js.map